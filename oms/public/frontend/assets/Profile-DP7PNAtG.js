var S=(u,n,i)=>new Promise((d,v)=>{var w=m=>{try{h(i.next(m))}catch(y){v(y)}},C=m=>{try{h(i.throw(m))}catch(y){v(y)}},h=m=>m.done?d(m.value):Promise.resolve(m.value).then(w,C);h((i=i.apply(u,n)).next())});import{o as l,c as a,a as e,_ as F,e as r,E as k,i as M,T as A,n as J,t as c,f as p,G,r as g,s as D,b as P,d as Z,q as K,F as L,g as B}from"./index-CYN7HMaP.js";import{a as Q,r as X}from"./XMarkIcon-UChOyHTY.js";import{r as Y}from"./UserIcon-DUh7elX0.js";function ee(u,n){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})])}function te(u,n){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"})])}function E(u,n){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function oe(u,n){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})])}function se(u,n){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"})])}const ne={class:"px-4 py-3 flex items-center justify-between border-b sticky top-3 bg-white z-10"},le={class:"text-lg font-semibold text-gray-900"},ae={class:"p-4"},re={__name:"BottomSheet",props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:"Details"},fullScreen:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(u){return(n,i)=>(l(),a("div",null,[r(A,{name:"fade"},{default:k(()=>[u.modelValue?(l(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity",onClick:i[0]||(i[0]=d=>n.$emit("update:modelValue",!1))})):M("",!0)]),_:1}),r(A,{name:"slide-up"},{default:k(()=>[u.modelValue?(l(),a("div",{key:0,class:J(["fixed inset-x-0 bottom-0 z-50 bg-white rounded-t-2xl shadow-xl max-h-[90vh] overflow-y-auto",[u.fullScreen?"min-h-screen rounded-none":"max-w-3xl mx-auto"]])},[i[2]||(i[2]=e("div",{class:"w-full flex justify-center pt-2 pb-1 sticky top-0 bg-white z-10"},[e("div",{class:"w-12 h-1.5 bg-gray-300 rounded-full"})],-1)),e("div",ne,[e("h3",le,c(u.title),1),e("button",{onClick:i[1]||(i[1]=d=>n.$emit("update:modelValue",!1)),class:"rounded-full p-1 hover:bg-gray-100 transition-colors"},[r(p(Q),{class:"h-6 w-6 text-gray-500"})])]),e("div",ae,[G(n.$slots,"default",{},void 0,!0)])],2)):M("",!0)]),_:3})]))}},N=F(re,[["__scopeId","data-v-91346965"]]),ie={class:"min-h-screen bg-gray-50"},de={class:"bg-white shadow-sm"},ue={class:"px-4 py-3 flex items-center max-w-5xl mx-auto"},ce={class:"max-w-5xl mx-auto"},me={class:"bg-white mt-2 px-6 py-8 flex flex-col items-center rounded-lg shadow-sm"},pe={class:"relative"},fe={class:"h-28 w-28 rounded-full bg-gray-200 overflow-hidden shadow-md"},ge=["src","alt"],ve={key:1,class:"h-full w-full flex items-center justify-center bg-blue-100 text-blue-600 font-semibold text-3xl"},he={class:"mt-4 text-2xl font-semibold"},ye={class:"text-gray-600"},we={class:"mt-4 flex items-center text-sm text-gray-500"},xe={class:"bg-white mt-4 rounded-lg shadow-sm overflow-hidden"},_e={class:"flex items-center"},be={class:"flex items-center"},ke={class:"flex items-center"},Ce={class:"px-4 mt-6 mb-8"},je={class:"relative flex items-center"},Ve={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},$e={class:"bg-white rounded-lg max-w-sm w-full p-6 shadow-xl"},Se={class:"flex justify-end space-x-3"},De={class:"space-y-4"},Le={class:"text-sm text-gray-500 mb-1"},Be={class:"font-medium text-gray-800"},Ee={class:"space-y-4"},Ne={class:"text-sm text-gray-500 mb-1"},Me={class:"font-medium text-gray-800"},Re={class:"space-y-4"},ze={class:"text-sm text-gray-500 mb-1"},Ie={class:"font-medium text-gray-800"},Oe={__name:"Profile",setup(u){const n=g(null),i=g(null),d=g(null),v=g(window.innerWidth<768),w=g(!1),C=g({}),h=g({}),m=g({}),y=D({get:()=>d.value==="employee",set:s=>{s||(d.value=null)}}),R=D({get:()=>d.value==="company",set:s=>{s||(d.value=null)}}),z=D({get:()=>d.value==="contact",set:s=>{s||(d.value=null)}}),H=s=>s?s.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"",V=s=>s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),O=()=>{w.value=!0},W=()=>S(this,null,function*(){try{yield fetch("/api/method/logout"),window.location.href="/oms/account/login"}catch(s){console.error("Error logging out:",s)}}),q=s=>s?s.startsWith("/private/files")?`/api/method/frappe.utils.file_manager.download_file?file_url=${s}`:s:"",I=()=>{v.value=window.innerWidth<768};P(()=>S(this,null,function*(){var s,t;window.addEventListener("resize",I);try{const _=yield(yield fetch("/api/method/oms.api.get_current_user_info")).json();if(_.message){n.value=_.message;const b=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Employee",filters:{user_id:n.value.name},fields:["*"]})})).json();if((s=b.message)!=null&&s[0]){const o=b.message[0];i.value=o,C.value={first_name:o.first_name,middle_name:o.middle_name,last_name:o.last_name,gender:o.gender,date_of_birth:U(o.date_of_birth),date_of_joining:U(o.date_of_joining),employee_number:o.employee_number,status:o.status},h.value={company:o.company,department:o.department,designation:o.designation,grade:o.grade,branch:o.branch,reports_to:o.reports_to};const T=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Contact",filters:{user:n.value.name},fields:["*"]})})).json();if((t=T.message)!=null&&t[0]){const j=T.message[0];m.value={email:j.email_id,phone:j.phone,mobile_no:j.mobile_no,company_name:j.company_name}}}}}catch(x){console.error("Error fetching profile data:",x)}}));const U=s=>{if(!s)return"";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(t){return s}};return Z(()=>{window.removeEventListener("resize",I)}),(s,t)=>{var x,_,$,b;return l(),a("div",ie,[e("div",de,[e("div",ue,[e("button",{onClick:t[0]||(t[0]=o=>s.$router.back()),class:"mr-2 hover:bg-gray-100 rounded-full p-1.5 transition-colors"},[r(p(X),{class:"h-6 w-6 text-gray-600"})]),t[8]||(t[8]=e("h1",{class:"text-xl font-semibold"},"Profile",-1))])]),e("div",ce,[e("div",me,[e("div",pe,[e("div",fe,[n.value&&n.value.user_image?(l(),a("img",{key:0,src:q(n.value.user_image),alt:n.value.full_name,class:"h-full w-full object-cover"},null,8,ge)):(l(),a("div",ve,c(H((x=n.value)==null?void 0:x.full_name)),1))])]),e("h2",he,c((_=n.value)==null?void 0:_.full_name),1),e("p",ye,c((($=i.value)==null?void 0:$.designation)||"No Designation"),1),e("div",we,[r(p(oe),{class:"h-4 w-4 mr-1"}),e("span",null,c(((b=n.value)==null?void 0:b.name)||"No Email"),1)])]),e("div",xe,[e("button",{onClick:t[1]||(t[1]=o=>d.value="employee"),class:"w-full px-6 py-4 flex items-center justify-between border-b hover:bg-gray-50 transition-colors"},[e("div",_e,[r(p(Y),{class:"h-5 w-5 text-blue-500 mr-3"}),t[9]||(t[9]=e("span",{class:"font-medium"},"Employee Details",-1))]),r(p(E),{class:"h-5 w-5 text-gray-400"})]),e("button",{onClick:t[2]||(t[2]=o=>d.value="company"),class:"w-full px-6 py-4 flex items-center justify-between border-b hover:bg-gray-50 transition-colors"},[e("div",be,[r(p(te),{class:"h-5 w-5 text-green-500 mr-3"}),t[10]||(t[10]=e("span",{class:"font-medium"},"Company Information",-1))]),r(p(E),{class:"h-5 w-5 text-gray-400"})]),e("button",{onClick:t[3]||(t[3]=o=>d.value="contact"),class:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors"},[e("div",ke,[r(p(se),{class:"h-5 w-5 text-purple-500 mr-3"}),t[11]||(t[11]=e("span",{class:"font-medium"},"Contact Information",-1))]),r(p(E),{class:"h-5 w-5 text-gray-400"})])]),e("div",Ce,[e("button",{onClick:O,class:"w-full bg-white text-red-600 font-medium py-4 rounded-lg border border-red-200 shadow-sm hover:bg-red-50 transition-colors flex items-center justify-center relative overflow-hidden group"},[t[13]||(t[13]=e("span",{class:"absolute inset-0 w-3 bg-red-100 transition-all duration-300 ease-out group-hover:w-full"},null,-1)),e("span",je,[r(p(ee),{class:"h-5 w-5 mr-2"}),t[12]||(t[12]=K(" Log Out "))])])])]),w.value?(l(),a("div",Ve,[e("div",$e,[t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"Confirm Logout",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 mb-5"},"Are you sure you want to log out of your account?",-1)),e("div",Se,[e("button",{onClick:t[4]||(t[4]=o=>w.value=!1),class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"}," Cancel "),e("button",{onClick:W,class:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors"}," Logout ")])])])):M("",!0),r(N,{modelValue:y.value,"onUpdate:modelValue":t[5]||(t[5]=o=>y.value=o),title:"Employee Details","full-screen":v.value},{default:k(()=>[e("div",De,[(l(!0),a(L,null,B(C.value,(o,f)=>(l(),a("div",{key:f,class:"bg-gray-50 p-4 rounded-lg"},[e("p",Le,c(V(f)),1),e("p",Be,c(o||"Not specified"),1)]))),128))])]),_:1},8,["modelValue","full-screen"]),r(N,{modelValue:R.value,"onUpdate:modelValue":t[6]||(t[6]=o=>R.value=o),title:"Company Information","full-screen":v.value},{default:k(()=>[e("div",Ee,[(l(!0),a(L,null,B(h.value,(o,f)=>(l(),a("div",{key:f,class:"bg-gray-50 p-4 rounded-lg"},[e("p",Ne,c(V(f)),1),e("p",Me,c(o||"Not specified"),1)]))),128))])]),_:1},8,["modelValue","full-screen"]),r(N,{modelValue:z.value,"onUpdate:modelValue":t[7]||(t[7]=o=>z.value=o),title:"Contact Information","full-screen":v.value},{default:k(()=>[e("div",Re,[(l(!0),a(L,null,B(m.value,(o,f)=>(l(),a("div",{key:f,class:"bg-gray-50 p-4 rounded-lg"},[e("p",ze,c(V(f)),1),e("p",Ie,c(o||"Not specified"),1)]))),128))])]),_:1},8,["modelValue","full-screen"])])}}};export{Oe as default};
