var Vr=Object.defineProperty,Kr=Object.defineProperties;var Gr=Object.getOwnPropertyDescriptors;var yr=Object.getOwnPropertySymbols;var Jr=Object.prototype.hasOwnProperty,Zr=Object.prototype.propertyIsEnumerable;var gr=(S,H,f)=>H in S?Vr(S,H,{enumerable:!0,configurable:!0,writable:!0,value:f}):S[H]=f,lt=(S,H)=>{for(var f in H||(H={}))Jr.call(H,f)&&gr(S,f,H[f]);if(yr)for(var f of yr(H))Zr.call(H,f)&&gr(S,f,H[f]);return S},Zt=(S,H)=>Kr(S,Gr(H));var ge=(S,H,f)=>new Promise((s,a)=>{var p=m=>{try{g(f.next(m))}catch(b){a(b)}},_=m=>{try{g(f.throw(m))}catch(b){a(b)}},g=m=>m.done?s(m.value):Promise.resolve(m.value).then(p,_);g((f=f.apply(S,H)).next())});import{o as q,a as B,b as k,u as Qt,r as he,d as Fe,e as Lt,w as tt,f as Sr,g as Re,v as et,h as ct,i as It,n as De,t as ae,j as ye,k as Tt,F as Oe,l as Le,m as Ae,c as gn,p as Wr,q as Yr,s as Xr,x as Qr,y as eo,z as We,_ as cr,A as dt,B as fr,C as bn,D as sr,E as jt,G as to,H as Nr}from"./index-BWT8cemi.js";function no(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})])}function br(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function ro(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function oo(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})])}function io(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}function lo(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"})])}function ao(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}function so(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function uo(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6h.008v.008H6V6Z"})])}function _r(S,H){return q(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}const ft={doctypeFields:{},linkOptions:{},clientScripts:{}};function dr(){return ge(this,null,function*(){try{return(yield(yield fetch("/api/method/frappe.auth.get_logged_user")).json()).message||null}catch(S){return console.error("Error getting current user:",S),null}})}function co(){return ge(this,null,function*(){try{const H=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Has Role",fields:["role"],filters:{parenttype:"User",parent:yield dr()}})})).json();return H.message?H.message.map(f=>f.role):[]}catch(S){return console.error("Error fetching user roles:",S),[]}})}function fo(){return ge(this,null,function*(){try{const H=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","allow","for_value","apply_to_all_doctypes","applicable_for"],filters:{user:yield dr()}})})).json();return H.message?H.message:[]}catch(S){return console.error("Error fetching user permissions:",S),[]}})}function ho(S){return ge(this,null,function*(){try{const f=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocPerm",fields:["name","role","permlevel","read","write","create","delete","submit","cancel","amend","report","import","export","print","email","share","if_owner"],filters:{parent:S}})})).json();return f.message?f.message:[]}catch(H){return console.error(`Error fetching permissions for ${S}:`,H),[]}})}function Pr(S){return ge(this,null,function*(){if(ft.doctypeFields[S])return ft.doctypeFields[S];try{console.log(`Fetching doctype fields for ${S}...`);try{const a=yield(yield fetch("/api/method/oms.api.get_doctype_fields",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S})})).json();if(a.message&&Array.isArray(a.message)&&a.message.length>0)return ft.doctypeFields[S]=a.message,console.log(`Successfully fetched ${a.message.length} fields using custom API`),a.message;console.log("Custom API returned no fields, falling back to standard API")}catch(s){console.error("Error using custom API, falling back to standard API:",s)}const f=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S})})).json();if(f.message&&f.message.docs&&f.message.docs[0]){const s=f.message.docs[0];return ft.doctypeFields[S]=s.fields||[],console.log(`Successfully fetched ${s.fields.length} fields using standard API`),s.fields}else throw console.error("Failed to get fields from standard API"),new Error("Failed to get doctype fields")}catch(H){throw console.error("Error fetching doctype fields:",H),H}})}function po(S){return ge(this,null,function*(){try{const H=yield Pr(S),f={};for(const s of H)f[s.fieldname]=s.permlevel||0;return f}catch(H){return console.error(`Error getting field permissions for ${S}:`,H),{}}})}function vo(p){return ge(this,arguments,function*(S,H=["name"],f={},s=0,a=9999){const _=`${S}:${H.join(",")}:${JSON.stringify(f)}:${s}:${a}`;if(ft.linkOptions[_])return ft.linkOptions[_];try{const m=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S,fields:H,filters:f,start:s,limit_page_length:a})})).json();return m.message?(ft.linkOptions[_]=m.message,m.message):[]}catch(g){return console.error(`Error fetching options for ${S}:`,g),[]}})}function mo(S){return ge(this,null,function*(){if(ft.clientScripts[S])return ft.clientScripts[S];try{const f=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Client Script",fields:["name","script","dt","enabled"],filters:{dt:S,enabled:1}})})).json();return f.message?(ft.clientScripts[S]=f.message,f.message):[]}catch(H){return console.error(`Error fetching client scripts for ${S}:`,H),[]}})}function yo(S,H){return ge(this,null,function*(){try{const s=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S,name:H})})).json();if(console.log("Data=",s),s.message)return s.message;throw new Error(`Document ${S} ${H} not found`)}catch(f){throw console.error(`Error fetching document ${S} ${H}:`,f),f}})}function go(S){return ge(this,null,function*(){try{const{doctype:H,fields:f=["*"],filters:s={},orFilters:a,start:p=0,limit:_=20,orderBy:g="creation desc"}=S,m={doctype:H,fields:f,filters:s,start:p,limit_page_length:_};if(a&&a.length>0&&(m.or_filters=a),g){const[i,n]=g.split(" ");m.order_by=`${i} ${n}`}const d=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).json();if(d.message){const n=yield(yield fetch("/api/method/frappe.client.get_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:H,filters:s})})).json();return{records:d.message,totalCount:n.message||d.message.length}}return{records:[],totalCount:0}}catch(H){throw console.error(`Error fetching document list for ${S.doctype}:`,H),H}})}function jr(S){return ge(this,null,function*(){try{const f=yield(yield fetch("/api/method/frappe.client.insert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:S})})).json();if(f.message)return f.message;throw new Error("Failed to create document")}catch(H){throw console.error(`Error creating document ${S.doctype}:`,H),H}})}function Lr(S){return ge(this,null,function*(){try{const f=yield(yield fetch("/api/method/frappe.client.save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:S})})).json();if(f.message)return f.message;throw new Error("Failed to update document")}catch(H){throw console.error(`Error updating document ${S.doctype} ${S.name}:`,H),H}})}function bo(S,H=!1){return ge(this,null,function*(){return H?jr(S):Lr(S)})}function _o(S,H){return ge(this,null,function*(){try{if((yield(yield fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S,name:H})})).json()).message==="ok")return!0;throw new Error("Failed to delete document")}catch(f){throw console.error(`Error deleting document ${S} ${H}:`,f),f}})}function $r(S){return ge(this,null,function*(){try{const H=new FormData;H.append("file",S),H.append("is_private",0);const s=yield(yield fetch("/api/method/upload_file",{method:"POST",body:H})).json();if(s.exc_type||s.exception){let a="Failed to upload file";if(s._server_messages)try{const p=JSON.parse(s._server_messages);Array.isArray(p)?a=JSON.parse(p[0]).message||a:a=p.message||a}catch(p){a=s._server_messages}else if(s.exception){const p=s.exception.match(/ValidationError: (.*?)($|\n)/);p&&p[1]&&(a=p[1])}throw console.error("Upload failed:",a),new Error(a)}if(s.message&&s.message.file_url)return console.log("File uploaded successfully:",s.message.file_url),s.message.file_url;throw new Error("Failed to upload file: No file URL returned")}catch(H){throw console.error("Error uploading file:",H),H}})}function Cr(S,H,f,s){return ge(this,null,function*(){try{if(!f||!H)throw new Error("Document name and type are required to attach a file");const _=yield(yield fetch("/api/method/frappe.client.insert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:{doctype:"File",file_url:S,attached_to_doctype:H,attached_to_name:f,attached_to_field:s,is_private:0}})})).json();if(_.exc_type||_.exception){let g="Failed to attach file to document";if(_._server_messages)try{const m=JSON.parse(_._server_messages);Array.isArray(m)?g=JSON.parse(m[0]).message||g:g=m.message||g}catch(m){g=_._server_messages}else if(_.exception){const m=_.exception.match(/ValidationError: (.*?)($|\n)/);m&&m[1]&&(g=m[1])}throw console.error("Attachment failed:",g),new Error(g)}return _.message&&_.message.file_url?(console.log("File attached successfully:",_.message.file_url),_.message.file_url):S}catch(a){throw console.error("Error attaching file to document:",a),a}})}function wo(S,H,f,s){return ge(this,null,function*(){try{const a=yield $r(S);return s?yield Cr(a,H,s,f):a}catch(a){throw console.error("Error in uploadFile:",a),a}})}function xo(){ft.doctypeFields={},ft.linkOptions={},ft.clientScripts={}}const Ue={getCurrentUser:dr,fetchUserRoles:co,fetchUserPermissions:fo,fetchDocPermissions:ho,fetchDoctypeFields:Pr,getFieldPermissions:po,fetchLinkOptions:vo,fetchClientScripts:mo,fetchDocument:yo,fetchDocumentList:go,createDocument:jr,updateDocument:Lr,saveDocument:bo,deleteDocument:_o,uploadFile:wo,uploadFileToTemp:$r,attachFileToDoc:Cr,clearCache:xo};function ko(S){return ge(this,null,function*(){try{console.log(`Checking permissions for ${S}...`);const H={read:1,write:1,create:1,delete:1,submit:0,cancel:0,report:1,share:1,if_owner:0,read_all:1};try{const s=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S})});if(s.ok){const a=yield s.json();if(a.message)return console.log(`Direct permissions API for ${S}:`,a.message),{read:a.message.read||1,write:a.message.write||1,create:a.message.create||1,delete:a.message.delete||1,submit:a.message.submit||0,cancel:a.message.cancel||0,amend:a.message.amend||0,report:a.message.report||1,import:a.message.import||0,export:a.message.export||0,print:a.message.print||0,email:a.message.email||0,share:a.message.share||1,if_owner:a.message.if_owner||0,read_all:1}}}catch(s){console.error("Error using direct permissions API:",s)}let f=[];try{const s=yield fetch("/api/method/frappe.auth.get_roles");s.ok&&(f=(yield s.json()).message||[],console.log("User roles:",f))}catch(s){console.error("Error fetching user roles:",s)}if(f.includes("Support Team"))return console.log("User has Support Team role, granting all permissions"),H;try{const s=yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:S})});if(s.ok){const a=yield s.json();if(a.message&&a.message._permissions){const p=a.message._permissions;return console.log(`Permissions from getdoctype for ${S}:`,p),{read:(p.read,1),write:(p.write,1),create:(p.create,1),delete:(p.delete,1),submit:p.submit?1:0,cancel:p.cancel?1:0,amend:p.amend?1:0,report:(p.report,1),import:p.import?1:0,export:p.export?1:0,print:p.print?1:0,email:p.email?1:0,share:(p.share,1),if_owner:p.if_owner?1:0,read_all:1}}}}catch(s){console.error("Error using getdoctype API:",s)}return console.log(`Using default permissions for ${S}`),H}catch(H){return console.error(`Error fetching permissions for ${S}:`,H),{read:1,write:1,create:1,delete:1,submit:0,cancel:0,report:1,share:1,if_owner:0,read_all:1}}})}function Yt(){return ge(this,null,function*(){try{const S=yield fetch("/api/method/frappe.auth.get_logged_user");if(!S.ok)return console.error("Error fetching current user: Response not OK"),null;const H=yield S.json();return H.message?(console.log("Current user:",H.message),H.message):null}catch(S){return console.error("Error fetching current user:",S),null}})}const Oo={class:"p-4"},Eo={class:"bg-white rounded-xl shadow-md p-3 mb-4 sticky top-0 z-10"},Ao={class:"flex items-center gap-2"},To={class:"flex-1 relative"},So=["placeholder"],No={class:"relative"},Po={key:0,class:"absolute -top-1 -right-1 bg-blue-600 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center"},jo={key:0,class:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg z-50 p-3 border filter-dropdown"},Lo={key:0,class:"mb-3"},$o=["value"],Co={class:"block text-xs font-medium text-gray-700 mb-1"},Do=["onUpdate:modelValue"],Ro={value:""},Mo=["value"],Io=["onUpdate:modelValue"],Fo={value:""},qo=["value"],Bo={key:2,class:"flex gap-2"},Uo=["onUpdate:modelValue"],Ho=["onUpdate:modelValue"],zo=["onUpdate:modelValue","placeholder"],Vo={class:"mb-3"},Ko={class:"mb-3"},Go=["value"],Jo=["value"],Zo={key:0,class:"flex justify-center items-center py-8"},Wo={key:1,class:"bg-white rounded-xl shadow-md p-6 text-center"},Yo={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-100 flex items-center justify-center"},Xo={class:"text-gray-600 mb-4"},Qo={key:2,class:"space-y-4"},ei=["onClick"],ti={class:"flex justify-between items-start"},ni={class:"flex-1"},ri={class:"flex items-center space-x-2 flex-wrap gap-2"},oi={class:"text-sm text-gray-500"},ii={key:1,class:"flex items-center text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full"},li={key:2,class:"flex items-center text-gray-600 bg-gray-50 px-2 py-0.5 rounded-full"},ai={class:"text-xs font-medium"},si={class:"font-semibold text-gray-800 mt-1 text-lg"},ui={class:"flex flex-wrap gap-4 mt-2"},ci={key:3,class:"mt-6 flex justify-between items-center"},fi=["disabled"],di={class:"text-sm text-gray-600 bg-white px-4 py-2 rounded-lg border"},hi=["disabled"],pi={__name:"ListView",props:{doctype:{type:String,required:!0},titleField:{type:String,default:"subject"},listFields:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})},showOnlyOwnRecords:{type:Boolean,default:!1}},emits:["record-click"],setup(S,{emit:H}){const f=S;Qt();const s=he([]),a=he(!0),p=he([]);he(null);const _=he({}),g=he([]),m=he(!1),b=he(null),d=he({}),i=he({}),n=he(""),t=he(""),l=he({}),u=he({}),c=he("creation desc"),r=he(""),o=he(!1),v=he(1),e=he(20),y=he(1),j=he(0),N=he([]),P=Fe(()=>f.doctype.toLowerCase().replace(/\s+/g,"-")),I=Fe(()=>t.value!==""||n.value!==""||r.value!==""||Object.values(l.value).some(Q=>Q!=="")||Object.values(u.value).some(Q=>Q.from||Q.to)),x=Fe(()=>{let Q=0;return t.value&&Q++,n.value&&Q++,r.value&&Q++,Q+=Object.values(l.value).filter(G=>G!=="").length,Q+=Object.values(u.value).filter(G=>G.from||G.to).length,Q}),w=Fe(()=>p.value.find(Q=>Q.fieldname==="status")),O=Fe(()=>p.value.filter(Q=>["Data","Link","Select","Date","Datetime"].includes(Q.fieldtype))),$=Fe(()=>p.value.filter(Q=>["Data","Link","Select","Date","Datetime","Int","Float"].includes(Q.fieldtype)&&!["name","creation","modified","modified_by","owner"].includes(Q.fieldname)&&Q.fieldname!=="status").slice(0,5)),F=Fe(()=>{if(f.listFields.length>0)return f.listFields.map(R=>p.value.find(V=>V.fieldname===R)).filter(Boolean);const Q=p.value.filter(R=>R.in_list_view===1||R.in_list_view===!0||R.in_list_view==="1");if(Q.length>0)return Q.slice(0,4);const G=["name","title","subject","status","creation"];return p.value.filter(R=>G.includes(R.fieldname)).slice(0,3)}),K=()=>ge(this,null,function*(){try{m.value=!0,console.log(`Permission check for ${f.doctype}: canCreate = ${m.value}`);const Q=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:f.doctype})});if(Q.ok){const G=yield Q.json();G.message&&(m.value=!0,console.log(`Direct permissions for ${f.doctype}:`,G.message))}}catch(Q){console.error("Error checking permissions:",Q),m.value=!0}}),ee=()=>ge(this,null,function*(){try{const Q=yield Ue.fetchDoctypeFields(f.doctype);if(Array.isArray(Q))p.value=Q;else if(Q&&Q.fields)p.value=Q.fields;else throw new Error("Invalid response format");p.value.filter(G=>G.fieldtype==="Date"||G.fieldtype==="Datetime").forEach(G=>{u.value[G.fieldname]={from:"",to:""}}),yield M()}catch(Q){console.error("Error fetching doctype fields:",Q),Q.value="Failed to load doctype fields"}}),Z=()=>ge(this,null,function*(){try{const G=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield Yt()]}})})).json();G.message&&(g.value=G.message,console.log("User permissions:",g.value))}catch(Q){console.error("Error fetching user permissions:",Q)}}),M=()=>ge(this,null,function*(){const Q=[...F.value,...$.value].filter(G=>G&&G.fieldtype==="Link").reduce((G,R)=>(G.some(V=>V.fieldname===R.fieldname)||G.push(R),G),[]);for(const G of Q)try{console.log(`Fetching options for ${G.fieldname} (${G.options})`);let R=[];G.options==="Project"?R=(yield Ue.fetchLinkOptions("Project",["name","project_name"])).map(L=>({value:L.name,label:L.project_name||L.name})):G.options==="Contact"?R=(yield Ue.fetchLinkOptions("Contact",["name","first_name","last_name"])).map(L=>({value:L.name,label:`${L.first_name||""} ${L.last_name||""} (${L.name})`})):R=(yield Ue.fetchLinkOptions(G.options,["name"])).map(L=>({value:L.name,label:L.name})),_.value[G.fieldname]=R}catch(R){console.error(`Error fetching options for ${G.fieldname}:`,R)}}),T=()=>ge(this,null,function*(){try{b.value||(b.value=yield Yt());const G=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["reference_name","allocated_to"],filters:{reference_type:f.doctype,status:"Open"}})})).json();if(G.message){const R={},V={};G.message.forEach(L=>{L.allocated_to===b.value&&(R[L.reference_name]=!0),V[L.reference_name]=L.allocated_to}),d.value=R,i.value=V,console.log("Assigned records:",d.value),console.log("Assigned users:",i.value)}}catch(Q){console.error("Error fetching assigned records:",Q)}}),A=Q=>d.value[Q.name]===!0||Q.allocated_to&&Q.allocated_to===b.value,E=Q=>i.value[Q.name]&&i.value[Q.name]!==b.value,C=Q=>{const G=i.value[Q.name];return G?G.substring(0,2).toUpperCase():""},z=()=>ge(this,null,function*(){a.value=!0;try{const Q=lt({},f.filters);J(Q),b.value||(b.value=yield Yt()),yield T();let G=[];if(r.value){if(r.value==="assigned_to_me"){const L=Object.keys(d.value);L.length>0?G.push(["name","in",L]):G.push(["name","=","no-assignments-found"]),p.value.some(ce=>ce.fieldname==="allocated_to")&&G.push(["allocated_to","=",b.value])}else if(r.value==="created_by_me")G.push(["owner","=",b.value]);else if(r.value==="both"){const L=Object.keys(d.value);L.length>0&&G.push(["name","in",L]),p.value.some(ce=>ce.fieldname==="allocated_to")&&G.push(["allocated_to","=",b.value]),G.push(["owner","=",b.value])}}else f.showOnlyOwnRecords&&b.value&&(G.push(["owner","=",b.value]),p.value.some(pe=>pe.fieldname==="allocated_to")&&G.push(["allocated_to","=",b.value]),Object.keys(d.value).length>0&&G.push(["name","in",Object.keys(d.value)]));t.value&&(Q.status=t.value);for(const[L,pe]of Object.entries(l.value))pe&&(Q[L]=pe);for(const[L,pe]of Object.entries(u.value))pe.from&&pe.to?Q[L]=["between",[pe.from,pe.to]]:pe.from?Q[L]=[">=",pe.from]:pe.to&&(Q[L]=["<=",pe.to]);let R=[];if(n.value.trim()){const L=n.value.trim();R.push([f.doctype,"name","like",`%${L}%`]),R.push([f.doctype,f.titleField,"like",`%${L}%`])}console.log("Fetching all records with filters:",Q),console.log("OR filters:",G);const V=yield Ue.fetchDocumentList({doctype:f.doctype,fields:["*"],filters:Q,orFilters:G.length>0?G:R.length>0?R:void 0,limit:1e3,orderBy:c.value});N.value=V.records,j.value=V.records.length,y.value=Math.ceil(j.value/e.value),console.log(`Fetched ${N.value.length} total records. Pages: ${y.value}`),te()}catch(Q){console.error(`Error fetching ${f.doctype} records:`,Q),Q.value=`Failed to load ${f.doctype} records`}finally{a.value=!1}}),te=()=>{const Q=(v.value-1)*e.value,G=Math.min(Q+e.value,N.value.length);console.log(`Updating displayed records for page ${v.value}, start: ${Q}, end: ${G}`),s.value=N.value.slice(Q,G),console.log(`Displaying ${s.value.length} records for page ${v.value}`)},J=Q=>{const G=g.value.filter(R=>R.allow===f.doctype);if(G.length>0){const R={};for(const V of G){const L=p.value.filter(pe=>pe.fieldtype==="Link"&&pe.options===V.allow);for(const pe of L)R[pe.fieldname]||(R[pe.fieldname]=[]),R[pe.fieldname].push(V.for_value)}for(const[V,L]of Object.entries(R))L.length===1?Q[V]=L[0]:Q[V]=["in",L]}},U=Q=>Q[f.titleField]||Q.name||"Untitled",X=Q=>{switch(Q.toLowerCase()){case"open":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-green-100 text-green-800";case"resolved":return"bg-blue-100 text-blue-800";case"on hold":case"hold":return"bg-orange-100 text-orange-800";case"replied":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},ne=()=>w.value&&w.value.options?w.value.options.split(`
`):["Open","Closed","Resolved","On Hold","Replied"],re=Q=>_.value[Q.fieldname]||[],de=Q=>Q.options?Q.options.split(`
`):[],be=Q=>{if(!Q)return br;switch(Q.fieldname){case"project":return io;case"priority":return oo;case"custom_raised_by_contact":case"raised_by":case"allocated_to":return eo;case"creation":case"modified":return no;case"status":return uo;case"company":return Qr;case"custom_raised_by_mobile":return Xr;case"email":return Yr;default:return br}},we=Q=>Q?Q.label||Q.fieldname:"",xe=(Q,G)=>{if(!Q||!G)return"";const R=Q[G.fieldname];return R==null?"":G.fieldtype==="Link"&&Q[`${G.fieldname}_data`]?Q[`${G.fieldname}_data`].label||R:G.fieldtype==="Date"||G.fieldtype==="Datetime"?Ee(R):R},Ee=Q=>Q?new Date(Q).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Se=()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{v.value=1,z()},300)},qe=()=>{t.value="",c.value="creation desc",n.value="",l.value={},r.value="";for(const Q in u.value)u.value[Q]={from:"",to:""};o.value=!1,v.value=1,z()},Me=()=>{o.value=!1,v.value=1,z()},ie=()=>{v.value>1&&(v.value--,te())},ue=()=>{v.value<y.value&&(v.value++,te())},ve=Q=>{const G=document.querySelector(".filter-dropdown"),R=document.querySelector(".filter-toggle-btn");o.value&&G&&!G.contains(Q.target)&&!R.contains(Q.target)&&(o.value=!1)};return Lt(()=>ge(this,null,function*(){console.log(`ListView component mounted for ${f.doctype}`);try{b.value=yield Yt(),yield K(),yield ee(),yield Z(),yield T(),yield z()}catch(Q){console.error("Error initializing component:",Q),Q.value="Failed to initialize component"}document.addEventListener("click",ve)})),tt(c,()=>{v.value=1,z()}),tt(()=>f.doctype,()=>ge(this,null,function*(){a.value=!0,p.value=[],s.value=[],N.value=[],v.value=1;try{yield K(),yield ee(),yield Z(),yield T(),yield z()}catch(Q){console.error("Error when doctype changed:",Q)}finally{a.value=!1}})),tt(()=>f.filters,()=>{v.value=1,z()},{deep:!0}),Sr(()=>{document.removeEventListener("click",ve)}),(Q,G)=>(q(),B("div",Oo,[k("div",Eo,[k("div",Ao,[k("div",To,[Re(k("input",{"onUpdate:modelValue":G[0]||(G[0]=R=>n.value=R),type:"text",placeholder:`Search ${S.doctype}...`,class:"w-full pl-8 pr-2 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onInput:Se},null,40,So),[[et,n.value]]),ct(It(ao),{class:"h-4 w-4 text-gray-400 absolute left-2 top-2.5"})]),k("div",No,[k("button",{onClick:G[1]||(G[1]=R=>o.value=!o.value),class:De(["p-2 border rounded-lg hover:bg-gray-50 relative filter-toggle-btn",{"bg-blue-50 border-blue-300":I.value}])},[ct(It(lo),{class:De(["h-5 w-5",I.value?"text-blue-600":"text-gray-600"])},null,8,["class"]),I.value?(q(),B("span",Po,ae(x.value),1)):ye("",!0)],2),o.value?(q(),B("div",jo,[w.value?(q(),B("div",Lo,[G[8]||(G[8]=k("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Status",-1)),Re(k("select",{"onUpdate:modelValue":G[2]||(G[2]=R=>t.value=R),class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[G[7]||(G[7]=k("option",{value:""},"All Status",-1)),(q(!0),B(Oe,null,Le(ne(),R=>(q(),B("option",{key:R,value:R},ae(R),9,$o))),128))],512),[[Tt,t.value]])])):ye("",!0),(q(!0),B(Oe,null,Le($.value,R=>(q(),B("div",{key:R.fieldname,class:"mb-3"},[k("label",Co,ae(R.label),1),R.fieldtype==="Link"?Re((q(),B("select",{key:0,"onUpdate:modelValue":V=>l.value[R.fieldname]=V,class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[k("option",Ro,"All "+ae(R.label),1),(q(!0),B(Oe,null,Le(re(R),V=>(q(),B("option",{key:V.value,value:V.value},ae(V.label),9,Mo))),128))],8,Do)),[[Tt,l.value[R.fieldname]]]):R.fieldtype==="Select"?Re((q(),B("select",{key:1,"onUpdate:modelValue":V=>l.value[R.fieldname]=V,class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[k("option",Fo,"All "+ae(R.label),1),(q(!0),B(Oe,null,Le(de(R),V=>(q(),B("option",{key:V,value:V},ae(V),9,qo))),128))],8,Io)),[[Tt,l.value[R.fieldname]]]):R.fieldtype==="Date"||R.fieldtype==="Datetime"?(q(),B("div",Bo,[Re(k("input",{"onUpdate:modelValue":V=>u.value[R.fieldname].from=V,type:"date",class:"w-1/2 border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"From"},null,8,Uo),[[et,u.value[R.fieldname].from]]),Re(k("input",{"onUpdate:modelValue":V=>u.value[R.fieldname].to=V,type:"date",class:"w-1/2 border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"To"},null,8,Ho),[[et,u.value[R.fieldname].to]])])):Re((q(),B("input",{key:3,"onUpdate:modelValue":V=>l.value[R.fieldname]=V,type:"text",class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Filter by ${R.label}`},null,8,zo)),[[et,l.value[R.fieldname]]])]))),128)),k("div",Vo,[G[10]||(G[10]=k("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Assignment",-1)),Re(k("select",{"onUpdate:modelValue":G[3]||(G[3]=R=>r.value=R),class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},G[9]||(G[9]=[k("option",{value:""},"All Records",-1),k("option",{value:"assigned_to_me"},"Assigned to Me",-1),k("option",{value:"created_by_me"},"Created by Me",-1),k("option",{value:"both"},"Both",-1)]),512),[[Tt,r.value]])]),k("div",Ko,[G[13]||(G[13]=k("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Sort By",-1)),Re(k("select",{"onUpdate:modelValue":G[4]||(G[4]=R=>c.value=R),class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[G[11]||(G[11]=k("option",{value:"creation desc"},"Newest First",-1)),G[12]||(G[12]=k("option",{value:"creation asc"},"Oldest First",-1)),(q(!0),B(Oe,null,Le(O.value,R=>(q(),B("option",{key:R.fieldname,value:`${R.fieldname} asc`},ae(R.label)+" (A-Z) ",9,Go))),128)),(q(!0),B(Oe,null,Le(O.value,R=>(q(),B("option",{key:`${R.fieldname}-desc`,value:`${R.fieldname} desc`},ae(R.label)+" (Z-A) ",9,Jo))),128))],512),[[Tt,c.value]])]),k("div",{class:"flex justify-between"},[k("button",{onClick:qe,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Reset "),k("button",{onClick:Me,class:"px-3 py-1.5 text-sm bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-colors"}," Apply ")])])):ye("",!0)]),m.value?(q(),B("button",{key:0,onClick:G[5]||(G[5]=R=>Q.$router.push(`/${P.value}/new`)),class:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg flex items-center hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-md"},[ct(It(so),{class:"h-5 w-5 mr-1"}),G[14]||(G[14]=Ae(" New "))])):ye("",!0)])]),a.value?(q(),B("div",Zo,G[15]||(G[15]=[k("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):s.value.length===0?(q(),B("div",Wo,[k("div",Yo,[ct(It(ro),{class:"h-8 w-8 text-blue-600"})]),k("p",Xo,"No "+ae(S.doctype)+" found",1),m.value?(q(),B("button",{key:0,onClick:G[6]||(G[6]=R=>Q.$router.push(`/${P.value}/new`)),class:"mt-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-md"}," Create New "+ae(S.doctype),1)):ye("",!0)])):(q(),B("div",Qo,[(q(!0),B(Oe,null,Le(s.value,R=>(q(),B("div",{key:R.name,onClick:V=>Q.$router.push(`/${P.value}/${R.name}`),class:"bg-white rounded-xl shadow-md p-4 cursor-pointer hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 border border-transparent hover:border-blue-100"},[k("div",ti,[k("div",ni,[k("div",ri,[k("span",oi,ae(R.name),1),R.status?(q(),B("div",{key:0,class:De([X(R.status),"px-2 py-0.5 rounded-full text-xs font-medium"])},ae(R.status),3)):ye("",!0),A(R)?(q(),B("div",ii,[ct(It(_r),{class:"h-4 w-4 mr-1"}),G[16]||(G[16]=k("span",{class:"text-xs font-medium"},"Assigned to me",-1))])):E(R)?(q(),B("div",li,[ct(It(_r),{class:"h-4 w-4 mr-1"}),k("span",ai,ae(C(R)),1)])):ye("",!0)]),k("h3",si,ae(U(R)),1),k("div",ui,[(q(!0),B(Oe,null,Le(F.value,(V,L)=>(q(),B("div",{key:L,class:"flex items-center text-sm text-gray-500"},[(q(),gn(Wr(be(V)),{class:"h-4 w-4 mr-1 text-blue-500"})),k("span",null,ae(we(V))+": "+ae(xe(R,V)),1)]))),128))])])])],8,ei))),128))])),y.value>1?(q(),B("div",ci,[k("button",{onClick:ie,disabled:v.value===1,class:"px-4 py-2 bg-white border rounded-lg disabled:opacity-50 hover:bg-gray-50 transition-colors flex items-center"},G[17]||(G[17]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),Ae(" Previous ")]),8,fi),k("span",di," Page "+ae(v.value)+" of "+ae(y.value),1),k("button",{onClick:ue,disabled:v.value===y.value,class:"px-4 py-2 bg-white border rounded-lg disabled:opacity-50 hover:bg-gray-50 transition-colors flex items-center"},G[18]||(G[18]=[Ae(" Next "),k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,hi)])):ye("",!0)]))}},vi={hiddenFields:[],readonlyFields:[],hiddenViewFields:[]},mi={Task:{hiddenFields:["tna_base_document_no","tna_planne","custom_tna_end_date","completed_by","completed_on","start","duration","custom_section_break_iahoa","custom_task_resource","custom_total_amount","sb_depends_on","depends_on","depends_on_tasks","act_start_date","act_end_date","review_date","closing_date","custom_development_checklist","custom_qc_check","color"],readonlyFields:[],hiddenViewFields:["custom_section_break_iahoa","custom_task_resource","custom_total_amount","sb_depends_on","depends_on","actual_time","custom_developer_name","custom_development_complete","company","custom_development_checklist","custom_qc_complete","custom_qc_check"]},Issue:{hiddenFields:[],readonlyFields:[],hiddenViewFields:[]}};function yi(S){return mi[S]||vi}function wr(S,H){return yi(S).hiddenViewFields.includes(H)}var gi={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(S,H){(function(s,a){S.exports=a()})(typeof self!="undefined"?self:We,function(){return function(f){var s={};function a(p){if(s[p])return s[p].exports;var _=s[p]={i:p,l:!1,exports:{}};return f[p].call(_.exports,_,_.exports,a),_.l=!0,_.exports}return a.m=f,a.c=s,a.d=function(p,_,g){a.o(p,_)||Object.defineProperty(p,_,{configurable:!1,enumerable:!0,get:g})},a.n=function(p){var _=p&&p.__esModule?function(){return p.default}:function(){return p};return a.d(_,"a",_),_},a.o=function(p,_){return Object.prototype.hasOwnProperty.call(p,_)},a.p="",a(a.s=109)}([function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(17),_=a(18),g=a(19),m=a(45),b=a(46),d=a(47),i=a(48),n=a(49),t=a(12),l=a(32),u=a(33),c=a(31),r=a(1),o={Scope:r.Scope,create:r.create,find:r.find,query:r.query,register:r.register,Container:p.default,Format:_.default,Leaf:g.default,Embed:i.default,Scroll:m.default,Block:d.default,Inline:b.default,Text:n.default,Attributor:{Attribute:t.default,Class:l.default,Style:u.default,Store:c.default}};s.default=o},function(f,s,a){var p=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var v in o)o.hasOwnProperty(v)&&(r[v]=o[v])};return function(r,o){c(r,o);function v(){this.constructor=r}r.prototype=o===null?Object.create(o):(v.prototype=o.prototype,new v)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=function(c){p(r,c);function r(o){var v=this;return o="[Parchment] "+o,v=c.call(this,o)||this,v.message=o,v.name=v.constructor.name,v}return r}(Error);s.ParchmentError=_;var g={},m={},b={},d={};s.DATA_KEY="__blot";var i;(function(c){c[c.TYPE=3]="TYPE",c[c.LEVEL=12]="LEVEL",c[c.ATTRIBUTE=13]="ATTRIBUTE",c[c.BLOT=14]="BLOT",c[c.INLINE=7]="INLINE",c[c.BLOCK=11]="BLOCK",c[c.BLOCK_BLOT=10]="BLOCK_BLOT",c[c.INLINE_BLOT=6]="INLINE_BLOT",c[c.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",c[c.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",c[c.ANY=15]="ANY"})(i=s.Scope||(s.Scope={}));function n(c,r){var o=l(c);if(o==null)throw new _("Unable to create "+c+" blot");var v=o,e=c instanceof Node||c.nodeType===Node.TEXT_NODE?c:v.create(r);return new v(e,r)}s.create=n;function t(c,r){return r===void 0&&(r=!1),c==null?null:c[s.DATA_KEY]!=null?c[s.DATA_KEY].blot:r?t(c.parentNode,r):null}s.find=t;function l(c,r){r===void 0&&(r=i.ANY);var o;if(typeof c=="string")o=d[c]||g[c];else if(c instanceof Text||c.nodeType===Node.TEXT_NODE)o=d.text;else if(typeof c=="number")c&i.LEVEL&i.BLOCK?o=d.block:c&i.LEVEL&i.INLINE&&(o=d.inline);else if(c instanceof HTMLElement){var v=(c.getAttribute("class")||"").split(/\s+/);for(var e in v)if(o=m[v[e]],o)break;o=o||b[c.tagName]}return o==null?null:r&i.LEVEL&o.scope&&r&i.TYPE&o.scope?o:null}s.query=l;function u(){for(var c=[],r=0;r<arguments.length;r++)c[r]=arguments[r];if(c.length>1)return c.map(function(e){return u(e)});var o=c[0];if(typeof o.blotName!="string"&&typeof o.attrName!="string")throw new _("Invalid definition");if(o.blotName==="abstract")throw new _("Cannot register abstract class");if(d[o.blotName||o.attrName]=o,typeof o.keyName=="string")g[o.keyName]=o;else if(o.className!=null&&(m[o.className]=o),o.tagName!=null){Array.isArray(o.tagName)?o.tagName=o.tagName.map(function(e){return e.toUpperCase()}):o.tagName=o.tagName.toUpperCase();var v=Array.isArray(o.tagName)?o.tagName:[o.tagName];v.forEach(function(e){(b[e]==null||o.className==null)&&(b[e]=o)})}return o}s.register=u},function(f,s,a){var p=a(51),_=a(11),g=a(3),m=a(20),b="\0",d=function(i){Array.isArray(i)?this.ops=i:i!=null&&Array.isArray(i.ops)?this.ops=i.ops:this.ops=[]};d.prototype.insert=function(i,n){var t={};return i.length===0?this:(t.insert=i,n!=null&&typeof n=="object"&&Object.keys(n).length>0&&(t.attributes=n),this.push(t))},d.prototype.delete=function(i){return i<=0?this:this.push({delete:i})},d.prototype.retain=function(i,n){if(i<=0)return this;var t={retain:i};return n!=null&&typeof n=="object"&&Object.keys(n).length>0&&(t.attributes=n),this.push(t)},d.prototype.push=function(i){var n=this.ops.length,t=this.ops[n-1];if(i=g(!0,{},i),typeof t=="object"){if(typeof i.delete=="number"&&typeof t.delete=="number")return this.ops[n-1]={delete:t.delete+i.delete},this;if(typeof t.delete=="number"&&i.insert!=null&&(n-=1,t=this.ops[n-1],typeof t!="object"))return this.ops.unshift(i),this;if(_(i.attributes,t.attributes)){if(typeof i.insert=="string"&&typeof t.insert=="string")return this.ops[n-1]={insert:t.insert+i.insert},typeof i.attributes=="object"&&(this.ops[n-1].attributes=i.attributes),this;if(typeof i.retain=="number"&&typeof t.retain=="number")return this.ops[n-1]={retain:t.retain+i.retain},typeof i.attributes=="object"&&(this.ops[n-1].attributes=i.attributes),this}}return n===this.ops.length?this.ops.push(i):this.ops.splice(n,0,i),this},d.prototype.chop=function(){var i=this.ops[this.ops.length-1];return i&&i.retain&&!i.attributes&&this.ops.pop(),this},d.prototype.filter=function(i){return this.ops.filter(i)},d.prototype.forEach=function(i){this.ops.forEach(i)},d.prototype.map=function(i){return this.ops.map(i)},d.prototype.partition=function(i){var n=[],t=[];return this.forEach(function(l){var u=i(l)?n:t;u.push(l)}),[n,t]},d.prototype.reduce=function(i,n){return this.ops.reduce(i,n)},d.prototype.changeLength=function(){return this.reduce(function(i,n){return n.insert?i+m.length(n):n.delete?i-n.delete:i},0)},d.prototype.length=function(){return this.reduce(function(i,n){return i+m.length(n)},0)},d.prototype.slice=function(i,n){i=i||0,typeof n!="number"&&(n=1/0);for(var t=[],l=m.iterator(this.ops),u=0;u<n&&l.hasNext();){var c;u<i?c=l.next(i-u):(c=l.next(n-u),t.push(c)),u+=m.length(c)}return new d(t)},d.prototype.compose=function(i){var n=m.iterator(this.ops),t=m.iterator(i.ops),l=[],u=t.peek();if(u!=null&&typeof u.retain=="number"&&u.attributes==null){for(var c=u.retain;n.peekType()==="insert"&&n.peekLength()<=c;)c-=n.peekLength(),l.push(n.next());u.retain-c>0&&t.next(u.retain-c)}for(var r=new d(l);n.hasNext()||t.hasNext();)if(t.peekType()==="insert")r.push(t.next());else if(n.peekType()==="delete")r.push(n.next());else{var o=Math.min(n.peekLength(),t.peekLength()),v=n.next(o),e=t.next(o);if(typeof e.retain=="number"){var y={};typeof v.retain=="number"?y.retain=o:y.insert=v.insert;var j=m.attributes.compose(v.attributes,e.attributes,typeof v.retain=="number");if(j&&(y.attributes=j),r.push(y),!t.hasNext()&&_(r.ops[r.ops.length-1],y)){var N=new d(n.rest());return r.concat(N).chop()}}else typeof e.delete=="number"&&typeof v.retain=="number"&&r.push(e)}return r.chop()},d.prototype.concat=function(i){var n=new d(this.ops.slice());return i.ops.length>0&&(n.push(i.ops[0]),n.ops=n.ops.concat(i.ops.slice(1))),n},d.prototype.diff=function(i,n){if(this.ops===i.ops)return new d;var t=[this,i].map(function(o){return o.map(function(v){if(v.insert!=null)return typeof v.insert=="string"?v.insert:b;var e=o===i?"on":"with";throw new Error("diff() called "+e+" non-document")}).join("")}),l=new d,u=p(t[0],t[1],n),c=m.iterator(this.ops),r=m.iterator(i.ops);return u.forEach(function(o){for(var v=o[1].length;v>0;){var e=0;switch(o[0]){case p.INSERT:e=Math.min(r.peekLength(),v),l.push(r.next(e));break;case p.DELETE:e=Math.min(v,c.peekLength()),c.next(e),l.delete(e);break;case p.EQUAL:e=Math.min(c.peekLength(),r.peekLength(),v);var y=c.next(e),j=r.next(e);_(y.insert,j.insert)?l.retain(e,m.attributes.diff(y.attributes,j.attributes)):l.push(j).delete(e);break}v-=e}}),l.chop()},d.prototype.eachLine=function(i,n){n=n||`
`;for(var t=m.iterator(this.ops),l=new d,u=0;t.hasNext();){if(t.peekType()!=="insert")return;var c=t.peek(),r=m.length(c)-t.peekLength(),o=typeof c.insert=="string"?c.insert.indexOf(n,r)-r:-1;if(o<0)l.push(t.next());else if(o>0)l.push(t.next(o));else{if(i(l,t.next(1).attributes||{},u)===!1)return;u+=1,l=new d}}l.length()>0&&i(l,{},u)},d.prototype.transform=function(i,n){if(n=!!n,typeof i=="number")return this.transformPosition(i,n);for(var t=m.iterator(this.ops),l=m.iterator(i.ops),u=new d;t.hasNext()||l.hasNext();)if(t.peekType()==="insert"&&(n||l.peekType()!=="insert"))u.retain(m.length(t.next()));else if(l.peekType()==="insert")u.push(l.next());else{var c=Math.min(t.peekLength(),l.peekLength()),r=t.next(c),o=l.next(c);if(r.delete)continue;o.delete?u.push(o):u.retain(c,m.attributes.transform(r.attributes,o.attributes,n))}return u.chop()},d.prototype.transformPosition=function(i,n){n=!!n;for(var t=m.iterator(this.ops),l=0;t.hasNext()&&l<=i;){var u=t.peekLength(),c=t.peekType();if(t.next(),c==="delete"){i-=Math.min(u,i-l);continue}else c==="insert"&&(l<i||!n)&&(i+=u);l+=u}return i},f.exports=d},function(f,s){var a=Object.prototype.hasOwnProperty,p=Object.prototype.toString,_=Object.defineProperty,g=Object.getOwnPropertyDescriptor,m=function(t){return typeof Array.isArray=="function"?Array.isArray(t):p.call(t)==="[object Array]"},b=function(t){if(!t||p.call(t)!=="[object Object]")return!1;var l=a.call(t,"constructor"),u=t.constructor&&t.constructor.prototype&&a.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!l&&!u)return!1;var c;for(c in t);return typeof c=="undefined"||a.call(t,c)},d=function(t,l){_&&l.name==="__proto__"?_(t,l.name,{enumerable:!0,configurable:!0,value:l.newValue,writable:!0}):t[l.name]=l.newValue},i=function(t,l){if(l==="__proto__")if(a.call(t,l)){if(g)return g(t,l).value}else return;return t[l]};f.exports=function n(){var t,l,u,c,r,o,v=arguments[0],e=1,y=arguments.length,j=!1;for(typeof v=="boolean"&&(j=v,v=arguments[1]||{},e=2),(v==null||typeof v!="object"&&typeof v!="function")&&(v={});e<y;++e)if(t=arguments[e],t!=null)for(l in t)u=i(v,l),c=i(t,l),v!==c&&(j&&c&&(b(c)||(r=m(c)))?(r?(r=!1,o=u&&m(u)?u:[]):o=u&&b(u)?u:{},d(v,{name:l,newValue:n(j,o,c)})):typeof c!="undefined"&&d(v,{name:l,newValue:c}));return v}},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.BlockEmbed=s.bubbleFormats=void 0;var p=function(){function w(O,$){for(var F=0;F<$.length;F++){var K=$[F];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(O,K.key,K)}}return function(O,$,F){return $&&w(O.prototype,$),F&&w(O,F),O}}(),_=function w(O,$,F){O===null&&(O=Function.prototype);var K=Object.getOwnPropertyDescriptor(O,$);if(K===void 0){var ee=Object.getPrototypeOf(O);return ee===null?void 0:w(ee,$,F)}else{if("value"in K)return K.value;var Z=K.get;return Z===void 0?void 0:Z.call(F)}},g=a(3),m=v(g),b=a(2),d=v(b),i=a(0),n=v(i),t=a(16),l=v(t),u=a(6),c=v(u),r=a(7),o=v(r);function v(w){return w&&w.__esModule?w:{default:w}}function e(w,O){if(!(w instanceof O))throw new TypeError("Cannot call a class as a function")}function y(w,O){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:w}function j(w,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);w.prototype=Object.create(O&&O.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(w,O):w.__proto__=O)}var N=1,P=function(w){j(O,w);function O(){return e(this,O),y(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return p(O,[{key:"attach",value:function(){_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"attach",this).call(this),this.attributes=new n.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new d.default().insert(this.value(),(0,m.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(F,K){var ee=n.default.query(F,n.default.Scope.BLOCK_ATTRIBUTE);ee!=null&&this.attributes.attribute(ee,K)}},{key:"formatAt",value:function(F,K,ee,Z){this.format(ee,Z)}},{key:"insertAt",value:function(F,K,ee){if(typeof K=="string"&&K.endsWith(`
`)){var Z=n.default.create(I.blotName);this.parent.insertBefore(Z,F===0?this:this.next),Z.insertAt(0,K.slice(0,-1))}else _(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertAt",this).call(this,F,K,ee)}}]),O}(n.default.Embed);P.scope=n.default.Scope.BLOCK_BLOT;var I=function(w){j(O,w);function O($){e(this,O);var F=y(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,$));return F.cache={},F}return p(O,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(n.default.Leaf).reduce(function(F,K){return K.length()===0?F:F.insert(K.value(),x(K))},new d.default).insert(`
`,x(this))),this.cache.delta}},{key:"deleteAt",value:function(F,K){_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"deleteAt",this).call(this,F,K),this.cache={}}},{key:"formatAt",value:function(F,K,ee,Z){K<=0||(n.default.query(ee,n.default.Scope.BLOCK)?F+K===this.length()&&this.format(ee,Z):_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"formatAt",this).call(this,F,Math.min(K,this.length()-F-1),ee,Z),this.cache={})}},{key:"insertAt",value:function(F,K,ee){if(ee!=null)return _(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertAt",this).call(this,F,K,ee);if(K.length!==0){var Z=K.split(`
`),M=Z.shift();M.length>0&&(F<this.length()-1||this.children.tail==null?_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertAt",this).call(this,Math.min(F,this.length()-1),M):this.children.tail.insertAt(this.children.tail.length(),M),this.cache={});var T=this;Z.reduce(function(A,E){return T=T.split(A,!0),T.insertAt(0,E),E.length},F+M.length)}}},{key:"insertBefore",value:function(F,K){var ee=this.children.head;_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertBefore",this).call(this,F,K),ee instanceof l.default&&ee.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"length",this).call(this)+N),this.cache.length}},{key:"moveChildren",value:function(F,K){_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"moveChildren",this).call(this,F,K),this.cache={}}},{key:"optimize",value:function(F){_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"optimize",this).call(this,F),this.cache={}}},{key:"path",value:function(F){return _(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"path",this).call(this,F,!0)}},{key:"removeChild",value:function(F){_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"removeChild",this).call(this,F),this.cache={}}},{key:"split",value:function(F){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(K&&(F===0||F>=this.length()-N)){var ee=this.clone();return F===0?(this.parent.insertBefore(ee,this),this):(this.parent.insertBefore(ee,this.next),ee)}else{var Z=_(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"split",this).call(this,F,K);return this.cache={},Z}}}]),O}(n.default.Block);I.blotName="block",I.tagName="P",I.defaultChild="break",I.allowedChildren=[c.default,n.default.Embed,o.default];function x(w){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return w==null||(typeof w.formats=="function"&&(O=(0,m.default)(O,w.formats())),w.parent==null||w.parent.blotName=="scroll"||w.parent.statics.scope!==w.statics.scope)?O:x(w.parent,O)}s.bubbleFormats=x,s.BlockEmbed=P,s.default=I},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.overload=s.expandConfig=void 0;var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},_=function(){function T(A,E){var C=[],z=!0,te=!1,J=void 0;try{for(var U=A[Symbol.iterator](),X;!(z=(X=U.next()).done)&&(C.push(X.value),!(E&&C.length===E));z=!0);}catch(ne){te=!0,J=ne}finally{try{!z&&U.return&&U.return()}finally{if(te)throw J}}return C}return function(A,E){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return T(A,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function T(A,E){for(var C=0;C<E.length;C++){var z=E[C];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(A,z.key,z)}}return function(A,E,C){return E&&T(A.prototype,E),C&&T(A,C),A}}();a(50);var m=a(2),b=x(m),d=a(14),i=x(d),n=a(8),t=x(n),l=a(9),u=x(l),c=a(0),r=x(c),o=a(15),v=x(o),e=a(3),y=x(e),j=a(10),N=x(j),P=a(34),I=x(P);function x(T){return T&&T.__esModule?T:{default:T}}function w(T,A,E){return A in T?Object.defineProperty(T,A,{value:E,enumerable:!0,configurable:!0,writable:!0}):T[A]=E,T}function O(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")}var $=(0,N.default)("quill"),F=function(){g(T,null,[{key:"debug",value:function(E){E===!0&&(E="log"),N.default.level(E)}},{key:"find",value:function(E){return E.__quill||r.default.find(E)}},{key:"import",value:function(E){return this.imports[E]==null&&$.error("Cannot import "+E+". Are you sure it was registered?"),this.imports[E]}},{key:"register",value:function(E,C){var z=this,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof E!="string"){var J=E.attrName||E.blotName;typeof J=="string"?this.register("formats/"+J,E,C):Object.keys(E).forEach(function(U){z.register(U,E[U],C)})}else this.imports[E]!=null&&!te&&$.warn("Overwriting "+E+" with",C),this.imports[E]=C,(E.startsWith("blots/")||E.startsWith("formats/"))&&C.blotName!=="abstract"?r.default.register(C):E.startsWith("modules")&&typeof C.register=="function"&&C.register()}}]);function T(A){var E=this,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(O(this,T),this.options=K(A,C),this.container=this.options.container,this.container==null)return $.error("Invalid Quill container",A);this.options.debug&&T.debug(this.options.debug);var z=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new t.default,this.scroll=r.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new i.default(this.scroll),this.selection=new v.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(t.default.events.EDITOR_CHANGE,function(J){J===t.default.events.TEXT_CHANGE&&E.root.classList.toggle("ql-blank",E.editor.isBlank())}),this.emitter.on(t.default.events.SCROLL_UPDATE,function(J,U){var X=E.selection.lastRange,ne=X&&X.length===0?X.index:void 0;ee.call(E,function(){return E.editor.update(null,U,ne)},J)});var te=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+z+"<p><br></p></div>");this.setContents(te),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return g(T,[{key:"addContainer",value:function(E){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof E=="string"){var z=E;E=document.createElement("div"),E.classList.add(z)}return this.container.insertBefore(E,C),E}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(E,C,z){var te=this,J=Z(E,C,z),U=_(J,4);return E=U[0],C=U[1],z=U[3],ee.call(this,function(){return te.editor.deleteText(E,C)},z,E,-1*C)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(E),this.container.classList.toggle("ql-disabled",!E)}},{key:"focus",value:function(){var E=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=E,this.scrollIntoView()}},{key:"format",value:function(E,C){var z=this,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.default.sources.API;return ee.call(this,function(){var J=z.getSelection(!0),U=new b.default;if(J==null)return U;if(r.default.query(E,r.default.Scope.BLOCK))U=z.editor.formatLine(J.index,J.length,w({},E,C));else{if(J.length===0)return z.selection.format(E,C),U;U=z.editor.formatText(J.index,J.length,w({},E,C))}return z.setSelection(J,t.default.sources.SILENT),U},te)}},{key:"formatLine",value:function(E,C,z,te,J){var U=this,X=void 0,ne=Z(E,C,z,te,J),re=_(ne,4);return E=re[0],C=re[1],X=re[2],J=re[3],ee.call(this,function(){return U.editor.formatLine(E,C,X)},J,E,0)}},{key:"formatText",value:function(E,C,z,te,J){var U=this,X=void 0,ne=Z(E,C,z,te,J),re=_(ne,4);return E=re[0],C=re[1],X=re[2],J=re[3],ee.call(this,function(){return U.editor.formatText(E,C,X)},J,E,0)}},{key:"getBounds",value:function(E){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,z=void 0;typeof E=="number"?z=this.selection.getBounds(E,C):z=this.selection.getBounds(E.index,E.length);var te=this.container.getBoundingClientRect();return{bottom:z.bottom-te.top,height:z.height,left:z.left-te.left,right:z.right-te.left,top:z.top-te.top,width:z.width}}},{key:"getContents",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-E,z=Z(E,C),te=_(z,2);return E=te[0],C=te[1],this.editor.getContents(E,C)}},{key:"getFormat",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof E=="number"?this.editor.getFormat(E,C):this.editor.getFormat(E.index,E.length)}},{key:"getIndex",value:function(E){return E.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(E){return this.scroll.leaf(E)}},{key:"getLine",value:function(E){return this.scroll.line(E)}},{key:"getLines",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof E!="number"?this.scroll.lines(E.index,E.length):this.scroll.lines(E,C)}},{key:"getModule",value:function(E){return this.theme.modules[E]}},{key:"getSelection",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return E&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-E,z=Z(E,C),te=_(z,2);return E=te[0],C=te[1],this.editor.getText(E,C)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(E,C,z){var te=this,J=arguments.length>3&&arguments[3]!==void 0?arguments[3]:T.sources.API;return ee.call(this,function(){return te.editor.insertEmbed(E,C,z)},J,E)}},{key:"insertText",value:function(E,C,z,te,J){var U=this,X=void 0,ne=Z(E,0,z,te,J),re=_(ne,4);return E=re[0],X=re[2],J=re[3],ee.call(this,function(){return U.editor.insertText(E,C,X)},J,E,C.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(E,C,z){this.clipboard.dangerouslyPasteHTML(E,C,z)}},{key:"removeFormat",value:function(E,C,z){var te=this,J=Z(E,C,z),U=_(J,4);return E=U[0],C=U[1],z=U[3],ee.call(this,function(){return te.editor.removeFormat(E,C)},z,E)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(E){var C=this,z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.default.sources.API;return ee.call(this,function(){E=new b.default(E);var te=C.getLength(),J=C.editor.deleteText(0,te),U=C.editor.applyDelta(E),X=U.ops[U.ops.length-1];X!=null&&typeof X.insert=="string"&&X.insert[X.insert.length-1]===`
`&&(C.editor.deleteText(C.getLength()-1,1),U.delete(1));var ne=J.compose(U);return ne},z)}},{key:"setSelection",value:function(E,C,z){if(E==null)this.selection.setRange(null,C||T.sources.API);else{var te=Z(E,C,z),J=_(te,4);E=J[0],C=J[1],z=J[3],this.selection.setRange(new o.Range(E,C),z),z!==t.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(E){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.default.sources.API,z=new b.default().insert(E);return this.setContents(z,C)}},{key:"update",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.default.sources.USER,C=this.scroll.update(E);return this.selection.update(E),C}},{key:"updateContents",value:function(E){var C=this,z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.default.sources.API;return ee.call(this,function(){return E=new b.default(E),C.editor.applyDelta(E,z)},z,!0)}}]),T}();F.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},F.events=t.default.events,F.sources=t.default.sources,F.version="1.3.7",F.imports={delta:b.default,parchment:r.default,"core/module":u.default,"core/theme":I.default};function K(T,A){if(A=(0,y.default)(!0,{container:T,modules:{clipboard:!0,keyboard:!0,history:!0}},A),!A.theme||A.theme===F.DEFAULTS.theme)A.theme=I.default;else if(A.theme=F.import("themes/"+A.theme),A.theme==null)throw new Error("Invalid theme "+A.theme+". Did you register it?");var E=(0,y.default)(!0,{},A.theme.DEFAULTS);[E,A].forEach(function(te){te.modules=te.modules||{},Object.keys(te.modules).forEach(function(J){te.modules[J]===!0&&(te.modules[J]={})})});var C=Object.keys(E.modules).concat(Object.keys(A.modules)),z=C.reduce(function(te,J){var U=F.import("modules/"+J);return U==null?$.error("Cannot load "+J+" module. Are you sure you registered it?"):te[J]=U.DEFAULTS||{},te},{});return A.modules!=null&&A.modules.toolbar&&A.modules.toolbar.constructor!==Object&&(A.modules.toolbar={container:A.modules.toolbar}),A=(0,y.default)(!0,{},F.DEFAULTS,{modules:z},E,A),["bounds","container","scrollingContainer"].forEach(function(te){typeof A[te]=="string"&&(A[te]=document.querySelector(A[te]))}),A.modules=Object.keys(A.modules).reduce(function(te,J){return A.modules[J]&&(te[J]=A.modules[J]),te},{}),A}function ee(T,A,E,C){if(this.options.strict&&!this.isEnabled()&&A===t.default.sources.USER)return new b.default;var z=E==null?null:this.getSelection(),te=this.editor.delta,J=T();if(z!=null&&(E===!0&&(E=z.index),C==null?z=M(z,J,A):C!==0&&(z=M(z,E,C,A)),this.setSelection(z,t.default.sources.SILENT)),J.length()>0){var U,X=[t.default.events.TEXT_CHANGE,J,te,A];if((U=this.emitter).emit.apply(U,[t.default.events.EDITOR_CHANGE].concat(X)),A!==t.default.sources.SILENT){var ne;(ne=this.emitter).emit.apply(ne,X)}}return J}function Z(T,A,E,C,z){var te={};return typeof T.index=="number"&&typeof T.length=="number"?typeof A!="number"?(z=C,C=E,E=A,A=T.length,T=T.index):(A=T.length,T=T.index):typeof A!="number"&&(z=C,C=E,E=A,A=0),(typeof E=="undefined"?"undefined":p(E))==="object"?(te=E,z=C):typeof E=="string"&&(C!=null?te[E]=C:z=E),z=z||t.default.sources.API,[T,A,te,z]}function M(T,A,E,C){if(T==null)return null;var z=void 0,te=void 0;if(A instanceof b.default){var J=[T.index,T.index+T.length].map(function(re){return A.transformPosition(re,C!==t.default.sources.USER)}),U=_(J,2);z=U[0],te=U[1]}else{var X=[T.index,T.index+T.length].map(function(re){return re<A||re===A&&C===t.default.sources.USER?re:E>=0?re+E:Math.max(A,re+E)}),ne=_(X,2);z=ne[0],te=ne[1]}return new o.Range(z,te-z)}s.expandConfig=K,s.overload=Z,s.default=F},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function c(r,o){for(var v=0;v<o.length;v++){var e=o[v];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,o,v){return o&&c(r.prototype,o),v&&c(r,v),r}}(),_=function c(r,o,v){r===null&&(r=Function.prototype);var e=Object.getOwnPropertyDescriptor(r,o);if(e===void 0){var y=Object.getPrototypeOf(r);return y===null?void 0:c(y,o,v)}else{if("value"in e)return e.value;var j=e.get;return j===void 0?void 0:j.call(v)}},g=a(7),m=i(g),b=a(0),d=i(b);function i(c){return c&&c.__esModule?c:{default:c}}function n(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}function t(c,r){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:c}function l(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);c.prototype=Object.create(r&&r.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(c,r):c.__proto__=r)}var u=function(c){l(r,c);function r(){return n(this,r),t(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return p(r,[{key:"formatAt",value:function(v,e,y,j){if(r.compare(this.statics.blotName,y)<0&&d.default.query(y,d.default.Scope.BLOT)){var N=this.isolate(v,e);j&&N.wrap(y,j)}else _(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"formatAt",this).call(this,v,e,y,j)}},{key:"optimize",value:function(v){if(_(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"optimize",this).call(this,v),this.parent instanceof r&&r.compare(this.statics.blotName,this.parent.statics.blotName)>0){var e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}}],[{key:"compare",value:function(v,e){var y=r.order.indexOf(v),j=r.order.indexOf(e);return y>=0||j>=0?y-j:v===e?0:v<e?-1:1}}]),r}(d.default.Inline);u.allowedChildren=[u,d.default.Embed,m.default],u.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],s.default=u},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(0),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}function m(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var i=function(n){d(t,n);function t(){return m(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(_.default.Text);s.default=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function o(v,e){for(var y=0;y<e.length;y++){var j=e[y];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(v,j.key,j)}}return function(v,e,y){return e&&o(v.prototype,e),y&&o(v,y),v}}(),_=function o(v,e,y){v===null&&(v=Function.prototype);var j=Object.getOwnPropertyDescriptor(v,e);if(j===void 0){var N=Object.getPrototypeOf(v);return N===null?void 0:o(N,e,y)}else{if("value"in j)return j.value;var P=j.get;return P===void 0?void 0:P.call(y)}},g=a(54),m=i(g),b=a(10),d=i(b);function i(o){return o&&o.__esModule?o:{default:o}}function n(o,v){if(!(o instanceof v))throw new TypeError("Cannot call a class as a function")}function t(o,v){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:o}function l(o,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);o.prototype=Object.create(v&&v.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(o,v):o.__proto__=v)}var u=(0,d.default)("quill:events"),c=["selectionchange","mousedown","mouseup","click"];c.forEach(function(o){document.addEventListener(o,function(){for(var v=arguments.length,e=Array(v),y=0;y<v;y++)e[y]=arguments[y];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(j){if(j.__quill&&j.__quill.emitter){var N;(N=j.__quill.emitter).handleDOM.apply(N,e)}})})});var r=function(o){l(v,o);function v(){n(this,v);var e=t(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));return e.listeners={},e.on("error",u.error),e}return p(v,[{key:"emit",value:function(){u.log.apply(u,arguments),_(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(y){for(var j=arguments.length,N=Array(j>1?j-1:0),P=1;P<j;P++)N[P-1]=arguments[P];(this.listeners[y.type]||[]).forEach(function(I){var x=I.node,w=I.handler;(y.target===x||x.contains(y.target))&&w.apply(void 0,[y].concat(N))})}},{key:"listenDOM",value:function(y,j,N){this.listeners[y]||(this.listeners[y]=[]),this.listeners[y].push({node:j,handler:N})}}]),v}(m.default);r.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},r.sources={API:"api",SILENT:"silent",USER:"user"},s.default=r},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});function p(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}var _=function g(m){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};p(this,g),this.quill=m,this.options=b};_.DEFAULTS={},s.default=_},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=["error","warn","log","info"],_="warn";function g(b){if(p.indexOf(b)<=p.indexOf(_)){for(var d,i=arguments.length,n=Array(i>1?i-1:0),t=1;t<i;t++)n[t-1]=arguments[t];(d=console)[b].apply(d,n)}}function m(b){return p.reduce(function(d,i){return d[i]=g.bind(console,i,b),d},{})}g.level=m.level=function(b){_=b},s.default=m},function(f,s,a){var p=Array.prototype.slice,_=a(52),g=a(53),m=f.exports=function(n,t,l){return l||(l={}),n===t?!0:n instanceof Date&&t instanceof Date?n.getTime()===t.getTime():!n||!t||typeof n!="object"&&typeof t!="object"?l.strict?n===t:n==t:i(n,t,l)};function b(n){return n==null}function d(n){return!(!n||typeof n!="object"||typeof n.length!="number"||typeof n.copy!="function"||typeof n.slice!="function"||n.length>0&&typeof n[0]!="number")}function i(n,t,l){var u,c;if(b(n)||b(t)||n.prototype!==t.prototype)return!1;if(g(n))return g(t)?(n=p.call(n),t=p.call(t),m(n,t,l)):!1;if(d(n)){if(!d(t)||n.length!==t.length)return!1;for(u=0;u<n.length;u++)if(n[u]!==t[u])return!1;return!0}try{var r=_(n),o=_(t)}catch(v){return!1}if(r.length!=o.length)return!1;for(r.sort(),o.sort(),u=r.length-1;u>=0;u--)if(r[u]!=o[u])return!1;for(u=r.length-1;u>=0;u--)if(c=r[u],!m(n[c],t[c],l))return!1;return typeof n==typeof t}},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(1),_=function(){function g(m,b,d){d===void 0&&(d={}),this.attrName=m,this.keyName=b;var i=p.Scope.TYPE&p.Scope.ATTRIBUTE;d.scope!=null?this.scope=d.scope&p.Scope.LEVEL|i:this.scope=p.Scope.ATTRIBUTE,d.whitelist!=null&&(this.whitelist=d.whitelist)}return g.keys=function(m){return[].map.call(m.attributes,function(b){return b.name})},g.prototype.add=function(m,b){return this.canAdd(m,b)?(m.setAttribute(this.keyName,b),!0):!1},g.prototype.canAdd=function(m,b){var d=p.query(m,p.Scope.BLOT&(this.scope|p.Scope.TYPE));return d==null?!1:this.whitelist==null?!0:typeof b=="string"?this.whitelist.indexOf(b.replace(/["']/g,""))>-1:this.whitelist.indexOf(b)>-1},g.prototype.remove=function(m){m.removeAttribute(this.keyName)},g.prototype.value=function(m){var b=m.getAttribute(this.keyName);return this.canAdd(m,b)&&b?b:""},g}();s.default=_},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.Code=void 0;var p=function(){function P(I,x){var w=[],O=!0,$=!1,F=void 0;try{for(var K=I[Symbol.iterator](),ee;!(O=(ee=K.next()).done)&&(w.push(ee.value),!(x&&w.length===x));O=!0);}catch(Z){$=!0,F=Z}finally{try{!O&&K.return&&K.return()}finally{if($)throw F}}return w}return function(I,x){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return P(I,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function(){function P(I,x){for(var w=0;w<x.length;w++){var O=x[w];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(I,O.key,O)}}return function(I,x,w){return x&&P(I.prototype,x),w&&P(I,w),I}}(),g=function P(I,x,w){I===null&&(I=Function.prototype);var O=Object.getOwnPropertyDescriptor(I,x);if(O===void 0){var $=Object.getPrototypeOf(I);return $===null?void 0:P($,x,w)}else{if("value"in O)return O.value;var F=O.get;return F===void 0?void 0:F.call(w)}},m=a(2),b=o(m),d=a(0),i=o(d),n=a(4),t=o(n),l=a(6),u=o(l),c=a(7),r=o(c);function o(P){return P&&P.__esModule?P:{default:P}}function v(P,I){if(!(P instanceof I))throw new TypeError("Cannot call a class as a function")}function e(P,I){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:P}function y(P,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);P.prototype=Object.create(I&&I.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(P,I):P.__proto__=I)}var j=function(P){y(I,P);function I(){return v(this,I),e(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return I}(u.default);j.blotName="code",j.tagName="CODE";var N=function(P){y(I,P);function I(){return v(this,I),e(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return _(I,[{key:"delta",value:function(){var w=this,O=this.domNode.textContent;return O.endsWith(`
`)&&(O=O.slice(0,-1)),O.split(`
`).reduce(function($,F){return $.insert(F).insert(`
`,w.formats())},new b.default)}},{key:"format",value:function(w,O){if(!(w===this.statics.blotName&&O)){var $=this.descendant(r.default,this.length()-1),F=p($,1),K=F[0];K!=null&&K.deleteAt(K.length()-1,1),g(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"format",this).call(this,w,O)}}},{key:"formatAt",value:function(w,O,$,F){if(O!==0&&!(i.default.query($,i.default.Scope.BLOCK)==null||$===this.statics.blotName&&F===this.statics.formats(this.domNode))){var K=this.newlineIndex(w);if(!(K<0||K>=w+O)){var ee=this.newlineIndex(w,!0)+1,Z=K-ee+1,M=this.isolate(ee,Z),T=M.next;M.format($,F),T instanceof I&&T.formatAt(0,w-ee+O-Z,$,F)}}}},{key:"insertAt",value:function(w,O,$){if($==null){var F=this.descendant(r.default,w),K=p(F,2),ee=K[0],Z=K[1];ee.insertAt(Z,O)}}},{key:"length",value:function(){var w=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?w:w+1}},{key:"newlineIndex",value:function(w){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(O)return this.domNode.textContent.slice(0,w).lastIndexOf(`
`);var $=this.domNode.textContent.slice(w).indexOf(`
`);return $>-1?w+$:-1}},{key:"optimize",value:function(w){this.domNode.textContent.endsWith(`
`)||this.appendChild(i.default.create("text",`
`)),g(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"optimize",this).call(this,w);var O=this.next;O!=null&&O.prev===this&&O.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===O.statics.formats(O.domNode)&&(O.optimize(w),O.moveChildren(this),O.remove())}},{key:"replace",value:function(w){g(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"replace",this).call(this,w),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(O){var $=i.default.find(O);$==null?O.parentNode.removeChild(O):$ instanceof i.default.Embed?$.remove():$.unwrap()})}}],[{key:"create",value:function(w){var O=g(I.__proto__||Object.getPrototypeOf(I),"create",this).call(this,w);return O.setAttribute("spellcheck",!1),O}},{key:"formats",value:function(){return!0}}]),I}(t.default);N.blotName="code-block",N.tagName="PRE",N.TAB="  ",s.Code=j,s.default=N},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},_=function(){function T(A,E){var C=[],z=!0,te=!1,J=void 0;try{for(var U=A[Symbol.iterator](),X;!(z=(X=U.next()).done)&&(C.push(X.value),!(E&&C.length===E));z=!0);}catch(ne){te=!0,J=ne}finally{try{!z&&U.return&&U.return()}finally{if(te)throw J}}return C}return function(A,E){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return T(A,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function T(A,E){for(var C=0;C<E.length;C++){var z=E[C];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(A,z.key,z)}}return function(A,E,C){return E&&T(A.prototype,E),C&&T(A,C),A}}(),m=a(2),b=O(m),d=a(20),i=O(d),n=a(0),t=O(n),l=a(13),u=O(l),c=a(24),r=O(c),o=a(4),v=O(o),e=a(16),y=O(e),j=a(21),N=O(j),P=a(11),I=O(P),x=a(3),w=O(x);function O(T){return T&&T.__esModule?T:{default:T}}function $(T,A,E){return A in T?Object.defineProperty(T,A,{value:E,enumerable:!0,configurable:!0,writable:!0}):T[A]=E,T}function F(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")}var K=/^[ -~]*$/,ee=function(){function T(A){F(this,T),this.scroll=A,this.delta=this.getDelta()}return g(T,[{key:"applyDelta",value:function(E){var C=this,z=!1;this.scroll.update();var te=this.scroll.length();return this.scroll.batchStart(),E=M(E),E.reduce(function(J,U){var X=U.retain||U.delete||U.insert.length||1,ne=U.attributes||{};if(U.insert!=null){if(typeof U.insert=="string"){var re=U.insert;re.endsWith(`
`)&&z&&(z=!1,re=re.slice(0,-1)),J>=te&&!re.endsWith(`
`)&&(z=!0),C.scroll.insertAt(J,re);var de=C.scroll.line(J),be=_(de,2),we=be[0],xe=be[1],Ee=(0,w.default)({},(0,o.bubbleFormats)(we));if(we instanceof v.default){var Se=we.descendant(t.default.Leaf,xe),qe=_(Se,1),Me=qe[0];Ee=(0,w.default)(Ee,(0,o.bubbleFormats)(Me))}ne=i.default.attributes.diff(Ee,ne)||{}}else if(p(U.insert)==="object"){var ie=Object.keys(U.insert)[0];if(ie==null)return J;C.scroll.insertAt(J,ie,U.insert[ie])}te+=X}return Object.keys(ne).forEach(function(ue){C.scroll.formatAt(J,X,ue,ne[ue])}),J+X},0),E.reduce(function(J,U){return typeof U.delete=="number"?(C.scroll.deleteAt(J,U.delete),J):J+(U.retain||U.insert.length||1)},0),this.scroll.batchEnd(),this.update(E)}},{key:"deleteText",value:function(E,C){return this.scroll.deleteAt(E,C),this.update(new b.default().retain(E).delete(C))}},{key:"formatLine",value:function(E,C){var z=this,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(te).forEach(function(J){if(!(z.scroll.whitelist!=null&&!z.scroll.whitelist[J])){var U=z.scroll.lines(E,Math.max(C,1)),X=C;U.forEach(function(ne){var re=ne.length();if(!(ne instanceof u.default))ne.format(J,te[J]);else{var de=E-ne.offset(z.scroll),be=ne.newlineIndex(de+X)-de+1;ne.formatAt(de,be,J,te[J])}X-=re})}}),this.scroll.optimize(),this.update(new b.default().retain(E).retain(C,(0,N.default)(te)))}},{key:"formatText",value:function(E,C){var z=this,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(te).forEach(function(J){z.scroll.formatAt(E,C,J,te[J])}),this.update(new b.default().retain(E).retain(C,(0,N.default)(te)))}},{key:"getContents",value:function(E,C){return this.delta.slice(E,E+C)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(E,C){return E.concat(C.delta())},new b.default)}},{key:"getFormat",value:function(E){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,z=[],te=[];C===0?this.scroll.path(E).forEach(function(U){var X=_(U,1),ne=X[0];ne instanceof v.default?z.push(ne):ne instanceof t.default.Leaf&&te.push(ne)}):(z=this.scroll.lines(E,C),te=this.scroll.descendants(t.default.Leaf,E,C));var J=[z,te].map(function(U){if(U.length===0)return{};for(var X=(0,o.bubbleFormats)(U.shift());Object.keys(X).length>0;){var ne=U.shift();if(ne==null)return X;X=Z((0,o.bubbleFormats)(ne),X)}return X});return w.default.apply(w.default,J)}},{key:"getText",value:function(E,C){return this.getContents(E,C).filter(function(z){return typeof z.insert=="string"}).map(function(z){return z.insert}).join("")}},{key:"insertEmbed",value:function(E,C,z){return this.scroll.insertAt(E,C,z),this.update(new b.default().retain(E).insert($({},C,z)))}},{key:"insertText",value:function(E,C){var z=this,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return C=C.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(E,C),Object.keys(te).forEach(function(J){z.scroll.formatAt(E,C.length,J,te[J])}),this.update(new b.default().retain(E).insert(C,(0,N.default)(te)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var E=this.scroll.children.head;return E.statics.blotName!==v.default.blotName||E.children.length>1?!1:E.children.head instanceof y.default}},{key:"removeFormat",value:function(E,C){var z=this.getText(E,C),te=this.scroll.line(E+C),J=_(te,2),U=J[0],X=J[1],ne=0,re=new b.default;U!=null&&(U instanceof u.default?ne=U.newlineIndex(X)-X+1:ne=U.length()-X,re=U.delta().slice(X,X+ne-1).insert(`
`));var de=this.getContents(E,C+ne),be=de.diff(new b.default().insert(z).concat(re)),we=new b.default().retain(E).concat(be);return this.applyDelta(we)}},{key:"update",value:function(E){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,te=this.delta;if(C.length===1&&C[0].type==="characterData"&&C[0].target.data.match(K)&&t.default.find(C[0].target)){var J=t.default.find(C[0].target),U=(0,o.bubbleFormats)(J),X=J.offset(this.scroll),ne=C[0].oldValue.replace(r.default.CONTENTS,""),re=new b.default().insert(ne),de=new b.default().insert(J.value()),be=new b.default().retain(X).concat(re.diff(de,z));E=be.reduce(function(we,xe){return xe.insert?we.insert(xe.insert,U):we.push(xe)},new b.default),this.delta=te.compose(E)}else this.delta=this.getDelta(),(!E||!(0,I.default)(te.compose(E),this.delta))&&(E=te.diff(this.delta,z));return E}}]),T}();function Z(T,A){return Object.keys(A).reduce(function(E,C){return T[C]==null||(A[C]===T[C]?E[C]=A[C]:Array.isArray(A[C])?A[C].indexOf(T[C])<0&&(E[C]=A[C].concat([T[C]])):E[C]=[A[C],T[C]]),E},{})}function M(T){return T.reduce(function(A,E){if(E.insert===1){var C=(0,N.default)(E.attributes);return delete C.image,A.insert({image:E.attributes.image},C)}if(E.attributes!=null&&(E.attributes.list===!0||E.attributes.bullet===!0)&&(E=(0,N.default)(E),E.attributes.list?E.attributes.list="ordered":(E.attributes.list="bullet",delete E.attributes.bullet)),typeof E.insert=="string"){var z=E.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return A.insert(z,E.attributes)}return A.push(E)},new b.default)}s.default=ee},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.Range=void 0;var p=function(){function P(I,x){var w=[],O=!0,$=!1,F=void 0;try{for(var K=I[Symbol.iterator](),ee;!(O=(ee=K.next()).done)&&(w.push(ee.value),!(x&&w.length===x));O=!0);}catch(Z){$=!0,F=Z}finally{try{!O&&K.return&&K.return()}finally{if($)throw F}}return w}return function(I,x){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return P(I,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function(){function P(I,x){for(var w=0;w<x.length;w++){var O=x[w];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(I,O.key,O)}}return function(I,x,w){return x&&P(I.prototype,x),w&&P(I,w),I}}(),g=a(0),m=r(g),b=a(21),d=r(b),i=a(11),n=r(i),t=a(8),l=r(t),u=a(10),c=r(u);function r(P){return P&&P.__esModule?P:{default:P}}function o(P){if(Array.isArray(P)){for(var I=0,x=Array(P.length);I<P.length;I++)x[I]=P[I];return x}else return Array.from(P)}function v(P,I){if(!(P instanceof I))throw new TypeError("Cannot call a class as a function")}var e=(0,c.default)("quill:selection"),y=function P(I){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;v(this,P),this.index=I,this.length=x},j=function(){function P(I,x){var w=this;v(this,P),this.emitter=x,this.scroll=I,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=m.default.create("cursor",this),this.lastRange=this.savedRange=new y(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){w.mouseDown||setTimeout(w.update.bind(w,l.default.sources.USER),1)}),this.emitter.on(l.default.events.EDITOR_CHANGE,function(O,$){O===l.default.events.TEXT_CHANGE&&$.length()>0&&w.update(l.default.sources.SILENT)}),this.emitter.on(l.default.events.SCROLL_BEFORE_UPDATE,function(){if(w.hasFocus()){var O=w.getNativeRange();O!=null&&O.start.node!==w.cursor.textNode&&w.emitter.once(l.default.events.SCROLL_UPDATE,function(){try{w.setNativeRange(O.start.node,O.start.offset,O.end.node,O.end.offset)}catch($){}})}}),this.emitter.on(l.default.events.SCROLL_OPTIMIZE,function(O,$){if($.range){var F=$.range,K=F.startNode,ee=F.startOffset,Z=F.endNode,M=F.endOffset;w.setNativeRange(K,ee,Z,M)}}),this.update(l.default.sources.SILENT)}return _(P,[{key:"handleComposition",value:function(){var x=this;this.root.addEventListener("compositionstart",function(){x.composing=!0}),this.root.addEventListener("compositionend",function(){if(x.composing=!1,x.cursor.parent){var w=x.cursor.restore();if(!w)return;setTimeout(function(){x.setNativeRange(w.startNode,w.startOffset,w.endNode,w.endOffset)},1)}})}},{key:"handleDragging",value:function(){var x=this;this.emitter.listenDOM("mousedown",document.body,function(){x.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){x.mouseDown=!1,x.update(l.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(x,w){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[x])){this.scroll.update();var O=this.getNativeRange();if(!(O==null||!O.native.collapsed||m.default.query(x,m.default.Scope.BLOCK))){if(O.start.node!==this.cursor.textNode){var $=m.default.find(O.start.node,!1);if($==null)return;if($ instanceof m.default.Leaf){var F=$.split(O.start.offset);$.parent.insertBefore(this.cursor,F)}else $.insertBefore(this.cursor,O.start.node);this.cursor.attach()}this.cursor.format(x,w),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(x){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=this.scroll.length();x=Math.min(x,O-1),w=Math.min(x+w,O-1)-x;var $=void 0,F=this.scroll.leaf(x),K=p(F,2),ee=K[0],Z=K[1];if(ee==null)return null;var M=ee.position(Z,!0),T=p(M,2);$=T[0],Z=T[1];var A=document.createRange();if(w>0){A.setStart($,Z);var E=this.scroll.leaf(x+w),C=p(E,2);if(ee=C[0],Z=C[1],ee==null)return null;var z=ee.position(Z,!0),te=p(z,2);return $=te[0],Z=te[1],A.setEnd($,Z),A.getBoundingClientRect()}else{var J="left",U=void 0;return $ instanceof Text?(Z<$.data.length?(A.setStart($,Z),A.setEnd($,Z+1)):(A.setStart($,Z-1),A.setEnd($,Z),J="right"),U=A.getBoundingClientRect()):(U=ee.domNode.getBoundingClientRect(),Z>0&&(J="right")),{bottom:U.top+U.height,height:U.height,left:U[J],right:U[J],top:U.top,width:0}}}},{key:"getNativeRange",value:function(){var x=document.getSelection();if(x==null||x.rangeCount<=0)return null;var w=x.getRangeAt(0);if(w==null)return null;var O=this.normalizeNative(w);return e.info("getNativeRange",O),O}},{key:"getRange",value:function(){var x=this.getNativeRange();if(x==null)return[null,null];var w=this.normalizedToRange(x);return[w,x]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(x){var w=this,O=[[x.start.node,x.start.offset]];x.native.collapsed||O.push([x.end.node,x.end.offset]);var $=O.map(function(ee){var Z=p(ee,2),M=Z[0],T=Z[1],A=m.default.find(M,!0),E=A.offset(w.scroll);return T===0?E:A instanceof m.default.Container?E+A.length():E+A.index(M,T)}),F=Math.min(Math.max.apply(Math,o($)),this.scroll.length()-1),K=Math.min.apply(Math,[F].concat(o($)));return new y(K,F-K)}},{key:"normalizeNative",value:function(x){if(!N(this.root,x.startContainer)||!x.collapsed&&!N(this.root,x.endContainer))return null;var w={start:{node:x.startContainer,offset:x.startOffset},end:{node:x.endContainer,offset:x.endOffset},native:x};return[w.start,w.end].forEach(function(O){for(var $=O.node,F=O.offset;!($ instanceof Text)&&$.childNodes.length>0;)if($.childNodes.length>F)$=$.childNodes[F],F=0;else if($.childNodes.length===F)$=$.lastChild,F=$ instanceof Text?$.data.length:$.childNodes.length+1;else break;O.node=$,O.offset=F}),w}},{key:"rangeToNative",value:function(x){var w=this,O=x.collapsed?[x.index]:[x.index,x.index+x.length],$=[],F=this.scroll.length();return O.forEach(function(K,ee){K=Math.min(F-1,K);var Z=void 0,M=w.scroll.leaf(K),T=p(M,2),A=T[0],E=T[1],C=A.position(E,ee!==0),z=p(C,2);Z=z[0],E=z[1],$.push(Z,E)}),$.length<2&&($=$.concat($)),$}},{key:"scrollIntoView",value:function(x){var w=this.lastRange;if(w!=null){var O=this.getBounds(w.index,w.length);if(O!=null){var $=this.scroll.length()-1,F=this.scroll.line(Math.min(w.index,$)),K=p(F,1),ee=K[0],Z=ee;if(w.length>0){var M=this.scroll.line(Math.min(w.index+w.length,$)),T=p(M,1);Z=T[0]}if(!(ee==null||Z==null)){var A=x.getBoundingClientRect();O.top<A.top?x.scrollTop-=A.top-O.top:O.bottom>A.bottom&&(x.scrollTop+=O.bottom-A.bottom)}}}}},{key:"setNativeRange",value:function(x,w){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x,$=arguments.length>3&&arguments[3]!==void 0?arguments[3]:w,F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(e.info("setNativeRange",x,w,O,$),!(x!=null&&(this.root.parentNode==null||x.parentNode==null||O.parentNode==null))){var K=document.getSelection();if(K!=null)if(x!=null){this.hasFocus()||this.root.focus();var ee=(this.getNativeRange()||{}).native;if(ee==null||F||x!==ee.startContainer||w!==ee.startOffset||O!==ee.endContainer||$!==ee.endOffset){x.tagName=="BR"&&(w=[].indexOf.call(x.parentNode.childNodes,x),x=x.parentNode),O.tagName=="BR"&&($=[].indexOf.call(O.parentNode.childNodes,O),O=O.parentNode);var Z=document.createRange();Z.setStart(x,w),Z.setEnd(O,$),K.removeAllRanges(),K.addRange(Z)}}else K.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(x){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l.default.sources.API;if(typeof w=="string"&&(O=w,w=!1),e.info("setRange",x),x!=null){var $=this.rangeToNative(x);this.setNativeRange.apply(this,o($).concat([w]))}else this.setNativeRange(null);this.update(O)}},{key:"update",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:l.default.sources.USER,w=this.lastRange,O=this.getRange(),$=p(O,2),F=$[0],K=$[1];if(this.lastRange=F,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,n.default)(w,this.lastRange)){var ee;!this.composing&&K!=null&&K.native.collapsed&&K.start.node!==this.cursor.textNode&&this.cursor.restore();var Z=[l.default.events.SELECTION_CHANGE,(0,d.default)(this.lastRange),(0,d.default)(w),x];if((ee=this.emitter).emit.apply(ee,[l.default.events.EDITOR_CHANGE].concat(Z)),x!==l.default.sources.SILENT){var M;(M=this.emitter).emit.apply(M,Z)}}}}]),P}();function N(P,I){try{I.parentNode}catch(x){return!1}return I instanceof Text&&(I=I.parentNode),P.contains(I)}s.Range=y,s.default=j},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function l(u,c){for(var r=0;r<c.length;r++){var o=c[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}return function(u,c,r){return c&&l(u.prototype,c),r&&l(u,r),u}}(),_=function l(u,c,r){u===null&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,c);if(o===void 0){var v=Object.getPrototypeOf(u);return v===null?void 0:l(v,c,r)}else{if("value"in o)return o.value;var e=o.get;return e===void 0?void 0:e.call(r)}},g=a(0),m=b(g);function b(l){return l&&l.__esModule?l:{default:l}}function d(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function i(l,u){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:l}function n(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}var t=function(l){n(u,l);function u(){return d(this,u),i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return p(u,[{key:"insertInto",value:function(r,o){r.children.length===0?_(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"insertInto",this).call(this,r,o):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),u}(m.default.Embed);t.blotName="break",t.tagName="BR",s.default=t},function(f,s,a){var p=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var l in t)t.hasOwnProperty(l)&&(n[l]=t[l])};return function(n,t){i(n,t);function l(){this.constructor=n}n.prototype=t===null?Object.create(t):(l.prototype=t.prototype,new l)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(44),g=a(30),m=a(1),b=function(i){p(n,i);function n(t){var l=i.call(this,t)||this;return l.build(),l}return n.prototype.appendChild=function(t){this.insertBefore(t)},n.prototype.attach=function(){i.prototype.attach.call(this),this.children.forEach(function(t){t.attach()})},n.prototype.build=function(){var t=this;this.children=new _.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(l){try{var u=d(l);t.insertBefore(u,t.children.head||void 0)}catch(c){if(c instanceof m.ParchmentError)return;throw c}})},n.prototype.deleteAt=function(t,l){if(t===0&&l===this.length())return this.remove();this.children.forEachAt(t,l,function(u,c,r){u.deleteAt(c,r)})},n.prototype.descendant=function(t,l){var u=this.children.find(l),c=u[0],r=u[1];return t.blotName==null&&t(c)||t.blotName!=null&&c instanceof t?[c,r]:c instanceof n?c.descendant(t,r):[null,-1]},n.prototype.descendants=function(t,l,u){l===void 0&&(l=0),u===void 0&&(u=Number.MAX_VALUE);var c=[],r=u;return this.children.forEachAt(l,u,function(o,v,e){(t.blotName==null&&t(o)||t.blotName!=null&&o instanceof t)&&c.push(o),o instanceof n&&(c=c.concat(o.descendants(t,v,r))),r-=e}),c},n.prototype.detach=function(){this.children.forEach(function(t){t.detach()}),i.prototype.detach.call(this)},n.prototype.formatAt=function(t,l,u,c){this.children.forEachAt(t,l,function(r,o,v){r.formatAt(o,v,u,c)})},n.prototype.insertAt=function(t,l,u){var c=this.children.find(t),r=c[0],o=c[1];if(r)r.insertAt(o,l,u);else{var v=u==null?m.create("text",l):m.create(l,u);this.appendChild(v)}},n.prototype.insertBefore=function(t,l){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(u){return t instanceof u}))throw new m.ParchmentError("Cannot insert "+t.statics.blotName+" into "+this.statics.blotName);t.insertInto(this,l)},n.prototype.length=function(){return this.children.reduce(function(t,l){return t+l.length()},0)},n.prototype.moveChildren=function(t,l){this.children.forEach(function(u){t.insertBefore(u,l)})},n.prototype.optimize=function(t){if(i.prototype.optimize.call(this,t),this.children.length===0)if(this.statics.defaultChild!=null){var l=m.create(this.statics.defaultChild);this.appendChild(l),l.optimize(t)}else this.remove()},n.prototype.path=function(t,l){l===void 0&&(l=!1);var u=this.children.find(t,l),c=u[0],r=u[1],o=[[this,t]];return c instanceof n?o.concat(c.path(r,l)):(c!=null&&o.push([c,r]),o)},n.prototype.removeChild=function(t){this.children.remove(t)},n.prototype.replace=function(t){t instanceof n&&t.moveChildren(this),i.prototype.replace.call(this,t)},n.prototype.split=function(t,l){if(l===void 0&&(l=!1),!l){if(t===0)return this;if(t===this.length())return this.next}var u=this.clone();return this.parent.insertBefore(u,this.next),this.children.forEachAt(t,this.length(),function(c,r,o){c=c.split(r,l),u.appendChild(c)}),u},n.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},n.prototype.update=function(t,l){var u=this,c=[],r=[];t.forEach(function(o){o.target===u.domNode&&o.type==="childList"&&(c.push.apply(c,o.addedNodes),r.push.apply(r,o.removedNodes))}),r.forEach(function(o){if(!(o.parentNode!=null&&o.tagName!=="IFRAME"&&document.body.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var v=m.find(o);v!=null&&(v.domNode.parentNode==null||v.domNode.parentNode===u.domNode)&&v.detach()}}),c.filter(function(o){return o.parentNode==u.domNode}).sort(function(o,v){return o===v?0:o.compareDocumentPosition(v)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(o){var v=null;o.nextSibling!=null&&(v=m.find(o.nextSibling));var e=d(o);(e.next!=v||e.next==null)&&(e.parent!=null&&e.parent.removeChild(u),u.insertBefore(e,v||void 0))})},n}(g.default);function d(i){var n=m.find(i);if(n==null)try{n=m.create(i)}catch(t){n=m.create(m.Scope.INLINE),[].slice.call(i.childNodes).forEach(function(l){n.domNode.appendChild(l)}),i.parentNode&&i.parentNode.replaceChild(n.domNode,i),n.attach()}return n}s.default=b},function(f,s,a){var p=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var l in t)t.hasOwnProperty(l)&&(n[l]=t[l])};return function(n,t){i(n,t);function l(){this.constructor=n}n.prototype=t===null?Object.create(t):(l.prototype=t.prototype,new l)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(12),g=a(31),m=a(17),b=a(1),d=function(i){p(n,i);function n(t){var l=i.call(this,t)||this;return l.attributes=new g.default(l.domNode),l}return n.formats=function(t){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()},n.prototype.format=function(t,l){var u=b.query(t);u instanceof _.default?this.attributes.attribute(u,l):l&&u!=null&&(t!==this.statics.blotName||this.formats()[t]!==l)&&this.replaceWith(t,l)},n.prototype.formats=function(){var t=this.attributes.values(),l=this.statics.formats(this.domNode);return l!=null&&(t[this.statics.blotName]=l),t},n.prototype.replaceWith=function(t,l){var u=i.prototype.replaceWith.call(this,t,l);return this.attributes.copy(u),u},n.prototype.update=function(t,l){var u=this;i.prototype.update.call(this,t,l),t.some(function(c){return c.target===u.domNode&&c.type==="attributes"})&&this.attributes.build()},n.prototype.wrap=function(t,l){var u=i.prototype.wrap.call(this,t,l);return u instanceof n&&u.statics.scope===this.statics.scope&&this.attributes.move(u),u},n}(m.default);s.default=d},function(f,s,a){var p=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var n in i)i.hasOwnProperty(n)&&(d[n]=i[n])};return function(d,i){b(d,i);function n(){this.constructor=d}d.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(30),g=a(1),m=function(b){p(d,b);function d(){return b!==null&&b.apply(this,arguments)||this}return d.value=function(i){return!0},d.prototype.index=function(i,n){return this.domNode===i||this.domNode.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(n,1):-1},d.prototype.position=function(i,n){var t=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return i>0&&(t+=1),[this.parent.domNode,t]},d.prototype.value=function(){var i;return i={},i[this.statics.blotName]=this.statics.value(this.domNode)||!0,i},d.scope=g.Scope.INLINE_BLOT,d}(_.default);s.default=m},function(f,s,a){var p=a(11),_=a(3),g={attributes:{compose:function(b,d,i){typeof b!="object"&&(b={}),typeof d!="object"&&(d={});var n=_(!0,{},d);i||(n=Object.keys(n).reduce(function(l,u){return n[u]!=null&&(l[u]=n[u]),l},{}));for(var t in b)b[t]!==void 0&&d[t]===void 0&&(n[t]=b[t]);return Object.keys(n).length>0?n:void 0},diff:function(b,d){typeof b!="object"&&(b={}),typeof d!="object"&&(d={});var i=Object.keys(b).concat(Object.keys(d)).reduce(function(n,t){return p(b[t],d[t])||(n[t]=d[t]===void 0?null:d[t]),n},{});return Object.keys(i).length>0?i:void 0},transform:function(b,d,i){if(typeof b!="object")return d;if(typeof d=="object"){if(!i)return d;var n=Object.keys(d).reduce(function(t,l){return b[l]===void 0&&(t[l]=d[l]),t},{});return Object.keys(n).length>0?n:void 0}}},iterator:function(b){return new m(b)},length:function(b){return typeof b.delete=="number"?b.delete:typeof b.retain=="number"?b.retain:typeof b.insert=="string"?b.insert.length:1}};function m(b){this.ops=b,this.index=0,this.offset=0}m.prototype.hasNext=function(){return this.peekLength()<1/0},m.prototype.next=function(b){b||(b=1/0);var d=this.ops[this.index];if(d){var i=this.offset,n=g.length(d);if(b>=n-i?(b=n-i,this.index+=1,this.offset=0):this.offset+=b,typeof d.delete=="number")return{delete:b};var t={};return d.attributes&&(t.attributes=d.attributes),typeof d.retain=="number"?t.retain=b:typeof d.insert=="string"?t.insert=d.insert.substr(i,b):t.insert=d.insert,t}else return{retain:1/0}},m.prototype.peek=function(){return this.ops[this.index]},m.prototype.peekLength=function(){return this.ops[this.index]?g.length(this.ops[this.index])-this.offset:1/0},m.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},m.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var b=this.offset,d=this.index,i=this.next(),n=this.ops.slice(this.index);return this.offset=b,this.index=d,[i].concat(n)}else return[]},f.exports=g},function(f,s){var a=function(){function p(u,c){return c!=null&&u instanceof c}var _;try{_=Map}catch(u){_=function(){}}var g;try{g=Set}catch(u){g=function(){}}var m;try{m=Promise}catch(u){m=function(){}}function b(u,c,r,o,v){typeof c=="object"&&(r=c.depth,o=c.prototype,v=c.includeNonEnumerable,c=c.circular);var e=[],y=[],j=typeof Buffer!="undefined";typeof c=="undefined"&&(c=!0),typeof r=="undefined"&&(r=1/0);function N(P,I){if(P===null)return null;if(I===0)return P;var x,w;if(typeof P!="object")return P;if(p(P,_))x=new _;else if(p(P,g))x=new g;else if(p(P,m))x=new m(function(A,E){P.then(function(C){A(N(C,I-1))},function(C){E(N(C,I-1))})});else if(b.__isArray(P))x=[];else if(b.__isRegExp(P))x=new RegExp(P.source,l(P)),P.lastIndex&&(x.lastIndex=P.lastIndex);else if(b.__isDate(P))x=new Date(P.getTime());else{if(j&&Buffer.isBuffer(P))return Buffer.allocUnsafe?x=Buffer.allocUnsafe(P.length):x=new Buffer(P.length),P.copy(x),x;p(P,Error)?x=Object.create(P):typeof o=="undefined"?(w=Object.getPrototypeOf(P),x=Object.create(w)):(x=Object.create(o),w=o)}if(c){var O=e.indexOf(P);if(O!=-1)return y[O];e.push(P),y.push(x)}p(P,_)&&P.forEach(function(A,E){var C=N(E,I-1),z=N(A,I-1);x.set(C,z)}),p(P,g)&&P.forEach(function(A){var E=N(A,I-1);x.add(E)});for(var $ in P){var F;w&&(F=Object.getOwnPropertyDescriptor(w,$)),!(F&&F.set==null)&&(x[$]=N(P[$],I-1))}if(Object.getOwnPropertySymbols)for(var K=Object.getOwnPropertySymbols(P),$=0;$<K.length;$++){var ee=K[$],Z=Object.getOwnPropertyDescriptor(P,ee);Z&&!Z.enumerable&&!v||(x[ee]=N(P[ee],I-1),Z.enumerable||Object.defineProperty(x,ee,{enumerable:!1}))}if(v)for(var M=Object.getOwnPropertyNames(P),$=0;$<M.length;$++){var T=M[$],Z=Object.getOwnPropertyDescriptor(P,T);Z&&Z.enumerable||(x[T]=N(P[T],I-1),Object.defineProperty(x,T,{enumerable:!1}))}return x}return N(u,r)}b.clonePrototype=function(c){if(c===null)return null;var r=function(){};return r.prototype=c,new r};function d(u){return Object.prototype.toString.call(u)}b.__objToStr=d;function i(u){return typeof u=="object"&&d(u)==="[object Date]"}b.__isDate=i;function n(u){return typeof u=="object"&&d(u)==="[object Array]"}b.__isArray=n;function t(u){return typeof u=="object"&&d(u)==="[object RegExp]"}b.__isRegExp=t;function l(u){var c="";return u.global&&(c+="g"),u.ignoreCase&&(c+="i"),u.multiline&&(c+="m"),c}return b.__getRegExpFlags=l,b}();typeof f=="object"&&f.exports&&(f.exports=a)},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function x(w,O){var $=[],F=!0,K=!1,ee=void 0;try{for(var Z=w[Symbol.iterator](),M;!(F=(M=Z.next()).done)&&($.push(M.value),!(O&&$.length===O));F=!0);}catch(T){K=!0,ee=T}finally{try{!F&&Z.return&&Z.return()}finally{if(K)throw ee}}return $}return function(w,O){if(Array.isArray(w))return w;if(Symbol.iterator in Object(w))return x(w,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function(){function x(w,O){for(var $=0;$<O.length;$++){var F=O[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(w,F.key,F)}}return function(w,O,$){return O&&x(w.prototype,O),$&&x(w,$),w}}(),g=function x(w,O,$){w===null&&(w=Function.prototype);var F=Object.getOwnPropertyDescriptor(w,O);if(F===void 0){var K=Object.getPrototypeOf(w);return K===null?void 0:x(K,O,$)}else{if("value"in F)return F.value;var ee=F.get;return ee===void 0?void 0:ee.call($)}},m=a(0),b=e(m),d=a(8),i=e(d),n=a(4),t=e(n),l=a(16),u=e(l),c=a(13),r=e(c),o=a(25),v=e(o);function e(x){return x&&x.__esModule?x:{default:x}}function y(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function j(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function N(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}function P(x){return x instanceof t.default||x instanceof n.BlockEmbed}var I=function(x){N(w,x);function w(O,$){y(this,w);var F=j(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,O));return F.emitter=$.emitter,Array.isArray($.whitelist)&&(F.whitelist=$.whitelist.reduce(function(K,ee){return K[ee]=!0,K},{})),F.domNode.addEventListener("DOMNodeInserted",function(){}),F.optimize(),F.enable(),F}return _(w,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function($,F){var K=this.line($),ee=p(K,2),Z=ee[0],M=ee[1],T=this.line($+F),A=p(T,1),E=A[0];if(g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"deleteAt",this).call(this,$,F),E!=null&&Z!==E&&M>0){if(Z instanceof n.BlockEmbed||E instanceof n.BlockEmbed){this.optimize();return}if(Z instanceof r.default){var C=Z.newlineIndex(Z.length(),!0);if(C>-1&&(Z=Z.split(C+1),Z===E)){this.optimize();return}}else if(E instanceof r.default){var z=E.newlineIndex(0);z>-1&&E.split(z+1)}var te=E.children.head instanceof u.default?null:E.children.head;Z.moveChildren(E,te),Z.remove()}this.optimize()}},{key:"enable",value:function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",$)}},{key:"formatAt",value:function($,F,K,ee){this.whitelist!=null&&!this.whitelist[K]||(g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"formatAt",this).call(this,$,F,K,ee),this.optimize())}},{key:"insertAt",value:function($,F,K){if(!(K!=null&&this.whitelist!=null&&!this.whitelist[F])){if($>=this.length())if(K==null||b.default.query(F,b.default.Scope.BLOCK)==null){var ee=b.default.create(this.statics.defaultChild);this.appendChild(ee),K==null&&F.endsWith(`
`)&&(F=F.slice(0,-1)),ee.insertAt(0,F,K)}else{var Z=b.default.create(F,K);this.appendChild(Z)}else g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertAt",this).call(this,$,F,K);this.optimize()}}},{key:"insertBefore",value:function($,F){if($.statics.scope===b.default.Scope.INLINE_BLOT){var K=b.default.create(this.statics.defaultChild);K.appendChild($),$=K}g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertBefore",this).call(this,$,F)}},{key:"leaf",value:function($){return this.path($).pop()||[null,-1]}},{key:"line",value:function($){return $===this.length()?this.line($-1):this.descendant(P,$)}},{key:"lines",value:function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,K=function ee(Z,M,T){var A=[],E=T;return Z.children.forEachAt(M,T,function(C,z,te){P(C)?A.push(C):C instanceof b.default.Container&&(A=A.concat(ee(C,z,E))),E-=te}),A};return K(this,$,F)}},{key:"optimize",value:function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"optimize",this).call(this,$,F),$.length>0&&this.emitter.emit(i.default.events.SCROLL_OPTIMIZE,$,F))}},{key:"path",value:function($){return g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"path",this).call(this,$).slice(1)}},{key:"update",value:function($){if(this.batch!==!0){var F=i.default.sources.USER;typeof $=="string"&&(F=$),Array.isArray($)||($=this.observer.takeRecords()),$.length>0&&this.emitter.emit(i.default.events.SCROLL_BEFORE_UPDATE,F,$),g(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"update",this).call(this,$.concat([])),$.length>0&&this.emitter.emit(i.default.events.SCROLL_UPDATE,F,$)}}}]),w}(b.default.Scroll);I.blotName="scroll",I.className="ql-editor",I.tagName="DIV",I.defaultChild="block",I.allowedChildren=[t.default,n.BlockEmbed,v.default],s.default=I},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.SHORTKEY=s.default=void 0;var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U},_=function(){function U(X,ne){var re=[],de=!0,be=!1,we=void 0;try{for(var xe=X[Symbol.iterator](),Ee;!(de=(Ee=xe.next()).done)&&(re.push(Ee.value),!(ne&&re.length===ne));de=!0);}catch(Se){be=!0,we=Se}finally{try{!de&&xe.return&&xe.return()}finally{if(be)throw we}}return re}return function(X,ne){if(Array.isArray(X))return X;if(Symbol.iterator in Object(X))return U(X,ne);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function U(X,ne){for(var re=0;re<ne.length;re++){var de=ne[re];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),Object.defineProperty(X,de.key,de)}}return function(X,ne,re){return ne&&U(X.prototype,ne),re&&U(X,re),X}}(),m=a(21),b=x(m),d=a(11),i=x(d),n=a(3),t=x(n),l=a(2),u=x(l),c=a(20),r=x(c),o=a(0),v=x(o),e=a(5),y=x(e),j=a(10),N=x(j),P=a(9),I=x(P);function x(U){return U&&U.__esModule?U:{default:U}}function w(U,X,ne){return X in U?Object.defineProperty(U,X,{value:ne,enumerable:!0,configurable:!0,writable:!0}):U[X]=ne,U}function O(U,X){if(!(U instanceof X))throw new TypeError("Cannot call a class as a function")}function $(U,X){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return X&&(typeof X=="object"||typeof X=="function")?X:U}function F(U,X){if(typeof X!="function"&&X!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof X);U.prototype=Object.create(X&&X.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),X&&(Object.setPrototypeOf?Object.setPrototypeOf(U,X):U.__proto__=X)}var K=(0,N.default)("quill:keyboard"),ee=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",Z=function(U){F(X,U),g(X,null,[{key:"match",value:function(re,de){return de=J(de),["altKey","ctrlKey","metaKey","shiftKey"].some(function(be){return!!de[be]!==re[be]&&de[be]!==null})?!1:de.key===(re.which||re.keyCode)}}]);function X(ne,re){O(this,X);var de=$(this,(X.__proto__||Object.getPrototypeOf(X)).call(this,ne,re));return de.bindings={},Object.keys(de.options.bindings).forEach(function(be){be==="list autofill"&&ne.scroll.whitelist!=null&&!ne.scroll.whitelist.list||de.options.bindings[be]&&de.addBinding(de.options.bindings[be])}),de.addBinding({key:X.keys.ENTER,shiftKey:null},C),de.addBinding({key:X.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(de.addBinding({key:X.keys.BACKSPACE},{collapsed:!0},T),de.addBinding({key:X.keys.DELETE},{collapsed:!0},A)):(de.addBinding({key:X.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},T),de.addBinding({key:X.keys.DELETE},{collapsed:!0,suffix:/^.?$/},A)),de.addBinding({key:X.keys.BACKSPACE},{collapsed:!1},E),de.addBinding({key:X.keys.DELETE},{collapsed:!1},E),de.addBinding({key:X.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},T),de.listen(),de}return g(X,[{key:"addBinding",value:function(re){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},we=J(re);if(we==null||we.key==null)return K.warn("Attempted to add invalid keyboard binding",we);typeof de=="function"&&(de={handler:de}),typeof be=="function"&&(be={handler:be}),we=(0,t.default)(we,de,be),this.bindings[we.key]=this.bindings[we.key]||[],this.bindings[we.key].push(we)}},{key:"listen",value:function(){var re=this;this.quill.root.addEventListener("keydown",function(de){if(!de.defaultPrevented){var be=de.which||de.keyCode,we=(re.bindings[be]||[]).filter(function(je){return X.match(de,je)});if(we.length!==0){var xe=re.quill.getSelection();if(!(xe==null||!re.quill.hasFocus())){var Ee=re.quill.getLine(xe.index),Se=_(Ee,2),qe=Se[0],Me=Se[1],ie=re.quill.getLeaf(xe.index),ue=_(ie,2),ve=ue[0],Q=ue[1],G=xe.length===0?[ve,Q]:re.quill.getLeaf(xe.index+xe.length),R=_(G,2),V=R[0],L=R[1],pe=ve instanceof v.default.Text?ve.value().slice(0,Q):"",ce=V instanceof v.default.Text?V.value().slice(L):"",Ne={collapsed:xe.length===0,empty:xe.length===0&&qe.length()<=1,format:re.quill.getFormat(xe),offset:Me,prefix:pe,suffix:ce},st=we.some(function(je){if(je.collapsed!=null&&je.collapsed!==Ne.collapsed||je.empty!=null&&je.empty!==Ne.empty||je.offset!=null&&je.offset!==Ne.offset)return!1;if(Array.isArray(je.format)){if(je.format.every(function(Ve){return Ne.format[Ve]==null}))return!1}else if(p(je.format)==="object"&&!Object.keys(je.format).every(function(Ve){return je.format[Ve]===!0?Ne.format[Ve]!=null:je.format[Ve]===!1?Ne.format[Ve]==null:(0,i.default)(je.format[Ve],Ne.format[Ve])}))return!1;return je.prefix!=null&&!je.prefix.test(Ne.prefix)||je.suffix!=null&&!je.suffix.test(Ne.suffix)?!1:je.handler.call(re,xe,Ne)!==!0});st&&de.preventDefault()}}}})}}]),X}(I.default);Z.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},Z.DEFAULTS={bindings:{bold:te("bold"),italic:te("italic"),underline:te("underline"),indent:{key:Z.keys.TAB,format:["blockquote","indent","list"],handler:function(X,ne){if(ne.collapsed&&ne.offset!==0)return!0;this.quill.format("indent","+1",y.default.sources.USER)}},outdent:{key:Z.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(X,ne){if(ne.collapsed&&ne.offset!==0)return!0;this.quill.format("indent","-1",y.default.sources.USER)}},"outdent backspace":{key:Z.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(X,ne){ne.format.indent!=null?this.quill.format("indent","-1",y.default.sources.USER):ne.format.list!=null&&this.quill.format("list",!1,y.default.sources.USER)}},"indent code-block":z(!0),"outdent code-block":z(!1),"remove tab":{key:Z.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(X){this.quill.deleteText(X.index-1,1,y.default.sources.USER)}},tab:{key:Z.keys.TAB,handler:function(X){this.quill.history.cutoff();var ne=new u.default().retain(X.index).delete(X.length).insert("	");this.quill.updateContents(ne,y.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(X.index+1,y.default.sources.SILENT)}},"list empty enter":{key:Z.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(X,ne){this.quill.format("list",!1,y.default.sources.USER),ne.format.indent&&this.quill.format("indent",!1,y.default.sources.USER)}},"checklist enter":{key:Z.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(X){var ne=this.quill.getLine(X.index),re=_(ne,2),de=re[0],be=re[1],we=(0,t.default)({},de.formats(),{list:"checked"}),xe=new u.default().retain(X.index).insert(`
`,we).retain(de.length()-be-1).retain(1,{list:"unchecked"});this.quill.updateContents(xe,y.default.sources.USER),this.quill.setSelection(X.index+1,y.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:Z.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(X,ne){var re=this.quill.getLine(X.index),de=_(re,2),be=de[0],we=de[1],xe=new u.default().retain(X.index).insert(`
`,ne.format).retain(be.length()-we-1).retain(1,{header:null});this.quill.updateContents(xe,y.default.sources.USER),this.quill.setSelection(X.index+1,y.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(X,ne){var re=ne.prefix.length,de=this.quill.getLine(X.index),be=_(de,2),we=be[0],xe=be[1];if(xe>re)return!0;var Ee=void 0;switch(ne.prefix.trim()){case"[]":case"[ ]":Ee="unchecked";break;case"[x]":Ee="checked";break;case"-":case"*":Ee="bullet";break;default:Ee="ordered"}this.quill.insertText(X.index," ",y.default.sources.USER),this.quill.history.cutoff();var Se=new u.default().retain(X.index-xe).delete(re+1).retain(we.length()-2-xe).retain(1,{list:Ee});this.quill.updateContents(Se,y.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(X.index-re,y.default.sources.SILENT)}},"code exit":{key:Z.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(X){var ne=this.quill.getLine(X.index),re=_(ne,2),de=re[0],be=re[1],we=new u.default().retain(X.index+de.length()-be-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(we,y.default.sources.USER)}},"embed left":M(Z.keys.LEFT,!1),"embed left shift":M(Z.keys.LEFT,!0),"embed right":M(Z.keys.RIGHT,!1),"embed right shift":M(Z.keys.RIGHT,!0)}};function M(U,X){var ne,re=U===Z.keys.LEFT?"prefix":"suffix";return ne={key:U,shiftKey:X,altKey:null},w(ne,re,/^$/),w(ne,"handler",function(be){var we=be.index;U===Z.keys.RIGHT&&(we+=be.length+1);var xe=this.quill.getLeaf(we),Ee=_(xe,1),Se=Ee[0];return Se instanceof v.default.Embed?(U===Z.keys.LEFT?X?this.quill.setSelection(be.index-1,be.length+1,y.default.sources.USER):this.quill.setSelection(be.index-1,y.default.sources.USER):X?this.quill.setSelection(be.index,be.length+1,y.default.sources.USER):this.quill.setSelection(be.index+be.length+1,y.default.sources.USER),!1):!0}),ne}function T(U,X){if(!(U.index===0||this.quill.getLength()<=1)){var ne=this.quill.getLine(U.index),re=_(ne,1),de=re[0],be={};if(X.offset===0){var we=this.quill.getLine(U.index-1),xe=_(we,1),Ee=xe[0];if(Ee!=null&&Ee.length()>1){var Se=de.formats(),qe=this.quill.getFormat(U.index-1,1);be=r.default.attributes.diff(Se,qe)||{}}}var Me=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(X.prefix)?2:1;this.quill.deleteText(U.index-Me,Me,y.default.sources.USER),Object.keys(be).length>0&&this.quill.formatLine(U.index-Me,Me,be,y.default.sources.USER),this.quill.focus()}}function A(U,X){var ne=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(X.suffix)?2:1;if(!(U.index>=this.quill.getLength()-ne)){var re={},de=0,be=this.quill.getLine(U.index),we=_(be,1),xe=we[0];if(X.offset>=xe.length()-1){var Ee=this.quill.getLine(U.index+1),Se=_(Ee,1),qe=Se[0];if(qe){var Me=xe.formats(),ie=this.quill.getFormat(U.index,1);re=r.default.attributes.diff(Me,ie)||{},de=qe.length()}}this.quill.deleteText(U.index,ne,y.default.sources.USER),Object.keys(re).length>0&&this.quill.formatLine(U.index+de-1,ne,re,y.default.sources.USER)}}function E(U){var X=this.quill.getLines(U),ne={};if(X.length>1){var re=X[0].formats(),de=X[X.length-1].formats();ne=r.default.attributes.diff(de,re)||{}}this.quill.deleteText(U,y.default.sources.USER),Object.keys(ne).length>0&&this.quill.formatLine(U.index,1,ne,y.default.sources.USER),this.quill.setSelection(U.index,y.default.sources.SILENT),this.quill.focus()}function C(U,X){var ne=this;U.length>0&&this.quill.scroll.deleteAt(U.index,U.length);var re=Object.keys(X.format).reduce(function(de,be){return v.default.query(be,v.default.Scope.BLOCK)&&!Array.isArray(X.format[be])&&(de[be]=X.format[be]),de},{});this.quill.insertText(U.index,`
`,re,y.default.sources.USER),this.quill.setSelection(U.index+1,y.default.sources.SILENT),this.quill.focus(),Object.keys(X.format).forEach(function(de){re[de]==null&&(Array.isArray(X.format[de])||de!=="link"&&ne.quill.format(de,X.format[de],y.default.sources.USER))})}function z(U){return{key:Z.keys.TAB,shiftKey:!U,format:{"code-block":!0},handler:function(ne){var re=v.default.query("code-block"),de=ne.index,be=ne.length,we=this.quill.scroll.descendant(re,de),xe=_(we,2),Ee=xe[0],Se=xe[1];if(Ee!=null){var qe=this.quill.getIndex(Ee),Me=Ee.newlineIndex(Se,!0)+1,ie=Ee.newlineIndex(qe+Se+be),ue=Ee.domNode.textContent.slice(Me,ie).split(`
`);Se=0,ue.forEach(function(ve,Q){U?(Ee.insertAt(Me+Se,re.TAB),Se+=re.TAB.length,Q===0?de+=re.TAB.length:be+=re.TAB.length):ve.startsWith(re.TAB)&&(Ee.deleteAt(Me+Se,re.TAB.length),Se-=re.TAB.length,Q===0?de-=re.TAB.length:be-=re.TAB.length),Se+=ve.length+1}),this.quill.update(y.default.sources.USER),this.quill.setSelection(de,be,y.default.sources.SILENT)}}}}function te(U){return{key:U[0].toUpperCase(),shortKey:!0,handler:function(ne,re){this.quill.format(U,!re.format[U],y.default.sources.USER)}}}function J(U){if(typeof U=="string"||typeof U=="number")return J({key:U});if((typeof U=="undefined"?"undefined":p(U))==="object"&&(U=(0,b.default)(U,!1)),typeof U.key=="string")if(Z.keys[U.key.toUpperCase()]!=null)U.key=Z.keys[U.key.toUpperCase()];else if(U.key.length===1)U.key=U.key.toUpperCase().charCodeAt(0);else return null;return U.shortKey&&(U[ee]=U.shortKey,delete U.shortKey),U}s.default=Z,s.SHORTKEY=ee},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function r(o,v){var e=[],y=!0,j=!1,N=void 0;try{for(var P=o[Symbol.iterator](),I;!(y=(I=P.next()).done)&&(e.push(I.value),!(v&&e.length===v));y=!0);}catch(x){j=!0,N=x}finally{try{!y&&P.return&&P.return()}finally{if(j)throw N}}return e}return function(o,v){if(Array.isArray(o))return o;if(Symbol.iterator in Object(o))return r(o,v);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function r(o,v,e){o===null&&(o=Function.prototype);var y=Object.getOwnPropertyDescriptor(o,v);if(y===void 0){var j=Object.getPrototypeOf(o);return j===null?void 0:r(j,v,e)}else{if("value"in y)return y.value;var N=y.get;return N===void 0?void 0:N.call(e)}},g=function(){function r(o,v){for(var e=0;e<v.length;e++){var y=v[e];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(o,y.key,y)}}return function(o,v,e){return v&&r(o.prototype,v),e&&r(o,e),o}}(),m=a(0),b=n(m),d=a(7),i=n(d);function n(r){return r&&r.__esModule?r:{default:r}}function t(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function l(r,o){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o&&(typeof o=="object"||typeof o=="function")?o:r}function u(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof o);r.prototype=Object.create(o&&o.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(r,o):r.__proto__=o)}var c=function(r){u(o,r),g(o,null,[{key:"value",value:function(){}}]);function o(v,e){t(this,o);var y=l(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,v));return y.selection=e,y.textNode=document.createTextNode(o.CONTENTS),y.domNode.appendChild(y.textNode),y._length=0,y}return g(o,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(e,y){if(this._length!==0)return _(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"format",this).call(this,e,y);for(var j=this,N=0;j!=null&&j.statics.scope!==b.default.Scope.BLOCK_BLOT;)N+=j.offset(j.parent),j=j.parent;j!=null&&(this._length=o.CONTENTS.length,j.optimize(),j.formatAt(N,o.CONTENTS.length,e,y),this._length=0)}},{key:"index",value:function(e,y){return e===this.textNode?0:_(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"index",this).call(this,e,y)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){_(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var e=this.textNode,y=this.selection.getNativeRange(),j=void 0,N=void 0,P=void 0;if(y!=null&&y.start.node===e&&y.end.node===e){var I=[e,y.start.offset,y.end.offset];j=I[0],N=I[1],P=I[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==o.CONTENTS){var x=this.textNode.data.split(o.CONTENTS).join("");this.next instanceof i.default?(j=this.next.domNode,this.next.insertAt(0,x),this.textNode.data=o.CONTENTS):(this.textNode.data=x,this.parent.insertBefore(b.default.create(this.textNode),this),this.textNode=document.createTextNode(o.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),N!=null){var w=[N,P].map(function($){return Math.max(0,Math.min(j.data.length,$-1))}),O=p(w,2);return N=O[0],P=O[1],{startNode:j,startOffset:N,endNode:j,endOffset:P}}}}},{key:"update",value:function(e,y){var j=this;if(e.some(function(P){return P.type==="characterData"&&P.target===j.textNode})){var N=this.restore();N&&(y.range=N)}}},{key:"value",value:function(){return""}}]),o}(b.default.Embed);c.blotName="cursor",c.className="ql-cursor",c.tagName="span",c.CONTENTS="\uFEFF",s.default=c},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(0),_=b(p),g=a(4),m=b(g);function b(l){return l&&l.__esModule?l:{default:l}}function d(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function i(l,u){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:l}function n(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}var t=function(l){n(u,l);function u(){return d(this,u),i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return u}(_.default.Container);t.allowedChildren=[m.default,g.BlockEmbed,t],s.default=t},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.ColorStyle=s.ColorClass=s.ColorAttributor=void 0;var p=function(){function c(r,o){for(var v=0;v<o.length;v++){var e=o[v];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,o,v){return o&&c(r.prototype,o),v&&c(r,v),r}}(),_=function c(r,o,v){r===null&&(r=Function.prototype);var e=Object.getOwnPropertyDescriptor(r,o);if(e===void 0){var y=Object.getPrototypeOf(r);return y===null?void 0:c(y,o,v)}else{if("value"in e)return e.value;var j=e.get;return j===void 0?void 0:j.call(v)}},g=a(0),m=b(g);function b(c){return c&&c.__esModule?c:{default:c}}function d(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}function i(c,r){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:c}function n(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);c.prototype=Object.create(r&&r.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(c,r):c.__proto__=r)}var t=function(c){n(r,c);function r(){return d(this,r),i(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return p(r,[{key:"value",value:function(v){var e=_(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"value",this).call(this,v);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+e.split(",").map(function(y){return("00"+parseInt(y).toString(16)).slice(-2)}).join("")):e}}]),r}(m.default.Attributor.Style),l=new m.default.Attributor.Class("color","ql-color",{scope:m.default.Scope.INLINE}),u=new t("color","color",{scope:m.default.Scope.INLINE});s.ColorAttributor=t,s.ColorClass=l,s.ColorStyle=u},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.sanitize=s.default=void 0;var p=function(){function u(c,r){for(var o=0;o<r.length;o++){var v=r[o];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(c,v.key,v)}}return function(c,r,o){return r&&u(c.prototype,r),o&&u(c,o),c}}(),_=function u(c,r,o){c===null&&(c=Function.prototype);var v=Object.getOwnPropertyDescriptor(c,r);if(v===void 0){var e=Object.getPrototypeOf(c);return e===null?void 0:u(e,r,o)}else{if("value"in v)return v.value;var y=v.get;return y===void 0?void 0:y.call(o)}},g=a(6),m=b(g);function b(u){return u&&u.__esModule?u:{default:u}}function d(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}function i(u,c){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:u}function n(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);u.prototype=Object.create(c&&c.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(u,c):u.__proto__=c)}var t=function(u){n(c,u);function c(){return d(this,c),i(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return p(c,[{key:"format",value:function(o,v){if(o!==this.statics.blotName||!v)return _(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"format",this).call(this,o,v);v=this.constructor.sanitize(v),this.domNode.setAttribute("href",v)}}],[{key:"create",value:function(o){var v=_(c.__proto__||Object.getPrototypeOf(c),"create",this).call(this,o);return o=this.sanitize(o),v.setAttribute("href",o),v.setAttribute("rel","noopener noreferrer"),v.setAttribute("target","_blank"),v}},{key:"formats",value:function(o){return o.getAttribute("href")}},{key:"sanitize",value:function(o){return l(o,this.PROTOCOL_WHITELIST)?o:this.SANITIZED_URL}}]),c}(m.default);t.blotName="link",t.tagName="A",t.SANITIZED_URL="about:blank",t.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function l(u,c){var r=document.createElement("a");r.href=u;var o=r.href.slice(0,r.href.indexOf(":"));return c.indexOf(o)>-1}s.default=t,s.sanitize=l},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},_=function(){function c(r,o){for(var v=0;v<o.length;v++){var e=o[v];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,o,v){return o&&c(r.prototype,o),v&&c(r,v),r}}(),g=a(23),m=i(g),b=a(107),d=i(b);function i(c){return c&&c.__esModule?c:{default:c}}function n(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}var t=0;function l(c,r){c.setAttribute(r,c.getAttribute(r)!=="true")}var u=function(){function c(r){var o=this;n(this,c),this.select=r,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){o.togglePicker()}),this.label.addEventListener("keydown",function(v){switch(v.keyCode){case m.default.keys.ENTER:o.togglePicker();break;case m.default.keys.ESCAPE:o.escape(),v.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return _(c,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),l(this.label,"aria-expanded"),l(this.options,"aria-hidden")}},{key:"buildItem",value:function(o){var v=this,e=document.createElement("span");return e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item"),o.hasAttribute("value")&&e.setAttribute("data-value",o.getAttribute("value")),o.textContent&&e.setAttribute("data-label",o.textContent),e.addEventListener("click",function(){v.selectItem(e,!0)}),e.addEventListener("keydown",function(y){switch(y.keyCode){case m.default.keys.ENTER:v.selectItem(e,!0),y.preventDefault();break;case m.default.keys.ESCAPE:v.escape(),y.preventDefault();break}}),e}},{key:"buildLabel",value:function(){var o=document.createElement("span");return o.classList.add("ql-picker-label"),o.innerHTML=d.default,o.tabIndex="0",o.setAttribute("role","button"),o.setAttribute("aria-expanded","false"),this.container.appendChild(o),o}},{key:"buildOptions",value:function(){var o=this,v=document.createElement("span");v.classList.add("ql-picker-options"),v.setAttribute("aria-hidden","true"),v.tabIndex="-1",v.id="ql-picker-options-"+t,t+=1,this.label.setAttribute("aria-controls",v.id),this.options=v,[].slice.call(this.select.options).forEach(function(e){var y=o.buildItem(e);v.appendChild(y),e.selected===!0&&o.selectItem(y)}),this.container.appendChild(v)}},{key:"buildPicker",value:function(){var o=this;[].slice.call(this.select.attributes).forEach(function(v){o.container.setAttribute(v.name,v.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var o=this;this.close(),setTimeout(function(){return o.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(o){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=this.container.querySelector(".ql-selected");if(o!==e&&(e!=null&&e.classList.remove("ql-selected"),o!=null&&(o.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(o.parentNode.children,o),o.hasAttribute("data-value")?this.label.setAttribute("data-value",o.getAttribute("data-value")):this.label.removeAttribute("data-value"),o.hasAttribute("data-label")?this.label.setAttribute("data-label",o.getAttribute("data-label")):this.label.removeAttribute("data-label"),v))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event=="undefined"?"undefined":p(Event))==="object"){var y=document.createEvent("Event");y.initEvent("change",!0,!0),this.select.dispatchEvent(y)}this.close()}}},{key:"update",value:function(){var o=void 0;if(this.select.selectedIndex>-1){var v=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];o=this.select.options[this.select.selectedIndex],this.selectItem(v)}else this.selectItem(null);var e=o!=null&&o!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}}]),c}();s.default=u},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(0),_=K(p),g=a(5),m=K(g),b=a(4),d=K(b),i=a(16),n=K(i),t=a(25),l=K(t),u=a(24),c=K(u),r=a(35),o=K(r),v=a(6),e=K(v),y=a(22),j=K(y),N=a(7),P=K(N),I=a(55),x=K(I),w=a(42),O=K(w),$=a(23),F=K($);function K(ee){return ee&&ee.__esModule?ee:{default:ee}}m.default.register({"blots/block":d.default,"blots/block/embed":b.BlockEmbed,"blots/break":n.default,"blots/container":l.default,"blots/cursor":c.default,"blots/embed":o.default,"blots/inline":e.default,"blots/scroll":j.default,"blots/text":P.default,"modules/clipboard":x.default,"modules/history":O.default,"modules/keyboard":F.default}),_.default.register(d.default,n.default,c.default,e.default,j.default,P.default),s.default=m.default},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(1),_=function(){function g(m){this.domNode=m,this.domNode[p.DATA_KEY]={blot:this}}return Object.defineProperty(g.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),g.create=function(m){if(this.tagName==null)throw new p.ParchmentError("Blot definition missing tagName");var b;return Array.isArray(this.tagName)?(typeof m=="string"&&(m=m.toUpperCase(),parseInt(m).toString()===m&&(m=parseInt(m))),typeof m=="number"?b=document.createElement(this.tagName[m-1]):this.tagName.indexOf(m)>-1?b=document.createElement(m):b=document.createElement(this.tagName[0])):b=document.createElement(this.tagName),this.className&&b.classList.add(this.className),b},g.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},g.prototype.clone=function(){var m=this.domNode.cloneNode(!1);return p.create(m)},g.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[p.DATA_KEY]},g.prototype.deleteAt=function(m,b){var d=this.isolate(m,b);d.remove()},g.prototype.formatAt=function(m,b,d,i){var n=this.isolate(m,b);if(p.query(d,p.Scope.BLOT)!=null&&i)n.wrap(d,i);else if(p.query(d,p.Scope.ATTRIBUTE)!=null){var t=p.create(this.statics.scope);n.wrap(t),t.format(d,i)}},g.prototype.insertAt=function(m,b,d){var i=d==null?p.create("text",b):p.create(b,d),n=this.split(m);this.parent.insertBefore(i,n)},g.prototype.insertInto=function(m,b){b===void 0&&(b=null),this.parent!=null&&this.parent.children.remove(this);var d=null;m.children.insertBefore(this,b),b!=null&&(d=b.domNode),(this.domNode.parentNode!=m.domNode||this.domNode.nextSibling!=d)&&m.domNode.insertBefore(this.domNode,d),this.parent=m,this.attach()},g.prototype.isolate=function(m,b){var d=this.split(m);return d.split(b),d},g.prototype.length=function(){return 1},g.prototype.offset=function(m){return m===void 0&&(m=this.parent),this.parent==null||this==m?0:this.parent.children.offset(this)+this.parent.offset(m)},g.prototype.optimize=function(m){this.domNode[p.DATA_KEY]!=null&&delete this.domNode[p.DATA_KEY].mutations},g.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},g.prototype.replace=function(m){m.parent!=null&&(m.parent.insertBefore(this,m.next),m.remove())},g.prototype.replaceWith=function(m,b){var d=typeof m=="string"?p.create(m,b):m;return d.replace(this),d},g.prototype.split=function(m,b){return m===0?this:this.next},g.prototype.update=function(m,b){},g.prototype.wrap=function(m,b){var d=typeof m=="string"?p.create(m,b):m;return this.parent!=null&&this.parent.insertBefore(d,this.next),d.appendChild(this),d},g.blotName="abstract",g}();s.default=_},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(12),_=a(32),g=a(33),m=a(1),b=function(){function d(i){this.attributes={},this.domNode=i,this.build()}return d.prototype.attribute=function(i,n){n?i.add(this.domNode,n)&&(i.value(this.domNode)!=null?this.attributes[i.attrName]=i:delete this.attributes[i.attrName]):(i.remove(this.domNode),delete this.attributes[i.attrName])},d.prototype.build=function(){var i=this;this.attributes={};var n=p.default.keys(this.domNode),t=_.default.keys(this.domNode),l=g.default.keys(this.domNode);n.concat(t).concat(l).forEach(function(u){var c=m.query(u,m.Scope.ATTRIBUTE);c instanceof p.default&&(i.attributes[c.attrName]=c)})},d.prototype.copy=function(i){var n=this;Object.keys(this.attributes).forEach(function(t){var l=n.attributes[t].value(n.domNode);i.format(t,l)})},d.prototype.move=function(i){var n=this;this.copy(i),Object.keys(this.attributes).forEach(function(t){n.attributes[t].remove(n.domNode)}),this.attributes={}},d.prototype.values=function(){var i=this;return Object.keys(this.attributes).reduce(function(n,t){return n[t]=i.attributes[t].value(i.domNode),n},{})},d}();s.default=b},function(f,s,a){var p=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var n in i)i.hasOwnProperty(n)&&(d[n]=i[n])};return function(d,i){b(d,i);function n(){this.constructor=d}d.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(12);function g(b,d){var i=b.getAttribute("class")||"";return i.split(/\s+/).filter(function(n){return n.indexOf(d+"-")===0})}var m=function(b){p(d,b);function d(){return b!==null&&b.apply(this,arguments)||this}return d.keys=function(i){return(i.getAttribute("class")||"").split(/\s+/).map(function(n){return n.split("-").slice(0,-1).join("-")})},d.prototype.add=function(i,n){return this.canAdd(i,n)?(this.remove(i),i.classList.add(this.keyName+"-"+n),!0):!1},d.prototype.remove=function(i){var n=g(i,this.keyName);n.forEach(function(t){i.classList.remove(t)}),i.classList.length===0&&i.removeAttribute("class")},d.prototype.value=function(i){var n=g(i,this.keyName)[0]||"",t=n.slice(this.keyName.length+1);return this.canAdd(i,t)?t:""},d}(_.default);s.default=m},function(f,s,a){var p=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var n in i)i.hasOwnProperty(n)&&(d[n]=i[n])};return function(d,i){b(d,i);function n(){this.constructor=d}d.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(12);function g(b){var d=b.split("-"),i=d.slice(1).map(function(n){return n[0].toUpperCase()+n.slice(1)}).join("");return d[0]+i}var m=function(b){p(d,b);function d(){return b!==null&&b.apply(this,arguments)||this}return d.keys=function(i){return(i.getAttribute("style")||"").split(";").map(function(n){var t=n.split(":");return t[0].trim()})},d.prototype.add=function(i,n){return this.canAdd(i,n)?(i.style[g(this.keyName)]=n,!0):!1},d.prototype.remove=function(i){i.style[g(this.keyName)]="",i.getAttribute("style")||i.removeAttribute("style")},d.prototype.value=function(i){var n=i.style[g(this.keyName)];return this.canAdd(i,n)?n:""},d}(_.default);s.default=m},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function m(b,d){for(var i=0;i<d.length;i++){var n=d[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(b,n.key,n)}}return function(b,d,i){return d&&m(b.prototype,d),i&&m(b,i),b}}();function _(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}var g=function(){function m(b,d){_(this,m),this.quill=b,this.options=d,this.modules={}}return p(m,[{key:"init",value:function(){var d=this;Object.keys(this.options.modules).forEach(function(i){d.modules[i]==null&&d.addModule(i)})}},{key:"addModule",value:function(d){var i=this.quill.constructor.import("modules/"+d);return this.modules[d]=new i(this.quill,this.options.modules[d]||{}),this.modules[d]}}]),m}();g.DEFAULTS={modules:{}},g.themes={default:g},s.default=g},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function r(o,v){for(var e=0;e<v.length;e++){var y=v[e];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(o,y.key,y)}}return function(o,v,e){return v&&r(o.prototype,v),e&&r(o,e),o}}(),_=function r(o,v,e){o===null&&(o=Function.prototype);var y=Object.getOwnPropertyDescriptor(o,v);if(y===void 0){var j=Object.getPrototypeOf(o);return j===null?void 0:r(j,v,e)}else{if("value"in y)return y.value;var N=y.get;return N===void 0?void 0:N.call(e)}},g=a(0),m=i(g),b=a(7),d=i(b);function i(r){return r&&r.__esModule?r:{default:r}}function n(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function t(r,o){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o&&(typeof o=="object"||typeof o=="function")?o:r}function l(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof o);r.prototype=Object.create(o&&o.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(r,o):r.__proto__=o)}var u="\uFEFF",c=function(r){l(o,r);function o(v){n(this,o);var e=t(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,v));return e.contentNode=document.createElement("span"),e.contentNode.setAttribute("contenteditable",!1),[].slice.call(e.domNode.childNodes).forEach(function(y){e.contentNode.appendChild(y)}),e.leftGuard=document.createTextNode(u),e.rightGuard=document.createTextNode(u),e.domNode.appendChild(e.leftGuard),e.domNode.appendChild(e.contentNode),e.domNode.appendChild(e.rightGuard),e}return p(o,[{key:"index",value:function(e,y){return e===this.leftGuard?0:e===this.rightGuard?1:_(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"index",this).call(this,e,y)}},{key:"restore",value:function(e){var y=void 0,j=void 0,N=e.data.split(u).join("");if(e===this.leftGuard)if(this.prev instanceof d.default){var P=this.prev.length();this.prev.insertAt(P,N),y={startNode:this.prev.domNode,startOffset:P+N.length}}else j=document.createTextNode(N),this.parent.insertBefore(m.default.create(j),this),y={startNode:j,startOffset:N.length};else e===this.rightGuard&&(this.next instanceof d.default?(this.next.insertAt(0,N),y={startNode:this.next.domNode,startOffset:N.length}):(j=document.createTextNode(N),this.parent.insertBefore(m.default.create(j),this.next),y={startNode:j,startOffset:N.length}));return e.data=u,y}},{key:"update",value:function(e,y){var j=this;e.forEach(function(N){if(N.type==="characterData"&&(N.target===j.leftGuard||N.target===j.rightGuard)){var P=j.restore(N.target);P&&(y.range=P)}})}}]),o}(m.default.Embed);s.default=c},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.AlignStyle=s.AlignClass=s.AlignAttribute=void 0;var p=a(0),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}var m={scope:_.default.Scope.BLOCK,whitelist:["right","center","justify"]},b=new _.default.Attributor.Attribute("align","align",m),d=new _.default.Attributor.Class("align","ql-align",m),i=new _.default.Attributor.Style("align","text-align",m);s.AlignAttribute=b,s.AlignClass=d,s.AlignStyle=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.BackgroundStyle=s.BackgroundClass=void 0;var p=a(0),_=m(p),g=a(26);function m(i){return i&&i.__esModule?i:{default:i}}var b=new _.default.Attributor.Class("background","ql-bg",{scope:_.default.Scope.INLINE}),d=new g.ColorAttributor("background","background-color",{scope:_.default.Scope.INLINE});s.BackgroundClass=b,s.BackgroundStyle=d},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.DirectionStyle=s.DirectionClass=s.DirectionAttribute=void 0;var p=a(0),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}var m={scope:_.default.Scope.BLOCK,whitelist:["rtl"]},b=new _.default.Attributor.Attribute("direction","dir",m),d=new _.default.Attributor.Class("direction","ql-direction",m),i=new _.default.Attributor.Style("direction","direction",m);s.DirectionAttribute=b,s.DirectionClass=d,s.DirectionStyle=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.FontClass=s.FontStyle=void 0;var p=function(){function r(o,v){for(var e=0;e<v.length;e++){var y=v[e];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(o,y.key,y)}}return function(o,v,e){return v&&r(o.prototype,v),e&&r(o,e),o}}(),_=function r(o,v,e){o===null&&(o=Function.prototype);var y=Object.getOwnPropertyDescriptor(o,v);if(y===void 0){var j=Object.getPrototypeOf(o);return j===null?void 0:r(j,v,e)}else{if("value"in y)return y.value;var N=y.get;return N===void 0?void 0:N.call(e)}},g=a(0),m=b(g);function b(r){return r&&r.__esModule?r:{default:r}}function d(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function i(r,o){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o&&(typeof o=="object"||typeof o=="function")?o:r}function n(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof o);r.prototype=Object.create(o&&o.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(r,o):r.__proto__=o)}var t={scope:m.default.Scope.INLINE,whitelist:["serif","monospace"]},l=new m.default.Attributor.Class("font","ql-font",t),u=function(r){n(o,r);function o(){return d(this,o),i(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return p(o,[{key:"value",value:function(e){return _(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"value",this).call(this,e).replace(/["']/g,"")}}]),o}(m.default.Attributor.Style),c=new u("font","font-family",t);s.FontStyle=c,s.FontClass=l},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.SizeStyle=s.SizeClass=void 0;var p=a(0),_=g(p);function g(d){return d&&d.__esModule?d:{default:d}}var m=new _.default.Attributor.Class("size","ql-size",{scope:_.default.Scope.INLINE,whitelist:["small","large","huge"]}),b=new _.default.Attributor.Style("size","font-size",{scope:_.default.Scope.INLINE,whitelist:["10px","18px","32px"]});s.SizeClass=m,s.SizeStyle=b},function(f,s,a){f.exports={align:{"":a(76),center:a(77),right:a(78),justify:a(79)},background:a(80),blockquote:a(81),bold:a(82),clean:a(83),code:a(58),"code-block":a(58),color:a(84),direction:{"":a(85),rtl:a(86)},float:{center:a(87),full:a(88),left:a(89),right:a(90)},formula:a(91),header:{1:a(92),2:a(93)},italic:a(94),image:a(95),indent:{"+1":a(96),"-1":a(97)},link:a(98),list:{ordered:a(99),bullet:a(100),check:a(101)},script:{sub:a(102),super:a(103)},strike:a(104),underline:a(105),video:a(106)}},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.getLastChangeIndex=s.default=void 0;var p=function(){function v(e,y){for(var j=0;j<y.length;j++){var N=y[j];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(e,N.key,N)}}return function(e,y,j){return y&&v(e.prototype,y),j&&v(e,j),e}}(),_=a(0),g=n(_),m=a(5),b=n(m),d=a(9),i=n(d);function n(v){return v&&v.__esModule?v:{default:v}}function t(v,e){if(!(v instanceof e))throw new TypeError("Cannot call a class as a function")}function l(v,e){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:v}function u(v,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);v.prototype=Object.create(e&&e.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(v,e):v.__proto__=e)}var c=function(v){u(e,v);function e(y,j){t(this,e);var N=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,y,j));return N.lastRecorded=0,N.ignoreChange=!1,N.clear(),N.quill.on(b.default.events.EDITOR_CHANGE,function(P,I,x,w){P!==b.default.events.TEXT_CHANGE||N.ignoreChange||(!N.options.userOnly||w===b.default.sources.USER?N.record(I,x):N.transform(I))}),N.quill.keyboard.addBinding({key:"Z",shortKey:!0},N.undo.bind(N)),N.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},N.redo.bind(N)),/Win/i.test(navigator.platform)&&N.quill.keyboard.addBinding({key:"Y",shortKey:!0},N.redo.bind(N)),N}return p(e,[{key:"change",value:function(j,N){if(this.stack[j].length!==0){var P=this.stack[j].pop();this.stack[N].push(P),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(P[j],b.default.sources.USER),this.ignoreChange=!1;var I=o(P[j]);this.quill.setSelection(I)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(j,N){if(j.ops.length!==0){this.stack.redo=[];var P=this.quill.getContents().diff(N),I=Date.now();if(this.lastRecorded+this.options.delay>I&&this.stack.undo.length>0){var x=this.stack.undo.pop();P=P.compose(x.undo),j=x.redo.compose(j)}else this.lastRecorded=I;this.stack.undo.push({redo:j,undo:P}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(j){this.stack.undo.forEach(function(N){N.undo=j.transform(N.undo,!0),N.redo=j.transform(N.redo,!0)}),this.stack.redo.forEach(function(N){N.undo=j.transform(N.undo,!0),N.redo=j.transform(N.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),e}(i.default);c.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function r(v){var e=v.ops[v.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(function(y){return g.default.query(y,g.default.Scope.BLOCK)!=null}):!1}function o(v){var e=v.reduce(function(j,N){return j+=N.delete||0,j},0),y=v.length()-e;return r(v)&&(y-=1),y}s.default=c,s.getLastChangeIndex=o},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.BaseTooltip=void 0;var p=function(){function C(z,te){for(var J=0;J<te.length;J++){var U=te[J];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(z,U.key,U)}}return function(z,te,J){return te&&C(z.prototype,te),J&&C(z,J),z}}(),_=function C(z,te,J){z===null&&(z=Function.prototype);var U=Object.getOwnPropertyDescriptor(z,te);if(U===void 0){var X=Object.getPrototypeOf(z);return X===null?void 0:C(X,te,J)}else{if("value"in U)return U.value;var ne=U.get;return ne===void 0?void 0:ne.call(J)}},g=a(3),m=I(g),b=a(2),d=I(b),i=a(8),n=I(i),t=a(23),l=I(t),u=a(34),c=I(u),r=a(59),o=I(r),v=a(60),e=I(v),y=a(28),j=I(y),N=a(61),P=I(N);function I(C){return C&&C.__esModule?C:{default:C}}function x(C,z){if(!(C instanceof z))throw new TypeError("Cannot call a class as a function")}function w(C,z){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z&&(typeof z=="object"||typeof z=="function")?z:C}function O(C,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof z);C.prototype=Object.create(z&&z.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),z&&(Object.setPrototypeOf?Object.setPrototypeOf(C,z):C.__proto__=z)}var $=[!1,"center","right","justify"],F=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],K=[!1,"serif","monospace"],ee=["1","2","3",!1],Z=["small",!1,"large","huge"],M=function(C){O(z,C);function z(te,J){x(this,z);var U=w(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,te,J)),X=function ne(re){if(!document.body.contains(te.root))return document.body.removeEventListener("click",ne);U.tooltip!=null&&!U.tooltip.root.contains(re.target)&&document.activeElement!==U.tooltip.textbox&&!U.quill.hasFocus()&&U.tooltip.hide(),U.pickers!=null&&U.pickers.forEach(function(de){de.container.contains(re.target)||de.close()})};return te.emitter.listenDOM("click",document.body,X),U}return p(z,[{key:"addModule",value:function(J){var U=_(z.prototype.__proto__||Object.getPrototypeOf(z.prototype),"addModule",this).call(this,J);return J==="toolbar"&&this.extendToolbar(U),U}},{key:"buildButtons",value:function(J,U){J.forEach(function(X){var ne=X.getAttribute("class")||"";ne.split(/\s+/).forEach(function(re){if(re.startsWith("ql-")&&(re=re.slice(3),U[re]!=null))if(re==="direction")X.innerHTML=U[re][""]+U[re].rtl;else if(typeof U[re]=="string")X.innerHTML=U[re];else{var de=X.value||"";de!=null&&U[re][de]&&(X.innerHTML=U[re][de])}})})}},{key:"buildPickers",value:function(J,U){var X=this;this.pickers=J.map(function(re){if(re.classList.contains("ql-align"))return re.querySelector("option")==null&&E(re,$),new e.default(re,U.align);if(re.classList.contains("ql-background")||re.classList.contains("ql-color")){var de=re.classList.contains("ql-background")?"background":"color";return re.querySelector("option")==null&&E(re,F,de==="background"?"#ffffff":"#000000"),new o.default(re,U[de])}else return re.querySelector("option")==null&&(re.classList.contains("ql-font")?E(re,K):re.classList.contains("ql-header")?E(re,ee):re.classList.contains("ql-size")&&E(re,Z)),new j.default(re)});var ne=function(){X.pickers.forEach(function(de){de.update()})};this.quill.on(n.default.events.EDITOR_CHANGE,ne)}}]),z}(c.default);M.DEFAULTS=(0,m.default)(!0,{},c.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var z=this,te=this.container.querySelector("input.ql-image[type=file]");te==null&&(te=document.createElement("input"),te.setAttribute("type","file"),te.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),te.classList.add("ql-image"),te.addEventListener("change",function(){if(te.files!=null&&te.files[0]!=null){var J=new FileReader;J.onload=function(U){var X=z.quill.getSelection(!0);z.quill.updateContents(new d.default().retain(X.index).delete(X.length).insert({image:U.target.result}),n.default.sources.USER),z.quill.setSelection(X.index+1,n.default.sources.SILENT),te.value=""},J.readAsDataURL(te.files[0])}}),this.container.appendChild(te)),te.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var T=function(C){O(z,C);function z(te,J){x(this,z);var U=w(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,te,J));return U.textbox=U.root.querySelector('input[type="text"]'),U.listen(),U}return p(z,[{key:"listen",value:function(){var J=this;this.textbox.addEventListener("keydown",function(U){l.default.match(U,"enter")?(J.save(),U.preventDefault()):l.default.match(U,"escape")&&(J.cancel(),U.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),U!=null?this.textbox.value=U:J!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+J)||""),this.root.setAttribute("data-mode",J)}},{key:"restoreFocus",value:function(){var J=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=J}},{key:"save",value:function(){var J=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var U=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",J,n.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",J,n.default.sources.USER)),this.quill.root.scrollTop=U;break}case"video":J=A(J);case"formula":{if(!J)break;var X=this.quill.getSelection(!0);if(X!=null){var ne=X.index+X.length;this.quill.insertEmbed(ne,this.root.getAttribute("data-mode"),J,n.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(ne+1," ",n.default.sources.USER),this.quill.setSelection(ne+2,n.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),z}(P.default);function A(C){var z=C.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||C.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return z?(z[1]||"https")+"://www.youtube.com/embed/"+z[2]+"?showinfo=0":(z=C.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(z[1]||"https")+"://player.vimeo.com/video/"+z[2]+"/":C}function E(C,z){var te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;z.forEach(function(J){var U=document.createElement("option");J===te?U.setAttribute("selected","selected"):U.setAttribute("value",J),C.appendChild(U)})}s.BaseTooltip=T,s.default=M},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function _(){this.head=this.tail=null,this.length=0}return _.prototype.append=function(){for(var g=[],m=0;m<arguments.length;m++)g[m]=arguments[m];this.insertBefore(g[0],null),g.length>1&&this.append.apply(this,g.slice(1))},_.prototype.contains=function(g){for(var m,b=this.iterator();m=b();)if(m===g)return!0;return!1},_.prototype.insertBefore=function(g,m){g&&(g.next=m,m!=null?(g.prev=m.prev,m.prev!=null&&(m.prev.next=g),m.prev=g,m===this.head&&(this.head=g)):this.tail!=null?(this.tail.next=g,g.prev=this.tail,this.tail=g):(g.prev=null,this.head=this.tail=g),this.length+=1)},_.prototype.offset=function(g){for(var m=0,b=this.head;b!=null;){if(b===g)return m;m+=b.length(),b=b.next}return-1},_.prototype.remove=function(g){this.contains(g)&&(g.prev!=null&&(g.prev.next=g.next),g.next!=null&&(g.next.prev=g.prev),g===this.head&&(this.head=g.next),g===this.tail&&(this.tail=g.prev),this.length-=1)},_.prototype.iterator=function(g){return g===void 0&&(g=this.head),function(){var m=g;return g!=null&&(g=g.next),m}},_.prototype.find=function(g,m){m===void 0&&(m=!1);for(var b,d=this.iterator();b=d();){var i=b.length();if(g<i||m&&g===i&&(b.next==null||b.next.length()!==0))return[b,g];g-=i}return[null,0]},_.prototype.forEach=function(g){for(var m,b=this.iterator();m=b();)g(m)},_.prototype.forEachAt=function(g,m,b){if(!(m<=0))for(var d=this.find(g),i=d[0],n=d[1],t,l=g-n,u=this.iterator(i);(t=u())&&l<g+m;){var c=t.length();g>l?b(t,g-l,Math.min(m,l+c-g)):b(t,0,Math.min(c,g+m-l)),l+=c}},_.prototype.map=function(g){return this.reduce(function(m,b){return m.push(g(b)),m},[])},_.prototype.reduce=function(g,m){for(var b,d=this.iterator();b=d();)m=g(m,b);return m},_}();s.default=p},function(f,s,a){var p=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var l in t)t.hasOwnProperty(l)&&(n[l]=t[l])};return function(n,t){i(n,t);function l(){this.constructor=n}n.prototype=t===null?Object.create(t):(l.prototype=t.prototype,new l)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(17),g=a(1),m={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},b=100,d=function(i){p(n,i);function n(t){var l=i.call(this,t)||this;return l.scroll=l,l.observer=new MutationObserver(function(u){l.update(u)}),l.observer.observe(l.domNode,m),l.attach(),l}return n.prototype.detach=function(){i.prototype.detach.call(this),this.observer.disconnect()},n.prototype.deleteAt=function(t,l){this.update(),t===0&&l===this.length()?this.children.forEach(function(u){u.remove()}):i.prototype.deleteAt.call(this,t,l)},n.prototype.formatAt=function(t,l,u,c){this.update(),i.prototype.formatAt.call(this,t,l,u,c)},n.prototype.insertAt=function(t,l,u){this.update(),i.prototype.insertAt.call(this,t,l,u)},n.prototype.optimize=function(t,l){var u=this;t===void 0&&(t=[]),l===void 0&&(l={}),i.prototype.optimize.call(this,l);for(var c=[].slice.call(this.observer.takeRecords());c.length>0;)t.push(c.pop());for(var r=function(y,j){j===void 0&&(j=!0),!(y==null||y===u)&&y.domNode.parentNode!=null&&(y.domNode[g.DATA_KEY].mutations==null&&(y.domNode[g.DATA_KEY].mutations=[]),j&&r(y.parent))},o=function(y){y.domNode[g.DATA_KEY]==null||y.domNode[g.DATA_KEY].mutations==null||(y instanceof _.default&&y.children.forEach(o),y.optimize(l))},v=t,e=0;v.length>0;e+=1){if(e>=b)throw new Error("[Parchment] Maximum optimize iterations reached");for(v.forEach(function(y){var j=g.find(y.target,!0);j!=null&&(j.domNode===y.target&&(y.type==="childList"?(r(g.find(y.previousSibling,!1)),[].forEach.call(y.addedNodes,function(N){var P=g.find(N,!1);r(P,!1),P instanceof _.default&&P.children.forEach(function(I){r(I,!1)})})):y.type==="attributes"&&r(j.prev)),r(j))}),this.children.forEach(o),v=[].slice.call(this.observer.takeRecords()),c=v.slice();c.length>0;)t.push(c.pop())}},n.prototype.update=function(t,l){var u=this;l===void 0&&(l={}),t=t||this.observer.takeRecords(),t.map(function(c){var r=g.find(c.target,!0);return r==null?null:r.domNode[g.DATA_KEY].mutations==null?(r.domNode[g.DATA_KEY].mutations=[c],r):(r.domNode[g.DATA_KEY].mutations.push(c),null)}).forEach(function(c){c==null||c===u||c.domNode[g.DATA_KEY]==null||c.update(c.domNode[g.DATA_KEY].mutations||[],l)}),this.domNode[g.DATA_KEY].mutations!=null&&i.prototype.update.call(this,this.domNode[g.DATA_KEY].mutations,l),this.optimize(t,l)},n.blotName="scroll",n.defaultChild="block",n.scope=g.Scope.BLOCK_BLOT,n.tagName="DIV",n}(_.default);s.default=d},function(f,s,a){var p=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t])};return function(i,n){d(i,n);function t(){this.constructor=i}i.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(18),g=a(1);function m(d,i){if(Object.keys(d).length!==Object.keys(i).length)return!1;for(var n in d)if(d[n]!==i[n])return!1;return!0}var b=function(d){p(i,d);function i(){return d!==null&&d.apply(this,arguments)||this}return i.formats=function(n){if(n.tagName!==i.tagName)return d.formats.call(this,n)},i.prototype.format=function(n,t){var l=this;n===this.statics.blotName&&!t?(this.children.forEach(function(u){u instanceof _.default||(u=u.wrap(i.blotName,!0)),l.attributes.copy(u)}),this.unwrap()):d.prototype.format.call(this,n,t)},i.prototype.formatAt=function(n,t,l,u){if(this.formats()[l]!=null||g.query(l,g.Scope.ATTRIBUTE)){var c=this.isolate(n,t);c.format(l,u)}else d.prototype.formatAt.call(this,n,t,l,u)},i.prototype.optimize=function(n){d.prototype.optimize.call(this,n);var t=this.formats();if(Object.keys(t).length===0)return this.unwrap();var l=this.next;l instanceof i&&l.prev===this&&m(t,l.formats())&&(l.moveChildren(this),l.remove())},i.blotName="inline",i.scope=g.Scope.INLINE_BLOT,i.tagName="SPAN",i}(_.default);s.default=b},function(f,s,a){var p=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var n in i)i.hasOwnProperty(n)&&(d[n]=i[n])};return function(d,i){b(d,i);function n(){this.constructor=d}d.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(18),g=a(1),m=function(b){p(d,b);function d(){return b!==null&&b.apply(this,arguments)||this}return d.formats=function(i){var n=g.query(d.blotName).tagName;if(i.tagName!==n)return b.formats.call(this,i)},d.prototype.format=function(i,n){g.query(i,g.Scope.BLOCK)!=null&&(i===this.statics.blotName&&!n?this.replaceWith(d.blotName):b.prototype.format.call(this,i,n))},d.prototype.formatAt=function(i,n,t,l){g.query(t,g.Scope.BLOCK)!=null?this.format(t,l):b.prototype.formatAt.call(this,i,n,t,l)},d.prototype.insertAt=function(i,n,t){if(t==null||g.query(n,g.Scope.INLINE)!=null)b.prototype.insertAt.call(this,i,n,t);else{var l=this.split(i),u=g.create(n,t);l.parent.insertBefore(u,l)}},d.prototype.update=function(i,n){navigator.userAgent.match(/Trident/)?this.build():b.prototype.update.call(this,i,n)},d.blotName="block",d.scope=g.Scope.BLOCK_BLOT,d.tagName="P",d}(_.default);s.default=m},function(f,s,a){var p=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,d){b.__proto__=d}||function(b,d){for(var i in d)d.hasOwnProperty(i)&&(b[i]=d[i])};return function(b,d){m(b,d);function i(){this.constructor=b}b.prototype=d===null?Object.create(d):(i.prototype=d.prototype,new i)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(19),g=function(m){p(b,m);function b(){return m!==null&&m.apply(this,arguments)||this}return b.formats=function(d){},b.prototype.format=function(d,i){m.prototype.formatAt.call(this,0,this.length(),d,i)},b.prototype.formatAt=function(d,i,n,t){d===0&&i===this.length()?this.format(n,t):m.prototype.formatAt.call(this,d,i,n,t)},b.prototype.formats=function(){return this.statics.formats(this.domNode)},b}(_.default);s.default=g},function(f,s,a){var p=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var n in i)i.hasOwnProperty(n)&&(d[n]=i[n])};return function(d,i){b(d,i);function n(){this.constructor=d}d.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(s,"__esModule",{value:!0});var _=a(19),g=a(1),m=function(b){p(d,b);function d(i){var n=b.call(this,i)||this;return n.text=n.statics.value(n.domNode),n}return d.create=function(i){return document.createTextNode(i)},d.value=function(i){var n=i.data;return n.normalize&&(n=n.normalize()),n},d.prototype.deleteAt=function(i,n){this.domNode.data=this.text=this.text.slice(0,i)+this.text.slice(i+n)},d.prototype.index=function(i,n){return this.domNode===i?n:-1},d.prototype.insertAt=function(i,n,t){t==null?(this.text=this.text.slice(0,i)+n+this.text.slice(i),this.domNode.data=this.text):b.prototype.insertAt.call(this,i,n,t)},d.prototype.length=function(){return this.text.length},d.prototype.optimize=function(i){b.prototype.optimize.call(this,i),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof d&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},d.prototype.position=function(i,n){return[this.domNode,i]},d.prototype.split=function(i,n){if(n===void 0&&(n=!1),!n){if(i===0)return this;if(i===this.length())return this.next}var t=g.create(this.domNode.splitText(i));return this.parent.insertBefore(t,this.next),this.text=this.statics.value(this.domNode),t},d.prototype.update=function(i,n){var t=this;i.some(function(l){return l.type==="characterData"&&l.target===t.domNode})&&(this.text=this.statics.value(this.domNode))},d.prototype.value=function(){return this.text},d.blotName="text",d.scope=g.Scope.INLINE_BLOT,d}(_.default);s.default=m},function(f,s,a){var p=document.createElement("div");if(p.classList.toggle("test-class",!1),p.classList.contains("test-class")){var _=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(g,m){return arguments.length>1&&!this.contains(g)==!m?m:_.call(this,g)}}String.prototype.startsWith||(String.prototype.startsWith=function(g,m){return m=m||0,this.substr(m,g.length)===g}),String.prototype.endsWith||(String.prototype.endsWith=function(g,m){var b=this.toString();(typeof m!="number"||!isFinite(m)||Math.floor(m)!==m||m>b.length)&&(m=b.length),m-=g.length;var d=b.indexOf(g,m);return d!==-1&&d===m}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(m){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof m!="function")throw new TypeError("predicate must be a function");for(var b=Object(this),d=b.length>>>0,i=arguments[1],n,t=0;t<d;t++)if(n=b[t],m.call(i,n,t,b))return n}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(f,s){var a=-1,p=1,_=0;function g(e,y,j){if(e==y)return e?[[_,e]]:[];(j<0||e.length<j)&&(j=null);var N=i(e,y),P=e.substring(0,N);e=e.substring(N),y=y.substring(N),N=n(e,y);var I=e.substring(e.length-N);e=e.substring(0,e.length-N),y=y.substring(0,y.length-N);var x=m(e,y);return P&&x.unshift([_,P]),I&&x.push([_,I]),l(x),j!=null&&(x=r(x,j)),x=o(x),x}function m(e,y){var j;if(!e)return[[p,y]];if(!y)return[[a,e]];var N=e.length>y.length?e:y,P=e.length>y.length?y:e,I=N.indexOf(P);if(I!=-1)return j=[[p,N.substring(0,I)],[_,P],[p,N.substring(I+P.length)]],e.length>y.length&&(j[0][0]=j[2][0]=a),j;if(P.length==1)return[[a,e],[p,y]];var x=t(e,y);if(x){var w=x[0],O=x[1],$=x[2],F=x[3],K=x[4],ee=g(w,$),Z=g(O,F);return ee.concat([[_,K]],Z)}return b(e,y)}function b(e,y){for(var j=e.length,N=y.length,P=Math.ceil((j+N)/2),I=P,x=2*P,w=new Array(x),O=new Array(x),$=0;$<x;$++)w[$]=-1,O[$]=-1;w[I+1]=0,O[I+1]=0;for(var F=j-N,K=F%2!=0,ee=0,Z=0,M=0,T=0,A=0;A<P;A++){for(var E=-A+ee;E<=A-Z;E+=2){var C=I+E,z;E==-A||E!=A&&w[C-1]<w[C+1]?z=w[C+1]:z=w[C-1]+1;for(var te=z-E;z<j&&te<N&&e.charAt(z)==y.charAt(te);)z++,te++;if(w[C]=z,z>j)Z+=2;else if(te>N)ee+=2;else if(K){var J=I+F-E;if(J>=0&&J<x&&O[J]!=-1){var U=j-O[J];if(z>=U)return d(e,y,z,te)}}}for(var X=-A+M;X<=A-T;X+=2){var J=I+X,U;X==-A||X!=A&&O[J-1]<O[J+1]?U=O[J+1]:U=O[J-1]+1;for(var ne=U-X;U<j&&ne<N&&e.charAt(j-U-1)==y.charAt(N-ne-1);)U++,ne++;if(O[J]=U,U>j)T+=2;else if(ne>N)M+=2;else if(!K){var C=I+F-X;if(C>=0&&C<x&&w[C]!=-1){var z=w[C],te=I+z-C;if(U=j-U,z>=U)return d(e,y,z,te)}}}}return[[a,e],[p,y]]}function d(e,y,j,N){var P=e.substring(0,j),I=y.substring(0,N),x=e.substring(j),w=y.substring(N),O=g(P,I),$=g(x,w);return O.concat($)}function i(e,y){if(!e||!y||e.charAt(0)!=y.charAt(0))return 0;for(var j=0,N=Math.min(e.length,y.length),P=N,I=0;j<P;)e.substring(I,P)==y.substring(I,P)?(j=P,I=j):N=P,P=Math.floor((N-j)/2+j);return P}function n(e,y){if(!e||!y||e.charAt(e.length-1)!=y.charAt(y.length-1))return 0;for(var j=0,N=Math.min(e.length,y.length),P=N,I=0;j<P;)e.substring(e.length-P,e.length-I)==y.substring(y.length-P,y.length-I)?(j=P,I=j):N=P,P=Math.floor((N-j)/2+j);return P}function t(e,y){var j=e.length>y.length?e:y,N=e.length>y.length?y:e;if(j.length<4||N.length*2<j.length)return null;function P(Z,M,T){for(var A=Z.substring(T,T+Math.floor(Z.length/4)),E=-1,C="",z,te,J,U;(E=M.indexOf(A,E+1))!=-1;){var X=i(Z.substring(T),M.substring(E)),ne=n(Z.substring(0,T),M.substring(0,E));C.length<ne+X&&(C=M.substring(E-ne,E)+M.substring(E,E+X),z=Z.substring(0,T-ne),te=Z.substring(T+X),J=M.substring(0,E-ne),U=M.substring(E+X))}return C.length*2>=Z.length?[z,te,J,U,C]:null}var I=P(j,N,Math.ceil(j.length/4)),x=P(j,N,Math.ceil(j.length/2)),w;if(!I&&!x)return null;x?I?w=I[4].length>x[4].length?I:x:w=x:w=I;var O,$,F,K;e.length>y.length?(O=w[0],$=w[1],F=w[2],K=w[3]):(F=w[0],K=w[1],O=w[2],$=w[3]);var ee=w[4];return[O,$,F,K,ee]}function l(e){e.push([_,""]);for(var y=0,j=0,N=0,P="",I="",x;y<e.length;)switch(e[y][0]){case p:N++,I+=e[y][1],y++;break;case a:j++,P+=e[y][1],y++;break;case _:j+N>1?(j!==0&&N!==0&&(x=i(I,P),x!==0&&(y-j-N>0&&e[y-j-N-1][0]==_?e[y-j-N-1][1]+=I.substring(0,x):(e.splice(0,0,[_,I.substring(0,x)]),y++),I=I.substring(x),P=P.substring(x)),x=n(I,P),x!==0&&(e[y][1]=I.substring(I.length-x)+e[y][1],I=I.substring(0,I.length-x),P=P.substring(0,P.length-x))),j===0?e.splice(y-N,j+N,[p,I]):N===0?e.splice(y-j,j+N,[a,P]):e.splice(y-j-N,j+N,[a,P],[p,I]),y=y-j-N+(j?1:0)+(N?1:0)+1):y!==0&&e[y-1][0]==_?(e[y-1][1]+=e[y][1],e.splice(y,1)):y++,N=0,j=0,P="",I="";break}e[e.length-1][1]===""&&e.pop();var w=!1;for(y=1;y<e.length-1;)e[y-1][0]==_&&e[y+1][0]==_&&(e[y][1].substring(e[y][1].length-e[y-1][1].length)==e[y-1][1]?(e[y][1]=e[y-1][1]+e[y][1].substring(0,e[y][1].length-e[y-1][1].length),e[y+1][1]=e[y-1][1]+e[y+1][1],e.splice(y-1,1),w=!0):e[y][1].substring(0,e[y+1][1].length)==e[y+1][1]&&(e[y-1][1]+=e[y+1][1],e[y][1]=e[y][1].substring(e[y+1][1].length)+e[y+1][1],e.splice(y+1,1),w=!0)),y++;w&&l(e)}var u=g;u.INSERT=p,u.DELETE=a,u.EQUAL=_,f.exports=u;function c(e,y){if(y===0)return[_,e];for(var j=0,N=0;N<e.length;N++){var P=e[N];if(P[0]===a||P[0]===_){var I=j+P[1].length;if(y===I)return[N+1,e];if(y<I){e=e.slice();var x=y-j,w=[P[0],P[1].slice(0,x)],O=[P[0],P[1].slice(x)];return e.splice(N,1,w,O),[N+1,e]}else j=I}}throw new Error("cursor_pos is out of bounds!")}function r(e,y){var j=c(e,y),N=j[1],P=j[0],I=N[P],x=N[P+1];if(I==null)return e;if(I[0]!==_)return e;if(x!=null&&I[1]+x[1]===x[1]+I[1])return N.splice(P,2,x,I),v(N,P,2);if(x!=null&&x[1].indexOf(I[1])===0){N.splice(P,2,[x[0],I[1]],[0,I[1]]);var w=x[1].slice(I[1].length);return w.length>0&&N.splice(P+2,0,[x[0],w]),v(N,P,3)}else return e}function o(e){for(var y=!1,j=function(x){return x.charCodeAt(0)>=56320&&x.charCodeAt(0)<=57343},N=function(x){return x.charCodeAt(x.length-1)>=55296&&x.charCodeAt(x.length-1)<=56319},P=2;P<e.length;P+=1)e[P-2][0]===_&&N(e[P-2][1])&&e[P-1][0]===a&&j(e[P-1][1])&&e[P][0]===p&&j(e[P][1])&&(y=!0,e[P-1][1]=e[P-2][1].slice(-1)+e[P-1][1],e[P][1]=e[P-2][1].slice(-1)+e[P][1],e[P-2][1]=e[P-2][1].slice(0,-1));if(!y)return e;for(var I=[],P=0;P<e.length;P+=1)e[P][1].length>0&&I.push(e[P]);return I}function v(e,y,j){for(var N=y+j-1;N>=0&&N>=y-1;N--)if(N+1<e.length){var P=e[N],I=e[N+1];P[0]===I[1]&&e.splice(N,2,[P[0],P[1]+I[1]])}return e}},function(f,s){s=f.exports=typeof Object.keys=="function"?Object.keys:a,s.shim=a;function a(p){var _=[];for(var g in p)_.push(g);return _}},function(f,s){var a=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";s=f.exports=a?p:_,s.supported=p;function p(g){return Object.prototype.toString.call(g)=="[object Arguments]"}s.unsupported=_;function _(g){return g&&typeof g=="object"&&typeof g.length=="number"&&Object.prototype.hasOwnProperty.call(g,"callee")&&!Object.prototype.propertyIsEnumerable.call(g,"callee")||!1}},function(f,s){var a=Object.prototype.hasOwnProperty,p="~";function _(){}Object.create&&(_.prototype=Object.create(null),new _().__proto__||(p=!1));function g(b,d,i){this.fn=b,this.context=d,this.once=i||!1}function m(){this._events=new _,this._eventsCount=0}m.prototype.eventNames=function(){var d=[],i,n;if(this._eventsCount===0)return d;for(n in i=this._events)a.call(i,n)&&d.push(p?n.slice(1):n);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(i)):d},m.prototype.listeners=function(d,i){var n=p?p+d:d,t=this._events[n];if(i)return!!t;if(!t)return[];if(t.fn)return[t.fn];for(var l=0,u=t.length,c=new Array(u);l<u;l++)c[l]=t[l].fn;return c},m.prototype.emit=function(d,i,n,t,l,u){var c=p?p+d:d;if(!this._events[c])return!1;var r=this._events[c],o=arguments.length,v,e;if(r.fn){switch(r.once&&this.removeListener(d,r.fn,void 0,!0),o){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,i),!0;case 3:return r.fn.call(r.context,i,n),!0;case 4:return r.fn.call(r.context,i,n,t),!0;case 5:return r.fn.call(r.context,i,n,t,l),!0;case 6:return r.fn.call(r.context,i,n,t,l,u),!0}for(e=1,v=new Array(o-1);e<o;e++)v[e-1]=arguments[e];r.fn.apply(r.context,v)}else{var y=r.length,j;for(e=0;e<y;e++)switch(r[e].once&&this.removeListener(d,r[e].fn,void 0,!0),o){case 1:r[e].fn.call(r[e].context);break;case 2:r[e].fn.call(r[e].context,i);break;case 3:r[e].fn.call(r[e].context,i,n);break;case 4:r[e].fn.call(r[e].context,i,n,t);break;default:if(!v)for(j=1,v=new Array(o-1);j<o;j++)v[j-1]=arguments[j];r[e].fn.apply(r[e].context,v)}}return!0},m.prototype.on=function(d,i,n){var t=new g(i,n||this),l=p?p+d:d;return this._events[l]?this._events[l].fn?this._events[l]=[this._events[l],t]:this._events[l].push(t):(this._events[l]=t,this._eventsCount++),this},m.prototype.once=function(d,i,n){var t=new g(i,n||this,!0),l=p?p+d:d;return this._events[l]?this._events[l].fn?this._events[l]=[this._events[l],t]:this._events[l].push(t):(this._events[l]=t,this._eventsCount++),this},m.prototype.removeListener=function(d,i,n,t){var l=p?p+d:d;if(!this._events[l])return this;if(!i)return--this._eventsCount===0?this._events=new _:delete this._events[l],this;var u=this._events[l];if(u.fn)u.fn===i&&(!t||u.once)&&(!n||u.context===n)&&(--this._eventsCount===0?this._events=new _:delete this._events[l]);else{for(var c=0,r=[],o=u.length;c<o;c++)(u[c].fn!==i||t&&!u[c].once||n&&u[c].context!==n)&&r.push(u[c]);r.length?this._events[l]=r.length===1?r[0]:r:--this._eventsCount===0?this._events=new _:delete this._events[l]}return this},m.prototype.removeAllListeners=function(d){var i;return d?(i=p?p+d:d,this._events[i]&&(--this._eventsCount===0?this._events=new _:delete this._events[i])):(this._events=new _,this._eventsCount=0),this},m.prototype.off=m.prototype.removeListener,m.prototype.addListener=m.prototype.on,m.prototype.setMaxListeners=function(){return this},m.prefixed=p,m.EventEmitter=m,typeof f!="undefined"&&(f.exports=m)},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.matchText=s.matchSpacing=s.matchNewline=s.matchBlot=s.matchAttributor=s.default=void 0;var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ie){return typeof ie}:function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie},_=function(){function ie(ue,ve){var Q=[],G=!0,R=!1,V=void 0;try{for(var L=ue[Symbol.iterator](),pe;!(G=(pe=L.next()).done)&&(Q.push(pe.value),!(ve&&Q.length===ve));G=!0);}catch(ce){R=!0,V=ce}finally{try{!G&&L.return&&L.return()}finally{if(R)throw V}}return Q}return function(ue,ve){if(Array.isArray(ue))return ue;if(Symbol.iterator in Object(ue))return ie(ue,ve);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=function(){function ie(ue,ve){for(var Q=0;Q<ve.length;Q++){var G=ve[Q];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(ue,G.key,G)}}return function(ue,ve,Q){return ve&&ie(ue.prototype,ve),Q&&ie(ue,Q),ue}}(),m=a(3),b=O(m),d=a(2),i=O(d),n=a(0),t=O(n),l=a(5),u=O(l),c=a(10),r=O(c),o=a(9),v=O(o),e=a(36),y=a(37),j=a(13),N=O(j),P=a(26),I=a(38),x=a(39),w=a(40);function O(ie){return ie&&ie.__esModule?ie:{default:ie}}function $(ie,ue,ve){return ue in ie?Object.defineProperty(ie,ue,{value:ve,enumerable:!0,configurable:!0,writable:!0}):ie[ue]=ve,ie}function F(ie,ue){if(!(ie instanceof ue))throw new TypeError("Cannot call a class as a function")}function K(ie,ue){if(!ie)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ue&&(typeof ue=="object"||typeof ue=="function")?ue:ie}function ee(ie,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ue);ie.prototype=Object.create(ue&&ue.prototype,{constructor:{value:ie,enumerable:!1,writable:!0,configurable:!0}}),ue&&(Object.setPrototypeOf?Object.setPrototypeOf(ie,ue):ie.__proto__=ue)}var Z=(0,r.default)("quill:clipboard"),M="__ql-matcher",T=[[Node.TEXT_NODE,Me],[Node.TEXT_NODE,Ee],["br",be],[Node.ELEMENT_NODE,Ee],[Node.ELEMENT_NODE,de],[Node.ELEMENT_NODE,Se],[Node.ELEMENT_NODE,re],[Node.ELEMENT_NODE,qe],["li",xe],["b",ne.bind(ne,"bold")],["i",ne.bind(ne,"italic")],["style",we]],A=[e.AlignAttribute,I.DirectionAttribute].reduce(function(ie,ue){return ie[ue.keyName]=ue,ie},{}),E=[e.AlignStyle,y.BackgroundStyle,P.ColorStyle,I.DirectionStyle,x.FontStyle,w.SizeStyle].reduce(function(ie,ue){return ie[ue.keyName]=ue,ie},{}),C=function(ie){ee(ue,ie);function ue(ve,Q){F(this,ue);var G=K(this,(ue.__proto__||Object.getPrototypeOf(ue)).call(this,ve,Q));return G.quill.root.addEventListener("paste",G.onPaste.bind(G)),G.container=G.quill.addContainer("ql-clipboard"),G.container.setAttribute("contenteditable",!0),G.container.setAttribute("tabindex",-1),G.matchers=[],T.concat(G.options.matchers).forEach(function(R){var V=_(R,2),L=V[0],pe=V[1];!Q.matchVisual&&pe===Se||G.addMatcher(L,pe)}),G}return g(ue,[{key:"addMatcher",value:function(Q,G){this.matchers.push([Q,G])}},{key:"convert",value:function(Q){if(typeof Q=="string")return this.container.innerHTML=Q.replace(/\>\r?\n +\</g,"><"),this.convert();var G=this.quill.getFormat(this.quill.selection.savedRange.index);if(G[N.default.blotName]){var R=this.container.innerText;return this.container.innerHTML="",new i.default().insert(R,$({},N.default.blotName,G[N.default.blotName]))}var V=this.prepareMatching(),L=_(V,2),pe=L[0],ce=L[1],Ne=X(this.container,pe,ce);return J(Ne,`
`)&&Ne.ops[Ne.ops.length-1].attributes==null&&(Ne=Ne.compose(new i.default().retain(Ne.length()-1).delete(1))),Z.log("convert",this.container.innerHTML,Ne),this.container.innerHTML="",Ne}},{key:"dangerouslyPasteHTML",value:function(Q,G){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u.default.sources.API;if(typeof Q=="string")this.quill.setContents(this.convert(Q),G),this.quill.setSelection(0,u.default.sources.SILENT);else{var V=this.convert(G);this.quill.updateContents(new i.default().retain(Q).concat(V),R),this.quill.setSelection(Q+V.length(),u.default.sources.SILENT)}}},{key:"onPaste",value:function(Q){var G=this;if(!(Q.defaultPrevented||!this.quill.isEnabled())){var R=this.quill.getSelection(),V=new i.default().retain(R.index),L=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(u.default.sources.SILENT),setTimeout(function(){V=V.concat(G.convert()).delete(R.length),G.quill.updateContents(V,u.default.sources.USER),G.quill.setSelection(V.length()-R.length,u.default.sources.SILENT),G.quill.scrollingContainer.scrollTop=L,G.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Q=this,G=[],R=[];return this.matchers.forEach(function(V){var L=_(V,2),pe=L[0],ce=L[1];switch(pe){case Node.TEXT_NODE:R.push(ce);break;case Node.ELEMENT_NODE:G.push(ce);break;default:[].forEach.call(Q.container.querySelectorAll(pe),function(Ne){Ne[M]=Ne[M]||[],Ne[M].push(ce)});break}}),[G,R]}}]),ue}(v.default);C.DEFAULTS={matchers:[],matchVisual:!0};function z(ie,ue,ve){return(typeof ue=="undefined"?"undefined":p(ue))==="object"?Object.keys(ue).reduce(function(Q,G){return z(Q,G,ue[G])},ie):ie.reduce(function(Q,G){return G.attributes&&G.attributes[ue]?Q.push(G):Q.insert(G.insert,(0,b.default)({},$({},ue,ve),G.attributes))},new i.default)}function te(ie){if(ie.nodeType!==Node.ELEMENT_NODE)return{};var ue="__ql-computed-style";return ie[ue]||(ie[ue]=window.getComputedStyle(ie))}function J(ie,ue){for(var ve="",Q=ie.ops.length-1;Q>=0&&ve.length<ue.length;--Q){var G=ie.ops[Q];if(typeof G.insert!="string")break;ve=G.insert+ve}return ve.slice(-1*ue.length)===ue}function U(ie){if(ie.childNodes.length===0)return!1;var ue=te(ie);return["block","list-item"].indexOf(ue.display)>-1}function X(ie,ue,ve){return ie.nodeType===ie.TEXT_NODE?ve.reduce(function(Q,G){return G(ie,Q)},new i.default):ie.nodeType===ie.ELEMENT_NODE?[].reduce.call(ie.childNodes||[],function(Q,G){var R=X(G,ue,ve);return G.nodeType===ie.ELEMENT_NODE&&(R=ue.reduce(function(V,L){return L(G,V)},R),R=(G[M]||[]).reduce(function(V,L){return L(G,V)},R)),Q.concat(R)},new i.default):new i.default}function ne(ie,ue,ve){return z(ve,ie,!0)}function re(ie,ue){var ve=t.default.Attributor.Attribute.keys(ie),Q=t.default.Attributor.Class.keys(ie),G=t.default.Attributor.Style.keys(ie),R={};return ve.concat(Q).concat(G).forEach(function(V){var L=t.default.query(V,t.default.Scope.ATTRIBUTE);L!=null&&(R[L.attrName]=L.value(ie),R[L.attrName])||(L=A[V],L!=null&&(L.attrName===V||L.keyName===V)&&(R[L.attrName]=L.value(ie)||void 0),L=E[V],L!=null&&(L.attrName===V||L.keyName===V)&&(L=E[V],R[L.attrName]=L.value(ie)||void 0))}),Object.keys(R).length>0&&(ue=z(ue,R)),ue}function de(ie,ue){var ve=t.default.query(ie);if(ve==null)return ue;if(ve.prototype instanceof t.default.Embed){var Q={},G=ve.value(ie);G!=null&&(Q[ve.blotName]=G,ue=new i.default().insert(Q,ve.formats(ie)))}else typeof ve.formats=="function"&&(ue=z(ue,ve.blotName,ve.formats(ie)));return ue}function be(ie,ue){return J(ue,`
`)||ue.insert(`
`),ue}function we(){return new i.default}function xe(ie,ue){var ve=t.default.query(ie);if(ve==null||ve.blotName!=="list-item"||!J(ue,`
`))return ue;for(var Q=-1,G=ie.parentNode;!G.classList.contains("ql-clipboard");)(t.default.query(G)||{}).blotName==="list"&&(Q+=1),G=G.parentNode;return Q<=0?ue:ue.compose(new i.default().retain(ue.length()-1).retain(1,{indent:Q}))}function Ee(ie,ue){return J(ue,`
`)||(U(ie)||ue.length()>0&&ie.nextSibling&&U(ie.nextSibling))&&ue.insert(`
`),ue}function Se(ie,ue){if(U(ie)&&ie.nextElementSibling!=null&&!J(ue,`

`)){var ve=ie.offsetHeight+parseFloat(te(ie).marginTop)+parseFloat(te(ie).marginBottom);ie.nextElementSibling.offsetTop>ie.offsetTop+ve*1.5&&ue.insert(`
`)}return ue}function qe(ie,ue){var ve={},Q=ie.style||{};return Q.fontStyle&&te(ie).fontStyle==="italic"&&(ve.italic=!0),Q.fontWeight&&(te(ie).fontWeight.startsWith("bold")||parseInt(te(ie).fontWeight)>=700)&&(ve.bold=!0),Object.keys(ve).length>0&&(ue=z(ue,ve)),parseFloat(Q.textIndent||0)>0&&(ue=new i.default().insert("	").concat(ue)),ue}function Me(ie,ue){var ve=ie.data;if(ie.parentNode.tagName==="O:P")return ue.insert(ve.trim());if(ve.trim().length===0&&ie.parentNode.classList.contains("ql-clipboard"))return ue;if(!te(ie.parentNode).whiteSpace.startsWith("pre")){var Q=function(R,V){return V=V.replace(/[^\u00a0]/g,""),V.length<1&&R?" ":V};ve=ve.replace(/\r\n/g," ").replace(/\n/g," "),ve=ve.replace(/\s\s+/g,Q.bind(Q,!0)),(ie.previousSibling==null&&U(ie.parentNode)||ie.previousSibling!=null&&U(ie.previousSibling))&&(ve=ve.replace(/^\s+/,Q.bind(Q,!1))),(ie.nextSibling==null&&U(ie.parentNode)||ie.nextSibling!=null&&U(ie.nextSibling))&&(ve=ve.replace(/\s+$/,Q.bind(Q,!1)))}return ue.insert(ve)}s.default=C,s.matchAttributor=re,s.matchBlot=de,s.matchNewline=Ee,s.matchSpacing=Se,s.matchText=Me},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function l(u,c){for(var r=0;r<c.length;r++){var o=c[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}return function(u,c,r){return c&&l(u.prototype,c),r&&l(u,r),u}}(),_=function l(u,c,r){u===null&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,c);if(o===void 0){var v=Object.getPrototypeOf(u);return v===null?void 0:l(v,c,r)}else{if("value"in o)return o.value;var e=o.get;return e===void 0?void 0:e.call(r)}},g=a(6),m=b(g);function b(l){return l&&l.__esModule?l:{default:l}}function d(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function i(l,u){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:l}function n(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}var t=function(l){n(u,l);function u(){return d(this,u),i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return p(u,[{key:"optimize",value:function(r){_(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"optimize",this).call(this,r),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return _(u.__proto__||Object.getPrototypeOf(u),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),u}(m.default);t.blotName="bold",t.tagName=["STRONG","B"],s.default=t},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.addControls=s.default=void 0;var p=function(){function w(O,$){var F=[],K=!0,ee=!1,Z=void 0;try{for(var M=O[Symbol.iterator](),T;!(K=(T=M.next()).done)&&(F.push(T.value),!($&&F.length===$));K=!0);}catch(A){ee=!0,Z=A}finally{try{!K&&M.return&&M.return()}finally{if(ee)throw Z}}return F}return function(O,$){if(Array.isArray(O))return O;if(Symbol.iterator in Object(O))return w(O,$);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function(){function w(O,$){for(var F=0;F<$.length;F++){var K=$[F];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(O,K.key,K)}}return function(O,$,F){return $&&w(O.prototype,$),F&&w(O,F),O}}(),g=a(2),m=r(g),b=a(0),d=r(b),i=a(5),n=r(i),t=a(10),l=r(t),u=a(9),c=r(u);function r(w){return w&&w.__esModule?w:{default:w}}function o(w,O,$){return O in w?Object.defineProperty(w,O,{value:$,enumerable:!0,configurable:!0,writable:!0}):w[O]=$,w}function v(w,O){if(!(w instanceof O))throw new TypeError("Cannot call a class as a function")}function e(w,O){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:w}function y(w,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);w.prototype=Object.create(O&&O.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(w,O):w.__proto__=O)}var j=(0,l.default)("quill:toolbar"),N=function(w){y(O,w);function O($,F){v(this,O);var K=e(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,$,F));if(Array.isArray(K.options.container)){var ee=document.createElement("div");I(ee,K.options.container),$.container.parentNode.insertBefore(ee,$.container),K.container=ee}else typeof K.options.container=="string"?K.container=document.querySelector(K.options.container):K.container=K.options.container;if(!(K.container instanceof HTMLElement)){var Z;return Z=j.error("Container required for toolbar",K.options),e(K,Z)}return K.container.classList.add("ql-toolbar"),K.controls=[],K.handlers={},Object.keys(K.options.handlers).forEach(function(M){K.addHandler(M,K.options.handlers[M])}),[].forEach.call(K.container.querySelectorAll("button, select"),function(M){K.attach(M)}),K.quill.on(n.default.events.EDITOR_CHANGE,function(M,T){M===n.default.events.SELECTION_CHANGE&&K.update(T)}),K.quill.on(n.default.events.SCROLL_OPTIMIZE,function(){var M=K.quill.selection.getRange(),T=p(M,1),A=T[0];K.update(A)}),K}return _(O,[{key:"addHandler",value:function(F,K){this.handlers[F]=K}},{key:"attach",value:function(F){var K=this,ee=[].find.call(F.classList,function(M){return M.indexOf("ql-")===0});if(ee){if(ee=ee.slice(3),F.tagName==="BUTTON"&&F.setAttribute("type","button"),this.handlers[ee]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[ee]==null){j.warn("ignoring attaching to disabled format",ee,F);return}if(d.default.query(ee)==null){j.warn("ignoring attaching to nonexistent format",ee,F);return}}var Z=F.tagName==="SELECT"?"change":"click";F.addEventListener(Z,function(M){var T=void 0;if(F.tagName==="SELECT"){if(F.selectedIndex<0)return;var A=F.options[F.selectedIndex];A.hasAttribute("selected")?T=!1:T=A.value||!1}else F.classList.contains("ql-active")?T=!1:T=F.value||!F.hasAttribute("value"),M.preventDefault();K.quill.focus();var E=K.quill.selection.getRange(),C=p(E,1),z=C[0];if(K.handlers[ee]!=null)K.handlers[ee].call(K,T);else if(d.default.query(ee).prototype instanceof d.default.Embed){if(T=prompt("Enter "+ee),!T)return;K.quill.updateContents(new m.default().retain(z.index).delete(z.length).insert(o({},ee,T)),n.default.sources.USER)}else K.quill.format(ee,T,n.default.sources.USER);K.update(z)}),this.controls.push([ee,F])}}},{key:"update",value:function(F){var K=F==null?{}:this.quill.getFormat(F);this.controls.forEach(function(ee){var Z=p(ee,2),M=Z[0],T=Z[1];if(T.tagName==="SELECT"){var A=void 0;if(F==null)A=null;else if(K[M]==null)A=T.querySelector("option[selected]");else if(!Array.isArray(K[M])){var E=K[M];typeof E=="string"&&(E=E.replace(/\"/g,'\\"')),A=T.querySelector('option[value="'+E+'"]')}A==null?(T.value="",T.selectedIndex=-1):A.selected=!0}else if(F==null)T.classList.remove("ql-active");else if(T.hasAttribute("value")){var C=K[M]===T.getAttribute("value")||K[M]!=null&&K[M].toString()===T.getAttribute("value")||K[M]==null&&!T.getAttribute("value");T.classList.toggle("ql-active",C)}else T.classList.toggle("ql-active",K[M]!=null)})}}]),O}(c.default);N.DEFAULTS={};function P(w,O,$){var F=document.createElement("button");F.setAttribute("type","button"),F.classList.add("ql-"+O),$!=null&&(F.value=$),w.appendChild(F)}function I(w,O){Array.isArray(O[0])||(O=[O]),O.forEach(function($){var F=document.createElement("span");F.classList.add("ql-formats"),$.forEach(function(K){if(typeof K=="string")P(F,K);else{var ee=Object.keys(K)[0],Z=K[ee];Array.isArray(Z)?x(F,ee,Z):P(F,ee,Z)}}),w.appendChild(F)})}function x(w,O,$){var F=document.createElement("select");F.classList.add("ql-"+O),$.forEach(function(K){var ee=document.createElement("option");K!==!1?ee.setAttribute("value",K):ee.setAttribute("selected","selected"),F.appendChild(ee)}),w.appendChild(F)}N.DEFAULTS={container:null,handlers:{clean:function(){var O=this,$=this.quill.getSelection();if($!=null)if($.length==0){var F=this.quill.getFormat();Object.keys(F).forEach(function(K){d.default.query(K,d.default.Scope.INLINE)!=null&&O.quill.format(K,!1)})}else this.quill.removeFormat($,n.default.sources.USER)},direction:function(O){var $=this.quill.getFormat().align;O==="rtl"&&$==null?this.quill.format("align","right",n.default.sources.USER):!O&&$==="right"&&this.quill.format("align",!1,n.default.sources.USER),this.quill.format("direction",O,n.default.sources.USER)},indent:function(O){var $=this.quill.getSelection(),F=this.quill.getFormat($),K=parseInt(F.indent||0);if(O==="+1"||O==="-1"){var ee=O==="+1"?1:-1;F.direction==="rtl"&&(ee*=-1),this.quill.format("indent",K+ee,n.default.sources.USER)}},link:function(O){O===!0&&(O=prompt("Enter link URL:")),this.quill.format("link",O,n.default.sources.USER)},list:function(O){var $=this.quill.getSelection(),F=this.quill.getFormat($);O==="check"?F.list==="checked"||F.list==="unchecked"?this.quill.format("list",!1,n.default.sources.USER):this.quill.format("list","unchecked",n.default.sources.USER):this.quill.format("list",O,n.default.sources.USER)}}},s.default=N,s.addControls=I},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function l(u,c){for(var r=0;r<c.length;r++){var o=c[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}return function(u,c,r){return c&&l(u.prototype,c),r&&l(u,r),u}}(),_=function l(u,c,r){u===null&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,c);if(o===void 0){var v=Object.getPrototypeOf(u);return v===null?void 0:l(v,c,r)}else{if("value"in o)return o.value;var e=o.get;return e===void 0?void 0:e.call(r)}},g=a(28),m=b(g);function b(l){return l&&l.__esModule?l:{default:l}}function d(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function i(l,u){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:l}function n(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}var t=function(l){n(u,l);function u(c,r){d(this,u);var o=i(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,c));return o.label.innerHTML=r,o.container.classList.add("ql-color-picker"),[].slice.call(o.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(v){v.classList.add("ql-primary")}),o}return p(u,[{key:"buildItem",value:function(r){var o=_(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"buildItem",this).call(this,r);return o.style.backgroundColor=r.getAttribute("value")||"",o}},{key:"selectItem",value:function(r,o){_(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"selectItem",this).call(this,r,o);var v=this.label.querySelector(".ql-color-label"),e=r&&r.getAttribute("data-value")||"";v&&(v.tagName==="line"?v.style.stroke=e:v.style.fill=e)}}]),u}(m.default);s.default=t},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function l(u,c){for(var r=0;r<c.length;r++){var o=c[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}return function(u,c,r){return c&&l(u.prototype,c),r&&l(u,r),u}}(),_=function l(u,c,r){u===null&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,c);if(o===void 0){var v=Object.getPrototypeOf(u);return v===null?void 0:l(v,c,r)}else{if("value"in o)return o.value;var e=o.get;return e===void 0?void 0:e.call(r)}},g=a(28),m=b(g);function b(l){return l&&l.__esModule?l:{default:l}}function d(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function i(l,u){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:l}function n(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}var t=function(l){n(u,l);function u(c,r){d(this,u);var o=i(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,c));return o.container.classList.add("ql-icon-picker"),[].forEach.call(o.container.querySelectorAll(".ql-picker-item"),function(v){v.innerHTML=r[v.getAttribute("data-value")||""]}),o.defaultItem=o.container.querySelector(".ql-selected"),o.selectItem(o.defaultItem),o}return p(u,[{key:"selectItem",value:function(r,o){_(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"selectItem",this).call(this,r,o),r=r||this.defaultItem,this.label.innerHTML=r.innerHTML}}]),u}(m.default);s.default=t},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function m(b,d){for(var i=0;i<d.length;i++){var n=d[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(b,n.key,n)}}return function(b,d,i){return d&&m(b.prototype,d),i&&m(b,i),b}}();function _(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}var g=function(){function m(b,d){var i=this;_(this,m),this.quill=b,this.boundsContainer=d||document.body,this.root=b.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){i.root.style.marginTop=-1*i.quill.root.scrollTop+"px"}),this.hide()}return p(m,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(d){var i=d.left+d.width/2-this.root.offsetWidth/2,n=d.bottom+this.quill.root.scrollTop;this.root.style.left=i+"px",this.root.style.top=n+"px",this.root.classList.remove("ql-flip");var t=this.boundsContainer.getBoundingClientRect(),l=this.root.getBoundingClientRect(),u=0;if(l.right>t.right&&(u=t.right-l.right,this.root.style.left=i+u+"px"),l.left<t.left&&(u=t.left-l.left,this.root.style.left=i+u+"px"),l.bottom>t.bottom){var c=l.bottom-l.top,r=d.bottom-d.top+c;this.root.style.top=n-r+"px",this.root.classList.add("ql-flip")}return u}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),m}();s.default=g},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function x(w,O){var $=[],F=!0,K=!1,ee=void 0;try{for(var Z=w[Symbol.iterator](),M;!(F=(M=Z.next()).done)&&($.push(M.value),!(O&&$.length===O));F=!0);}catch(T){K=!0,ee=T}finally{try{!F&&Z.return&&Z.return()}finally{if(K)throw ee}}return $}return function(w,O){if(Array.isArray(w))return w;if(Symbol.iterator in Object(w))return x(w,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function x(w,O,$){w===null&&(w=Function.prototype);var F=Object.getOwnPropertyDescriptor(w,O);if(F===void 0){var K=Object.getPrototypeOf(w);return K===null?void 0:x(K,O,$)}else{if("value"in F)return F.value;var ee=F.get;return ee===void 0?void 0:ee.call($)}},g=function(){function x(w,O){for(var $=0;$<O.length;$++){var F=O[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(w,F.key,F)}}return function(w,O,$){return O&&x(w.prototype,O),$&&x(w,$),w}}(),m=a(3),b=v(m),d=a(8),i=v(d),n=a(43),t=v(n),l=a(27),u=v(l),c=a(15),r=a(41),o=v(r);function v(x){return x&&x.__esModule?x:{default:x}}function e(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function y(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function j(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var N=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],P=function(x){j(w,x);function w(O,$){e(this,w),$.modules.toolbar!=null&&$.modules.toolbar.container==null&&($.modules.toolbar.container=N);var F=y(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,O,$));return F.quill.container.classList.add("ql-snow"),F}return g(w,[{key:"extendToolbar",value:function($){$.container.classList.add("ql-snow"),this.buildButtons([].slice.call($.container.querySelectorAll("button")),o.default),this.buildPickers([].slice.call($.container.querySelectorAll("select")),o.default),this.tooltip=new I(this.quill,this.options.bounds),$.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(F,K){$.handlers.link.call($,!K.format.link)})}}]),w}(t.default);P.DEFAULTS=(0,b.default)(!0,{},t.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(w){if(w){var O=this.quill.getSelection();if(O==null||O.length==0)return;var $=this.quill.getText(O);/^\S+@\S+\.\S+$/.test($)&&$.indexOf("mailto:")!==0&&($="mailto:"+$);var F=this.quill.theme.tooltip;F.edit("link",$)}else this.quill.format("link",!1)}}}}});var I=function(x){j(w,x);function w(O,$){e(this,w);var F=y(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,O,$));return F.preview=F.root.querySelector("a.ql-preview"),F}return g(w,[{key:"listen",value:function(){var $=this;_(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(F){$.root.classList.contains("ql-editing")?$.save():$.edit("link",$.preview.textContent),F.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(F){if($.linkRange!=null){var K=$.linkRange;$.restoreFocus(),$.quill.formatText(K,"link",!1,i.default.sources.USER),delete $.linkRange}F.preventDefault(),$.hide()}),this.quill.on(i.default.events.SELECTION_CHANGE,function(F,K,ee){if(F!=null){if(F.length===0&&ee===i.default.sources.USER){var Z=$.quill.scroll.descendant(u.default,F.index),M=p(Z,2),T=M[0],A=M[1];if(T!=null){$.linkRange=new c.Range(F.index-A,T.length());var E=u.default.formats(T.domNode);$.preview.textContent=E,$.preview.setAttribute("href",E),$.show(),$.position($.quill.getBounds($.linkRange));return}}else delete $.linkRange;$.hide()}})}},{key:"show",value:function(){_(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),w}(n.BaseTooltip);I.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),s.default=P},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(29),_=G(p),g=a(36),m=a(38),b=a(64),d=a(65),i=G(d),n=a(66),t=G(n),l=a(67),u=G(l),c=a(37),r=a(26),o=a(39),v=a(40),e=a(56),y=G(e),j=a(68),N=G(j),P=a(27),I=G(P),x=a(69),w=G(x),O=a(70),$=G(O),F=a(71),K=G(F),ee=a(72),Z=G(ee),M=a(73),T=G(M),A=a(13),E=G(A),C=a(74),z=G(C),te=a(75),J=G(te),U=a(57),X=G(U),ne=a(41),re=G(ne),de=a(28),be=G(de),we=a(59),xe=G(we),Ee=a(60),Se=G(Ee),qe=a(61),Me=G(qe),ie=a(108),ue=G(ie),ve=a(62),Q=G(ve);function G(R){return R&&R.__esModule?R:{default:R}}_.default.register({"attributors/attribute/direction":m.DirectionAttribute,"attributors/class/align":g.AlignClass,"attributors/class/background":c.BackgroundClass,"attributors/class/color":r.ColorClass,"attributors/class/direction":m.DirectionClass,"attributors/class/font":o.FontClass,"attributors/class/size":v.SizeClass,"attributors/style/align":g.AlignStyle,"attributors/style/background":c.BackgroundStyle,"attributors/style/color":r.ColorStyle,"attributors/style/direction":m.DirectionStyle,"attributors/style/font":o.FontStyle,"attributors/style/size":v.SizeStyle},!0),_.default.register({"formats/align":g.AlignClass,"formats/direction":m.DirectionClass,"formats/indent":b.IndentClass,"formats/background":c.BackgroundStyle,"formats/color":r.ColorStyle,"formats/font":o.FontClass,"formats/size":v.SizeClass,"formats/blockquote":i.default,"formats/code-block":E.default,"formats/header":t.default,"formats/list":u.default,"formats/bold":y.default,"formats/code":A.Code,"formats/italic":N.default,"formats/link":I.default,"formats/script":w.default,"formats/strike":$.default,"formats/underline":K.default,"formats/image":Z.default,"formats/video":T.default,"formats/list/item":l.ListItem,"modules/formula":z.default,"modules/syntax":J.default,"modules/toolbar":X.default,"themes/bubble":ue.default,"themes/snow":Q.default,"ui/icons":re.default,"ui/picker":be.default,"ui/icon-picker":Se.default,"ui/color-picker":xe.default,"ui/tooltip":Me.default},!0),s.default=_.default},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.IndentClass=void 0;var p=function(){function u(c,r){for(var o=0;o<r.length;o++){var v=r[o];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(c,v.key,v)}}return function(c,r,o){return r&&u(c.prototype,r),o&&u(c,o),c}}(),_=function u(c,r,o){c===null&&(c=Function.prototype);var v=Object.getOwnPropertyDescriptor(c,r);if(v===void 0){var e=Object.getPrototypeOf(c);return e===null?void 0:u(e,r,o)}else{if("value"in v)return v.value;var y=v.get;return y===void 0?void 0:y.call(o)}},g=a(0),m=b(g);function b(u){return u&&u.__esModule?u:{default:u}}function d(u,c){if(!(u instanceof c))throw new TypeError("Cannot call a class as a function")}function i(u,c){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c&&(typeof c=="object"||typeof c=="function")?c:u}function n(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof c);u.prototype=Object.create(c&&c.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),c&&(Object.setPrototypeOf?Object.setPrototypeOf(u,c):u.__proto__=c)}var t=function(u){n(c,u);function c(){return d(this,c),i(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return p(c,[{key:"add",value:function(o,v){if(v==="+1"||v==="-1"){var e=this.value(o)||0;v=v==="+1"?e+1:e-1}return v===0?(this.remove(o),!0):_(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"add",this).call(this,o,v)}},{key:"canAdd",value:function(o,v){return _(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"canAdd",this).call(this,o,v)||_(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"canAdd",this).call(this,o,parseInt(v))}},{key:"value",value:function(o){return parseInt(_(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"value",this).call(this,o))||void 0}}]),c}(m.default.Attributor.Class),l=new t("indent","ql-indent",{scope:m.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});s.IndentClass=l},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(4),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}function m(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var i=function(n){d(t,n);function t(){return m(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(_.default);i.blotName="blockquote",i.tagName="blockquote",s.default=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function t(l,u){for(var c=0;c<u.length;c++){var r=u[c];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(l,r.key,r)}}return function(l,u,c){return u&&t(l.prototype,u),c&&t(l,c),l}}(),_=a(4),g=m(_);function m(t){return t&&t.__esModule?t:{default:t}}function b(t,l){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}function d(t,l){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l&&(typeof l=="object"||typeof l=="function")?l:t}function i(t,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof l);t.prototype=Object.create(l&&l.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(t,l):t.__proto__=l)}var n=function(t){i(l,t);function l(){return b(this,l),d(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return p(l,null,[{key:"formats",value:function(c){return this.tagName.indexOf(c.tagName)+1}}]),l}(g.default);n.blotName="header",n.tagName=["H1","H2","H3","H4","H5","H6"],s.default=n},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.ListItem=void 0;var p=function(){function e(y,j){for(var N=0;N<j.length;N++){var P=j[N];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(y,P.key,P)}}return function(y,j,N){return j&&e(y.prototype,j),N&&e(y,N),y}}(),_=function e(y,j,N){y===null&&(y=Function.prototype);var P=Object.getOwnPropertyDescriptor(y,j);if(P===void 0){var I=Object.getPrototypeOf(y);return I===null?void 0:e(I,j,N)}else{if("value"in P)return P.value;var x=P.get;return x===void 0?void 0:x.call(N)}},g=a(0),m=t(g),b=a(4),d=t(b),i=a(25),n=t(i);function t(e){return e&&e.__esModule?e:{default:e}}function l(e,y,j){return y in e?Object.defineProperty(e,y,{value:j,enumerable:!0,configurable:!0,writable:!0}):e[y]=j,e}function u(e,y){if(!(e instanceof y))throw new TypeError("Cannot call a class as a function")}function c(e,y){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:e}function r(e,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);e.prototype=Object.create(y&&y.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(e,y):e.__proto__=y)}var o=function(e){r(y,e);function y(){return u(this,y),c(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return p(y,[{key:"format",value:function(N,P){N===v.blotName&&!P?this.replaceWith(m.default.create(this.statics.scope)):_(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"format",this).call(this,N,P)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():_(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(N,P){return this.parent.isolate(this.offset(this.parent),this.length()),N===this.parent.statics.blotName?(this.parent.replaceWith(N,P),this):(this.parent.unwrap(),_(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"replaceWith",this).call(this,N,P))}}],[{key:"formats",value:function(N){return N.tagName===this.tagName?void 0:_(y.__proto__||Object.getPrototypeOf(y),"formats",this).call(this,N)}}]),y}(d.default);o.blotName="list-item",o.tagName="LI";var v=function(e){r(y,e),p(y,null,[{key:"create",value:function(N){var P=N==="ordered"?"OL":"UL",I=_(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,P);return(N==="checked"||N==="unchecked")&&I.setAttribute("data-checked",N==="checked"),I}},{key:"formats",value:function(N){if(N.tagName==="OL")return"ordered";if(N.tagName==="UL")return N.hasAttribute("data-checked")?N.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function y(j){u(this,y);var N=c(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,j)),P=function(x){if(x.target.parentNode===j){var w=N.statics.formats(j),O=m.default.find(x.target);w==="checked"?O.format("list","unchecked"):w==="unchecked"&&O.format("list","checked")}};return j.addEventListener("touchstart",P),j.addEventListener("mousedown",P),N}return p(y,[{key:"format",value:function(N,P){this.children.length>0&&this.children.tail.format(N,P)}},{key:"formats",value:function(){return l({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(N,P){if(N instanceof o)_(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"insertBefore",this).call(this,N,P);else{var I=P==null?this.length():P.offset(this),x=this.split(I);x.parent.insertBefore(N,x)}}},{key:"optimize",value:function(N){_(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,N);var P=this.next;P!=null&&P.prev===this&&P.statics.blotName===this.statics.blotName&&P.domNode.tagName===this.domNode.tagName&&P.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(P.moveChildren(this),P.remove())}},{key:"replace",value:function(N){if(N.statics.blotName!==this.statics.blotName){var P=m.default.create(this.statics.defaultChild);N.moveChildren(P),this.appendChild(P)}_(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"replace",this).call(this,N)}}]),y}(n.default);v.blotName="list",v.scope=m.default.Scope.BLOCK_BLOT,v.tagName=["OL","UL"],v.defaultChild="list-item",v.allowedChildren=[o],s.ListItem=o,s.default=v},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(56),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}function m(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var i=function(n){d(t,n);function t(){return m(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(_.default);i.blotName="italic",i.tagName=["EM","I"],s.default=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function l(u,c){for(var r=0;r<c.length;r++){var o=c[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(u,o.key,o)}}return function(u,c,r){return c&&l(u.prototype,c),r&&l(u,r),u}}(),_=function l(u,c,r){u===null&&(u=Function.prototype);var o=Object.getOwnPropertyDescriptor(u,c);if(o===void 0){var v=Object.getPrototypeOf(u);return v===null?void 0:l(v,c,r)}else{if("value"in o)return o.value;var e=o.get;return e===void 0?void 0:e.call(r)}},g=a(6),m=b(g);function b(l){return l&&l.__esModule?l:{default:l}}function d(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}function i(l,u){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u&&(typeof u=="object"||typeof u=="function")?u:l}function n(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}var t=function(l){n(u,l);function u(){return d(this,u),i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return p(u,null,[{key:"create",value:function(r){return r==="super"?document.createElement("sup"):r==="sub"?document.createElement("sub"):_(u.__proto__||Object.getPrototypeOf(u),"create",this).call(this,r)}},{key:"formats",value:function(r){if(r.tagName==="SUB")return"sub";if(r.tagName==="SUP")return"super"}}]),u}(m.default);t.blotName="script",t.tagName=["SUB","SUP"],s.default=t},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(6),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}function m(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var i=function(n){d(t,n);function t(){return m(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(_.default);i.blotName="strike",i.tagName="S",s.default=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=a(6),_=g(p);function g(n){return n&&n.__esModule?n:{default:n}}function m(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function b(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function d(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var i=function(n){d(t,n);function t(){return m(this,t),b(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return t}(_.default);i.blotName="underline",i.tagName="U",s.default=i},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function c(r,o){for(var v=0;v<o.length;v++){var e=o[v];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,o,v){return o&&c(r.prototype,o),v&&c(r,v),r}}(),_=function c(r,o,v){r===null&&(r=Function.prototype);var e=Object.getOwnPropertyDescriptor(r,o);if(e===void 0){var y=Object.getPrototypeOf(r);return y===null?void 0:c(y,o,v)}else{if("value"in e)return e.value;var j=e.get;return j===void 0?void 0:j.call(v)}},g=a(0),m=d(g),b=a(27);function d(c){return c&&c.__esModule?c:{default:c}}function i(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}function n(c,r){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:c}function t(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);c.prototype=Object.create(r&&r.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(c,r):c.__proto__=r)}var l=["alt","height","width"],u=function(c){t(r,c);function r(){return i(this,r),n(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return p(r,[{key:"format",value:function(v,e){l.indexOf(v)>-1?e?this.domNode.setAttribute(v,e):this.domNode.removeAttribute(v):_(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"format",this).call(this,v,e)}}],[{key:"create",value:function(v){var e=_(r.__proto__||Object.getPrototypeOf(r),"create",this).call(this,v);return typeof v=="string"&&e.setAttribute("src",this.sanitize(v)),e}},{key:"formats",value:function(v){return l.reduce(function(e,y){return v.hasAttribute(y)&&(e[y]=v.getAttribute(y)),e},{})}},{key:"match",value:function(v){return/\.(jpe?g|gif|png)$/.test(v)||/^data:image\/.+;base64/.test(v)}},{key:"sanitize",value:function(v){return(0,b.sanitize)(v,["http","https","data"])?v:"//:0"}},{key:"value",value:function(v){return v.getAttribute("src")}}]),r}(m.default.Embed);u.blotName="image",u.tagName="IMG",s.default=u},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0});var p=function(){function c(r,o){for(var v=0;v<o.length;v++){var e=o[v];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,o,v){return o&&c(r.prototype,o),v&&c(r,v),r}}(),_=function c(r,o,v){r===null&&(r=Function.prototype);var e=Object.getOwnPropertyDescriptor(r,o);if(e===void 0){var y=Object.getPrototypeOf(r);return y===null?void 0:c(y,o,v)}else{if("value"in e)return e.value;var j=e.get;return j===void 0?void 0:j.call(v)}},g=a(4),m=a(27),b=d(m);function d(c){return c&&c.__esModule?c:{default:c}}function i(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}function n(c,r){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:c}function t(c,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);c.prototype=Object.create(r&&r.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(c,r):c.__proto__=r)}var l=["height","width"],u=function(c){t(r,c);function r(){return i(this,r),n(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return p(r,[{key:"format",value:function(v,e){l.indexOf(v)>-1?e?this.domNode.setAttribute(v,e):this.domNode.removeAttribute(v):_(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"format",this).call(this,v,e)}}],[{key:"create",value:function(v){var e=_(r.__proto__||Object.getPrototypeOf(r),"create",this).call(this,v);return e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen",!0),e.setAttribute("src",this.sanitize(v)),e}},{key:"formats",value:function(v){return l.reduce(function(e,y){return v.hasAttribute(y)&&(e[y]=v.getAttribute(y)),e},{})}},{key:"sanitize",value:function(v){return b.default.sanitize(v)}},{key:"value",value:function(v){return v.getAttribute("src")}}]),r}(g.BlockEmbed);u.blotName="video",u.className="ql-video",u.tagName="IFRAME",s.default=u},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.FormulaBlot=void 0;var p=function(){function v(e,y){for(var j=0;j<y.length;j++){var N=y[j];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(e,N.key,N)}}return function(e,y,j){return y&&v(e.prototype,y),j&&v(e,j),e}}(),_=function v(e,y,j){e===null&&(e=Function.prototype);var N=Object.getOwnPropertyDescriptor(e,y);if(N===void 0){var P=Object.getPrototypeOf(e);return P===null?void 0:v(P,y,j)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(j)}},g=a(35),m=t(g),b=a(5),d=t(b),i=a(9),n=t(i);function t(v){return v&&v.__esModule?v:{default:v}}function l(v,e){if(!(v instanceof e))throw new TypeError("Cannot call a class as a function")}function u(v,e){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:v}function c(v,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);v.prototype=Object.create(e&&e.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(v,e):v.__proto__=e)}var r=function(v){c(e,v);function e(){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return p(e,null,[{key:"create",value:function(j){var N=_(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,j);return typeof j=="string"&&(window.katex.render(j,N,{throwOnError:!1,errorColor:"#f00"}),N.setAttribute("data-value",j)),N}},{key:"value",value:function(j){return j.getAttribute("data-value")}}]),e}(m.default);r.blotName="formula",r.className="ql-formula",r.tagName="SPAN";var o=function(v){c(e,v),p(e,null,[{key:"register",value:function(){d.default.register(r,!0)}}]);function e(){l(this,e);var y=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return y}return e}(n.default);s.FormulaBlot=r,s.default=o},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.CodeToken=s.CodeBlock=void 0;var p=function(){function j(N,P){for(var I=0;I<P.length;I++){var x=P[I];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(N,x.key,x)}}return function(N,P,I){return P&&j(N.prototype,P),I&&j(N,I),N}}(),_=function j(N,P,I){N===null&&(N=Function.prototype);var x=Object.getOwnPropertyDescriptor(N,P);if(x===void 0){var w=Object.getPrototypeOf(N);return w===null?void 0:j(w,P,I)}else{if("value"in x)return x.value;var O=x.get;return O===void 0?void 0:O.call(I)}},g=a(0),m=u(g),b=a(5),d=u(b),i=a(9),n=u(i),t=a(13),l=u(t);function u(j){return j&&j.__esModule?j:{default:j}}function c(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function r(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function o(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var v=function(j){o(N,j);function N(){return c(this,N),r(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return p(N,[{key:"replaceWith",value:function(I){this.domNode.textContent=this.domNode.textContent,this.attach(),_(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"replaceWith",this).call(this,I)}},{key:"highlight",value:function(I){var x=this.domNode.textContent;this.cachedText!==x&&((x.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=I(x),this.domNode.normalize(),this.attach()),this.cachedText=x)}}]),N}(l.default);v.className="ql-syntax";var e=new m.default.Attributor.Class("token","hljs",{scope:m.default.Scope.INLINE}),y=function(j){o(N,j),p(N,null,[{key:"register",value:function(){d.default.register(e,!0),d.default.register(v,!0)}}]);function N(P,I){c(this,N);var x=r(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,P,I));if(typeof x.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var w=null;return x.quill.on(d.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(w),w=setTimeout(function(){x.highlight(),w=null},x.options.interval)}),x.highlight(),x}return p(N,[{key:"highlight",value:function(){var I=this;if(!this.quill.selection.composing){this.quill.update(d.default.sources.USER);var x=this.quill.getSelection();this.quill.scroll.descendants(v).forEach(function(w){w.highlight(I.options.highlight)}),this.quill.update(d.default.sources.SILENT),x!=null&&this.quill.setSelection(x,d.default.sources.SILENT)}}}]),N}(n.default);y.DEFAULTS={highlight:function(){return window.hljs==null?null:function(j){var N=window.hljs.highlightAuto(j);return N.value}}(),interval:1e3},s.CodeBlock=v,s.CodeToken=e,s.default=y},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(f,s){f.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(f,s){f.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(f,s){f.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(f,s){f.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(f,s){f.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(f,s,a){Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.BubbleTooltip=void 0;var p=function N(P,I,x){P===null&&(P=Function.prototype);var w=Object.getOwnPropertyDescriptor(P,I);if(w===void 0){var O=Object.getPrototypeOf(P);return O===null?void 0:N(O,I,x)}else{if("value"in w)return w.value;var $=w.get;return $===void 0?void 0:$.call(x)}},_=function(){function N(P,I){for(var x=0;x<I.length;x++){var w=I[x];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(P,w.key,w)}}return function(P,I,x){return I&&N(P.prototype,I),x&&N(P,x),P}}(),g=a(3),m=c(g),b=a(8),d=c(b),i=a(43),n=c(i),t=a(15),l=a(41),u=c(l);function c(N){return N&&N.__esModule?N:{default:N}}function r(N,P){if(!(N instanceof P))throw new TypeError("Cannot call a class as a function")}function o(N,P){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:N}function v(N,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);N.prototype=Object.create(P&&P.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(N,P):N.__proto__=P)}var e=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],y=function(N){v(P,N);function P(I,x){r(this,P),x.modules.toolbar!=null&&x.modules.toolbar.container==null&&(x.modules.toolbar.container=e);var w=o(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,I,x));return w.quill.container.classList.add("ql-bubble"),w}return _(P,[{key:"extendToolbar",value:function(x){this.tooltip=new j(this.quill,this.options.bounds),this.tooltip.root.appendChild(x.container),this.buildButtons([].slice.call(x.container.querySelectorAll("button")),u.default),this.buildPickers([].slice.call(x.container.querySelectorAll("select")),u.default)}}]),P}(n.default);y.DEFAULTS=(0,m.default)(!0,{},n.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(P){P?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var j=function(N){v(P,N);function P(I,x){r(this,P);var w=o(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,I,x));return w.quill.on(d.default.events.EDITOR_CHANGE,function(O,$,F,K){if(O===d.default.events.SELECTION_CHANGE)if($!=null&&$.length>0&&K===d.default.sources.USER){w.show(),w.root.style.left="0px",w.root.style.width="",w.root.style.width=w.root.offsetWidth+"px";var ee=w.quill.getLines($.index,$.length);if(ee.length===1)w.position(w.quill.getBounds($));else{var Z=ee[ee.length-1],M=w.quill.getIndex(Z),T=Math.min(Z.length()-1,$.index+$.length-M),A=w.quill.getBounds(new t.Range(M,T));w.position(A)}}else document.activeElement!==w.textbox&&w.quill.hasFocus()&&w.hide()}),w}return _(P,[{key:"listen",value:function(){var x=this;p(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){x.root.classList.remove("ql-editing")}),this.quill.on(d.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!x.root.classList.contains("ql-hidden")){var w=x.quill.getSelection();w!=null&&x.position(x.quill.getBounds(w))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(x){var w=p(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"position",this).call(this,x),O=this.root.querySelector(".ql-tooltip-arrow");if(O.style.marginLeft="",w===0)return w;O.style.marginLeft=-1*w-O.offsetWidth/2+"px"}}]),P}(i.BaseTooltip);j.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),s.BubbleTooltip=j,s.default=y},function(f,s,a){f.exports=a(63)}]).default})})(gi);var bt=-1,pt=1,at=0;function Xt(S,H,f,s){if(S===H)return S?[[at,S]]:[];if(f!=null){var a=ki(S,H,f);if(a)return a}var p=hr(S,H),_=S.substring(0,p);S=S.substring(p),H=H.substring(p),p=pr(S,H);var g=S.substring(S.length-p);S=S.substring(0,S.length-p),H=H.substring(0,H.length-p);var m=bi(S,H);return _&&m.unshift([at,_]),g&&m.push([at,g]),Dr(m,s),m}function bi(S,H){var f;if(!S)return[[pt,H]];if(!H)return[[bt,S]];var s=S.length>H.length?S:H,a=S.length>H.length?H:S,p=s.indexOf(a);if(p!==-1)return f=[[pt,s.substring(0,p)],[at,a],[pt,s.substring(p+a.length)]],S.length>H.length&&(f[0][0]=f[2][0]=bt),f;if(a.length===1)return[[bt,S],[pt,H]];var _=wi(S,H);if(_){var g=_[0],m=_[1],b=_[2],d=_[3],i=_[4],n=Xt(g,b),t=Xt(m,d);return n.concat([[at,i]],t)}return _i(S,H)}function _i(S,H){for(var f=S.length,s=H.length,a=Math.ceil((f+s)/2),p=a,_=2*a,g=new Array(_),m=new Array(_),b=0;b<_;b++)g[b]=-1,m[b]=-1;g[p+1]=0,m[p+1]=0;for(var d=f-s,i=d%2!==0,n=0,t=0,l=0,u=0,c=0;c<a;c++){for(var r=-c+n;r<=c-t;r+=2){var o=p+r,v;r===-c||r!==c&&g[o-1]<g[o+1]?v=g[o+1]:v=g[o-1]+1;for(var e=v-r;v<f&&e<s&&S.charAt(v)===H.charAt(e);)v++,e++;if(g[o]=v,v>f)t+=2;else if(e>s)n+=2;else if(i){var y=p+d-r;if(y>=0&&y<_&&m[y]!==-1){var j=f-m[y];if(v>=j)return xr(S,H,v,e)}}}for(var N=-c+l;N<=c-u;N+=2){var y=p+N,j;N===-c||N!==c&&m[y-1]<m[y+1]?j=m[y+1]:j=m[y-1]+1;for(var P=j-N;j<f&&P<s&&S.charAt(f-j-1)===H.charAt(s-P-1);)j++,P++;if(m[y]=j,j>f)u+=2;else if(P>s)l+=2;else if(!i){var o=p+d-N;if(o>=0&&o<_&&g[o]!==-1){var v=g[o],e=p+v-o;if(j=f-j,v>=j)return xr(S,H,v,e)}}}}return[[bt,S],[pt,H]]}function xr(S,H,f,s){var a=S.substring(0,f),p=H.substring(0,s),_=S.substring(f),g=H.substring(s),m=Xt(a,p),b=Xt(_,g);return m.concat(b)}function hr(S,H){if(!S||!H||S.charAt(0)!==H.charAt(0))return 0;for(var f=0,s=Math.min(S.length,H.length),a=s,p=0;f<a;)S.substring(p,a)==H.substring(p,a)?(f=a,p=f):s=a,a=Math.floor((s-f)/2+f);return Rr(S.charCodeAt(a-1))&&a--,a}function pr(S,H){if(!S||!H||S.slice(-1)!==H.slice(-1))return 0;for(var f=0,s=Math.min(S.length,H.length),a=s,p=0;f<a;)S.substring(S.length-a,S.length-p)==H.substring(H.length-a,H.length-p)?(f=a,p=f):s=a,a=Math.floor((s-f)/2+f);return Mr(S.charCodeAt(S.length-a))&&a--,a}function wi(S,H){var f=S.length>H.length?S:H,s=S.length>H.length?H:S;if(f.length<4||s.length*2<f.length)return null;function a(t,l,u){for(var c=t.substring(u,u+Math.floor(t.length/4)),r=-1,o="",v,e,y,j;(r=l.indexOf(c,r+1))!==-1;){var N=hr(t.substring(u),l.substring(r)),P=pr(t.substring(0,u),l.substring(0,r));o.length<P+N&&(o=l.substring(r-P,r)+l.substring(r,r+N),v=t.substring(0,u-P),e=t.substring(u+N),y=l.substring(0,r-P),j=l.substring(r+N))}return o.length*2>=t.length?[v,e,y,j,o]:null}var p=a(f,s,Math.ceil(f.length/4)),_=a(f,s,Math.ceil(f.length/2)),g;if(!p&&!_)return null;_?p?g=p[4].length>_[4].length?p:_:g=_:g=p;var m,b,d,i;S.length>H.length?(m=g[0],b=g[1],d=g[2],i=g[3]):(d=g[0],i=g[1],m=g[2],b=g[3]);var n=g[4];return[m,b,d,i,n]}function Dr(S,H){S.push([at,""]);for(var f=0,s=0,a=0,p="",_="",g;f<S.length;){if(f<S.length-1&&!S[f][1]){S.splice(f,1);continue}switch(S[f][0]){case pt:a++,_+=S[f][1],f++;break;case bt:s++,p+=S[f][1],f++;break;case at:var m=f-a-s-1;if(H){if(m>=0&&Fr(S[m][1])){var b=S[m][1].slice(-1);if(S[m][1]=S[m][1].slice(0,-1),p=b+p,_=b+_,!S[m][1]){S.splice(m,1),f--;var d=m-1;S[d]&&S[d][0]===pt&&(a++,_=S[d][1]+_,d--),S[d]&&S[d][0]===bt&&(s++,p=S[d][1]+p,d--),m=d}}if(Ir(S[f][1])){var b=S[f][1].charAt(0);S[f][1]=S[f][1].slice(1),p+=b,_+=b}}if(f<S.length-1&&!S[f][1]){S.splice(f,1);break}if(p.length>0||_.length>0){p.length>0&&_.length>0&&(g=hr(_,p),g!==0&&(m>=0?S[m][1]+=_.substring(0,g):(S.splice(0,0,[at,_.substring(0,g)]),f++),_=_.substring(g),p=p.substring(g)),g=pr(_,p),g!==0&&(S[f][1]=_.substring(_.length-g)+S[f][1],_=_.substring(0,_.length-g),p=p.substring(0,p.length-g)));var i=a+s;p.length===0&&_.length===0?(S.splice(f-i,i),f=f-i):p.length===0?(S.splice(f-i,i,[pt,_]),f=f-i+1):_.length===0?(S.splice(f-i,i,[bt,p]),f=f-i+1):(S.splice(f-i,i,[bt,p],[pt,_]),f=f-i+2)}f!==0&&S[f-1][0]===at?(S[f-1][1]+=S[f][1],S.splice(f,1)):f++,a=0,s=0,p="",_="";break}}S[S.length-1][1]===""&&S.pop();var n=!1;for(f=1;f<S.length-1;)S[f-1][0]===at&&S[f+1][0]===at&&(S[f][1].substring(S[f][1].length-S[f-1][1].length)===S[f-1][1]?(S[f][1]=S[f-1][1]+S[f][1].substring(0,S[f][1].length-S[f-1][1].length),S[f+1][1]=S[f-1][1]+S[f+1][1],S.splice(f-1,1),n=!0):S[f][1].substring(0,S[f+1][1].length)==S[f+1][1]&&(S[f-1][1]+=S[f+1][1],S[f][1]=S[f][1].substring(S[f+1][1].length)+S[f+1][1],S.splice(f+1,1),n=!0)),f++;n&&Dr(S,H)}function Rr(S){return S>=55296&&S<=56319}function Mr(S){return S>=56320&&S<=57343}function Ir(S){return Mr(S.charCodeAt(0))}function Fr(S){return Rr(S.charCodeAt(S.length-1))}function xi(S){for(var H=[],f=0;f<S.length;f++)S[f][1].length>0&&H.push(S[f]);return H}function lr(S,H,f,s){return Fr(S)||Ir(s)?null:xi([[at,S],[bt,H],[pt,f],[at,s]])}function ki(S,H,f){var s=typeof f=="number"?{index:f,length:0}:f.oldRange,a=typeof f=="number"?null:f.newRange,p=S.length,_=H.length;if(s.length===0&&(a===null||a.length===0)){var g=s.index,m=S.slice(0,g),b=S.slice(g),d=a?a.index:null;e:{var i=g+_-p;if(d!==null&&d!==i||i<0||i>_)break e;var n=H.slice(0,i),t=H.slice(i);if(t!==b)break e;var l=Math.min(g,i),u=m.slice(0,l),c=n.slice(0,l);if(u!==c)break e;var r=m.slice(l),o=n.slice(l);return lr(u,r,o,b)}e:{if(d!==null&&d!==g)break e;var v=g,n=H.slice(0,v),t=H.slice(v);if(n!==m)break e;var e=Math.min(p-v,_-v),y=b.slice(b.length-e),j=t.slice(t.length-e);if(y!==j)break e;var r=b.slice(0,b.length-e),o=t.slice(0,t.length-e);return lr(m,r,o,y)}}if(s.length>0&&a&&a.length===0)e:{var u=S.slice(0,s.index),y=S.slice(s.index+s.length),l=u.length,e=y.length;if(_<l+e)break e;var c=H.slice(0,l),j=H.slice(_-e);if(u!==c||y!==j)break e;var r=S.slice(l,p-e),o=H.slice(l,_-e);return lr(u,r,o,y)}return null}function xn(S,H,f){return Xt(S,H,f,!0)}xn.INSERT=pt;xn.DELETE=bt;xn.EQUAL=at;var Oi=xn,_n={exports:{}};_n.exports;(function(S,H){var f=200,s="__lodash_hash_undefined__",a=9007199254740991,p="[object Arguments]",_="[object Array]",g="[object Boolean]",m="[object Date]",b="[object Error]",d="[object Function]",i="[object GeneratorFunction]",n="[object Map]",t="[object Number]",l="[object Object]",u="[object Promise]",c="[object RegExp]",r="[object Set]",o="[object String]",v="[object Symbol]",e="[object WeakMap]",y="[object ArrayBuffer]",j="[object DataView]",N="[object Float32Array]",P="[object Float64Array]",I="[object Int8Array]",x="[object Int16Array]",w="[object Int32Array]",O="[object Uint8Array]",$="[object Uint8ClampedArray]",F="[object Uint16Array]",K="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,Z=/\w*$/,M=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,A={};A[p]=A[_]=A[y]=A[j]=A[g]=A[m]=A[N]=A[P]=A[I]=A[x]=A[w]=A[n]=A[t]=A[l]=A[c]=A[r]=A[o]=A[v]=A[O]=A[$]=A[F]=A[K]=!0,A[b]=A[d]=A[e]=!1;var E=typeof We=="object"&&We&&We.Object===Object&&We,C=typeof self=="object"&&self&&self.Object===Object&&self,z=E||C||Function("return this")(),te=H&&!H.nodeType&&H,J=te&&!0&&S&&!S.nodeType&&S,U=J&&J.exports===te;function X(h,D){return h.set(D[0],D[1]),h}function ne(h,D){return h.add(D),h}function re(h,D){for(var W=-1,se=h?h.length:0;++W<se&&D(h[W],W,h)!==!1;);return h}function de(h,D){for(var W=-1,se=D.length,Te=h.length;++W<se;)h[Te+W]=D[W];return h}function be(h,D,W,se){for(var Te=-1,ke=h?h.length:0;++Te<ke;)W=D(W,h[Te],Te,h);return W}function we(h,D){for(var W=-1,se=Array(h);++W<h;)se[W]=D(W);return se}function xe(h,D){return h==null?void 0:h[D]}function Ee(h){var D=!1;if(h!=null&&typeof h.toString!="function")try{D=!!(h+"")}catch(W){}return D}function Se(h){var D=-1,W=Array(h.size);return h.forEach(function(se,Te){W[++D]=[Te,se]}),W}function qe(h,D){return function(W){return h(D(W))}}function Me(h){var D=-1,W=Array(h.size);return h.forEach(function(se){W[++D]=se}),W}var ie=Array.prototype,ue=Function.prototype,ve=Object.prototype,Q=z["__core-js_shared__"],G=function(){var h=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),R=ue.toString,V=ve.hasOwnProperty,L=ve.toString,pe=RegExp("^"+R.call(V).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ce=U?z.Buffer:void 0,Ne=z.Symbol,st=z.Uint8Array,je=qe(Object.getPrototypeOf,Object),Ve=Object.create,oe=ve.propertyIsEnumerable,Y=ie.splice,le=Object.getOwnPropertySymbols,fe=ce?ce.isBuffer:void 0,me=qe(Object.keys,Object),Pe=ht(z,"DataView"),_e=ht(z,"Map"),Be=ht(z,"Promise"),rt=ht(z,"Set"),He=ht(z,"WeakMap"),ut=ht(Object,"create"),Ot=nt(Pe),vt=nt(_e),Ft=nt(Be),qt=nt(rt),Bt=nt(He),Et=Ne?Ne.prototype:void 0,tn=Et?Et.valueOf:void 0;function _t(h){var D=-1,W=h?h.length:0;for(this.clear();++D<W;){var se=h[D];this.set(se[0],se[1])}}function kn(){this.__data__=ut?ut(null):{}}function On(h){return this.has(h)&&delete this.__data__[h]}function En(h){var D=this.__data__;if(ut){var W=D[h];return W===s?void 0:W}return V.call(D,h)?D[h]:void 0}function nn(h){var D=this.__data__;return ut?D[h]!==void 0:V.call(D,h)}function Ut(h,D){var W=this.__data__;return W[h]=ut&&D===void 0?s:D,this}_t.prototype.clear=kn,_t.prototype.delete=On,_t.prototype.get=En,_t.prototype.has=nn,_t.prototype.set=Ut;function Ge(h){var D=-1,W=h?h.length:0;for(this.clear();++D<W;){var se=h[D];this.set(se[0],se[1])}}function An(){this.__data__=[]}function Tn(h){var D=this.__data__,W=Ct(D,h);if(W<0)return!1;var se=D.length-1;return W==se?D.pop():Y.call(D,W,1),!0}function Sn(h){var D=this.__data__,W=Ct(D,h);return W<0?void 0:D[W][1]}function Nn(h){return Ct(this.__data__,h)>-1}function Pn(h,D){var W=this.__data__,se=Ct(W,h);return se<0?W.push([h,D]):W[se][1]=D,this}Ge.prototype.clear=An,Ge.prototype.delete=Tn,Ge.prototype.get=Sn,Ge.prototype.has=Nn,Ge.prototype.set=Pn;function Ye(h){var D=-1,W=h?h.length:0;for(this.clear();++D<W;){var se=h[D];this.set(se[0],se[1])}}function jn(){this.__data__={hash:new _t,map:new(_e||Ge),string:new _t}}function Ln(h){return Nt(this,h).delete(h)}function $n(h){return Nt(this,h).get(h)}function Cn(h){return Nt(this,h).has(h)}function Dn(h,D){return Nt(this,h).set(h,D),this}Ye.prototype.clear=jn,Ye.prototype.delete=Ln,Ye.prototype.get=$n,Ye.prototype.has=Cn,Ye.prototype.set=Dn;function ot(h){this.__data__=new Ge(h)}function Rn(){this.__data__=new Ge}function Mn(h){return this.__data__.delete(h)}function In(h){return this.__data__.get(h)}function Fn(h){return this.__data__.has(h)}function qn(h,D){var W=this.__data__;if(W instanceof Ge){var se=W.__data__;if(!_e||se.length<f-1)return se.push([h,D]),this;W=this.__data__=new Ye(se)}return W.set(h,D),this}ot.prototype.clear=Rn,ot.prototype.delete=Mn,ot.prototype.get=In,ot.prototype.has=Fn,ot.prototype.set=qn;function $t(h,D){var W=Kt(h)||Rt(h)?we(h.length,String):[],se=W.length,Te=!!se;for(var ke in h)V.call(h,ke)&&!(Te&&(ke=="length"||er(ke,se)))&&W.push(ke);return W}function rn(h,D,W){var se=h[D];(!(V.call(h,D)&&un(se,W))||W===void 0&&!(D in h))&&(h[D]=W)}function Ct(h,D){for(var W=h.length;W--;)if(un(h[W][0],D))return W;return-1}function mt(h,D){return h&&Vt(D,Jt(D),h)}function Ht(h,D,W,se,Te,ke,Ce){var $e;if(se&&($e=ke?se(h,Te,ke,Ce):se(h)),$e!==void 0)return $e;if(!gt(h))return h;var ze=Kt(h);if(ze){if($e=Xn(h),!D)return Zn(h,$e)}else{var Ie=xt(h),Xe=Ie==d||Ie==i;if(cn(h))return Dt(h,D);if(Ie==l||Ie==p||Xe&&!ke){if(Ee(h))return ke?h:{};if($e=yt(Xe?{}:h),!D)return Wn(h,mt($e,h))}else{if(!A[Ie])return ke?h:{};$e=Qn(h,Ie,Ht,D)}}Ce||(Ce=new ot);var it=Ce.get(h);if(it)return it;if(Ce.set(h,$e),!ze)var Ke=W?Yn(h):Jt(h);return re(Ke||h,function(Qe,Je){Ke&&(Je=Qe,Qe=h[Je]),rn($e,Je,Ht(Qe,D,W,se,Je,h,Ce))}),$e}function Bn(h){return gt(h)?Ve(h):{}}function Un(h,D,W){var se=D(h);return Kt(h)?se:de(se,W(h))}function Hn(h){return L.call(h)}function zn(h){if(!gt(h)||nr(h))return!1;var D=Gt(h)||Ee(h)?pe:M;return D.test(nt(h))}function Vn(h){if(!an(h))return me(h);var D=[];for(var W in Object(h))V.call(h,W)&&W!="constructor"&&D.push(W);return D}function Dt(h,D){if(D)return h.slice();var W=new h.constructor(h.length);return h.copy(W),W}function zt(h){var D=new h.constructor(h.byteLength);return new st(D).set(new st(h)),D}function St(h,D){var W=D?zt(h.buffer):h.buffer;return new h.constructor(W,h.byteOffset,h.byteLength)}function on(h,D,W){var se=D?W(Se(h),!0):Se(h);return be(se,X,new h.constructor)}function ln(h){var D=new h.constructor(h.source,Z.exec(h));return D.lastIndex=h.lastIndex,D}function Kn(h,D,W){var se=D?W(Me(h),!0):Me(h);return be(se,ne,new h.constructor)}function Gn(h){return tn?Object(tn.call(h)):{}}function Jn(h,D){var W=D?zt(h.buffer):h.buffer;return new h.constructor(W,h.byteOffset,h.length)}function Zn(h,D){var W=-1,se=h.length;for(D||(D=Array(se));++W<se;)D[W]=h[W];return D}function Vt(h,D,W,se){W||(W={});for(var Te=-1,ke=D.length;++Te<ke;){var Ce=D[Te],$e=void 0;rn(W,Ce,$e===void 0?h[Ce]:$e)}return W}function Wn(h,D){return Vt(h,wt(h),D)}function Yn(h){return Un(h,Jt,wt)}function Nt(h,D){var W=h.__data__;return tr(D)?W[typeof D=="string"?"string":"hash"]:W.map}function ht(h,D){var W=xe(h,D);return zn(W)?W:void 0}var wt=le?qe(le,Object):or,xt=Hn;(Pe&&xt(new Pe(new ArrayBuffer(1)))!=j||_e&&xt(new _e)!=n||Be&&xt(Be.resolve())!=u||rt&&xt(new rt)!=r||He&&xt(new He)!=e)&&(xt=function(h){var D=L.call(h),W=D==l?h.constructor:void 0,se=W?nt(W):void 0;if(se)switch(se){case Ot:return j;case vt:return n;case Ft:return u;case qt:return r;case Bt:return e}return D});function Xn(h){var D=h.length,W=h.constructor(D);return D&&typeof h[0]=="string"&&V.call(h,"index")&&(W.index=h.index,W.input=h.input),W}function yt(h){return typeof h.constructor=="function"&&!an(h)?Bn(je(h)):{}}function Qn(h,D,W,se){var Te=h.constructor;switch(D){case y:return zt(h);case g:case m:return new Te(+h);case j:return St(h,se);case N:case P:case I:case x:case w:case O:case $:case F:case K:return Jn(h,se);case n:return on(h,se,W);case t:case o:return new Te(h);case c:return ln(h);case r:return Kn(h,se,W);case v:return Gn(h)}}function er(h,D){return D=D==null?a:D,!!D&&(typeof h=="number"||T.test(h))&&h>-1&&h%1==0&&h<D}function tr(h){var D=typeof h;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?h!=="__proto__":h===null}function nr(h){return!!G&&G in h}function an(h){var D=h&&h.constructor,W=typeof D=="function"&&D.prototype||ve;return h===W}function nt(h){if(h!=null){try{return R.call(h)}catch(D){}try{return h+""}catch(D){}}return""}function sn(h){return Ht(h,!0,!0)}function un(h,D){return h===D||h!==h&&D!==D}function Rt(h){return rr(h)&&V.call(h,"callee")&&(!oe.call(h,"callee")||L.call(h)==p)}var Kt=Array.isArray;function Mt(h){return h!=null&&fn(h.length)&&!Gt(h)}function rr(h){return dn(h)&&Mt(h)}var cn=fe||ir;function Gt(h){var D=gt(h)?L.call(h):"";return D==d||D==i}function fn(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=a}function gt(h){var D=typeof h;return!!h&&(D=="object"||D=="function")}function dn(h){return!!h&&typeof h=="object"}function Jt(h){return Mt(h)?$t(h):Vn(h)}function or(){return[]}function ir(){return!1}S.exports=sn})(_n,_n.exports);var qr=_n.exports,wn={exports:{}};wn.exports;(function(S,H){var f=200,s="__lodash_hash_undefined__",a=1,p=2,_=9007199254740991,g="[object Arguments]",m="[object Array]",b="[object AsyncFunction]",d="[object Boolean]",i="[object Date]",n="[object Error]",t="[object Function]",l="[object GeneratorFunction]",u="[object Map]",c="[object Number]",r="[object Null]",o="[object Object]",v="[object Promise]",e="[object Proxy]",y="[object RegExp]",j="[object Set]",N="[object String]",P="[object Symbol]",I="[object Undefined]",x="[object WeakMap]",w="[object ArrayBuffer]",O="[object DataView]",$="[object Float32Array]",F="[object Float64Array]",K="[object Int8Array]",ee="[object Int16Array]",Z="[object Int32Array]",M="[object Uint8Array]",T="[object Uint8ClampedArray]",A="[object Uint16Array]",E="[object Uint32Array]",C=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,te=/^(?:0|[1-9]\d*)$/,J={};J[$]=J[F]=J[K]=J[ee]=J[Z]=J[M]=J[T]=J[A]=J[E]=!0,J[g]=J[m]=J[w]=J[d]=J[O]=J[i]=J[n]=J[t]=J[u]=J[c]=J[o]=J[y]=J[j]=J[N]=J[x]=!1;var U=typeof We=="object"&&We&&We.Object===Object&&We,X=typeof self=="object"&&self&&self.Object===Object&&self,ne=U||X||Function("return this")(),re=H&&!H.nodeType&&H,de=re&&!0&&S&&!S.nodeType&&S,be=de&&de.exports===re,we=be&&U.process,xe=function(){try{return we&&we.binding&&we.binding("util")}catch(h){}}(),Ee=xe&&xe.isTypedArray;function Se(h,D){for(var W=-1,se=h==null?0:h.length,Te=0,ke=[];++W<se;){var Ce=h[W];D(Ce,W,h)&&(ke[Te++]=Ce)}return ke}function qe(h,D){for(var W=-1,se=D.length,Te=h.length;++W<se;)h[Te+W]=D[W];return h}function Me(h,D){for(var W=-1,se=h==null?0:h.length;++W<se;)if(D(h[W],W,h))return!0;return!1}function ie(h,D){for(var W=-1,se=Array(h);++W<h;)se[W]=D(W);return se}function ue(h){return function(D){return h(D)}}function ve(h,D){return h.has(D)}function Q(h,D){return h==null?void 0:h[D]}function G(h){var D=-1,W=Array(h.size);return h.forEach(function(se,Te){W[++D]=[Te,se]}),W}function R(h,D){return function(W){return h(D(W))}}function V(h){var D=-1,W=Array(h.size);return h.forEach(function(se){W[++D]=se}),W}var L=Array.prototype,pe=Function.prototype,ce=Object.prototype,Ne=ne["__core-js_shared__"],st=pe.toString,je=ce.hasOwnProperty,Ve=function(){var h=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),oe=ce.toString,Y=RegExp("^"+st.call(je).replace(C,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),le=be?ne.Buffer:void 0,fe=ne.Symbol,me=ne.Uint8Array,Pe=ce.propertyIsEnumerable,_e=L.splice,Be=fe?fe.toStringTag:void 0,rt=Object.getOwnPropertySymbols,He=le?le.isBuffer:void 0,ut=R(Object.keys,Object),Ot=wt(ne,"DataView"),vt=wt(ne,"Map"),Ft=wt(ne,"Promise"),qt=wt(ne,"Set"),Bt=wt(ne,"WeakMap"),Et=wt(Object,"create"),tn=nt(Ot),_t=nt(vt),kn=nt(Ft),On=nt(qt),En=nt(Bt),nn=fe?fe.prototype:void 0,Ut=nn?nn.valueOf:void 0;function Ge(h){var D=-1,W=h==null?0:h.length;for(this.clear();++D<W;){var se=h[D];this.set(se[0],se[1])}}function An(){this.__data__=Et?Et(null):{},this.size=0}function Tn(h){var D=this.has(h)&&delete this.__data__[h];return this.size-=D?1:0,D}function Sn(h){var D=this.__data__;if(Et){var W=D[h];return W===s?void 0:W}return je.call(D,h)?D[h]:void 0}function Nn(h){var D=this.__data__;return Et?D[h]!==void 0:je.call(D,h)}function Pn(h,D){var W=this.__data__;return this.size+=this.has(h)?0:1,W[h]=Et&&D===void 0?s:D,this}Ge.prototype.clear=An,Ge.prototype.delete=Tn,Ge.prototype.get=Sn,Ge.prototype.has=Nn,Ge.prototype.set=Pn;function Ye(h){var D=-1,W=h==null?0:h.length;for(this.clear();++D<W;){var se=h[D];this.set(se[0],se[1])}}function jn(){this.__data__=[],this.size=0}function Ln(h){var D=this.__data__,W=Dt(D,h);if(W<0)return!1;var se=D.length-1;return W==se?D.pop():_e.call(D,W,1),--this.size,!0}function $n(h){var D=this.__data__,W=Dt(D,h);return W<0?void 0:D[W][1]}function Cn(h){return Dt(this.__data__,h)>-1}function Dn(h,D){var W=this.__data__,se=Dt(W,h);return se<0?(++this.size,W.push([h,D])):W[se][1]=D,this}Ye.prototype.clear=jn,Ye.prototype.delete=Ln,Ye.prototype.get=$n,Ye.prototype.has=Cn,Ye.prototype.set=Dn;function ot(h){var D=-1,W=h==null?0:h.length;for(this.clear();++D<W;){var se=h[D];this.set(se[0],se[1])}}function Rn(){this.size=0,this.__data__={hash:new Ge,map:new(vt||Ye),string:new Ge}}function Mn(h){var D=ht(this,h).delete(h);return this.size-=D?1:0,D}function In(h){return ht(this,h).get(h)}function Fn(h){return ht(this,h).has(h)}function qn(h,D){var W=ht(this,h),se=W.size;return W.set(h,D),this.size+=W.size==se?0:1,this}ot.prototype.clear=Rn,ot.prototype.delete=Mn,ot.prototype.get=In,ot.prototype.has=Fn,ot.prototype.set=qn;function $t(h){var D=-1,W=h==null?0:h.length;for(this.__data__=new ot;++D<W;)this.add(h[D])}function rn(h){return this.__data__.set(h,s),this}function Ct(h){return this.__data__.has(h)}$t.prototype.add=$t.prototype.push=rn,$t.prototype.has=Ct;function mt(h){var D=this.__data__=new Ye(h);this.size=D.size}function Ht(){this.__data__=new Ye,this.size=0}function Bn(h){var D=this.__data__,W=D.delete(h);return this.size=D.size,W}function Un(h){return this.__data__.get(h)}function Hn(h){return this.__data__.has(h)}function zn(h,D){var W=this.__data__;if(W instanceof Ye){var se=W.__data__;if(!vt||se.length<f-1)return se.push([h,D]),this.size=++W.size,this;W=this.__data__=new ot(se)}return W.set(h,D),this.size=W.size,this}mt.prototype.clear=Ht,mt.prototype.delete=Bn,mt.prototype.get=Un,mt.prototype.has=Hn,mt.prototype.set=zn;function Vn(h,D){var W=Rt(h),se=!W&&un(h),Te=!W&&!se&&Mt(h),ke=!W&&!se&&!Te&&dn(h),Ce=W||se||Te||ke,$e=Ce?ie(h.length,String):[],ze=$e.length;for(var Ie in h)je.call(h,Ie)&&!(Ce&&(Ie=="length"||Te&&(Ie=="offset"||Ie=="parent")||ke&&(Ie=="buffer"||Ie=="byteLength"||Ie=="byteOffset")||Qn(Ie,ze)))&&$e.push(Ie);return $e}function Dt(h,D){for(var W=h.length;W--;)if(sn(h[W][0],D))return W;return-1}function zt(h,D,W){var se=D(h);return Rt(h)?se:qe(se,W(h))}function St(h){return h==null?h===void 0?I:r:Be&&Be in Object(h)?xt(h):an(h)}function on(h){return gt(h)&&St(h)==g}function ln(h,D,W,se,Te){return h===D?!0:h==null||D==null||!gt(h)&&!gt(D)?h!==h&&D!==D:Kn(h,D,W,se,ln,Te)}function Kn(h,D,W,se,Te,ke){var Ce=Rt(h),$e=Rt(D),ze=Ce?m:yt(h),Ie=$e?m:yt(D);ze=ze==g?o:ze,Ie=Ie==g?o:Ie;var Xe=ze==o,it=Ie==o,Ke=ze==Ie;if(Ke&&Mt(h)){if(!Mt(D))return!1;Ce=!0,Xe=!1}if(Ke&&!Xe)return ke||(ke=new mt),Ce||dn(h)?Vt(h,D,W,se,Te,ke):Wn(h,D,ze,W,se,Te,ke);if(!(W&a)){var Qe=Xe&&je.call(h,"__wrapped__"),Je=it&&je.call(D,"__wrapped__");if(Qe||Je){var At=Qe?h.value():h,kt=Je?D.value():D;return ke||(ke=new mt),Te(At,kt,W,se,ke)}}return Ke?(ke||(ke=new mt),Yn(h,D,W,se,Te,ke)):!1}function Gn(h){if(!fn(h)||tr(h))return!1;var D=cn(h)?Y:z;return D.test(nt(h))}function Jn(h){return gt(h)&&Gt(h.length)&&!!J[St(h)]}function Zn(h){if(!nr(h))return ut(h);var D=[];for(var W in Object(h))je.call(h,W)&&W!="constructor"&&D.push(W);return D}function Vt(h,D,W,se,Te,ke){var Ce=W&a,$e=h.length,ze=D.length;if($e!=ze&&!(Ce&&ze>$e))return!1;var Ie=ke.get(h);if(Ie&&ke.get(D))return Ie==D;var Xe=-1,it=!0,Ke=W&p?new $t:void 0;for(ke.set(h,D),ke.set(D,h);++Xe<$e;){var Qe=h[Xe],Je=D[Xe];if(se)var At=Ce?se(Je,Qe,Xe,D,h,ke):se(Qe,Je,Xe,h,D,ke);if(At!==void 0){if(At)continue;it=!1;break}if(Ke){if(!Me(D,function(kt,Pt){if(!ve(Ke,Pt)&&(Qe===kt||Te(Qe,kt,W,se,ke)))return Ke.push(Pt)})){it=!1;break}}else if(!(Qe===Je||Te(Qe,Je,W,se,ke))){it=!1;break}}return ke.delete(h),ke.delete(D),it}function Wn(h,D,W,se,Te,ke,Ce){switch(W){case O:if(h.byteLength!=D.byteLength||h.byteOffset!=D.byteOffset)return!1;h=h.buffer,D=D.buffer;case w:return!(h.byteLength!=D.byteLength||!ke(new me(h),new me(D)));case d:case i:case c:return sn(+h,+D);case n:return h.name==D.name&&h.message==D.message;case y:case N:return h==D+"";case u:var $e=G;case j:var ze=se&a;if($e||($e=V),h.size!=D.size&&!ze)return!1;var Ie=Ce.get(h);if(Ie)return Ie==D;se|=p,Ce.set(h,D);var Xe=Vt($e(h),$e(D),se,Te,ke,Ce);return Ce.delete(h),Xe;case P:if(Ut)return Ut.call(h)==Ut.call(D)}return!1}function Yn(h,D,W,se,Te,ke){var Ce=W&a,$e=Nt(h),ze=$e.length,Ie=Nt(D),Xe=Ie.length;if(ze!=Xe&&!Ce)return!1;for(var it=ze;it--;){var Ke=$e[it];if(!(Ce?Ke in D:je.call(D,Ke)))return!1}var Qe=ke.get(h);if(Qe&&ke.get(D))return Qe==D;var Je=!0;ke.set(h,D),ke.set(D,h);for(var At=Ce;++it<ze;){Ke=$e[it];var kt=h[Ke],Pt=D[Ke];if(se)var mr=Ce?se(Pt,kt,Ke,D,h,ke):se(kt,Pt,Ke,h,D,ke);if(!(mr===void 0?kt===Pt||Te(kt,Pt,W,se,ke):mr)){Je=!1;break}At||(At=Ke=="constructor")}if(Je&&!At){var hn=h.constructor,pn=D.constructor;hn!=pn&&"constructor"in h&&"constructor"in D&&!(typeof hn=="function"&&hn instanceof hn&&typeof pn=="function"&&pn instanceof pn)&&(Je=!1)}return ke.delete(h),ke.delete(D),Je}function Nt(h){return zt(h,Jt,Xn)}function ht(h,D){var W=h.__data__;return er(D)?W[typeof D=="string"?"string":"hash"]:W.map}function wt(h,D){var W=Q(h,D);return Gn(W)?W:void 0}function xt(h){var D=je.call(h,Be),W=h[Be];try{h[Be]=void 0;var se=!0}catch(ke){}var Te=oe.call(h);return se&&(D?h[Be]=W:delete h[Be]),Te}var Xn=rt?function(h){return h==null?[]:(h=Object(h),Se(rt(h),function(D){return Pe.call(h,D)}))}:or,yt=St;(Ot&&yt(new Ot(new ArrayBuffer(1)))!=O||vt&&yt(new vt)!=u||Ft&&yt(Ft.resolve())!=v||qt&&yt(new qt)!=j||Bt&&yt(new Bt)!=x)&&(yt=function(h){var D=St(h),W=D==o?h.constructor:void 0,se=W?nt(W):"";if(se)switch(se){case tn:return O;case _t:return u;case kn:return v;case On:return j;case En:return x}return D});function Qn(h,D){return D=D==null?_:D,!!D&&(typeof h=="number"||te.test(h))&&h>-1&&h%1==0&&h<D}function er(h){var D=typeof h;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?h!=="__proto__":h===null}function tr(h){return!!Ve&&Ve in h}function nr(h){var D=h&&h.constructor,W=typeof D=="function"&&D.prototype||ce;return h===W}function an(h){return oe.call(h)}function nt(h){if(h!=null){try{return st.call(h)}catch(D){}try{return h+""}catch(D){}}return""}function sn(h,D){return h===D||h!==h&&D!==D}var un=on(function(){return arguments}())?on:function(h){return gt(h)&&je.call(h,"callee")&&!Pe.call(h,"callee")},Rt=Array.isArray;function Kt(h){return h!=null&&Gt(h.length)&&!cn(h)}var Mt=He||ir;function rr(h,D){return ln(h,D)}function cn(h){if(!fn(h))return!1;var D=St(h);return D==t||D==l||D==b||D==e}function Gt(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=_}function fn(h){var D=typeof h;return h!=null&&(D=="object"||D=="function")}function gt(h){return h!=null&&typeof h=="object"}var dn=Ee?ue(Ee):Jn;function Jt(h){return Kt(h)?Vn(h):Zn(h)}function or(){return[]}function ir(){return!1}S.exports=rr})(wn,wn.exports);var Br=wn.exports,vr={},Ur=We&&We.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(vr,"__esModule",{value:!0});var Ei=Ur(qr),Ai=Ur(Br),ur;(function(S){function H(p,_,g){p===void 0&&(p={}),_===void 0&&(_={}),typeof p!="object"&&(p={}),typeof _!="object"&&(_={});var m=Ei.default(_);g||(m=Object.keys(m).reduce(function(d,i){return m[i]!=null&&(d[i]=m[i]),d},{}));for(var b in p)p[b]!==void 0&&_[b]===void 0&&(m[b]=p[b]);return Object.keys(m).length>0?m:void 0}S.compose=H;function f(p,_){p===void 0&&(p={}),_===void 0&&(_={}),typeof p!="object"&&(p={}),typeof _!="object"&&(_={});var g=Object.keys(p).concat(Object.keys(_)).reduce(function(m,b){return Ai.default(p[b],_[b])||(m[b]=_[b]===void 0?null:_[b]),m},{});return Object.keys(g).length>0?g:void 0}S.diff=f;function s(p,_){p===void 0&&(p={}),_===void 0&&(_={}),p=p||{};var g=Object.keys(_).reduce(function(m,b){return _[b]!==p[b]&&p[b]!==void 0&&(m[b]=_[b]),m},{});return Object.keys(p).reduce(function(m,b){return p[b]!==_[b]&&_[b]===void 0&&(m[b]=null),m},g)}S.invert=s;function a(p,_,g){if(g===void 0&&(g=!1),typeof p!="object")return _;if(typeof _=="object"){if(!g)return _;var m=Object.keys(_).reduce(function(b,d){return p[d]===void 0&&(b[d]=_[d]),b},{});return Object.keys(m).length>0?m:void 0}}S.transform=a})(ur||(ur={}));vr.default=ur;var vn={},mn={},kr;function Ti(){if(kr)return mn;kr=1;var S=We&&We.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(mn,"__esModule",{value:!0});var H=S(Hr()),f=function(){function s(a){this.ops=a,this.index=0,this.offset=0}return s.prototype.hasNext=function(){return this.peekLength()<1/0},s.prototype.next=function(a){a||(a=1/0);var p=this.ops[this.index];if(p){var _=this.offset,g=H.default.length(p);if(a>=g-_?(a=g-_,this.index+=1,this.offset=0):this.offset+=a,typeof p.delete=="number")return{delete:a};var m={};return p.attributes&&(m.attributes=p.attributes),typeof p.retain=="number"?m.retain=a:typeof p.insert=="string"?m.insert=p.insert.substr(_,a):m.insert=p.insert,m}else return{retain:1/0}},s.prototype.peek=function(){return this.ops[this.index]},s.prototype.peekLength=function(){return this.ops[this.index]?H.default.length(this.ops[this.index])-this.offset:1/0},s.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},s.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var a=this.offset,p=this.index,_=this.next(),g=this.ops.slice(this.index);return this.offset=a,this.index=p,[_].concat(g)}else return[]},s}();return mn.default=f,mn}var Or;function Hr(){if(Or)return vn;Or=1;var S=We&&We.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(vn,"__esModule",{value:!0});var H=S(Ti()),f;return function(s){function a(_){return new H.default(_)}s.iterator=a;function p(_){return typeof _.delete=="number"?_.delete:typeof _.retain=="number"?_.retain:typeof _.insert=="string"?_.insert.length:1}s.length=p}(f||(f={})),vn.default=f,vn}var en=We&&We.__importDefault||function(S){return S&&S.__esModule?S:{default:S}},yn=en(Oi),Si=en(qr),ar=en(Br),Wt=en(vr),Ze=en(Hr()),Ni="\0";(function(){function S(H){Array.isArray(H)?this.ops=H:H!=null&&Array.isArray(H.ops)?this.ops=H.ops:this.ops=[]}return S.prototype.insert=function(H,f){var s={};return typeof H=="string"&&H.length===0?this:(s.insert=H,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(s.attributes=f),this.push(s))},S.prototype.delete=function(H){return H<=0?this:this.push({delete:H})},S.prototype.retain=function(H,f){if(H<=0)return this;var s={retain:H};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(s.attributes=f),this.push(s)},S.prototype.push=function(H){var f=this.ops.length,s=this.ops[f-1];if(H=Si.default(H),typeof s=="object"){if(typeof H.delete=="number"&&typeof s.delete=="number")return this.ops[f-1]={delete:s.delete+H.delete},this;if(typeof s.delete=="number"&&H.insert!=null&&(f-=1,s=this.ops[f-1],typeof s!="object"))return this.ops.unshift(H),this;if(ar.default(H.attributes,s.attributes)){if(typeof H.insert=="string"&&typeof s.insert=="string")return this.ops[f-1]={insert:s.insert+H.insert},typeof H.attributes=="object"&&(this.ops[f-1].attributes=H.attributes),this;if(typeof H.retain=="number"&&typeof s.retain=="number")return this.ops[f-1]={retain:s.retain+H.retain},typeof H.attributes=="object"&&(this.ops[f-1].attributes=H.attributes),this}}return f===this.ops.length?this.ops.push(H):this.ops.splice(f,0,H),this},S.prototype.chop=function(){var H=this.ops[this.ops.length-1];return H&&H.retain&&!H.attributes&&this.ops.pop(),this},S.prototype.filter=function(H){return this.ops.filter(H)},S.prototype.forEach=function(H){this.ops.forEach(H)},S.prototype.map=function(H){return this.ops.map(H)},S.prototype.partition=function(H){var f=[],s=[];return this.forEach(function(a){var p=H(a)?f:s;p.push(a)}),[f,s]},S.prototype.reduce=function(H,f){return this.ops.reduce(H,f)},S.prototype.changeLength=function(){return this.reduce(function(H,f){return f.insert?H+Ze.default.length(f):f.delete?H-f.delete:H},0)},S.prototype.length=function(){return this.reduce(function(H,f){return H+Ze.default.length(f)},0)},S.prototype.slice=function(H,f){H===void 0&&(H=0),f===void 0&&(f=1/0);for(var s=[],a=Ze.default.iterator(this.ops),p=0;p<f&&a.hasNext();){var _=void 0;p<H?_=a.next(H-p):(_=a.next(f-p),s.push(_)),p+=Ze.default.length(_)}return new S(s)},S.prototype.compose=function(H){var f=Ze.default.iterator(this.ops),s=Ze.default.iterator(H.ops),a=[],p=s.peek();if(p!=null&&typeof p.retain=="number"&&p.attributes==null){for(var _=p.retain;f.peekType()==="insert"&&f.peekLength()<=_;)_-=f.peekLength(),a.push(f.next());p.retain-_>0&&s.next(p.retain-_)}for(var g=new S(a);f.hasNext()||s.hasNext();)if(s.peekType()==="insert")g.push(s.next());else if(f.peekType()==="delete")g.push(f.next());else{var m=Math.min(f.peekLength(),s.peekLength()),b=f.next(m),d=s.next(m);if(typeof d.retain=="number"){var i={};typeof b.retain=="number"?i.retain=m:i.insert=b.insert;var n=Wt.default.compose(b.attributes,d.attributes,typeof b.retain=="number");if(n&&(i.attributes=n),g.push(i),!s.hasNext()&&ar.default(g.ops[g.ops.length-1],i)){var t=new S(f.rest());return g.concat(t).chop()}}else typeof d.delete=="number"&&typeof b.retain=="number"&&g.push(d)}return g.chop()},S.prototype.concat=function(H){var f=new S(this.ops.slice());return H.ops.length>0&&(f.push(H.ops[0]),f.ops=f.ops.concat(H.ops.slice(1))),f},S.prototype.diff=function(H,f){if(this.ops===H.ops)return new S;var s=[this,H].map(function(m){return m.map(function(b){if(b.insert!=null)return typeof b.insert=="string"?b.insert:Ni;var d=m===H?"on":"with";throw new Error("diff() called "+d+" non-document")}).join("")}),a=new S,p=yn.default(s[0],s[1],f),_=Ze.default.iterator(this.ops),g=Ze.default.iterator(H.ops);return p.forEach(function(m){for(var b=m[1].length;b>0;){var d=0;switch(m[0]){case yn.default.INSERT:d=Math.min(g.peekLength(),b),a.push(g.next(d));break;case yn.default.DELETE:d=Math.min(b,_.peekLength()),_.next(d),a.delete(d);break;case yn.default.EQUAL:d=Math.min(_.peekLength(),g.peekLength(),b);var i=_.next(d),n=g.next(d);ar.default(i.insert,n.insert)?a.retain(d,Wt.default.diff(i.attributes,n.attributes)):a.push(n).delete(d);break}b-=d}}),a.chop()},S.prototype.eachLine=function(H,f){f===void 0&&(f=`
`);for(var s=Ze.default.iterator(this.ops),a=new S,p=0;s.hasNext();){if(s.peekType()!=="insert")return;var _=s.peek(),g=Ze.default.length(_)-s.peekLength(),m=typeof _.insert=="string"?_.insert.indexOf(f,g)-g:-1;if(m<0)a.push(s.next());else if(m>0)a.push(s.next(m));else{if(H(a,s.next(1).attributes||{},p)===!1)return;p+=1,a=new S}}a.length()>0&&H(a,{},p)},S.prototype.invert=function(H){var f=new S;return this.reduce(function(s,a){if(a.insert)f.delete(Ze.default.length(a));else{if(a.retain&&a.attributes==null)return f.retain(a.retain),s+a.retain;if(a.delete||a.retain&&a.attributes){var p=a.delete||a.retain,_=H.slice(s,s+p);return _.forEach(function(g){a.delete?f.push(g):a.retain&&a.attributes&&f.retain(Ze.default.length(g),Wt.default.invert(a.attributes,g.attributes))}),s+p}}return s},0),f.chop()},S.prototype.transform=function(H,f){if(f===void 0&&(f=!1),f=!!f,typeof H=="number")return this.transformPosition(H,f);for(var s=H,a=Ze.default.iterator(this.ops),p=Ze.default.iterator(s.ops),_=new S;a.hasNext()||p.hasNext();)if(a.peekType()==="insert"&&(f||p.peekType()!=="insert"))_.retain(Ze.default.length(a.next()));else if(p.peekType()==="insert")_.push(p.next());else{var g=Math.min(a.peekLength(),p.peekLength()),m=a.next(g),b=p.next(g);if(m.delete)continue;b.delete?_.push(b):_.retain(g,Wt.default.transform(m.attributes,b.attributes,f))}return _.chop()},S.prototype.transformPosition=function(H,f){f===void 0&&(f=!1),f=!!f;for(var s=Ze.default.iterator(this.ops),a=0;s.hasNext()&&a<=H;){var p=s.peekLength(),_=s.peekType();if(s.next(),_==="delete"){H-=Math.min(p,H-a);continue}else _==="insert"&&(a<H||!f)&&(H+=p);a+=p}return H},S.Op=Ze.default,S.AttributeMap=Wt.default,S})();const Pi=["avg_response_time","total_hold_time","lead","first_response_time","user_resolution_time","opening_date","opening_time","resolution_time","agreement_status","service_level_agreement","response_by","resolution_by","response_by_variance","resolution_by_variance","on_hold_since","total_hold_time","user","naming_series","customer_name","service_level_section","issue_split_from","contact","section_break_19","resolution_details","response","first_responded_on","additional_info","email_account","via_customer_portal","subject_section","custom_qc_count","custom_qc_rework_count","custom_client_rework_count","custom_client_change_count_","sla_resolution_by","customer"],ji=["opening_date"],Li=()=>[...Pi,...ji],$i={class:"mb-6"},Ci={class:"block text-sm font-medium text-gray-700 mb-1"},Di={key:0,class:"text-red-500"},Ri={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},Mi={class:"hidden group-hover:block absolute bg-black text-white text-xs rounded p-2 z-50 w-48"},Ii={key:0,class:"bg-gray-100 p-2 mb-2 text-xs rounded"},Fi={key:0,class:"text-red-500"},qi={key:1,class:"mt-2"},Bi={class:"text-xs overflow-auto max-h-40"},Ui={key:1,class:"flex justify-center items-center py-4"},Hi={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4"},zi={key:3,class:"border rounded-lg overflow-hidden mb-2"},Vi={class:"overflow-x-auto"},Ki={class:"min-w-full divide-y divide-gray-200"},Gi={class:"bg-gray-50"},Ji={key:0,class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},Zi={class:"bg-white divide-y divide-gray-200"},Wi={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Yi={key:1,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Xi={key:3,class:"whitespace-pre-line max-h-20 overflow-y-auto"},Qi={key:4,class:"flex items-center"},el={key:0,class:"px-3 py-2 text-sm text-right whitespace-nowrap"},tl=["onClick"],nl=["onClick"],rl={key:0},ol=["colspan"],il={key:4,class:"text-center py-4 text-gray-500"},ll={key:6,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},al={class:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden"},sl={class:"px-4 py-3 border-b border-gray-200 flex justify-between items-center"},ul={class:"text-lg font-medium text-gray-900"},cl={class:"p-4 overflow-y-auto max-h-[calc(90vh-8rem)]"},fl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},dl={key:0,class:"col-span-1 md:col-span-2 border-t border-gray-200 pt-4 mt-2"},hl={key:0,class:"text-base font-medium text-gray-900 mb-2"},pl={key:1,class:"hidden md:block"},vl={class:"block text-sm font-medium text-gray-700 mb-1"},ml={key:0,class:"text-red-500"},yl={key:0,class:"relative"},gl=["onUpdate:modelValue","placeholder","onFocus","onBlur"],bl={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm"},_l=["onMousedown"],wl={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-4 text-blue-600"},xl={key:0,class:"py-2 px-3 text-gray-500 italic"},kl=["onUpdate:modelValue"],Ol={value:""},El=["value"],Al=["onUpdate:modelValue"],Tl=["onUpdate:modelValue"],Sl={key:4,class:"flex items-center"},Nl=["onUpdate:modelValue"],Pl={class:"ml-2 text-sm text-gray-700"},jl={key:5,class:"flex items-center"},Ll=["onUpdate:modelValue"],$l=["onUpdate:modelValue"],Cl=["onUpdate:modelValue","rows"],Dl=["onUpdate:modelValue","type","step"],Rl=["onUpdate:modelValue"],Ml={class:"px-4 py-3 bg-gray-50 text-right"},Er=3,Il={__name:"TableFieldComponent",props:{modelValue:{type:Array,default:()=>[]},fieldname:{type:String,required:!0},label:{type:String,required:!0},description:{type:String,default:""},required:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!1},childDoctype:{type:String,required:!0},parentDoctype:{type:String,required:!0},debug:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(S,{emit:H}){const f=S,s=H,a=he([]),p=he(!0),_=he(!1),g=he({}),m=he(-1),b=Fe(()=>m.value!==-1),d=he({}),i=he({}),n=he(null),t=he(null),l=he(null),u=he(0),c=Fe(()=>a.value.filter(M=>!M.hidden&&!["name","owner","creation","modified","modified_by","docstatus","idx","parent","parentfield","parenttype"].includes(M.fieldname)));Lt(()=>ge(this,null,function*(){try{p.value=!0,t.value=null,yield r(),a.value.length>0&&(yield o()),p.value=!1}catch(M){console.error("Error initializing table field component:",M),t.value=M.message||"Failed to load child table fields",p.value=!1}}));const r=()=>ge(this,null,function*(){try{console.log(`Fetching fields for child doctype: ${f.childDoctype}`),u.value++;let M=!1;try{const A=yield(yield fetch("/api/method/frappe.desk.form.meta.get_meta",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({doctype:f.childDoctype}),credentials:"include"})).json();l.value=A,A.message&&A.message.fields&&(a.value=A.message.fields,console.log(`Successfully fetched ${a.value.length} fields for ${f.childDoctype} using method 1`),a.value.sort((E,C)=>(E.idx||0)-(C.idx||0)),M=!0)}catch(T){console.error("Method 1 failed:",T)}if(!M)try{const A=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({doctype:f.childDoctype,with_parent:1}),credentials:"include"})).json();if(l.value=A,A.message&&A.message.docs&&A.message.docs[0]){const E=A.message.docs[0];a.value=E.fields||[],console.log(`Successfully fetched ${a.value.length} fields for ${f.childDoctype} using method 2`),a.value.sort((C,z)=>(C.idx||0)-(z.idx||0)),M=!0}}catch(T){console.error("Method 2 failed:",T)}if(!M)try{const A=yield(yield fetch("/api/method/frappe.desk.form.form_dict.get_doctype_meta",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({doctype:f.childDoctype}),credentials:"include"})).json();l.value=A,A.message&&A.message.fields&&(a.value=A.message.fields,console.log(`Successfully fetched ${a.value.length} fields for ${f.childDoctype} using method 3`),a.value.sort((E,C)=>(E.idx||0)-(C.idx||0)),M=!0)}catch(T){console.error("Method 3 failed:",T)}if(!M)try{const A=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({doctype:"DocField",filters:{parent:f.childDoctype},fields:["*"],limit_page_length:500,order_by:"idx asc"}),credentials:"include"})).json();l.value=A,A.message&&A.message.length>0&&(a.value=A.message,console.log(`Successfully fetched ${a.value.length} fields for ${f.childDoctype} using method 4`),M=!0)}catch(T){console.error("Method 4 failed:",T)}if(!M)try{const A=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({doctype:"DocType",name:f.childDoctype}),credentials:"include"})).json();l.value=A,A.message&&A.message.fields&&(a.value=A.message.fields,console.log(`Successfully fetched ${a.value.length} fields for ${f.childDoctype} using method 5`),a.value.sort((E,C)=>(E.idx||0)-(C.idx||0)),M=!0)}catch(T){console.error("Method 5 failed:",T)}if(!M&&u.value<Er)return console.log(`Retrying fetch attempt ${u.value} of ${Er}`),yield r();if(M||(t.value=`Could not fetch fields for ${f.childDoctype} after multiple attempts`,a.value=[{fieldname:"description",label:"Description",fieldtype:"Small Text"},{fieldname:"qty",label:"Quantity",fieldtype:"Float"},{fieldname:"rate",label:"Rate",fieldtype:"Currency"},{fieldname:"amount",label:"Amount",fieldtype:"Currency"}],console.warn("Using fallback fields:",a.value)),a.value.length===0)throw new Error(`Could not fetch fields for ${f.childDoctype}`)}catch(M){throw console.error(`Error fetching fields for ${f.childDoctype}:`,M),M}}),o=()=>ge(this,null,function*(){const M=a.value.filter(T=>T.fieldtype==="Link");for(const T of M)try{if(!T.options)continue;console.log(`Fetching options for ${T.fieldname} (${T.options})`);const A=yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:T.options,fields:["name","title"],limit_page_length:500}),credentials:"include"});if(!A.ok)throw new Error(`Failed to fetch options for ${T.fieldname}`);const E=yield A.json();E.message&&(d.value[T.fieldname]=E.message.map(C=>({value:C.name,label:C.title||C.name})),console.log(`Fetched ${d.value[T.fieldname].length} options for ${T.fieldname}`))}catch(A){console.error(`Error fetching options for ${T.fieldname}:`,A),d.value[T.fieldname]=[]}}),v=()=>ge(this,null,function*(){p.value=!0,t.value=null,u.value=0,l.value=null;try{yield r(),a.value.length>0&&(yield o())}catch(M){console.error("Error retrying fetch:",M),t.value=M.message||"Failed to load child table fields"}finally{p.value=!1}}),e=M=>{const T={};return M.fieldtype==="Check"?T.width="80px":M.fieldtype==="Int"||M.fieldtype==="Float"?T.width="100px":M.fieldtype==="Date"||M.fieldtype==="Color"?T.width="120px":M.fieldtype==="Small Text"&&(T.minWidth="200px"),T},y=M=>{if(n.value=M,g.value[M]){const T=a.value.find(A=>A.fieldname===M);if(T&&T.fieldtype==="Link"){const E=(d.value[M]||[]).find(C=>C.value===g.value[M]);E&&(i.value[M]=E.label)}}},j=M=>{setTimeout(()=>{n.value===M&&(n.value=null)},200)},N=M=>{const T=d.value[M.fieldname]||[],A=i.value[M.fieldname]||"";return A?T.filter(E=>E.label.toLowerCase().includes(A.toLowerCase())):T},P=(M,T,A)=>{g.value[M]=T,i.value[M]=A,n.value=null},I=(M,T)=>{if(!T)return"";const E=(d.value[M.fieldname]||[]).find(C=>C.value===T);return E?E.label:T},x=M=>M.options?M.options.split(`
`):[],w=M=>{if(!M)return"";try{return new Date(M).toLocaleDateString()}catch(T){return M}},O=M=>{if(M==null||M==="")return"";try{return parseFloat(M).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}catch(T){return M}},$=()=>{g.value={},i.value={},a.value.forEach(M=>{M.fieldtype==="Check"?g.value[M.fieldname]=!1:M.default?g.value[M.fieldname]=M.default:g.value[M.fieldname]=""}),g.value.parent="",g.value.parentfield=f.fieldname,g.value.parenttype=f.parentDoctype,m.value=-1,_.value=!0},F=M=>{g.value=JSON.parse(JSON.stringify(f.modelValue[M])),i.value={},a.value.filter(T=>T.fieldtype==="Link").forEach(T=>{const A=g.value[T.fieldname];if(A){const C=(d.value[T.fieldname]||[]).find(z=>z.value===A);C?i.value[T.fieldname]=C.label:i.value[T.fieldname]=A}}),m.value=M,_.value=!0},K=()=>{const T=c.value.filter(E=>E.reqd).filter(E=>!g.value[E.fieldname]);if(T.length>0){alert(`Please fill in all required fields: ${T.map(E=>E.label).join(", ")}`);return}const A=[...f.modelValue||[]];b.value?A[m.value]=lt({},g.value):A.push(lt({},g.value)),s("update:modelValue",A),s("change",A),Z()},ee=M=>{if(confirm("Are you sure you want to delete this entry?")){const T=[...f.modelValue];T.splice(M,1),s("update:modelValue",T),s("change",T)}},Z=()=>{_.value=!1,g.value={},m.value=-1,i.value={},n.value=null};return tt(()=>f.modelValue,M=>{M||s("update:modelValue",[])},{immediate:!0}),tt(()=>f.childDoctype,M=>ge(this,null,function*(){if(M){p.value=!0,a.value=[],d.value={},u.value=0,l.value=null,t.value=null;try{yield r(),a.value.length>0&&(yield o())}catch(T){console.error("Error when childDoctype changed:",T)}finally{p.value=!1}}})),(M,T)=>(q(),B("div",$i,[k("label",Ci,[Ae(ae(S.label)+" ",1),S.required?(q(),B("span",Di,"*")):ye("",!0),S.description?(q(),B("span",Ri,[T[0]||(T[0]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("span",Mi,ae(S.description),1)])):ye("",!0)]),S.debug?(q(),B("div",Ii,[k("div",null,"Child Doctype: "+ae(S.childDoctype),1),k("div",null,"Fields loaded: "+ae(a.value.length),1),k("div",null,"Visible fields: "+ae(c.value.length),1),k("div",null,"Field names: "+ae(c.value.map(A=>A.fieldname).join(", ")),1),t.value?(q(),B("div",Fi,"Error: "+ae(t.value),1)):ye("",!0),l.value?(q(),B("div",qi,[k("details",null,[T[1]||(T[1]=k("summary",null,"API Response",-1)),k("pre",Bi,ae(JSON.stringify(l.value,null,2)),1)])])):ye("",!0)])):ye("",!0),p.value?(q(),B("div",Ui,T[2]||(T[2]=[k("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1)]))):t.value?(q(),B("div",Hi,[k("p",null,ae(t.value),1),k("button",{onClick:v,class:"mt-2 text-sm bg-red-100 hover:bg-red-200 text-red-800 py-1 px-3 rounded"}," Retry ")])):c.value.length>0?(q(),B("div",zi,[k("div",Vi,[k("table",Ki,[k("thead",Gi,[k("tr",null,[(q(!0),B(Oe,null,Le(c.value,A=>(q(),B("th",{key:A.fieldname,class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",style:dt(e(A))},ae(A.label),5))),128)),S.isReadOnly?ye("",!0):(q(),B("th",Ji," Actions "))])]),k("tbody",Zi,[(q(!0),B(Oe,null,Le(S.modelValue||[],(A,E)=>(q(),B("tr",{key:E},[(q(!0),B(Oe,null,Le(c.value,C=>(q(),B("td",{key:C.fieldname,class:"px-3 py-2 text-sm text-blue-800 font-medium",style:dt(e(C))},[C.fieldtype==="Check"?(q(),B(Oe,{key:0},[A[C.fieldname]?(q(),B("span",Wi,T[3]||(T[3]=[k("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" Yes ")]))):(q(),B("span",Yi,T[4]||(T[4]=[k("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" No ")])))],64)):C.fieldtype==="Link"?(q(),B(Oe,{key:1},[Ae(ae(I(C,A[C.fieldname])),1)],64)):C.fieldtype==="Date"||C.fieldtype==="Datetime"?(q(),B(Oe,{key:2},[Ae(ae(w(A[C.fieldname])),1)],64)):C.fieldtype==="Small Text"?(q(),B("div",Xi,ae(A[C.fieldname]),1)):C.fieldtype==="Color"&&A[C.fieldname]?(q(),B("div",Qi,[k("div",{class:"h-4 w-4 rounded mr-1",style:dt({backgroundColor:A[C.fieldname]||"#FFFFFF"})},null,4),k("span",null,ae(A[C.fieldname]),1)])):C.fieldtype==="Currency"||C.fieldtype==="Float"?(q(),B(Oe,{key:5},[Ae(ae(O(A[C.fieldname])),1)],64)):(q(),B(Oe,{key:6},[Ae(ae(A[C.fieldname]),1)],64))],4))),128)),S.isReadOnly?ye("",!0):(q(),B("td",el,[k("button",{onClick:C=>F(E),class:"text-blue-600 hover:text-blue-800 mr-2"},T[5]||(T[5]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,tl),k("button",{onClick:C=>ee(E),class:"text-red-600 hover:text-red-800"},T[6]||(T[6]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v10M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m-5 0h10"})],-1)]),8,nl)]))]))),128)),(S.modelValue||[]).length?ye("",!0):(q(),B("tr",rl,[k("td",{colspan:c.value.length+(S.isReadOnly?0:1),class:"px-3 py-4 text-center text-gray-500"}," No items added ",8,ol)]))])])])])):!p.value&&!t.value?(q(),B("div",il," No fields found for "+ae(S.childDoctype),1)):ye("",!0),!S.isReadOnly&&!p.value?(q(),B("button",{key:5,onClick:$,class:"mt-2 inline-flex items-center px-3 py-2 border border-blue-600 text-sm leading-4 font-medium rounded-md text-blue-600 bg-white hover:bg-blue-50"},T[7]||(T[7]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Ae(" Add Row ")]))):ye("",!0),_.value?(q(),B("div",ll,[k("div",al,[k("div",sl,[k("h3",ul,ae(b.value?"Edit Row":"Add New Row"),1),k("button",{onClick:Z,class:"text-gray-400 hover:text-gray-500"},T[8]||(T[8]=[k("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),k("div",cl,[k("div",fl,[(q(!0),B(Oe,null,Le(c.value,A=>(q(),B(Oe,{key:A.fieldname},[A.fieldtype==="Section Break"?(q(),B("div",dl,[A.label?(q(),B("h4",hl,ae(A.label),1)):ye("",!0)])):A.fieldtype==="Column Break"?(q(),B("div",pl)):(q(),B("div",{key:2,class:De(["col-span-1",{"md:col-span-2":A.fieldtype==="Text Editor"||A.fieldtype==="Long Text"||A.fieldtype==="Small Text"}])},[k("label",vl,[Ae(ae(A.label)+" ",1),A.reqd?(q(),B("span",ml,"*")):ye("",!0)]),A.fieldtype==="Link"?(q(),B("div",yl,[Re(k("input",{"onUpdate:modelValue":E=>i.value[A.fieldname]=E,type:"text",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:`Search ${A.label}...`,onFocus:E=>y(A.fieldname),onBlur:E=>j(A.fieldname)},null,40,gl),[[et,i.value[A.fieldname]]]),n.value===A.fieldname?(q(),B("div",bl,[(q(!0),B(Oe,null,Le(N(A),E=>(q(),B("div",{key:E.value,class:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100",onMousedown:C=>P(A.fieldname,E.value,E.label)},[k("span",{class:De(["block truncate",{"font-semibold":g.value[A.fieldname]===E.value}])},ae(E.label),3),g.value[A.fieldname]===E.value?(q(),B("span",wl,T[9]||(T[9]=[k("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[k("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))):ye("",!0)],40,_l))),128)),N(A).length===0?(q(),B("div",xl," No results found ")):ye("",!0)])):ye("",!0)])):A.fieldtype==="Select"?Re((q(),B("select",{key:1,"onUpdate:modelValue":E=>g.value[A.fieldname]=E,class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[k("option",Ol,"Select "+ae(A.label),1),(q(!0),B(Oe,null,Le(x(A),E=>(q(),B("option",{key:E,value:E},ae(E),9,El))),128))],8,kl)),[[Tt,g.value[A.fieldname]]]):A.fieldtype==="Date"?Re((q(),B("input",{key:2,"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:"date",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,Al)),[[et,g.value[A.fieldname]]]):A.fieldtype==="Datetime"?Re((q(),B("input",{key:3,"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:"datetime-local",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,Tl)),[[et,g.value[A.fieldname]]]):A.fieldtype==="Check"?(q(),B("div",Sl,[Re(k("input",{"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,Nl),[[fr,g.value[A.fieldname]]]),k("span",Pl,ae(A.label),1)])):A.fieldtype==="Color"?(q(),B("div",jl,[Re(k("input",{"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:"color",class:"h-8 w-8 rounded border-gray-300 mr-2"},null,8,Ll),[[et,g.value[A.fieldname]]]),Re(k("input",{"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:"text",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"#RRGGBB"},null,8,$l),[[et,g.value[A.fieldname]]])])):A.fieldtype==="Small Text"||A.fieldtype==="Long Text"?Re((q(),B("textarea",{key:6,"onUpdate:modelValue":E=>g.value[A.fieldname]=E,rows:A.fieldtype==="Long Text"?4:2,class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,Cl)),[[et,g.value[A.fieldname]]]):A.fieldtype==="Int"||A.fieldtype==="Float"||A.fieldtype==="Currency"||A.fieldtype==="Percent"?Re((q(),B("input",{key:7,"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:A.fieldtype==="Int"?"number":"text",step:A.fieldtype==="Int"?"1":"0.01",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,Dl)),[[bn,g.value[A.fieldname]]]):Re((q(),B("input",{key:8,"onUpdate:modelValue":E=>g.value[A.fieldname]=E,type:"text",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,8,Rl)),[[et,g.value[A.fieldname]]])],2))],64))),128))])]),k("div",Ml,[k("button",{onClick:Z,class:"inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 mr-2"}," Cancel "),k("button",{onClick:K,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"},ae(b.value?"Update":"Add"),1)])])])):ye("",!0)]))}},Fl=cr(Il,[["__scopeId","data-v-fdbcd005"]]),ql={class:"bg-white rounded-lg shadow-sm form-view"},Bl={class:"p-4 md:p-6 overflow-y-auto form-content"},Ul={key:0,class:"flex justify-center items-center py-8"},Hl={key:1,class:"space-y-6"},zl={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6"},Vl={key:0,class:"col-span-1 md:col-span-2 border-t border-gray-200 pt-6 mt-6"},Kl={key:0,class:"text-lg font-medium text-gray-900 mb-4"},Gl={key:1,class:"hidden md:block"},Jl={class:"mb-4"},Zl={class:"text-sm font-medium text-gray-500 mb-1"},Wl={key:0,class:"text-gray-900"},Yl={key:1,class:"text-gray-900"},Xl={key:2,class:"prose max-w-none"},Ql=["innerHTML"],ea={key:3,class:"text-gray-900 whitespace-pre-line"},ta={key:4,class:"text-gray-900 whitespace-pre-line"},na={key:5,class:"text-gray-900"},ra={key:0,class:"text-green-600"},oa={key:1,class:"text-red-600"},ia={key:6,class:"mt-1"},la=["src"],aa={key:7,class:"mt-1 flex items-center"},sa=["href"],ua={key:8,class:"text-gray-900"},ca={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 relative"},fa={class:"flex items-center"},da={class:"block sm:inline"},ha={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6"},pa={key:0,class:"col-span-1 md:col-span-2 border-t border-gray-200 pt-6 mt-6"},va=["onClick"],ma={class:"text-lg font-medium text-gray-900"},ya={key:1,class:"hidden md:block"},ga={key:0,class:"relative"},ba={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},_a={key:0,class:"text-red-500"},wa={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},xa={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},ka=["innerHTML"],Oa={class:"relative"},Ea=["onUpdate:modelValue","disabled","onFocus","onInput","onBlur"],Aa={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm"},Ta=["onMousedown"],Sa={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-4 text-blue-600"},Na={key:0,class:"py-2 px-3 text-gray-500 italic"},Pa={key:1},ja={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},La={key:0,class:"text-red-500"},$a={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},Ca={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},Da=["innerHTML"],Ra=["onUpdate:modelValue","required","disabled","onChange"],Ma=["value"],Ia={key:2},Fa={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},qa={key:0,class:"text-red-500"},Ba={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},Ua={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},Ha=["innerHTML"],za=["onUpdate:modelValue","type","required","disabled","maxlength","onInput"],Va={key:3},Ka={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},Ga={key:0,class:"text-red-500"},Ja={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},Za={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},Wa=["innerHTML"],Ya=["onUpdate:modelValue","required","disabled","rows","onInput"],Xa={key:4},Qa={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},es={key:0,class:"text-red-500"},ts={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},ns={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},rs=["innerHTML"],os={key:5},is={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},ls={key:0,class:"text-red-500"},as={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},ss={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},us=["innerHTML"],cs=["onUpdate:modelValue","type","required","disabled","onInput"],fs={key:6},ds={class:"flex items-center"},hs=["onUpdate:modelValue","disabled","onChange"],ps={class:"ml-2 block text-sm text-gray-700 group relative"},vs={key:0,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},ms={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},ys=["innerHTML"],gs={key:7},bs={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},_s={key:0,class:"text-red-500"},ws={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},xs={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},ks=["innerHTML"],Os=["onUpdate:modelValue","type","step","required","disabled","min","max","onInput"],Es={key:8},As={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},Ts={key:0,class:"text-red-500"},Ss={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},Ns={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},Ps=["innerHTML"],js=["onDrop"],Ls={class:"space-y-1 text-center"},$s={class:"flex text-sm text-gray-600"},Cs={class:"relative cursor-pointer rounded-md font-medium text-blue-600 hover:text-blue-500"},Ds=["onChange"],Rs={key:1,class:"mt-1 relative"},Ms=["src"],Is=["onClick"],Fs={key:9},qs={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},Bs={key:0,class:"text-red-500"},Us={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},Hs={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},zs=["innerHTML"],Vs=["onDrop"],Ks={class:"space-y-1 text-center"},Gs={class:"flex text-sm text-gray-600"},Js={class:"relative cursor-pointer rounded-md font-medium text-blue-600 hover:text-blue-500"},Zs=["onChange"],Ws={key:1,class:"mt-1 flex items-center justify-between bg-gray-50 p-3 rounded-lg"},Ys={class:"flex items-center"},Xs={class:"text-sm text-gray-700"},Qs=["onClick"],eu={key:10},tu={class:"sticky bottom-0 z-10 bg-white p-4 md:p-6 border-t"},nu={class:"flex flex-wrap gap-3"},ru=["disabled"],ou={key:0,class:"flex items-center justify-center"},iu={key:1},lu={__name:"FetchFieldProp",props:{modelValue:{type:Object,required:!0},fields:{type:Array,required:!0},fieldOptions:{type:Object,default:()=>({})},isReadOnly:{type:Boolean,default:!1},submitText:{type:String,default:"Save"},submittingText:{type:String,default:"Saving..."},doctype:{type:String,required:!0},docname:{type:String,default:null},mode:{type:String,default:"add",validator:S=>["add","edit","view"].includes(S)},titleField:{type:String,default:"name"},debug:{type:Boolean,default:!1}},emits:["update:modelValue","submit","validate","field-change","delete","cancel","load"],setup(S,{expose:H,emit:f}){const s=S,a=f,p=he(!1),_=he(!1),g=he(""),m=he({}),b=he({}),d=he(!1),i=he({}),n=he({}),t=he([]),l=he({}),u=he(null),c=he([]),r=he({}),o=Qt(),v=he({}),e=Fe({get:()=>s.modelValue,set:R=>a("update:modelValue",R)});Fe(()=>e.value[s.titleField]?e.value[s.titleField]:`${s.doctype} ${s.docname||""}`);const y=Fe(()=>{const R=Li();return s.fields.filter(V=>V&&V.fieldname&&!V.hidden&&!R.includes(V.fieldname)).sort((V,L)=>(V.idx||0)-(L.idx||0))}),j=R=>["Data","Small Text","Phone","Email","Password"].includes(R.fieldtype),N=R=>["Int","Float","Currency","Percent"].includes(R.fieldtype),P=R=>{switch(R.fieldtype){case"Email":return"email";case"Password":return"password";case"Phone":return"tel";case"Int":case"Float":case"Currency":case"Percent":return"number";default:return"text"}},I=R=>{const V=y.value[R],L=R>0?y.value[R-1]:null,pe=R<y.value.length-1?y.value[R+1]:null;return V.fieldtype==="Section Break"?"col-span-1 md:col-span-2":L&&L.fieldtype==="Section Break"||L&&L.fieldtype==="Column Break"||pe&&pe.fieldtype==="Column Break"?"col-span-1":V.fieldtype==="Long Text"||V.fieldtype==="Text Editor"?"col-span-1 md:col-span-2":"col-span-1"},x=R=>s.fieldOptions[R.fieldname]?s.fieldOptions[R.fieldname]:R.fieldtype==="Link"&&n.value[R.fieldname]?n.value[R.fieldname]:R.fieldtype==="Select"&&R.options?R.options.split(`
`).map(V=>({value:V,label:V})):[],w=R=>{const V=x(R),L=l.value[R.fieldname]||"";return L?V.filter(pe=>pe.label.toLowerCase().includes(L.toLowerCase())):V},O=R=>{const V=s.fields.find(L=>L.fieldname===R);if(!V)return e.value[R]||"";if(V.fieldtype==="Link"){const pe=(s.fieldOptions[R]||n.value[R]||[]).find(ce=>ce.value===e.value[R]);return pe?pe.label:e.value[R]||""}return e.value[R]||""},$=R=>{l.value[R]!==O(R)&&(e.value[R]=null),Q({fieldname:R,value:e.value[R],searchQuery:l.value[R]})},F=R=>b.value[R]?b.value[R]:r.value[R]?r.value[R]:e.value[R]?e.value[R]:null,K=R=>{if(m.value[R])return m.value[R].name;if(e.value[R]){const L=e.value[R].split("/");return L[L.length-1]}return null},ee=R=>{if(u.value=R,e.value[R]){const V=s.fields.find(L=>L.fieldname===R);if(V&&V.fieldtype==="Link"){const pe=x(V).find(ce=>ce.value===e.value[R]);pe?l.value[R]=pe.label:e.value[R]&&(l.value[R]=e.value[R])}}},Z=R=>{setTimeout(()=>{u.value===R&&(u.value=null)},200)},M=(R,V)=>{const L=s.fields.find(ce=>ce.fieldname===R);if(!(L&&c.value.some(ce=>ce.allow===L.options))||L.read_only!==1){if(e.value[R]=V,L&&L.fieldtype==="Link"){const Ne=x(L).find(st=>st.value===V);Ne&&(l.value[R]=Ne.label)}Q({fieldname:R,value:V})}u.value=null},T=R=>t.value.includes(R),A=R=>{if(typeof R!="string")return"An error occurred";if(R.includes("Attached To Name must be a string or an integer"))return"Unable to attach file to this document. Please save the document first.";if(R.includes("ValidationError")){const V=R.match(/ValidationError: (.*?)($|\n)/);if(V&&V[1])return V[1]}return R.includes("File size exceeded")?"The file is too large. Please upload a smaller file (maximum 5MB).":R.includes("Failed to upload file")?"Unable to upload the file. Please try again or use a different file.":R},E=R=>{v.value[R]=!v.value[R]},C=R=>!!v.value[R],z=(R,V)=>{if(R.fieldtype==="Section Break"||R.fieldtype==="Column Break")return!1;let L=-1;for(let pe=V-1;pe>=0;pe--)if(y.value[pe].fieldtype==="Section Break"){L=pe;break}if(L>=0){const pe=y.value[L];if(pe.collapsible===1&&C(pe.fieldname))return!0}return!1},te=(R,V)=>{const L=R.target.files[0];U(L,V)},J=(R,V)=>{const L=R.dataTransfer.files[0];U(L,V)},U=(R,V)=>ge(this,null,function*(){if(!R)return;const L=5*1024*1024;if(V.includes("image")||s.fields.find(ce=>ce.fieldname===V&&ce.fieldtype==="Attach Image")){if(!R.type.startsWith("image/")){g.value="Please upload an image file";return}try{if(R.size>L){const ce=yield ne(R,1200);if(ce.size<=L){X(ce,V);return}else{g.value="Image is too large. Please use a smaller image.";return}}X(R,V)}catch(ce){console.error("Error processing image:",ce),g.value="Error processing image: "+ce.message}}else{if(R.size>L){g.value="File size must be less than 5MB";return}m.value[V]=R,e.value[V]=null,a("field-change",{fieldname:V,value:null,file:R})}}),X=(R,V)=>{const L=new FileReader;L.onload=pe=>{b.value[V]=pe.target.result,m.value[V]=R,e.value[V]=null,a("field-change",{fieldname:V,value:null,file:R})},L.readAsDataURL(R)},ne=(R,V)=>new Promise((L,pe)=>{const ce=new Image;ce.src=URL.createObjectURL(R),ce.onload=()=>{if(ce.width<=V){L(R);return}const Ne=document.createElement("canvas"),st=Ne.getContext("2d"),je=V/ce.width,Ve=V,oe=ce.height*je;Ne.width=Ve,Ne.height=oe,st.drawImage(ce,0,0,Ve,oe),Ne.toBlob(Y=>{if(Y){const le=new File([Y],R.name,{type:R.type,lastModified:Date.now()});L(le)}else pe(new Error("Failed to resize image"))},R.type)},ce.onerror=()=>{pe(new Error("Failed to load image"))}}),re=R=>{delete b.value[R],delete m.value[R],delete r.value[R],e.value[R]=null,a("field-change",{fieldname:R,value:null,file:null})},de=()=>{y.value.forEach(R=>{if((R.fieldtype==="Date"||R.fieldtype==="Datetime")&&e.value[R.fieldname]==="Today"){const V=new Date;R.fieldtype==="Date"?e.value[R.fieldname]=V.toISOString().split("T")[0]:e.value[R.fieldname]=V.toISOString().slice(0,16)}}),e.value.opening_date==="Today"&&(e.value.opening_date=new Date().toISOString().split("T")[0])},be=()=>ge(this,null,function*(){try{const V=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield Ue.getCurrentUser()]}})})).json();V.message&&(c.value=V.message,console.log("User permissions loaded:",c.value),s.mode!=="edit"&&we())}catch(R){console.error("Error fetching user permissions:",R)}}),we=()=>{s.mode!=="edit"&&c.value.forEach(R=>{s.fields.filter(L=>L.fieldtype==="Link"&&L.options===R.allow).forEach(L=>{e.value[L.fieldname]=R.for_value,l.value[L.fieldname]=R.for_value;const pe=s.fields.findIndex(ce=>ce.fieldname===L.fieldname);pe!==-1&&(s.fields[pe].read_only=1,s.fields[pe].read_only_depends_on=`User Permission for ${R.allow}`)})})},xe=()=>ge(this,null,function*(){const R={};for(const[V,L]of Object.entries(m.value))try{const pe=yield Ue.uploadFileToTemp(L);r.value[V]=pe,R[V]=pe}catch(pe){throw console.error(`Error uploading file for ${V}:`,pe),g.value=A(pe.message)||`Error uploading file: ${L.name}`,pe}return R}),Ee=R=>ge(this,null,function*(){if(!R)return{};const V={};for(const[L,pe]of Object.entries(r.value))try{const ce=yield Ue.attachFileToDoc(pe,s.doctype,R,L);V[L]=ce,e.value[L]=ce}catch(ce){console.error(`Error attaching file for ${L}:`,ce),g.value=A(ce.message)||"Error attaching file to document"}return V}),Se=()=>ge(this,null,function*(){g.value="",t.value=[],de();const R=y.value.filter(V=>V.reqd&&!e.value[V.fieldname]&&!m.value[V.fieldname]).map(V=>V.fieldname);if(R.length>0){g.value="Please fill in all required fields",t.value=R;return}if(a("validate"),!g.value){_.value=!0;try{const V=s.mode==="add",L=Object.keys(m.value).length>0;L&&(yield xe()),a("submit",{formData:e.value,files:{},isNew:V,doctype:s.doctype,docname:s.docname,tempFileUrls:r.value,attachFilesToDoc:L?Ee:null})}catch(V){_.value=!1,g.value=A(V.message)||"An error occurred while saving"}}}),qe=()=>{s.mode==="edit"||d.value?(Object.assign(e.value,JSON.parse(JSON.stringify(i.value))),d.value=!1,s.docname?o.push(`/${s.doctype.toLowerCase().replace(/\s+/g,"-")}/${s.docname}`):o.push(`/${s.doctype.toLowerCase().replace(/\s+/g,"-")}`)):o.push(`/${s.doctype.toLowerCase().replace(/\s+/g,"-")}`),a("cancel",{mode:s.mode,doctype:s.doctype,docname:s.docname})},Me=()=>ge(this,null,function*(){if(s.docname)try{_.value=!0,yield Ue.deleteDocument(s.doctype,s.docname),a("delete",s.docname)}catch(R){console.error(`Error deleting ${s.doctype}:`,R),g.value=A(R.message)||`Error deleting ${s.doctype}`}finally{_.value=!1}}),ie=()=>ge(this,null,function*(){if(!(s.mode!=="edit"&&s.mode!=="view")&&s.docname)try{p.value=!0;const R=yield Ue.fetchDocument(s.doctype,s.docname);Object.assign(e.value,R),i.value=JSON.parse(JSON.stringify(R)),ue(),a("load",R)}catch(R){console.error(`Error loading ${s.doctype}:`,R),g.value=A(R.message)||`Error loading ${s.doctype}`}finally{p.value=!1}}),ue=()=>{const R=y.value.filter(V=>V.fieldtype==="Link");for(const V of R)if(e.value[V.fieldname]){const pe=x(V).find(ce=>ce.value===e.value[V.fieldname]);pe?l.value[V.fieldname]=pe.label:l.value[V.fieldname]=e.value[V.fieldname]}},ve=()=>ge(this,null,function*(){const R=y.value.filter(V=>V.fieldtype==="Link");for(const V of R)try{console.log(`Auto-fetching options for ${V.fieldname} (${V.options})`);let L=[];V.options==="Project"?L=(yield Ue.fetchLinkOptions("Project",["name","project_name","creation"])).map(ce=>({value:ce.name,label:ce.project_name||ce.name,creation:ce.creation})):V.options==="Contact"?L=(yield Ue.fetchLinkOptions("Contact",["name","first_name","last_name","creation"])).map(ce=>({value:ce.name,label:`${ce.first_name||""} ${ce.last_name||""} (${ce.name})`,creation:ce.creation})):L=(yield Ue.fetchLinkOptions(V.options,["name","creation"])).map(ce=>({value:ce.name,label:ce.name,creation:ce.creation})),L.length>0&&L[0].creation&&L.sort((pe,ce)=>pe.creation?ce.creation?new Date(ce.creation)-new Date(pe.creation):-1:1),n.value[V.fieldname]=L}catch(L){console.error(`Error fetching options for ${V.fieldname}:`,L)}}),Q=R=>{t.value.includes(R.fieldname)&&(t.value=t.value.filter(V=>V!==R.fieldname)),a("field-change",R)};tt(()=>s.modelValue,(R,V)=>{if(V)for(const L in R)R[L]!==V[L]&&a("field-change",{fieldname:L,value:R[L],file:m.value[L]||null})},{deep:!0}),tt(()=>s.mode,R=>{(R==="edit"||R==="view")&&ie()}),tt(()=>s.docname,R=>{R&&(s.mode==="edit"||s.mode==="view")&&ie()}),tt(c,()=>{s.mode!=="edit"&&we()},{deep:!0});const G=()=>{y.value.forEach(R=>{R.fieldtype==="Section Break"&&R.collapsible===1&&v.value[R.fieldname]===void 0&&(v.value[R.fieldname]=!1)})};return H({setSubmitting(R){_.value=R},setErrorMessage(R){g.value=R},getFiles(){return m.value},uploadFilesToTemp:xe,attachFilesToDoc:Ee,loadDocument:ie,deleteDocument:Me}),Lt(()=>ge(this,null,function*(){console.log(`FormView mounted for ${s.doctype} in ${s.mode} mode`),yield be(),yield ve(),G(),(s.mode==="edit"||s.mode==="view")&&s.docname?yield ie():sr(()=>{de(),we()})})),(R,V)=>(q(),B("div",ql,[k("div",Bl,[p.value?(q(),B("div",Ul,V[3]||(V[3]=[k("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):S.mode==="view"&&!d.value?(q(),B("div",Hl,[k("div",zl,[(q(!0),B(Oe,null,Le(y.value,(L,pe)=>(q(),B(Oe,{key:L.fieldname},[L.fieldtype==="Section Break"?(q(),B("div",Vl,[L.label?(q(),B("h3",Kl,ae(L.label),1)):ye("",!0)])):L.fieldtype==="Column Break"?(q(),B("div",Gl)):(q(),B("div",{key:2,class:De(["field-container",I(pe)])},[k("div",Jl,[k("div",Zl,ae(L.label),1),L.fieldtype==="Link"?(q(),B("div",Wl,ae(O(L.fieldname)),1)):L.fieldtype==="Select"?(q(),B("div",Yl,ae(e.value[L.fieldname]),1)):L.fieldtype==="Text Editor"?(q(),B("div",Xl,[k("div",{innerHTML:e.value[L.fieldname]},null,8,Ql)])):L.fieldtype==="Long Text"?(q(),B("div",ea,ae(e.value[L.fieldname]),1)):L.fieldtype==="Small Text"?(q(),B("div",ta,ae(e.value[L.fieldname]),1)):L.fieldtype==="Check"?(q(),B("div",na,[e.value[L.fieldname]?(q(),B("span",ra,"Yes")):(q(),B("span",oa,"No"))])):L.fieldtype==="Attach Image"&&e.value[L.fieldname]?(q(),B("div",ia,[k("img",{src:e.value[L.fieldname],alt:"Attached Image",class:"h-48 w-auto rounded-lg object-cover"},null,8,la)])):L.fieldtype==="Attach"&&e.value[L.fieldname]?(q(),B("div",aa,[k("a",{href:e.value[L.fieldname],target:"_blank",class:"text-blue-600 hover:underline flex items-center"},V[4]||(V[4]=[k("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),Ae(" Download Attachment ")]),8,sa)])):(q(),B("div",ua,ae(e.value[L.fieldname]),1))])],2))],64))),128))])])):(q(),B("form",{key:2,onSubmit:jt(Se,["prevent"]),class:"space-y-6"},[g.value?(q(),B("div",ca,[k("div",fa,[V[5]||(V[5]=k("svg",{class:"h-5 w-5 mr-2 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),k("span",da,ae(A(g.value)),1)]),k("button",{onClick:V[0]||(V[0]=L=>g.value=""),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},V[6]||(V[6]=[k("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[k("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])):ye("",!0),k("div",ha,[(q(!0),B(Oe,null,Le(y.value,(L,pe)=>(q(),B(Oe,{key:L.fieldname},[L.fieldtype==="Section Break"?(q(),B("div",pa,[L.label?(q(),B("div",{key:0,class:De([{"cursor-pointer":L.collapsible===1},"flex items-center justify-between mb-4"]),onClick:ce=>L.collapsible===1?E(L.fieldname):null},[k("h3",ma,ae(L.label),1),L.collapsible===1?(q(),B("svg",{key:0,class:De(["h-5 w-5 text-gray-500 transition-transform duration-200",C(L.fieldname)?"":"transform rotate-180"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},V[7]||(V[7]=[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2)):ye("",!0)],10,va)):ye("",!0)])):L.fieldtype==="Column Break"?(q(),B("div",ya)):z(L,pe)?ye("",!0):(q(),B("div",{key:2,class:De(["field-container",I(pe)])},[L.fieldtype==="Link"?(q(),B("div",ga,[k("label",ba,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",_a,"*")):ye("",!0),L.description?(q(),B("span",wa,[V[8]||(V[8]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",xa,[k("span",{innerHTML:L.description},null,8,ka)])])):ye("",!0)]),k("div",Oa,[Re(k("input",{"onUpdate:modelValue":ce=>l.value[L.fieldname]=ce,type:"text",class:De(["w-full h-10 rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"bg-gray-100":L.read_only||S.isReadOnly,"border-red-500":T(L.fieldname)&&L.reqd}]),disabled:L.read_only||S.isReadOnly,onFocus:ce=>ee(L.fieldname),onInput:()=>$(L.fieldname),onBlur:ce=>Z(L.fieldname)},null,42,Ea),[[et,l.value[L.fieldname]]]),V[9]||(V[9]=k("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"},[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),u.value===L.fieldname?(q(),B("div",Aa,[(q(!0),B(Oe,null,Le(w(L),ce=>(q(),B("div",{key:ce.value,class:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100",onMousedown:Ne=>M(L.fieldname,ce.value)},[k("span",{class:De(["block truncate",{"font-semibold":e.value[L.fieldname]===ce.value}])},ae(ce.label),3),e.value[L.fieldname]===ce.value?(q(),B("span",Sa,V[10]||(V[10]=[k("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[k("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))):ye("",!0)],40,Ta))),128)),w(L).length===0?(q(),B("div",Na," No results found ")):ye("",!0)])):ye("",!0)])):L.fieldtype==="Select"?(q(),B("div",Pa,[k("label",ja,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",La,"*")):ye("",!0),L.description?(q(),B("span",$a,[V[11]||(V[11]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",Ca,[k("span",{innerHTML:L.description},null,8,Da)])])):ye("",!0)]),Re(k("select",{"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,required:L.reqd,disabled:L.read_only||S.isReadOnly,class:De(["w-full h-10 rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"bg-gray-100":L.read_only||S.isReadOnly,"border-red-500":T(L.fieldname)&&L.reqd}]),onChange:()=>Q({fieldname:L.fieldname,value:e.value[L.fieldname]})},[(q(!0),B(Oe,null,Le(x(L),ce=>(q(),B("option",{key:ce.value,value:ce.value},ae(ce.label),9,Ma))),128))],42,Ra),[[Tt,e.value[L.fieldname]]])])):j(L)?(q(),B("div",Ia,[k("label",Fa,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",qa,"*")):ye("",!0),L.description?(q(),B("span",Ba,[V[12]||(V[12]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",Ua,[k("span",{innerHTML:L.description},null,8,Ha)])])):ye("",!0)]),Re(k("input",{"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,type:P(L),required:L.reqd,disabled:L.read_only||S.isReadOnly,maxlength:L.length||140,class:De(["w-full h-10 rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"bg-gray-100":L.read_only||S.isReadOnly,"border-red-500":T(L.fieldname)&&L.reqd}]),onInput:()=>Q({fieldname:L.fieldname,value:e.value[L.fieldname]})},null,42,za),[[bn,e.value[L.fieldname]]])])):L.fieldtype==="Long Text"||L.fieldtype==="Small Text"?(q(),B("div",Va,[k("label",Ka,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",Ga,"*")):ye("",!0),L.description?(q(),B("span",Ja,[V[13]||(V[13]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",Za,[k("span",{innerHTML:L.description},null,8,Wa)])])):ye("",!0)]),Re(k("textarea",{"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,required:L.reqd,disabled:L.read_only||S.isReadOnly,rows:L.fieldtype==="Long Text"?6:3,class:De(["w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"bg-gray-100":L.read_only||S.isReadOnly,"border-red-500":T(L.fieldname)&&L.reqd}]),onInput:()=>Q({fieldname:L.fieldname,value:e.value[L.fieldname]})},null,42,Ya),[[et,e.value[L.fieldname]]])])):L.fieldtype==="Text Editor"?(q(),B("div",Xa,[k("label",Qa,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",es,"*")):ye("",!0),L.description?(q(),B("span",ts,[V[14]||(V[14]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",ns,[k("span",{innerHTML:L.description},null,8,rs)])])):ye("",!0)]),k("div",{class:De(["border rounded-lg overflow-hidden",{"border-red-500":T(L.fieldname)&&L.reqd}])},null,2)])):L.fieldtype==="Date"||L.fieldtype==="Datetime"?(q(),B("div",os,[k("label",is,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",ls,"*")):ye("",!0),L.description?(q(),B("span",as,[V[15]||(V[15]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",ss,[k("span",{innerHTML:L.description},null,8,us)])])):ye("",!0)]),Re(k("input",{"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,type:L.fieldtype==="Date"?"date":"datetime-local",required:L.reqd,disabled:L.read_only||S.isReadOnly,class:De(["w-full h-10 rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"bg-gray-100":L.read_only||S.isReadOnly,"border-red-500":T(L.fieldname)&&L.reqd}]),onInput:()=>Q({fieldname:L.fieldname,value:e.value[L.fieldname]})},null,42,cs),[[bn,e.value[L.fieldname]]])])):L.fieldtype==="Check"?(q(),B("div",fs,[k("div",ds,[Re(k("input",{"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,type:"checkbox",disabled:L.read_only||S.isReadOnly,class:De(["h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",{"bg-gray-100":L.read_only||S.isReadOnly}]),onChange:()=>Q({fieldname:L.fieldname,value:e.value[L.fieldname]})},null,42,hs),[[fr,e.value[L.fieldname]]]),k("label",ps,[Ae(ae(L.label)+" ",1),L.description?(q(),B("span",vs,[V[16]||(V[16]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",ms,[k("span",{innerHTML:L.description},null,8,ys)])])):ye("",!0)])])])):N(L)?(q(),B("div",gs,[k("label",bs,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",_s,"*")):ye("",!0),L.description?(q(),B("span",ws,[V[17]||(V[17]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",xs,[k("span",{innerHTML:L.description},null,8,ks)])])):ye("",!0)]),Re(k("input",{"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,type:L.fieldtype==="Int"?"number":"text",step:L.fieldtype==="Int"?"1":"0.01",required:L.reqd,disabled:L.read_only||S.isReadOnly,min:L.min_value!==void 0?L.min_value:void 0,max:L.max_value!==void 0?L.max_value:void 0,class:De(["w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",{"bg-gray-100":L.read_only||S.isReadOnly,"border-red-500":T(L.fieldname)&&L.reqd}]),onInput:()=>Q({fieldname:L.fieldname,value:e.value[L.fieldname]})},null,42,Os),[[bn,e.value[L.fieldname]]])])):L.fieldtype==="Attach Image"?(q(),B("div",Es,[k("label",As,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",Ts,"*")):ye("",!0),L.description?(q(),B("span",Ss,[V[18]||(V[18]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",Ns,[k("span",{innerHTML:L.description},null,8,Ps)])])):ye("",!0)]),!F(L.fieldname)&&!(L.read_only||S.isReadOnly)?(q(),B("div",{key:0,class:De(["mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed border-gray-300 rounded-lg",{"border-red-500":T(L.fieldname)&&L.reqd}]),onDragover:V[1]||(V[1]=jt(()=>{},["prevent"])),onDrop:jt(ce=>J(ce,L.fieldname),["prevent"])},[k("div",Ls,[V[21]||(V[21]=k("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"},[k("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),k("div",$s,[k("label",Cs,[V[19]||(V[19]=k("span",null,"Upload a file",-1)),k("input",{type:"file",class:"sr-only",accept:"image/*",onChange:ce=>te(ce,L.fieldname)},null,40,Ds)]),V[20]||(V[20]=k("p",{class:"pl-1"},"or drag and drop",-1))]),V[22]||(V[22]=k("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 5MB",-1))])],42,js)):F(L.fieldname)?(q(),B("div",Rs,[k("img",{src:F(L.fieldname),alt:"Preview",class:"h-48 w-auto rounded-lg object-cover"},null,8,Ms),L.read_only||S.isReadOnly?ye("",!0):(q(),B("button",{key:0,type:"button",onClick:ce=>re(L.fieldname),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600"},V[23]||(V[23]=[k("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[k("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Is))])):ye("",!0)])):L.fieldtype==="Attach"?(q(),B("div",Fs,[k("label",qs,[Ae(ae(L.label)+" ",1),L.reqd?(q(),B("span",Bs,"*")):ye("",!0),L.description?(q(),B("span",Us,[V[24]||(V[24]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),k("div",Hs,[k("span",{innerHTML:L.description},null,8,zs)])])):ye("",!0)]),!K(L.fieldname)&&!(L.read_only||S.isReadOnly)?(q(),B("div",{key:0,class:De(["mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed border-gray-300 rounded-lg",{"border-red-500":T(L.fieldname)&&L.reqd}]),onDragover:V[2]||(V[2]=jt(()=>{},["prevent"])),onDrop:jt(ce=>J(ce,L.fieldname),["prevent"])},[k("div",Ks,[V[27]||(V[27]=k("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1)),k("div",Gs,[k("label",Js,[V[25]||(V[25]=k("span",null,"Upload a file",-1)),k("input",{type:"file",class:"sr-only",onChange:ce=>te(ce,L.fieldname)},null,40,Zs)]),V[26]||(V[26]=k("p",{class:"pl-1"},"or drag and drop",-1))]),V[28]||(V[28]=k("p",{class:"text-xs text-gray-500"},"Any file type up to 5MB",-1))])],42,Vs)):K(L.fieldname)?(q(),B("div",Ws,[k("div",Ys,[V[29]||(V[29]=k("svg",{class:"h-6 w-6 text-gray-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1)),k("span",Xs,ae(K(L.fieldname)),1)]),L.read_only||S.isReadOnly?ye("",!0):(q(),B("button",{key:0,type:"button",onClick:ce=>re(L.fieldname),class:"text-red-500 hover:text-red-600"},V[30]||(V[30]=[k("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[k("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Qs))])):ye("",!0)])):L.fieldtype==="Table"?(q(),B("div",eu,[ct(Fl,{modelValue:e.value[L.fieldname],"onUpdate:modelValue":ce=>e.value[L.fieldname]=ce,fieldname:L.fieldname,label:L.label,description:L.description,required:L.reqd,"is-read-only":L.read_only||S.isReadOnly,"child-doctype":L.options,"parent-doctype":S.doctype,onChange:ce=>Q({fieldname:L.fieldname,value:ce})},null,8,["modelValue","onUpdate:modelValue","fieldname","label","description","required","is-read-only","child-doctype","parent-doctype","onChange"])])):ye("",!0)],2))],64))),128))])],32))]),k("div",tu,[to(R.$slots,"actions",{},()=>[k("div",nu,[k("button",{type:"button",onClick:qe,class:"flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors"}," Cancel "),k("button",{onClick:Se,disabled:_.value||S.isReadOnly,class:"flex-1 bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-blue-800"},[_.value?(q(),B("span",ou,[V[31]||(V[31]=k("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[k("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),k("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),Ae(" "+ae(S.submittingText||"Saving..."),1)])):(q(),B("span",iu,ae(S.submitText||"Save"),1))],8,ru)])])])]))}},au={class:"max-w-4xl mx-auto"},su={class:"sticky top-0 z-30 bg-white p-2 md:p-4 border-b"},uu={class:"flex items-center pl-10 md:pl-0"},cu={class:"text-xl font-semibold"},fu={class:"flex"},du={class:"flex-shrink-0"},hu={key:0,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},pu={key:1,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},vu={class:"ml-3"},mu={class:"text-sm"},yu={class:"ml-auto pl-3"},gu={class:"-mx-1.5 -my-1.5"},bu={key:1,class:"flex justify-center items-center py-8"},_u={key:2,class:"form-container"},zr={__name:"FormHandler",props:{doctype:{type:String,required:!0},recordId:{type:String,default:null},defaultValues:{type:Object,default:()=>({})},titleField:{type:String,default:"name"}},emits:["form-submitted"],setup(S,{emit:H}){const f=S,s=H,a=Qt();Nr();const p=he(!0),_=he(!1),g=he([]),m=he([]),b=he({}),d=he({}),i=he(null),n=he(""),t=he("info"),l=he([]),u=he({}),c=he([]),r=Fe(()=>f.doctype.toLowerCase().replace(/\s+/g,"-")),o=Fe(()=>!!f.recordId&&f.recordId!=="new"),v=()=>ge(this,null,function*(){try{console.log(`Fetching doctype fields for ${f.doctype}...`);const M=yield Ue.fetchDoctypeFields(f.doctype);if(Array.isArray(M))g.value=M;else if(M&&M.fields)g.value=M.fields,M.clientScripts?l.value=M.clientScripts:yield y();else throw new Error("Invalid response format");e(),yield j(),yield N()}catch(M){console.error("Error fetching doctype fields:",M),n.value="Failed to load doctype fields",t.value="error"}finally{p.value=!1}}),e=()=>{const M=["name","owner","creation","modified","modified_by","docstatus","idx"];m.value=g.value.filter(T=>!(!T||!T.fieldname||M.includes(T.fieldname)||T.hidden)).sort((T,A)=>(T.idx||0)-(A.idx||0))},y=()=>ge(this,null,function*(){try{console.log(`Fetching client scripts for ${f.doctype}...`),l.value=yield Ue.fetchClientScripts(f.doctype),console.log(`Successfully fetched ${l.value.length} client scripts`),P()}catch(M){console.error("Error fetching client scripts:",M)}}),j=()=>ge(this,null,function*(){try{const T=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield Ue.getCurrentUser()]}})})).json();T.message&&(c.value=T.message,console.log("User permissions:",c.value))}catch(M){console.error("Error fetching user permissions:",M)}}),N=()=>{o.value||c.value.forEach(M=>{m.value.filter(A=>A.fieldtype==="Link"&&A.options===M.allow).forEach(A=>{if(!d.value[A.fieldname]){d.value[A.fieldname]=M.for_value;const E=m.value.findIndex(C=>C.fieldname===A.fieldname);E!==-1&&(m.value[E]=Zt(lt({},m.value[E]),{read_only:1,read_only_depends_on:`User Permission for ${M.allow}`}))}})})},P=()=>{window.frappe||(window.frappe=I());for(const M of l.value)try{console.log(`Parsing client script: ${M.name}`),new Function(M.script)(),console.log(`Successfully parsed client script: ${M.name}`)}catch(T){console.error(`Error parsing client script ${M.name}:`,T),n.value=`Error in client script: ${T.message}`,t.value="error"}x("onload")},I=()=>({ui:{form:{on:(T,A)=>{console.log(`Registering events for ${T}:`,A);for(const[E,C]of Object.entries(A))u.value[E]||(u.value[E]=[]),u.value[E].push(C),console.log(`Registered handler for ${E} event`)}}},msgprint:T=>{console.log("MSGPRINT:",T),n.value=typeof T=="object"?T.message:T,t.value="info",setTimeout(()=>{n.value=""},5e3)},throw:T=>{console.log("THROW:",T),n.value=typeof T=="object"?T.message:T,t.value="error"},show_alert:(T,A=3)=>{console.log("SHOW_ALERT:",T),n.value=typeof T=="object"?T.message:T,t.value="info",setTimeout(()=>{n.value=""},A*1e3)},confirm:(T,A)=>{confirm(T)&&A()},prompt:(T,A)=>{const E=prompt(T.message||"Please enter a value",T.default||"");E!==null&&A(E)},format:(T,A)=>T,datetime:{now_date:()=>new Date().toISOString().split("T")[0]},model:{events:{on:(T,A,E)=>{}}},meta:{get_docfield:(T,A)=>m.value.find(E=>E.fieldname===A)||{}}}),x=(M,T=null)=>{console.log(`Triggering event: ${M}, field: ${T||"none"}`);const A={doc:d.value,doctype:f.doctype,get_field:E=>m.value.find(C=>C.fieldname===E)||{},set_value:(E,C)=>(d.value[E]=C,Promise.resolve()),refresh_field:E=>{const C=lt({},d.value);d.value=C},trigger:E=>{x(E)}};if(u.value[M])for(const E of u.value[M])try{E(A)}catch(C){console.error(`Error executing handler for ${M} event:`,C),n.value=`Error in client script: ${C.message}`,t.value="error"}if(T&&u.value[T])for(const E of u.value[T])try{E(A)}catch(C){console.error(`Error executing handler for ${T} field:`,C),n.value=`Error in client script: ${C.message}`,t.value="error"}},w=()=>ge(this,null,function*(){try{p.value=!0;const M=yield Ue.fetchDocument(f.doctype,f.recordId);if(!O(M)){n.value=`You don't have permission to access this ${f.doctype}`,t.value="error",a.push(`/${r.value}`);return}d.value=Zt(lt({},M),{doctype:f.doctype}),console.log("Loaded record data:",d.value)}catch(M){console.error(`Error fetching ${f.doctype}:`,M),n.value=`Failed to load ${f.doctype}`,t.value="error"}finally{p.value=!1}}),O=M=>{const T=c.value.filter(A=>A.allow===f.doctype);if(T.length===0)return!0;for(const A of T)for(const[E,C]of Object.entries(M))if(C===A.for_value)return!0;return!1},$=()=>{d.value=lt({doctype:f.doctype},f.defaultValues);for(const M of m.value)M.default&&!d.value[M.fieldname]&&(d.value[M.fieldname]=M.default);N()},F=({fieldname:M,value:T,file:A})=>{console.log(`Field ${M} changed:`,T,A),x("change",M),x(M)},K=()=>{x("validate"),console.log("Validating form...")},ee=A=>ge(this,[A],function*({formData:M,files:T}){try{x("before_save"),_.value=!0,console.log(`Submitting ${f.doctype} with data:`,M),console.log("Files to upload:",T);const E=Zt(lt({},M),{doctype:f.doctype});for(const[z,te]of Object.entries(T))try{console.log(`Uploading file for ${z}:`,te.name);const J=yield Ue.uploadFile(te,f.doctype,z,f.recordId);E[z]=J,console.log("File uploaded successfully, URL:",J)}catch(J){console.error(`Error uploading file for ${z}:`,J),i.value&&i.value.setErrorMessage(`Error uploading ${te.name}: ${J.message}`),_.value=!1;return}const C=yield Ue.saveDocument(E,!o.value);x("after_save"),n.value=`${f.doctype} ${o.value?"updated":"created"} successfully!`,t.value="success",s("form-submitted",C),setTimeout(()=>{a.push(`/${r.value}/${C.name}`)},1500)}catch(E){console.error(`Error ${o.value?"updating":"creating"} ${f.doctype}:`,E),n.value=`Error ${o.value?"updating":"creating"} ${f.doctype}: ${E.message||"Unknown error"}`,t.value="error",_.value=!1,i.value&&i.value.setErrorMessage(E.message||`Error ${o.value?"updating":"creating"} ${f.doctype}`)}}),Z=M=>ge(this,null,function*(){try{_.value=!0,yield Ue.deleteDocument(f.doctype,M),n.value=`${f.doctype} deleted successfully!`,t.value="success",setTimeout(()=>{a.push(`/${r.value}`)},1500)}catch(T){console.error(`Error deleting ${f.doctype}:`,T),n.value=`Error deleting ${f.doctype}: ${T.message||"Unknown error"}`,t.value="error"}finally{_.value=!1}});return Lt(()=>ge(this,null,function*(){console.log(`FormHandler component mounted for ${f.doctype}`);try{if(yield v(),o.value)yield w();else{$();try{const M=yield Ue.getCurrentUser();M&&m.value.find(T=>T.fieldname==="raised_by")&&(d.value.raised_by=M)}catch(M){console.error("Error fetching current user:",M)}}}catch(M){console.error("Error initializing component:",M),n.value="Failed to initialize component",t.value="error"}finally{p.value=!1}})),tt([()=>f.doctype,()=>f.recordId],()=>ge(this,null,function*(){var M;p.value=!0;try{f.doctype!==((M=d.value)==null?void 0:M.doctype)&&(g.value=[],m.value=[],b.value={},yield v()),o.value?yield w():$()}catch(T){console.error("Error when props changed:",T),n.value="Error loading data",t.value="error"}finally{p.value=!1}})),tt(()=>d.value,(M,T)=>{if(!T)return;const A=Object.keys(M).find(E=>M[E]!==T[E]);A&&(x("change",A),x(A))},{deep:!0}),(M,T)=>(q(),B("div",au,[k("div",su,[k("div",uu,[k("button",{onClick:T[0]||(T[0]=A=>M.$router.back()),class:"mr-4 text-gray-600 hover:text-gray-800 transition-colors"},T[3]||(T[3]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),k("h2",cu,ae(o.value?"Edit":"New")+" "+ae(S.doctype),1)])]),n.value?(q(),B("div",{key:0,class:De(["m-4 p-4 rounded-lg",t.value==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"])},[k("div",fu,[k("div",du,[t.value==="error"?(q(),B("svg",hu,T[4]||(T[4]=[k("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):(q(),B("svg",pu,T[5]||(T[5]=[k("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])))]),k("div",vu,[k("p",mu,ae(n.value),1)]),k("div",yu,[k("div",gu,[k("button",{onClick:T[1]||(T[1]=A=>n.value=""),class:De(["inline-flex rounded-md p-1.5",t.value==="error"?"text-red-500 hover:bg-red-100":"text-green-500 hover:bg-green-100"])},T[6]||(T[6]=[k("span",{class:"sr-only"},"Dismiss",-1),k("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[k("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),2)])])])],2)):ye("",!0),p.value?(q(),B("div",bu,T[7]||(T[7]=[k("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):(q(),B("div",_u,[ct(lu,{ref_key:"formViewRef",ref:i,modelValue:d.value,"onUpdate:modelValue":T[2]||(T[2]=A=>d.value=A),fields:m.value,"field-options":b.value,onValidate:K,onSubmit:ee,onFieldChange:F,onDelete:Z,"submit-text":o.value?"Update":"Create","submitting-text":o.value?"Updating...":"Creating...",doctype:S.doctype,docname:S.recordId,mode:o.value?"edit":"add",titleField:S.titleField},null,8,["modelValue","fields","field-options","submit-text","submitting-text","doctype","docname","mode","titleField"])]))]))}},wu={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},xu={class:"bg-white rounded-lg shadow-xl w-full max-w-md overflow-hidden animate-fade-in"},ku={class:"flex justify-between items-center border-b px-4 py-3 bg-gradient-to-r from-blue-50 to-white"},Ou={class:"text-lg font-medium text-gray-900"},Eu={class:"px-4 py-4 space-y-4 max-h-[70vh] overflow-y-auto"},Au={class:"flex items-center p-3 bg-blue-50 rounded-lg"},Tu={key:0,class:"ml-auto flex items-center"},Su={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white mr-2"},Nu=["src","alt"],Pu={key:1,class:"text-sm font-medium"},ju={class:"text-sm font-medium text-gray-700 truncate max-w-[120px]"},Lu={key:0},$u={class:"relative"},Cu=["disabled"],Du=["value"],Ru={class:"relative"},Mu=["disabled"],Iu={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm left-0 right-0",style:{"max-width":"100%"}},Fu=["onMousedown"],qu={class:"flex items-center"},Bu={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white mr-2"},Uu=["src","alt","onError"],Hu={key:1,class:"text-sm font-medium"},zu={class:"block truncate"},Vu={key:0,class:"py-2 px-3 text-gray-500 italic"},Ku={class:"flex space-x-2"},Gu={class:"bg-gray-50 px-4 py-3 flex justify-end"},Ju=["disabled"],Zu={key:0,class:"flex items-center"},Wu={key:1},Yu={__name:"AssignmentDialog",props:{doctype:{type:String,required:!0},docname:{type:String,required:!0}},emits:["assignment-added","assignment-error"],setup(S,{emit:H}){const f=S,s=H,a=he(!1),p=he(!1),_=he(""),g=he(!1),m=he([]),b=he([]),d=he(null),i=he(!1),n=he(""),t=he([]),l=he({doctype:f.doctype,name:f.docname,assign_to:"",user_group:"",description:"",priority:"Medium",complete_by:""}),u=Fe(()=>_.value?t.value.filter(Z=>Z.label.toLowerCase().includes(_.value.toLowerCase())):t.value),c=Fe(()=>l.value.assign_to!==""),r=Fe(()=>b.value.length>0),o=()=>ge(this,null,function*(){a.value=!0,e(),yield y(),yield Promise.all([$(),F(),K()]),j()}),v=()=>{a.value=!1,e()},e=()=>{p.value=!1,_.value="",l.value={doctype:f.doctype,name:f.docname,assign_to:"",user_group:"",description:"",priority:"Medium",complete_by:""}},y=()=>ge(this,null,function*(){try{const M=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:f.doctype,name:f.docname,fields:["name","title","subject"]})})).json();if(M.message){const T=M.message;n.value=T.title||T.subject||T.name||f.docname}}catch(Z){console.error("Error fetching document title:",Z),n.value=f.docname}}),j=()=>{const Z=n.value||f.docname;l.value.description=`Please review this ${f.doctype}: ${Z}`},N=()=>{p.value&&d.value?(l.value.assign_to=d.value.value,_.value=d.value.label):(l.value.assign_to="",_.value="")},P=()=>{setTimeout(()=>{g.value=!1},200)},I=Z=>{l.value.assign_to=Z.value,_.value=Z.label,g.value=!1},x=Z=>{if(!Z)return"";if(Z.includes("@"))return Z.substring(0,2).toUpperCase();const M=Z.split(" ");return M.length===1?M[0].charAt(0).toUpperCase():(M[0].charAt(0)+M[M.length-1].charAt(0)).toUpperCase()},w=(Z,M)=>{Z.target.style.display="none",M&&(M.image=null)},O=Z=>Z?Z.startsWith("/private/")?`/api/method/frappe.utils.file_manager.get_file?private=1&file=${encodeURIComponent(Z)}`:Z:null,$=()=>ge(this,null,function*(){try{const M=yield(yield fetch("/api/method/frappe.auth.get_logged_user")).json();if(M.message){const A=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",name:M.message,fields:["name","full_name","user_image"]})})).json();if(A.message){const E=A.message;d.value={value:E.name,label:E.full_name||E.name,image:E.user_image?O(E.user_image):null}}}}catch(Z){console.error("Error fetching current user:",Z)}}),F=()=>ge(this,null,function*(){try{try{const A=yield(yield fetch("/api/method/frappe.desk.form.assign_to.get_assignable_users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:f.doctype})})).json();if(A.message&&Array.isArray(A.message)){const E=A.message.map(C=>ge(this,null,function*(){try{const te=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",name:C,fields:["name","full_name","user_image"]})})).json();if(te.message){const J=te.message;return{value:J.name,label:J.full_name||J.name,image:J.user_image?O(J.user_image):null}}return{value:C,label:C,image:null}}catch(z){return console.error(`Error fetching details for user ${C}:`,z),{value:C,label:C,image:null}}}));t.value=yield Promise.all(E),m.value=t.value;return}}catch(T){console.error("Error fetching assignable users, falling back to all users:",T)}const M=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",fields:["name","full_name","user_image"],filters:{enabled:1},limit_page_length:0})})).json();M.message&&(m.value=M.message.map(T=>({value:T.name,label:T.full_name||T.name,image:T.user_image?O(T.user_image):null})),t.value=m.value)}catch(Z){console.error("Error fetching users:",Z)}}),K=()=>ge(this,null,function*(){try{const M=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Group",fields:["name"],limit_page_length:0})})).json();M.message&&(b.value=M.message.map(T=>({value:T.name,label:T.name})))}catch(Z){console.error("Error fetching user groups:",Z)}}),ee=()=>ge(this,null,function*(){var Z,M,T,A;if(c.value)try{i.value=!0;try{const te=yield(yield fetch("/api/method/oms.api.assign_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:f.doctype,name:f.docname,user:l.value.assign_to,description:l.value.description,priority:l.value.priority,date:l.value.complete_by||null})})).json();if(te.message&&te.message.status==="success"){const J={name:te.message.name||Date.now().toString(),allocated_to:l.value.assign_to,allocated_to_fullname:((Z=t.value.find(U=>U.value===l.value.assign_to))==null?void 0:Z.label)||l.value.assign_to,user_image:((M=t.value.find(U=>U.value===l.value.assign_to))==null?void 0:M.image)||null,description:l.value.description,priority:l.value.priority,date:l.value.complete_by||null};s("assignment-added",J),v();return}}catch(z){console.log("Custom endpoint not available, falling back to standard API")}const C=yield(yield fetch("/api/method/frappe.desk.form.assign_to.add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assign_to:[l.value.assign_to],doctype:f.doctype,name:f.docname,description:l.value.description,priority:l.value.priority,date:l.value.complete_by||null})})).json();if(C.message){const z={name:C.message.name||Date.now().toString(),allocated_to:l.value.assign_to,allocated_to_fullname:((T=t.value.find(te=>te.value===l.value.assign_to))==null?void 0:T.label)||l.value.assign_to,user_image:((A=t.value.find(te=>te.value===l.value.assign_to))==null?void 0:A.image)||null,description:l.value.description,priority:l.value.priority,date:l.value.complete_by||null};s("assignment-added",z),v()}else throw new Error("Failed to create assignment")}catch(E){console.error("Error creating assignment:",E),s("assignment-error",E.message||"Failed to create assignment")}finally{i.value=!1}});return tt(()=>f.doctype,Z=>{l.value.doctype=Z}),tt(()=>f.docname,Z=>{l.value.name=Z}),(Z,M)=>(q(),B("div",null,[k("button",{onClick:o,class:"flex items-center justify-center p-2 bg-white text-blue-600 border border-blue-600 rounded-full hover:bg-blue-50 transition-colors shadow-sm",title:"Assign to User"},M[10]||(M[10]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])),a.value?(q(),B("div",wu,[k("div",xu,[k("div",ku,[k("h3",Ou,"Assign "+ae(S.doctype),1),k("button",{onClick:v,class:"text-gray-400 hover:text-gray-500 focus:outline-none"},M[11]||(M[11]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),k("div",Eu,[k("div",Au,[Re(k("input",{type:"checkbox",id:"assign-to-me","onUpdate:modelValue":M[0]||(M[0]=T=>p.value=T),class:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500",onChange:N},null,544),[[fr,p.value]]),M[12]||(M[12]=k("label",{for:"assign-to-me",class:"ml-2 text-gray-700 font-medium"},"Assign to me",-1)),p.value&&d.value?(q(),B("div",Tu,[k("div",Su,[d.value.image?(q(),B("img",{key:0,src:d.value.image,alt:d.value.label,class:"h-full w-full object-cover",onError:M[1]||(M[1]=T=>w(T,d.value))},null,40,Nu)):(q(),B("span",Pu,ae(x(d.value.label)),1))]),k("span",ju,ae(d.value.label),1)])):ye("",!0)]),r.value?(q(),B("div",Lu,[M[14]||(M[14]=k("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assign To User Group",-1)),k("div",$u,[Re(k("select",{"onUpdate:modelValue":M[2]||(M[2]=T=>l.value.user_group=T),class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:p.value},[M[13]||(M[13]=k("option",{value:""},"Select User Group",-1)),(q(!0),B(Oe,null,Le(b.value,T=>(q(),B("option",{key:T.value,value:T.value},ae(T.label),9,Du))),128))],8,Cu),[[Tt,l.value.user_group]])])])):ye("",!0),k("div",null,[M[15]||(M[15]=k("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[Ae(" Assign To "),k("span",{class:"text-red-500"},"*")],-1)),k("div",Ru,[Re(k("input",{"onUpdate:modelValue":M[3]||(M[3]=T=>_.value=T),type:"text",class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Search users...",onFocus:M[4]||(M[4]=T=>g.value=!0),onBlur:P,disabled:p.value},null,40,Mu),[[et,_.value]]),g.value&&!p.value?(q(),B("div",Iu,[(q(!0),B(Oe,null,Le(u.value,T=>(q(),B("div",{key:T.value,class:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100",onMousedown:A=>I(T)},[k("div",qu,[k("div",Bu,[T.image?(q(),B("img",{key:0,src:T.image,alt:T.label,class:"h-full w-full object-cover",onError:A=>w(A,T)},null,40,Uu)):(q(),B("span",Hu,ae(x(T.label)),1))]),k("span",zu,ae(T.label),1)])],40,Fu))),128)),u.value.length===0?(q(),B("div",Vu," No users found ")):ye("",!0)])):ye("",!0)])]),k("div",null,[M[16]||(M[16]=k("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Complete By",-1)),Re(k("input",{type:"date","onUpdate:modelValue":M[5]||(M[5]=T=>l.value.complete_by=T),class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[et,l.value.complete_by]])]),k("div",null,[M[17]||(M[17]=k("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),k("div",Ku,[k("button",{onClick:M[6]||(M[6]=T=>l.value.priority="Low"),class:De(["flex-1 py-2 px-3 rounded-md border focus:outline-none transition-colors",l.value.priority==="Low"?"bg-green-50 border-green-300 text-green-700":"bg-gray-50 border-gray-300 text-gray-700"])}," Low ",2),k("button",{onClick:M[7]||(M[7]=T=>l.value.priority="Medium"),class:De(["flex-1 py-2 px-3 rounded-md border focus:outline-none transition-colors",l.value.priority==="Medium"?"bg-yellow-50 border-yellow-300 text-yellow-700":"bg-gray-50 border-gray-300 text-gray-700"])}," Medium ",2),k("button",{onClick:M[8]||(M[8]=T=>l.value.priority="High"),class:De(["flex-1 py-2 px-3 rounded-md border focus:outline-none transition-colors",l.value.priority==="High"?"bg-red-50 border-red-300 text-red-700":"bg-gray-50 border-gray-300 text-gray-700"])}," High ",2)])]),k("div",null,[M[18]||(M[18]=k("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Comment",-1)),Re(k("textarea",{"onUpdate:modelValue":M[9]||(M[9]=T=>l.value.description=T),rows:"3",class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Add a comment..."},null,512),[[et,l.value.description]])])]),k("div",Gu,[k("button",{onClick:ee,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:!c.value||i.value},[i.value?(q(),B("span",Zu,M[19]||(M[19]=[k("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[k("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),k("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Ae(" Processing... ")]))):(q(),B("span",Wu,"Assign"))],8,Ju)])])])):ye("",!0)]))}},Ar=cr(Yu,[["__scopeId","data-v-4c0be655"]]),Xu={class:"assignment-list"},Qu={key:0,class:"flex justify-center items-center py-2"},ec={key:1},tc={key:0,class:"text-gray-500 text-sm italic"},nc={key:1,class:"flex flex-wrap gap-1"},rc=["onClick","title"],oc={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white border-2 border-white shadow-sm"},ic=["src","alt","onError"],lc={key:1,class:"text-xs font-medium"},ac=["title"],sc=["data-popup-id"],uc={class:"flex items-center justify-between"},cc={class:"flex items-center"},fc={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white mr-2"},dc=["src","alt","onError"],hc={key:1,class:"text-xs font-medium"},pc={class:"font-medium text-blue-700 text-sm truncate max-w-[120px]"},vc=["onClick"],mc={class:"mt-2 text-xs text-gray-600"},yc={key:0,class:"mb-1"},gc={class:"truncate"},bc={key:1,class:"mb-1"},_c={class:"flex items-center"},wc={__name:"AssignmentList",props:{doctype:{type:String,required:!0},docname:{type:String,required:!0}},emits:["assignment-removed","assignment-error"],setup(S,{expose:H,emit:f}){const s=S,a=f,p=he([]),_=he(!0),g=he(null),m=he(null),b=he(null);he({});const d=()=>ge(this,null,function*(){if(!(!s.doctype||!s.docname))try{_.value=!0;const w=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["name","allocated_to","owner","description","priority","date","status"],filters:{reference_type:s.doctype,reference_name:s.docname,status:"Open"}})})).json();if(w.message){const $=w.message.map(F=>ge(this,null,function*(){try{const ee=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",name:F.allocated_to,fields:["name","full_name","user_image"]})})).json();return ee.message&&(F.allocated_to_fullname=ee.message.full_name||F.allocated_to,F.user_image=ee.message.user_image?l(ee.message.user_image):null),F}catch(K){return console.error("Error fetching user details:",K),F}}));p.value=yield Promise.all($)}else p.value=[]}catch(x){console.error("Error fetching assignments:",x),p.value=[]}finally{_.value=!1}}),i=x=>g.value&&x.allocated_to===g.value,n=(x,w)=>{x.target.style.display="none",w&&(w.user_image=null)},t=x=>{if(!x)return;const w=p.value.findIndex(O=>O.allocated_to===x.allocated_to);w>=0?p.value[w]=lt(lt({},p.value[w]),x):p.value.push(x)},l=x=>x?x.startsWith("/private/")?`/api/method/frappe.utils.file_manager.get_file?private=1&file=${encodeURIComponent(x)}`:x:null,u=x=>{if(!x)return"";if(x.includes("@"))return x.substring(0,2).toUpperCase();const w=x.split(" ");return w.length===1?w[0].charAt(0).toUpperCase():(w[0].charAt(0)+w[w.length-1].charAt(0)).toUpperCase()},c=x=>{if(!x)return"No due date";const w=new Date(x),O=new Date,$=new Date(O);return $.setDate($.getDate()+1),w.toDateString()===O.toDateString()?"Today":w.toDateString()===$.toDateString()?"Tomorrow":w.toLocaleDateString("en-US",{month:"short",day:"numeric"})},r=()=>ge(this,null,function*(){try{const w=yield(yield fetch("/api/method/frappe.auth.get_logged_user")).json();w.message&&(g.value=w.message)}catch(x){console.error("Error fetching current user:",x)}}),o=x=>g.value&&(x.owner===g.value||x.allocated_to===g.value),v=x=>ge(this,null,function*(){try{if((yield(yield fetch("/api/method/frappe.client.set_value",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",name:x,fieldname:"status",value:"Cancelled"})})).json()).message)p.value=p.value.filter($=>$.name!==x),a("assignment-removed",x),m.value=null;else throw new Error("Failed to remove assignment")}catch(w){console.error("Error removing assignment:",w),a("assignment-error",w.message||"Failed to remove assignment")}}),e=x=>{const w=p.value.findIndex(ee=>ee.name===x.name),O=window.innerWidth<640,$=(w+1)%4===0||w===p.value.length-1,F=p.value.length-w<=2;let K={top:"100%",left:"0",transform:"none"};return O?K={top:"auto",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"calc(100vw - 40px)",maxWidth:"300px"}:($||F)&&(K={top:"0",right:"100%",left:"auto",marginRight:"8px"}),K},y=x=>{m.value===x.name?m.value=null:(m.value=x.name,sr(()=>{j()}))},j=()=>{sr(()=>{document.querySelectorAll("[data-popup-id]").forEach(w=>{const O=w.getBoundingClientRect(),$=window.innerWidth,F=window.innerHeight;O.right>$&&(w.style.left="auto",w.style.right="0"),O.bottom>F&&(w.style.top="auto",w.style.bottom="100%"),O.left<0&&(w.style.left="0",w.style.right="auto"),O.top<0&&(w.style.top="0",w.style.bottom="auto")})})},N=x=>{m.value&&!x.target.closest(".assignment-list")&&(m.value=null)};tt([()=>s.doctype,()=>s.docname],()=>{d()});const P=x=>{x.detail&&x.detail.doctype===s.doctype&&x.detail.docname===s.docname&&t(x.detail.assignment)},I=()=>{m.value&&j()};return Lt(()=>{r(),d(),document.addEventListener("click",N),window.addEventListener("resize",I),window.addEventListener("assignment-added",P)}),Sr(()=>{document.removeEventListener("click",N),window.removeEventListener("resize",I),window.removeEventListener("assignment-added",P)}),H({addAssignment:t,removeAssignment:v,fetchAssignments:d}),(x,w)=>(q(),B("div",Xu,[_.value?(q(),B("div",Qu,w[0]||(w[0]=[k("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"},null,-1)]))):(q(),B("div",ec,[p.value.length===0?(q(),B("div",tc," No assignments ")):(q(),B("div",nc,[(q(!0),B(Oe,null,Le(p.value,O=>(q(),B("div",{key:O.name,class:"relative"},[k("div",{onClick:$=>y(O),class:"cursor-pointer transition-transform hover:scale-110",title:i(O)?"You":O.allocated_to_fullname||O.allocated_to},[k("div",oc,[O.user_image?(q(),B("img",{key:0,src:O.user_image,alt:i(O)?"You":O.allocated_to_fullname||O.allocated_to,class:"h-full w-full object-cover",onError:$=>n($,O)},null,40,ic)):(q(),B("span",lc,ae(u(O.allocated_to_fullname||O.allocated_to)),1))]),k("div",{class:De(["absolute -top-1 -right-1 w-3 h-3 rounded-full border border-white",{"bg-red-500":O.priority==="High","bg-yellow-500":O.priority==="Medium","bg-green-500":O.priority==="Low"}]),title:`Priority: ${O.priority}`},null,10,ac)],8,rc),m.value===O.name?(q(),B("div",{key:0,ref_for:!0,ref_key:"popupRef",ref:b,"data-popup-id":O.name,class:"fixed bg-white rounded-lg shadow-lg z-50 w-48 p-3 border",style:dt(e(O))},[k("div",uc,[k("div",cc,[k("div",fc,[O.user_image?(q(),B("img",{key:0,src:O.user_image,alt:i(O)?"You":O.allocated_to_fullname,class:"h-full w-full object-cover",onError:$=>n($,O)},null,40,dc)):(q(),B("span",hc,ae(u(O.allocated_to_fullname)),1))]),k("div",pc,ae(i(O)?"You":O.allocated_to_fullname),1)]),o(O)?(q(),B("button",{key:0,onClick:$=>v(O.name),class:"text-gray-400 hover:text-red-500 ml-2",title:"Remove assignment"},w[1]||(w[1]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,vc)):ye("",!0)]),k("div",mc,[O.description?(q(),B("div",yc,[w[2]||(w[2]=k("div",{class:"font-medium"},"Comment:",-1)),k("div",gc,ae(O.description),1)])):ye("",!0),O.date?(q(),B("div",bc,[w[3]||(w[3]=k("div",{class:"font-medium"},"Due:",-1)),k("div",null,ae(c(O.date)),1)])):ye("",!0),k("div",_c,[w[4]||(w[4]=k("div",{class:"font-medium mr-1"},"Priority:",-1)),k("div",{class:De(["px-2 py-0.5 rounded-full text-xs",{"bg-red-100 text-red-800":O.priority==="High","bg-yellow-100 text-yellow-800":O.priority==="Medium","bg-green-100 text-green-800":O.priority==="Low"}])},ae(O.priority),3)])])],12,sc)):ye("",!0)]))),128))]))]))]))}},Tr=cr(wc,[["__scopeId","data-v-18f13f66"]]),xc={class:"min-h-screen"},kc={key:0,class:"flex justify-center items-center py-8 bg-white"},Oc={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 mx-4 bg-white"},Ec={key:2,class:"bg-white"},Ac={key:0,class:"bg-white border-b border-gray-200 sticky top-0 z-10"},Tc={class:"px-4 py-3 max-w-3xl mx-auto flex items-center justify-between"},Sc={class:"flex items-center"},Nc={class:"text-xl font-semibold text-gray-900"},Pc={class:"flex items-center gap-2"},jc={key:1,class:"md:hidden border-b border-gray-200"},Lc={class:"flex overflow-x-auto"},$c=["onClick"],Cc={key:2,class:"p-0 max-w-3xl mx-auto"},Dc={key:3},Rc={class:"hidden md:block max-w-3xl mx-auto p-6"},Mc={class:"space-y-6"},Ic={class:"bg-blue-50 p-4 rounded-lg mb-6"},Fc={class:"flex items-center mb-3"},qc={key:0,class:"text-lg font-medium text-gray-900 mb-4"},Bc={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Uc={key:0,class:"mb-6"},Hc={class:"text-sm font-medium text-gray-500 mb-1"},zc={key:0,class:"text-blue-800 font-medium"},Vc={key:1,class:"text-blue-800 font-medium"},Kc={key:2,class:"prose max-w-none bg-gray-50 p-3 rounded-lg"},Gc=["innerHTML"],Jc={key:3,class:"text-blue-800 font-medium"},Zc={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Wc={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Yc={key:4,class:"mt-1"},Xc=["src","onClick"],Qc={key:5,class:"mt-1 flex items-center"},ef=["href"],tf={key:6,class:"text-blue-800 font-medium"},nf={key:7,class:"flex items-center"},rf={class:"text-blue-800 font-medium"},of={key:8,class:"text-blue-800 font-medium whitespace-pre-wrap bg-gray-50 p-2 rounded-md text-sm"},lf={key:9,class:"mt-2 overflow-x-auto"},af={class:"min-w-full divide-y divide-gray-200 border rounded-lg"},sf={class:"bg-gray-50"},uf={class:"bg-white divide-y divide-gray-200"},cf={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},ff={key:1,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},df={key:1,class:"flex items-center"},hf={key:10,class:"text-gray-500 italic"},pf={key:11,class:"text-blue-800 font-medium"},vf={key:0,class:"border-t border-gray-200 pt-6"},mf={class:"space-y-4"},yf={class:"font-medium text-gray-700 mb-2 flex items-center"},gf={class:"space-y-2"},bf=["href","onClick"],_f={class:"flex items-center"},wf={class:"flex items-center"},xf={class:"hidden md:inline mr-2 text-xs text-gray-500"},kf={class:"border-t border-gray-200 pt-6"},Of={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ef={class:"text-blue-800 font-medium"},Af={class:"text-blue-800 font-medium"},Tf={class:"text-blue-800 font-medium"},Sf={class:"text-blue-800 font-medium"},Nf={class:"md:hidden p-4"},Pf={key:0,class:"bg-blue-50 px-3 py-2 rounded-lg mb-4"},jf={class:"flex items-center justify-between"},Lf={class:"flex items-center space-x-2"},$f={key:1},Cf={class:"space-y-4"},Df={key:0,class:"mb-4 border-b pb-4"},Rf={class:"text-sm font-medium text-gray-500 mb-1"},Mf={key:0,class:"text-blue-800 font-medium"},If={key:1,class:"text-blue-800 font-medium"},Ff={key:2,class:"prose max-w-none bg-gray-50 p-3 rounded-lg"},qf=["innerHTML"],Bf={key:3,class:"text-blue-800 font-medium"},Uf={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Hf={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},zf={key:4,class:"mt-1"},Vf=["src","onClick"],Kf={key:5,class:"mt-1 flex items-center"},Gf=["href"],Jf={key:6,class:"text-blue-800 font-medium"},Zf={key:7,class:"flex items-center"},Wf={class:"text-blue-800 font-medium"},Yf={key:8,class:"text-blue-800 font-medium whitespace-pre-wrap bg-gray-50 p-2 rounded-md text-sm"},Xf={key:9,class:"mt-2 overflow-x-auto"},Qf={class:"min-w-full divide-y divide-gray-200 border rounded-lg"},ed={class:"bg-gray-50"},td={class:"bg-white divide-y divide-gray-200"},nd={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},rd={key:1,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},od={key:1,class:"flex items-center"},id={key:10,class:"text-gray-500 italic"},ld={key:11,class:"text-blue-800 font-medium"},ad={key:2,class:"space-y-4"},sd={class:"text-sm font-medium text-gray-700 mb-2"},ud={class:"space-y-3"},cd=["href","onClick"],fd={class:"text-sm text-gray-500 mt-1"},dd={key:3,class:"space-y-4"},hd={class:"mb-4 border-b pb-4"},pd={class:"text-blue-800 font-medium"},vd={class:"mb-4 border-b pb-4"},md={class:"text-blue-800 font-medium"},yd={class:"mb-4 border-b pb-4"},gd={class:"text-blue-800 font-medium"},bd={class:"mb-4 border-b pb-4"},_d={class:"text-blue-800 font-medium"},wd={class:"max-w-4xl max-h-screen p-4"},xd=["src"],kd={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Od={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Ed={class:"text-gray-600 mb-6"},Ad={class:"flex justify-end gap-3"},Td={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Sd={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Nd={key:0,class:"text-gray-700 mb-6"},Pd={class:"mb-2"},jd=["innerHTML"],Ld={key:1,class:"text-gray-700 mb-6"},$d={class:"flex justify-end"},Cd={__name:"DetailView",props:{doctype:{type:String,required:!0},recordId:{type:String,required:!0},titleField:{type:String,default:"subject"},detailFields:{type:Array,default:()=>[]}},emits:["record-deleted","record-updated"],setup(S,{emit:H}){const f=S,s=H,a=Qt(),p=he({}),_=he({}),g=he([]),m=he(!0),b=he(null),d=he({}),i=he(!1),n=he([]),t=he({});he({});const l=he(!1);he(!1);const u=he(!1),c=he(!1),r=he(null),o=he([]),v=he({}),e=he(0),y=he(null),j=he(!1),N=he(""),P=he(!1),I=he(""),x=he(""),w=he(!1),O=Fe(()=>f.doctype.toLowerCase().replace(/\s+/g,"-")),$=Fe(()=>{if(p.value){if(p.value.name)return p.value.name;if(f.titleField&&p.value[f.titleField])return p.value[f.titleField]}return`${f.doctype} ${f.recordId}`}),F=Fe(()=>o.value.length>0),K=Fe(()=>{const oe={};return o.value.forEach(Y=>{oe[Y.doctype]||(oe[Y.doctype]=[]),oe[Y.doctype].push(Y)}),oe}),ee=oe=>oe.toLowerCase().replace(/\s+/g,"-"),Z=oe=>{const Y={};return oe.fieldtype==="Check"?Y.width="60px":oe.fieldtype==="Int"||oe.fieldtype==="Float"?Y.width="100px":oe.fieldtype==="Date"||oe.fieldtype==="Color"?Y.width="120px":oe.fieldtype==="Small Text"&&(Y.minWidth="200px"),Y},M=Fe(()=>{const oe=[];let Y={label:"",columns:[[]]},le=0;const fe=["name","owner","creation","modified","modified_by","docstatus","idx"],me=g.value.filter(Pe=>Pe&&Pe.fieldname&&!Pe.hidden&&!fe.includes(Pe.fieldname)).sort((Pe,_e)=>(Pe.idx||0)-(_e.idx||0));for(const Pe of me)Pe.fieldtype==="Section Break"?Y.columns[0].length>0||oe.length===0?(oe.push(Y),Y={label:Pe.label||"",columns:[[]]},le=0):Y.label=Pe.label||"":Pe.fieldtype==="Column Break"?(le++,Y.columns[le]||(Y.columns[le]=[])):Y.columns[le].push(Pe);return Y.columns.some(Pe=>Pe.length>0)&&oe.push(Y),oe}),T=Fe(()=>M.value.filter(oe=>oe.columns.some(Y=>Y.some(le=>ve(le)&&!A(le.fieldname))))),A=oe=>["owner","creation","modified","modified_by","docstatus"].includes(oe),E=oe=>v.value[oe.options]||[],C=oe=>E(oe).filter(le=>!le.hidden&&!wr(oe.options,le.fieldname)),z=oe=>{N.value=oe,j.value=!0};function te(oe,Y){return ge(this,null,function*(){try{const le=yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe,name:Y})});if(!le.ok){const me=yield le.json();throw new Error(me.exception||me.message||`Error fetching ${oe}`)}const fe=yield le.json();if(fe.message)return fe.message;throw new Error(`${oe} not found`)}catch(le){throw console.error(`Error fetching ${oe}:`,le),le}})}function J(oe,Y){return ge(this,null,function*(){try{const fe=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["allocated_to"],filters:{reference_type:oe,reference_name:Y,status:"Open"}})})).json();fe.message&&fe.message.length>0?(y.value=fe.message[0].allocated_to,console.log(`Document is assigned to: ${y.value}`)):y.value=null}catch(le){console.error("Error fetching assignment info:",le),y.value=null}})}function U(oe){return ge(this,null,function*(){try{try{const me=yield(yield fetch("/api/method/oms.api.get_doctype_fields",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe})})).json();if(me.message&&Array.isArray(me.message)&&me.message.length>0)return console.log(`Successfully fetched ${me.message.length} fields using custom API`),me.message;console.log("Custom API returned no fields, falling back to standard API")}catch(fe){console.error("Error using custom API, falling back to standard API:",fe)}const le=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe})})).json();if(le.message&&le.message.docs&&le.message.docs[0]){const fe=le.message.docs[0];return console.log(`Successfully fetched ${fe.fields.length} fields using standard API`),{fields:fe.fields||[],clientScripts:le.message.__client_scripts||[]}}else throw new Error("Failed to get fields from standard API")}catch(Y){throw console.error("Error fetching doctype fields:",Y),Y}})}function X(oe){return ge(this,null,function*(){try{const le=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe})})).json();return le.message&&le.message.docs&&le.message.docs[0]?le.message.docs[0].fields||[]:[]}catch(Y){return console.error(`Error fetching child table fields for ${oe}:`,Y),[]}})}function ne(fe){return ge(this,arguments,function*(oe,Y=["name"],le={}){try{const Pe=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe,fields:Y,filters:le,limit:0})})).json();return Pe.message?Pe.message:[]}catch(me){return console.error(`Error fetching options for ${oe}:`,me),[]}})}function re(oe,Y){return ge(this,null,function*(){try{console.log(`Fetching linked records for ${oe} ${Y}...`);const fe=yield(yield fetch("/api/method/frappe.desk.form.linked_with.get_linked_doctypes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe})})).json();if(!fe.message)return console.log("No linked doctypes found"),[];const me=Object.keys(fe.message);console.log("Linked doctypes:",me);const Pe=[];for(const _e of me)try{if(["Version","Comment","Communication","File"].includes(_e))continue;const rt=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:_e,fields:["name","creation","modified"],filters:{[oe.toLowerCase()]:Y},limit:0})})).json();if(rt.message&&rt.message.length>0){console.log(`Found ${rt.message.length} linked ${_e} records`);const He=yield de(_e);if(He&&He!=="name")for(const ut of rt.message)try{const vt=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:_e,name:ut.name})})).json();vt.message&&(ut.title=vt.message[He])}catch(Ot){console.error(`Error fetching details for ${_e} ${ut.name}:`,Ot)}rt.message.forEach(ut=>{Pe.push(Zt(lt({},ut),{doctype:_e}))})}}catch(Be){console.error(`Error fetching linked ${_e} records:`,Be)}return console.log("All linked records:",Pe),Pe}catch(le){return console.error(`Error fetching linked records for ${oe} ${Y}:`,le),[]}})}function de(oe){return ge(this,null,function*(){try{const le=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe})})).json();if(le.message&&le.message.docs&&le.message.docs[0]){if(le.message.docs[0].title_field)return le.message.docs[0].title_field;const fe=["title","subject","name","description"],me=le.message.docs[0].fields||[];for(const Pe of fe)if(me.some(_e=>_e.fieldname===Pe))return Pe}return"name"}catch(Y){return console.error(`Error getting title field for ${oe}:`,Y),"name"}})}function be(oe,Y){return ge(this,null,function*(){try{const le=yield fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:oe,name:Y})});if(!le.ok){const fe=yield le.json();throw new Error(fe.exception||fe.message||`Error deleting ${oe}`)}return!0}catch(le){throw console.error(`Error deleting ${oe}:`,le),le}})}function we(oe){return ge(this,null,function*(){try{console.log(`Fetching client scripts for ${oe}...`);const le=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Client Script",filters:{dt:oe,enabled:1},fields:["name","script","dt","enabled","view"]})})).json();return le.message&&Array.isArray(le.message)?le.message:[]}catch(Y){return console.error(`Error fetching client scripts for ${oe}:`,Y),[]}})}const xe=()=>ge(this,null,function*(){try{m.value=!0,b.value=null,r.value=yield Yt(),console.log("Current user:",r.value);try{const oe=yield te(f.doctype,f.recordId);console.log("Fetched document:",oe);try{const Y=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:f.doctype})});if(Y.ok){const le=yield Y.json();le.message&&(u.value=le.message.write||!1,c.value=le.message.delete||!1,console.log(`Direct permissions for ${f.doctype}:`,le.message))}else{const le=yield ko(f.doctype);u.value=le.write,c.value=le.delete,le.if_owner&&!le.read_all&&(u.value=u.value&&oe.owner===r.value,c.value=c.value&&oe.owner===r.value),console.log(`Utility permissions for ${f.doctype}:`,{canEdit:u.value,canDelete:c.value})}}catch(Y){console.error("Error checking permissions:",Y),u.value=oe.owner===r.value,c.value=oe.owner===r.value}p.value=oe,_.value=JSON.parse(JSON.stringify(oe)),yield J(f.doctype,f.recordId),o.value=yield re(f.doctype,f.recordId),ie("onload")}catch(oe){console.error(`Error fetching ${f.doctype}:`,oe),oe.message&&oe.message.includes("Permission")?b.value=`You don't have permission to view this ${f.doctype}. Please contact your administrator.`:b.value=`Failed to load ${f.doctype}: ${oe.message||"Unknown error"}`}}finally{m.value=!1}}),Ee=()=>ge(this,null,function*(){try{const oe=yield U(f.doctype);if(Array.isArray(oe))g.value=oe;else if(oe&&oe.fields)g.value=oe.fields;else throw new Error("Invalid response format");const Y=g.value.filter(le=>le.fieldtype==="Table");for(const le of Y)if(le.options){const fe=yield X(le.options);v.value[le.options]=fe}yield ue(),yield Se()}catch(oe){console.error("Error fetching doctype fields:",oe),oe.value="Failed to load doctype fields"}}),Se=()=>ge(this,null,function*(){try{console.log(`Fetching client scripts for ${f.doctype}...`);const oe=yield we(f.doctype);n.value=oe,console.log(`Successfully fetched ${n.value.length} client scripts`),qe()}catch(oe){console.error("Error fetching client scripts:",oe)}}),qe=()=>{window.frappe||(window.frappe=Me());for(const oe of n.value)try{console.log(`Parsing client script: ${oe.name}`),new Function(oe.script)(),console.log(`Successfully parsed client script: ${oe.name}`)}catch(Y){console.error(`Error parsing client script ${oe.name}:`,Y)}},Me=()=>({ui:{form:{on:(Y,le)=>{console.log(`Registering events for ${Y}:`,le);for(const[fe,me]of Object.entries(le))t.value[fe]||(t.value[fe]=[]),t.value[fe].push(me),console.log(`Registered handler for ${fe} event`)}}},msgprint:Y=>{console.log("MSGPRINT:",Y),I.value=typeof Y=="object"?Y.message:Y,P.value=!0},throw:Y=>{console.log("THROW:",Y),b.value=typeof Y=="object"?Y.message:Y},show_alert:(Y,le=3)=>{console.log("SHOW_ALERT:",Y),I.value=typeof Y=="object"?Y.message:Y,P.value=!0,setTimeout(()=>{P.value=!1},le*1e3)},confirm:(Y,le)=>{confirm(Y)&&le()},prompt:(Y,le)=>{const fe=prompt(Y.message||"Please enter a value",Y.default||"");fe!==null&&le(fe)},format:(Y,le)=>Y,datetime:{now_date:()=>new Date().toISOString().split("T")[0]},model:{events:{on:(Y,le,fe)=>{}}},meta:{get_docfield:(Y,le)=>g.value.find(fe=>fe.fieldname===le)||{}}}),ie=(oe,Y=null)=>{console.log(`Triggering event: ${oe}, field: ${Y||"none"}`);const le={doc:p.value,doctype:f.doctype,docname:f.recordId,fields_dict:{},get_field:fe=>g.value.find(me=>me.fieldname===fe)||{},set_value:(fe,me)=>(p.value[fe]=me,Promise.resolve()),refresh_field:fe=>{const me=lt({},p.value);p.value=me},trigger:fe=>{ie(fe)}};if(t.value[oe])for(const fe of t.value[oe])try{fe(le)}catch(me){console.error(`Error executing handler for ${oe} event:`,me)}if(Y&&t.value[Y])for(const fe of t.value[Y])try{fe(le)}catch(me){console.error(`Error executing handler for ${Y} field:`,me)}},ue=()=>ge(this,null,function*(){const oe=g.value.filter(Y=>Y.fieldtype==="Link");for(const Y of oe)try{console.log(`Fetching options for ${Y.fieldname} (${Y.options})`);let le=[];Y.options==="Project"?le=(yield ne("Project",["name","project_name"])).map(me=>({value:me.name,label:me.project_name||me.name})):Y.options==="Contact"?le=(yield ne("Contact",["name","first_name","last_name"])).map(me=>({value:me.name,label:`${me.first_name||""} ${me.last_name||""} (${me.name})`})):le=(yield ne(Y.options,["name"])).map(me=>({value:me.name,label:me.name})),d.value[Y.fieldname]=le}catch(le){console.error(`Error fetching options for ${Y.fieldname}:`,le)}}),ve=oe=>{if(!p.value)return!1;if(l.value)return!0;if(wr(f.doctype,oe.fieldname))return!1;const Y=p.value[oe.fieldname];return oe.fieldtype==="Check"||oe.fieldtype==="Table"||Y!=null&&Y!==""},Q=oe=>{if(!oe||!p.value)return"";const Y=p.value[oe.fieldname];if(!Y)return"";if(oe.fieldtype==="Link"){const fe=(d.value[oe.fieldname]||[]).find(me=>me.value===Y);return fe?fe.label:Y}return Y},G=oe=>oe?new Date(oe).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",R=()=>{if(console.log("Attempting to start editing mode"),!u.value){I.value=`You don't have permission to edit this ${f.doctype}`,P.value=!0;return}_.value=JSON.parse(JSON.stringify(p.value)),l.value=!0,console.log("Edit mode activated"),ie("onedit")},V=oe=>{p.value=oe,l.value=!1,s("record-updated",oe),ie("onupdate")},L=()=>{J(f.doctype,f.recordId)},pe=()=>{J(f.doctype,f.recordId)},ce=oe=>{I.value=oe,P.value=!0},Ne=()=>{if(!c.value){I.value=`You don't have permission to delete this ${f.doctype}`,P.value=!0;return}i.value=!0},st=oe=>{if(oe.includes("LinkExistsError")||oe.includes("is linked with")){w.value=!0;let Y=oe;if(oe.includes("_server_messages"))try{const le=oe.match(/_server_messages\s*:\s*"(.+?)"/);if(le&&le[1]){const fe=le[1].replace(/\\"/g,'"').replace(/\\\\/g,"\\"),me=JSON.parse(fe);Array.isArray(me)&&me.length>0&&(Y=JSON.parse(me[0]).message||oe)}}catch(le){console.error("Error parsing server messages:",le)}return Y=Y.replace(/frappe\.exceptions\.LinkExistsError:\s*/,"").replace(/Cannot delete or cancel because/,"Cannot delete because"),Y}return w.value=!1,oe},je=()=>ge(this,null,function*(){try{m.value=!0,i.value=!1,yield be(f.doctype,f.recordId),s("record-deleted",f.recordId),a.push(`/${O.value}`)}catch(oe){console.error(`Error deleting ${f.doctype}:`,oe),oe.message&&oe.message.includes("Permission")?I.value=`Error deleting ${f.doctype}: You don't have permission to delete this document`:(x.value=st(oe.message),I.value=oe.message),P.value=!0}finally{m.value=!1}}),Ve=(oe,Y)=>{const le=`/${ee(oe)}/${Y}`;a.push(le)};return Lt(()=>ge(this,null,function*(){console.log(`DetailView component mounted for ${f.doctype} ${f.recordId}`);try{yield Ee(),yield xe()}catch(oe){console.error("Error initializing component:",oe),oe.value="Failed to initialize component"}})),tt(()=>f.recordId,oe=>ge(this,null,function*(){oe&&(l.value=!1,yield xe())})),tt(()=>f.doctype,()=>ge(this,null,function*(){m.value=!0,g.value=[],p.value={},_.value={},l.value=!1,v.value={};try{yield Ee(),yield xe()}catch(oe){console.error("Error when doctype changed:",oe)}finally{m.value=!1}})),(oe,Y)=>(q(),B("div",xc,[m.value?(q(),B("div",kc,Y[7]||(Y[7]=[k("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):b.value?(q(),B("div",Oc,[k("p",null,ae(b.value),1),k("button",{onClick:Y[0]||(Y[0]=le=>oe.$router.back()),class:"mt-2 bg-red-600 text-white px-4 py-2 rounded-lg"}," Go Back ")])):(q(),B("div",Ec,[l.value?ye("",!0):(q(),B("div",Ac,[k("div",Tc,[k("div",Sc,[k("button",{onClick:Y[1]||(Y[1]=le=>oe.$router.back()),class:"mr-3 text-blue-600 pl-3"},Y[8]||(Y[8]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),k("h1",Nc,ae($.value),1)]),k("div",Pc,[u.value?(q(),B("button",{key:0,onClick:R,class:"flex items-center px-3 py-1 bg-blue-50 text-blue-600 text-sm rounded-full border border-blue-600 hover:bg-blue-50 transition-colors",title:"Edit"},Y[9]||(Y[9]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),Ae(" Edit ")]))):ye("",!0),c.value?(q(),B("button",{key:1,onClick:Ne,class:"p-2 bg-red-50 text-red-500 rounded-full border border-red-500 hover:bg-red-50 transition-colors",title:"Delete"},Y[10]||(Y[10]=[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v10M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m-5 0h10"})],-1)]))):ye("",!0)])])])),l.value?ye("",!0):(q(),B("div",jc,[k("div",Lc,[(q(!0),B(Oe,null,Le(T.value,(le,fe)=>(q(),B("button",{key:fe,onClick:me=>e.value=fe,class:De(["px-4 py-3 text-sm font-medium whitespace-nowrap",e.value===fe?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"])},ae(le.label||`Section ${fe+1}`),11,$c))),128)),F.value?(q(),B("button",{key:0,onClick:Y[2]||(Y[2]=le=>e.value=T.value.length),class:De(["px-4 py-3 text-sm font-medium whitespace-nowrap",e.value===T.value.length?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"])}," Linked ",2)):ye("",!0),k("button",{onClick:Y[3]||(Y[3]=le=>e.value=T.value.length+(F.value?1:0)),class:De(["px-4 py-3 text-sm font-medium whitespace-nowrap",e.value===T.value.length+(F.value?1:0)?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"])}," Metadata ",2)])])),l.value?(q(),B("div",Cc,[ct(zr,{doctype:S.doctype,recordId:S.recordId,defaultValues:p.value,titleField:S.titleField,onFormSubmitted:V},null,8,["doctype","recordId","defaultValues","titleField"])])):(q(),B("div",Dc,[k("div",Rc,[k("div",Mc,[k("div",Ic,[k("div",Fc,[Y[11]||(Y[11]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),Y[12]||(Y[12]=k("h3",{class:"text-lg font-medium text-gray-900 mr-2"},"Assigned To",-1)),ct(Ar,{doctype:S.doctype,docname:S.recordId,onAssignmentAdded:L,onAssignmentError:ce},null,8,["doctype","docname"])]),ct(Tr,{doctype:S.doctype,docname:S.recordId,onAssignmentRemoved:pe,onAssignmentError:ce},null,8,["doctype","docname"])]),(q(!0),B(Oe,null,Le(T.value,(le,fe)=>(q(),B("div",{key:fe,class:De({"border-t border-gray-200 pt-6":fe>0})},[le.label?(q(),B("h3",qc,ae(le.label),1)):ye("",!0),k("div",Bc,[(q(!0),B(Oe,null,Le(le.columns,(me,Pe)=>(q(),B("div",{key:Pe,class:"space-y-4"},[(q(!0),B(Oe,null,Le(me,_e=>(q(),B(Oe,{key:_e.fieldname},[ve(_e)&&!A(_e.fieldname)?(q(),B("div",Uc,[k("div",Hc,ae(_e.label),1),_e.fieldtype==="Link"?(q(),B("div",zc,ae(Q(_e)),1)):_e.fieldtype==="Select"?(q(),B("div",Vc,ae(p.value[_e.fieldname]),1)):_e.fieldtype==="Text Editor"?(q(),B("div",Kc,[k("div",{innerHTML:p.value[_e.fieldname]},null,8,Gc)])):_e.fieldtype==="Check"?(q(),B("div",Jc,[p.value[_e.fieldname]?(q(),B("span",Zc,Y[13]||(Y[13]=[k("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" Yes ")]))):(q(),B("span",Wc,Y[14]||(Y[14]=[k("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" No ")])))])):_e.fieldtype==="Attach Image"&&p.value[_e.fieldname]?(q(),B("div",Yc,[k("img",{src:p.value[_e.fieldname],alt:"Attached Image",class:"h-48 w-auto rounded-lg object-cover cursor-pointer",onClick:Be=>z(p.value[_e.fieldname])},null,8,Xc)])):_e.fieldtype==="Attach"&&p.value[_e.fieldname]?(q(),B("div",Qc,[k("a",{href:p.value[_e.fieldname],target:"_blank",class:"text-blue-800 hover:underline flex items-center font-medium"},Y[15]||(Y[15]=[k("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),Ae(" Download Attachment ")]),8,ef)])):_e.fieldtype==="Date"||_e.fieldtype==="Datetime"?(q(),B("div",tf,ae(G(p.value[_e.fieldname])),1)):_e.fieldtype==="Color"&&p.value[_e.fieldname]?(q(),B("div",nf,[k("div",{class:"h-5 w-5 rounded mr-2",style:dt({backgroundColor:p.value[_e.fieldname]})},null,4),k("span",rf,ae(p.value[_e.fieldname]),1)])):_e.fieldtype==="Small Text"?(q(),B("div",of,ae(p.value[_e.fieldname]),1)):_e.fieldtype==="Table"&&p.value[_e.fieldname]&&p.value[_e.fieldname].length>0?(q(),B("div",lf,[k("table",af,[k("thead",sf,[k("tr",null,[(q(!0),B(Oe,null,Le(C(_e),Be=>(q(),B("th",{key:Be.fieldname,class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",style:dt(Z(Be))},ae(Be.label),5))),128))])]),k("tbody",uf,[(q(!0),B(Oe,null,Le(p.value[_e.fieldname],(Be,rt)=>(q(),B("tr",{key:rt},[(q(!0),B(Oe,null,Le(C(_e),He=>(q(),B("td",{key:He.fieldname,class:"px-3 py-2 text-sm text-blue-800 font-medium",style:dt(Z(He))},[He.fieldtype==="Check"?(q(),B(Oe,{key:0},[Be[He.fieldname]?(q(),B("span",cf,Y[16]||(Y[16]=[k("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" Yes ")]))):(q(),B("span",ff,Y[17]||(Y[17]=[k("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" No ")])))],64)):He.fieldtype==="Color"?(q(),B("div",df,[k("div",{class:"h-4 w-4 rounded mr-1",style:dt({backgroundColor:Be[He.fieldname]||"#FFFFFF"})},null,4),k("span",null,ae(Be[He.fieldname]),1)])):He.fieldtype==="Date"||He.fieldtype==="Datetime"?(q(),B(Oe,{key:2},[Ae(ae(G(Be[He.fieldname])),1)],64)):(q(),B(Oe,{key:3},[Ae(ae(Be[He.fieldname]),1)],64))],4))),128))]))),128))])])])):_e.fieldtype==="Table"&&(!p.value[_e.fieldname]||p.value[_e.fieldname].length===0)?(q(),B("div",hf," No items ")):(q(),B("div",pf,ae(p.value[_e.fieldname]),1))])):ye("",!0)],64))),128))]))),128))])],2))),128)),F.value?(q(),B("div",vf,[Y[21]||(Y[21]=k("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[k("div",{class:"flex items-center"},[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})]),Ae(" Linked Records ")])],-1)),k("div",mf,[(q(!0),B(Oe,null,Le(K.value,(le,fe)=>(q(),B("div",{key:fe,class:"bg-gray-50 p-4 rounded-lg"},[k("h4",yf,[Y[18]||(Y[18]=k("span",{class:"inline-block w-2 h-2 bg-blue-600 rounded-full mr-2"},null,-1)),Ae(" "+ae(fe)+" ("+ae(le.length)+") ",1)]),k("div",gf,[(q(!0),B(Oe,null,Le(le,me=>(q(),B("div",{key:me.name,class:"bg-white p-3 rounded border border-gray-200 hover:shadow-md transition-shadow"},[k("a",{href:`/${ee(fe)}/${me.name}`,class:"flex justify-between items-center text-blue-800 hover:text-blue-900 font-medium",onClick:jt(Pe=>Ve(fe,me.name),["prevent"])},[k("div",_f,[Y[19]||(Y[19]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),k("span",null,ae(me.title||me.name),1)]),k("div",wf,[k("span",xf,ae(G(me.modified||me.creation).split(",")[0]),1),Y[20]||(Y[20]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,bf)]))),128))])]))),128))])])):ye("",!0),k("div",kf,[Y[26]||(Y[26]=k("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[k("div",{class:"flex items-center"},[k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),Ae(" Metadata ")])],-1)),k("div",Of,[k("div",null,[Y[22]||(Y[22]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Created By",-1)),k("div",Ef,ae(p.value.owner||"Unknown"),1)]),k("div",null,[Y[23]||(Y[23]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Created On",-1)),k("div",Af,ae(G(p.value.creation)),1)]),k("div",null,[Y[24]||(Y[24]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Last Modified By",-1)),k("div",Tf,ae(p.value.modified_by||"Unknown"),1)]),k("div",null,[Y[25]||(Y[25]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Last Modified On",-1)),k("div",Sf,ae(G(p.value.modified)),1)])])])])]),k("div",Nf,[e.value===0?(q(),B("div",Pf,[k("div",jf,[k("div",Lf,[Y[27]||(Y[27]=k("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),Y[28]||(Y[28]=k("h3",{class:"text-sm font-medium text-gray-900 whitespace-nowrap"},"Assigned To",-1)),ct(Tr,{class:"flex-shrink-0",doctype:S.doctype,docname:S.recordId,onAssignmentRemoved:pe,onAssignmentError:ce},null,8,["doctype","docname"])]),ct(Ar,{class:"flex-shrink-0",doctype:S.doctype,docname:S.recordId,onAssignmentAdded:L,onAssignmentError:ce},null,8,["doctype","docname"])])])):ye("",!0),e.value<T.value.length?(q(),B("div",$f,[k("div",Cf,[(q(!0),B(Oe,null,Le(T.value[e.value].columns,le=>(q(),B(Oe,{key:le},[(q(!0),B(Oe,null,Le(le,fe=>(q(),B(Oe,{key:fe.fieldname},[ve(fe)&&!A(fe.fieldname)?(q(),B("div",Df,[k("div",Rf,ae(fe.label),1),fe.fieldtype==="Link"?(q(),B("div",Mf,ae(Q(fe)),1)):fe.fieldtype==="Select"?(q(),B("div",If,ae(p.value[fe.fieldname]),1)):fe.fieldtype==="Text Editor"?(q(),B("div",Ff,[k("div",{innerHTML:p.value[fe.fieldname]},null,8,qf)])):fe.fieldtype==="Check"?(q(),B("div",Bf,[p.value[fe.fieldname]?(q(),B("span",Uf,Y[29]||(Y[29]=[k("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" Yes ")]))):(q(),B("span",Hf,Y[30]||(Y[30]=[k("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" No ")])))])):fe.fieldtype==="Attach Image"&&p.value[fe.fieldname]?(q(),B("div",zf,[k("img",{src:p.value[fe.fieldname],alt:"Attached Image",class:"h-48 w-auto rounded-lg object-cover cursor-pointer",onClick:me=>z(p.value[fe.fieldname])},null,8,Vf)])):fe.fieldtype==="Attach"&&p.value[fe.fieldname]?(q(),B("div",Kf,[k("a",{href:p.value[fe.fieldname],target:"_blank",class:"text-blue-800 hover:underline flex items-center font-medium"},Y[31]||(Y[31]=[k("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[k("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),Ae(" Download Attachment ")]),8,Gf)])):fe.fieldtype==="Date"||fe.fieldtype==="Datetime"?(q(),B("div",Jf,ae(G(p.value[fe.fieldname])),1)):fe.fieldtype==="Color"&&p.value[fe.fieldname]?(q(),B("div",Zf,[k("div",{class:"h-5 w-5 rounded mr-2",style:dt({backgroundColor:p.value[fe.fieldname]})},null,4),k("span",Wf,ae(p.value[fe.fieldname]),1)])):fe.fieldtype==="Small Text"?(q(),B("div",Yf,ae(p.value[fe.fieldname]),1)):fe.fieldtype==="Table"&&p.value[fe.fieldname]&&p.value[fe.fieldname].length>0?(q(),B("div",Xf,[k("table",Qf,[k("thead",ed,[k("tr",null,[(q(!0),B(Oe,null,Le(C(fe),me=>(q(),B("th",{key:me.fieldname,class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",style:dt(Z(me))},ae(me.label),5))),128))])]),k("tbody",td,[(q(!0),B(Oe,null,Le(p.value[fe.fieldname],(me,Pe)=>(q(),B("tr",{key:Pe},[(q(!0),B(Oe,null,Le(C(fe),_e=>(q(),B("td",{key:_e.fieldname,class:"px-3 py-2 text-sm text-blue-800 font-medium",style:dt(Z(_e))},[_e.fieldtype==="Check"?(q(),B(Oe,{key:0},[me[_e.fieldname]?(q(),B("span",nd,Y[32]||(Y[32]=[k("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" Yes ")]))):(q(),B("span",rd,Y[33]||(Y[33]=[k("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[k("circle",{cx:"4",cy:"4",r:"3"})],-1),Ae(" No ")])))],64)):_e.fieldtype==="Color"?(q(),B("div",od,[k("div",{class:"h-4 w-4 rounded mr-1",style:dt({backgroundColor:me[_e.fieldname]||"#FFFFFF"})},null,4),k("span",null,ae(me[_e.fieldname]),1)])):_e.fieldtype==="Date"||_e.fieldtype==="Datetime"?(q(),B(Oe,{key:2},[Ae(ae(G(me[_e.fieldname])),1)],64)):(q(),B(Oe,{key:3},[Ae(ae(me[_e.fieldname]),1)],64))],4))),128))]))),128))])])])):fe.fieldtype==="Table"&&(!p.value[fe.fieldname]||p.value[fe.fieldname].length===0)?(q(),B("div",id," No items ")):(q(),B("div",ld,ae(p.value[fe.fieldname]),1))])):ye("",!0)],64))),128))],64))),128))])])):ye("",!0),e.value===T.value.length&&F.value?(q(),B("div",ad,[(q(!0),B(Oe,null,Le(K.value,(le,fe)=>(q(),B("div",{key:fe,class:"mb-6"},[k("div",sd,ae(fe)+" ("+ae(le.length)+")",1),k("div",ud,[(q(!0),B(Oe,null,Le(le,me=>(q(),B("div",{key:me.name,class:"border rounded-lg p-3"},[k("a",{href:`/${ee(fe)}/${me.name}`,class:"text-blue-800 hover:underline font-medium",onClick:jt(Pe=>Ve(fe,me.name),["prevent"])},ae(me.title||me.name),9,cd),k("div",fd,ae(G(me.modified||me.creation)),1)]))),128))])]))),128))])):ye("",!0),e.value===T.value.length+(F.value?1:0)?(q(),B("div",dd,[k("div",hd,[Y[34]||(Y[34]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Created By ",-1)),k("div",pd,ae(p.value.owner||"Unknown"),1)]),k("div",vd,[Y[35]||(Y[35]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Created On ",-1)),k("div",md,ae(G(p.value.creation)),1)]),k("div",yd,[Y[36]||(Y[36]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Last Modified By ",-1)),k("div",gd,ae(p.value.modified_by||"Unknown"),1)]),k("div",bd,[Y[37]||(Y[37]=k("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Last Modified On ",-1)),k("div",_d,ae(G(p.value.modified)),1)])])):ye("",!0)])]))])),j.value?(q(),B("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:Y[4]||(Y[4]=le=>j.value=!1)},[k("div",wd,[k("img",{src:N.value,alt:"Full size image",class:"max-w-full max-h-[90vh] object-contain"},null,8,xd)])])):ye("",!0),i.value?(q(),B("div",kd,[k("div",Od,[Y[38]||(Y[38]=k("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Confirm Delete",-1)),k("p",Ed," Are you sure you want to delete this "+ae(S.doctype)+"? This action cannot be undone. ",1),k("div",Ad,[k("button",{onClick:Y[5]||(Y[5]=le=>i.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Cancel "),k("button",{onClick:je,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Delete ")])])])):ye("",!0),P.value?(q(),B("div",Td,[k("div",Sd,[Y[39]||(Y[39]=k("h3",{class:"text-lg font-medium text-red-600 mb-4"},"Error",-1)),w.value?(q(),B("div",Nd,[k("p",Pd," Cannot delete this "+ae(S.doctype)+" because it is linked to other records: ",1),k("div",{class:"bg-gray-100 p-3 rounded-lg text-sm",innerHTML:x.value},null,8,jd)])):(q(),B("div",Ld,[k("p",null,ae(I.value),1)])),k("div",$d,[k("button",{onClick:Y[6]||(Y[6]=le=>P.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Close ")])])])):ye("",!0)]))}},Md={__name:"GenerateUI",props:{doctype:{type:String,required:!0},titleField:{type:String,default:"name"},listFields:{type:Array,default:()=>[]},detailFields:{type:Array,default:()=>[]},defaultValues:{type:Object,default:()=>({})}},emits:["record-deleted","form-submitted"],setup(S,{emit:H}){const f=S,s=H,a=Nr(),p=Qt(),_=he([]),g=he([]);Lt(()=>ge(this,null,function*(){try{const l=yield Ue.fetchDoctypeFields(f.doctype);Array.isArray(l)?_.value=l:l&&l.fields&&(_.value=l.fields),yield m()}catch(l){console.error(`Error fetching fields for ${f.doctype}:`,l)}}));const m=()=>ge(this,null,function*(){try{const u=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield Ue.getCurrentUser()]}})})).json();u.message&&(g.value=u.message,console.log("User permissions loaded:",g.value))}catch(l){console.error("Error fetching user permissions:",l)}}),b=Fe(()=>f.doctype.toLowerCase().replace(/\s+/g,"-")),d=Fe(()=>{const l=a.path,u=`/${b.value}`;return l===u?"list":l===`${u}/new`||l.includes("/edit/")?"form":"detail"}),i=Fe(()=>a.path===`/${b.value}/new`?null:(a.path.includes("/edit/"),a.params.id));Fe(()=>{const l=lt({},f.defaultValues);return g.value.forEach(u=>{_.value.filter(r=>r.fieldtype==="Link"&&r.options===u.allow).forEach(r=>{l[r.fieldname]||(l[r.fieldname]=u.for_value)})}),l});const n=l=>{s("record-deleted",l),p.push(`/${b.value}`)},t=l=>{s("form-submitted",l),p.push(`/${b.value}/${l.name}`)};return(l,u)=>(q(),B("div",null,[d.value==="list"?(q(),gn(pi,{key:0,doctype:S.doctype,titleField:S.titleField,listFields:S.listFields,showOnlyOwnRecords:!0},null,8,["doctype","titleField","listFields"])):d.value==="detail"?(q(),gn(Cd,{key:1,doctype:S.doctype,recordId:i.value,titleField:S.titleField,detailFields:S.detailFields,onRecordDeleted:n},null,8,["doctype","recordId","titleField","detailFields"])):d.value==="form"?(q(),gn(zr,{key:2,doctype:S.doctype,recordId:i.value,defaultValues:S.defaultValues,titleField:S.titleField,onFormSubmitted:t},null,8,["doctype","recordId","defaultValues","titleField"])):ye("",!0)]))}};export{Md as _};
