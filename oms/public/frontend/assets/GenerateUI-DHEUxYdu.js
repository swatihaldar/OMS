const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FontColor-BHHAqtij.js","assets/index-D-2YcNgo.js","assets/index-LSJ9QAK-.css","assets/InsertLink-BWdhbrmU.js","assets/Dialog-D6LQ_RJG.js","assets/InsertImage-DL60cU3L.js","assets/InsertVideo-CrKBESEJ.js"])))=>i.map(i=>d[i]);
var Ss=Object.defineProperty,Es=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var Do=Object.getOwnPropertySymbols;var Hn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable;var Rn=(e,t,o)=>t in e?Ss(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ge=(e,t)=>{for(var o in t||(t={}))Hn.call(t,o)&&Rn(e,o,t[o]);if(Do)for(var o of Do(t))Bn.call(t,o)&&Rn(e,o,t[o]);return e},We=(e,t)=>Es(e,Ds(t));var Rt=(e,t)=>{var o={};for(var n in e)Hn.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&Do)for(var n of Do(e))t.indexOf(n)<0&&Bn.call(e,n)&&(o[n]=e[n]);return o};var te=(e,t,o)=>new Promise((n,s)=>{var r=i=>{try{l(o.next(i))}catch(v){s(v)}},d=i=>{try{l(o.throw(i))}catch(v){s(v)}},l=i=>i.done?n(i.value):Promise.resolve(i.value).then(r,d);l((o=o.apply(e,t)).next())});import{o as u,a as c,b as a,d as js,h as jt,F as ae,i as vn,p as _r,r as L,e as Qe,w as Pt,f as ne,g as Ze,t as Pe,j as De,k as mn,n as it,_ as _e,l as Le,m as Ft,q as Et,s as fe,c as Ce,u as ce,v as be,x as Ve,y as ho,T as Ps,z as lt,A as hn,B as st,C as Ls,D as qe,E,G as Y,H as xe,I as ot,J as At,K as ko,L as le,M as kr,N as $r,O as pe,P as Zo,Q as Cr,R as Or,S as Fr,U as Ms,V as Rs,W as Ar,X as Hs,Y as Tr,Z as Sr,$ as qo,a0 as Bs,a1 as Is,a2 as Vs,a3 as lo,a4 as jo,a5 as Po,a6 as Ns,a7 as zs,a8 as Us,a9 as qs,aa as Ws,ab as Js,ac as Ks,ad as Ys,ae as Xs,af as Gs,ag as Qs,ah as Zs,ai as ea,aj as ta,ak as oa,al as na,am as ra,an as ao,ao as Dt,ap as $o,aq as gn,ar as sa,as as aa,at as ia,au as la,av as da,aw as ua}from"./index-D-2YcNgo.js";function ca(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})])}function In(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function pa(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function fa(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})])}function va(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}function ma(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"})])}function ha(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}function ga(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function ya(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6h.008v.008H6V6Z"})])}function Vn(e,t){return u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function at(e,t,...o){if(e in t){let s=t[e];return typeof s=="function"?s(...o):s}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,at),n}var go=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(go||{}),ba=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(ba||{});function eo(r){var d=r,{visible:e=!0,features:t=0,ourProps:o,theirProps:n}=d,s=Rt(d,["visible","features","ourProps","theirProps"]);var l;let i=Dr(n,o),v=Object.assign(s,{props:i});if(e||t&2&&i.static)return en(v);if(t&1){let p=(l=i.unmount)==null||l?0:1;return at(p,{0(){return null},1(){return en(We(ge({},s),{props:We(ge({},i),{hidden:!0,style:{display:"none"}})}))}})}return en(v)}function en({props:e,attrs:t,slots:o,slot:n,name:s}){var r,d;let k=yn(e,["unmount","static"]),{as:l}=k,i=Rt(k,["as"]),v=(r=o.default)==null?void 0:r.call(o,n),p={};if(n){let _=!1,w=[];for(let[y,F]of Object.entries(n))typeof F=="boolean"&&(_=!0),F===!0&&w.push(y);_&&(p["data-headlessui-state"]=w.join(" "))}if(l==="template"){if(v=Er(v!=null?v:[]),Object.keys(i).length>0||Object.keys(t).length>0){let[_,...w]=v!=null?v:[];if(!xa(_)||w.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${s} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(i).concat(Object.keys(t)).map(A=>A.trim()).filter((A,T,B)=>B.indexOf(A)===T).sort((A,T)=>A.localeCompare(T)).map(A=>`  - ${A}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(A=>`  - ${A}`).join(`
`)].join(`
`));let y=Dr((d=_.props)!=null?d:{},i),F=js(_,y);for(let A in y)A.startsWith("on")&&(F.props||(F.props={}),F.props[A]=y[A]);return F}return Array.isArray(v)&&v.length===1?v[0]:v}return jt(l,Object.assign({},i,p),{default:()=>v})}function Er(e){return e.flatMap(t=>t.type===ae?Er(t.children):[t])}function Dr(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},o={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(o[s]!=null||(o[s]=[]),o[s].push(n[s])):t[s]=n[s];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(o).map(n=>[n,void 0])));for(let n in o)Object.assign(t,{[n](s,...r){let d=o[n];for(let l of d){if(s instanceof Event&&s.defaultPrevented)return;l(s,...r)}}});return t}function wa(e){let t=Object.assign({},e);for(let o in t)t[o]===void 0&&delete t[o];return t}function yn(e,t=[]){let o=Object.assign({},e);for(let n of t)n in o&&delete o[n];return o}function xa(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}let _a=0;function ka(){return++_a}function Wo(){return ka()}var et=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(et||{});function $a(e){throw new Error("Unexpected object: "+e)}var ze=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(ze||{});function Ca(e,t){let o=t.resolveItems();if(o.length<=0)return null;let n=t.resolveActiveIndex(),s=n!=null?n:-1,r=(()=>{switch(e.focus){case 0:return o.findIndex(d=>!t.resolveDisabled(d));case 1:{let d=o.slice().reverse().findIndex((l,i,v)=>s!==-1&&v.length-i-1>=s?!1:!t.resolveDisabled(l));return d===-1?d:o.length-1-d}case 2:return o.findIndex((d,l)=>l<=s?!1:!t.resolveDisabled(d));case 3:{let d=o.slice().reverse().findIndex(l=>!t.resolveDisabled(l));return d===-1?d:o.length-1-d}case 4:return o.findIndex(d=>t.resolveId(d)===e.id);case 5:return null;default:$a(e)}})();return r===-1?n:r}function je(e){var t;return e==null||e.value==null?null:(t=e.value.$el)!=null?t:e.value}let jr=Symbol("Context");var yo=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(yo||{});function aw(){return Pr()!==null}function Pr(){return vn(jr,null)}function Oa(e){_r(jr,e)}function Nn(e,t){if(e)return e;let o=t!=null?t:"button";if(typeof o=="string"&&o.toLowerCase()==="button")return"button"}function Fa(e,t){let o=L(Nn(e.value.type,e.value.as));return Qe(()=>{o.value=Nn(e.value.type,e.value.as)}),Pt(()=>{var n;o.value||je(t)&&je(t)instanceof HTMLButtonElement&&!((n=je(t))!=null&&n.hasAttribute("type"))&&(o.value="button")}),o}var Aa=Object.defineProperty,Ta=(e,t,o)=>t in e?Aa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,zn=(e,t,o)=>(Ta(e,typeof t!="symbol"?t+"":t,o),o);class Sa{constructor(){zn(this,"current",this.detect()),zn(this,"currentId",0)}set(t){this.current!==t&&(this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window=="undefined"||typeof document=="undefined"?"server":"client"}}let bn=new Sa;function wn(e){if(bn.isServer)return null;if(e instanceof Node)return e.ownerDocument;if(e!=null&&e.hasOwnProperty("value")){let t=je(e);if(t)return t.ownerDocument}return document}function Ea({container:e,accept:t,walk:o,enabled:n}){Pt(()=>{let s=e.value;if(!s||n!==void 0&&!n.value)return;let r=wn(e);if(!r)return;let d=Object.assign(i=>t(i),{acceptNode:t}),l=r.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,d,!1);for(;l.nextNode();)o(l.currentNode)})}let sn=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Da=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(Da||{}),ja=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(ja||{}),Pa=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Pa||{});function La(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(sn)).sort((t,o)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(o.tabIndex||Number.MAX_SAFE_INTEGER)))}var Lr=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Lr||{});function Ma(e,t=0){var o;return e===((o=wn(e))==null?void 0:o.body)?!1:at(t,{0(){return e.matches(sn)},1(){let n=e;for(;n!==null;){if(n.matches(sn))return!0;n=n.parentElement}return!1}})}var Ra=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Ra||{});typeof window!="undefined"&&typeof document!="undefined"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function iw(e){e==null||e.focus({preventScroll:!0})}let Ha=["textarea","input"].join(",");function Ba(e){var t,o;return(o=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Ha))!=null?o:!1}function Mr(e,t=o=>o){return e.slice().sort((o,n)=>{let s=t(o),r=t(n);if(s===null||r===null)return 0;let d=s.compareDocumentPosition(r);return d&Node.DOCUMENT_POSITION_FOLLOWING?-1:d&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function lw(e,t,{sorted:o=!0,relativeTo:n=null,skipElements:s=[]}={}){var r;let d=(r=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e==null?void 0:e.ownerDocument)!=null?r:document,l=Array.isArray(e)?o?Mr(e):e:La(e);s.length>0&&l.length>1&&(l=l.filter(y=>!s.includes(y))),n=n!=null?n:d.activeElement;let i=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),v=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,l.indexOf(n))-1;if(t&4)return Math.max(0,l.indexOf(n))+1;if(t&8)return l.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),p=t&32?{preventScroll:!0}:{},k=0,_=l.length,w;do{if(k>=_||k+_<=0)return 0;let y=v+k;if(t&16)y=(y+_)%_;else{if(y<0)return 3;if(y>=_)return 1}w=l[y],w==null||w.focus(p),k+=i}while(w!==d.activeElement);return t&6&&Ba(w)&&w.select(),2}function Lo(e,t,o){bn.isServer||Pt(n=>{document.addEventListener(e,t,o),n(()=>document.removeEventListener(e,t,o))})}function Ia(e,t,o){bn.isServer||Pt(n=>{window.addEventListener(e,t,o),n(()=>window.removeEventListener(e,t,o))})}function Va(e,t,o=ne(()=>!0)){function n(r,d){if(!o.value||r.defaultPrevented)return;let l=d(r);if(l===null||!l.getRootNode().contains(l))return;let i=function v(p){return typeof p=="function"?v(p()):Array.isArray(p)||p instanceof Set?p:[p]}(e);for(let v of i){if(v===null)continue;let p=v instanceof HTMLElement?v:je(v);if(p!=null&&p.contains(l)||r.composed&&r.composedPath().includes(p))return}return!Ma(l,Lr.Loose)&&l.tabIndex!==-1&&r.preventDefault(),t(r,l)}let s=L(null);Lo("pointerdown",r=>{var d,l;o.value&&(s.value=((l=(d=r.composedPath)==null?void 0:d.call(r))==null?void 0:l[0])||r.target)},!0),Lo("mousedown",r=>{var d,l;o.value&&(s.value=((l=(d=r.composedPath)==null?void 0:d.call(r))==null?void 0:l[0])||r.target)},!0),Lo("click",r=>{s.value&&(n(r,()=>s.value),s.value=null)},!0),Lo("touchend",r=>n(r,()=>r.target instanceof HTMLElement?r.target:null),!0),Ia("blur",r=>n(r,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}var Rr=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Rr||{});let Na=Ze({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(e,{slots:t,attrs:o}){return()=>{let d=e,{features:n}=d,s=Rt(d,["features"]),r={"aria-hidden":(n&2)===2?!0:void 0,style:ge({position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},(n&4)===4&&(n&2)!==2&&{display:"none"})};return eo({ourProps:r,theirProps:s,slot:{},attrs:o,slots:t,name:"Hidden"})}}});function Hr(e={},t=null,o=[]){for(let[n,s]of Object.entries(e))Ir(o,Br(t,n),s);return o}function Br(e,t){return e?e+"["+t+"]":t}function Ir(e,t,o){if(Array.isArray(o))for(let[n,s]of o.entries())Ir(e,Br(t,n.toString()),s);else o instanceof Date?e.push([t,o.toISOString()]):typeof o=="boolean"?e.push([t,o?"1":"0"]):typeof o=="string"?e.push([t,o]):typeof o=="number"?e.push([t,`${o}`]):o==null?e.push([t,""]):Hr(o,t,e)}function za(e,t,o){let n=L(o==null?void 0:o.value),s=ne(()=>e.value!==void 0);return[ne(()=>s.value?e.value:n.value),function(r){return s.value||(n.value=r),t==null?void 0:t(r)}]}function Un(e){return[e.screenX,e.screenY]}function Ua(){let e=L([-1,-1]);return{wasMoved(t){let o=Un(t);return e.value[0]===o[0]&&e.value[1]===o[1]?!1:(e.value=o,!0)},update(t){e.value=Un(t)}}}function qa(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Wa(){return/Android/gi.test(window.navigator.userAgent)}function Ja(){return qa()||Wa()}function Ka(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function Vr(){let e=[],t={addEventListener(o,n,s,r){return o.addEventListener(n,s,r),t.add(()=>o.removeEventListener(n,s,r))},requestAnimationFrame(...o){let n=requestAnimationFrame(...o);t.add(()=>cancelAnimationFrame(n))},nextFrame(...o){t.requestAnimationFrame(()=>{t.requestAnimationFrame(...o)})},setTimeout(...o){let n=setTimeout(...o);t.add(()=>clearTimeout(n))},microTask(...o){let n={current:!0};return Ka(()=>{n.current&&o[0]()}),t.add(()=>{n.current=!1})},style(o,n,s){let r=o.style.getPropertyValue(n);return Object.assign(o.style,{[n]:s}),this.add(()=>{Object.assign(o.style,{[n]:r})})},group(o){let n=Vr();return o(n),this.add(()=>n.dispose())},add(o){return e.push(o),()=>{let n=e.indexOf(o);if(n>=0)for(let s of e.splice(n,1))s()}},dispose(){for(let o of e.splice(0))o()}};return t}function Ya(e,t){return e===t}var Xa=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Xa||{}),Ga=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Ga||{}),Qa=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Qa||{});let Nr=Symbol("ComboboxContext");function Co(e){let t=vn(Nr,null);if(t===null){let o=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,Co),o}return t}let Za=Ze({name:"Combobox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>Ya},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:t,attrs:o,emit:n}){let s=L(1),r=L(null),d=L(null),l=L(null),i=L(null),v=L({static:!1,hold:!1}),p=L([]),k=L(null),_=L(1),w=L(!1);function y(U=R=>R){let R=k.value!==null?p.value[k.value]:null,O=Mr(U(p.value.slice()),j=>je(j.dataRef.domRef)),C=R?O.indexOf(R):null;return C===-1&&(C=null),{options:O,activeOptionIndex:C}}let F=ne(()=>e.multiple?1:0),A=ne(()=>e.nullable),[T,B]=za(ne(()=>e.modelValue),U=>n("update:modelValue",U),ne(()=>e.defaultValue)),N=ne(()=>T.value===void 0?at(F.value,{1:[],0:void 0}):T.value),m=null,P=null,f={comboboxState:s,value:N,mode:F,compare(U,R){if(typeof e.by=="string"){let O=e.by;return(U==null?void 0:U[O])===(R==null?void 0:R[O])}return e.by(U,R)},defaultValue:ne(()=>e.defaultValue),nullable:A,inputRef:d,labelRef:r,buttonRef:l,optionsRef:i,disabled:ne(()=>e.disabled),options:p,change(U){B(U)},activeOptionIndex:ne(()=>{if(w.value&&k.value===null&&p.value.length>0){let U=p.value.findIndex(R=>!R.dataRef.disabled);U!==-1&&(k.value=U)}return k.value}),activationTrigger:_,optionsPropsRef:v,closeCombobox(){w.value=!1,!e.disabled&&s.value!==1&&(s.value=1,k.value=null)},openCombobox(){if(w.value=!0,e.disabled||s.value===0)return;let U=p.value.findIndex(R=>{let O=Pe(R.dataRef.value);return at(F.value,{0:()=>f.compare(Pe(f.value.value),Pe(O)),1:()=>Pe(f.value.value).some(C=>f.compare(Pe(C),Pe(O)))})});U!==-1&&(k.value=U),s.value=0},goToOption(U,R,O){w.value=!1,m!==null&&cancelAnimationFrame(m),m=requestAnimationFrame(()=>{if(e.disabled||i.value&&!v.value.static&&s.value===1)return;let C=y();if(C.activeOptionIndex===null){let Q=C.options.findIndex(ve=>!ve.dataRef.disabled);Q!==-1&&(C.activeOptionIndex=Q)}let j=Ca(U===ze.Specific?{focus:ze.Specific,id:R}:{focus:U},{resolveItems:()=>C.options,resolveActiveIndex:()=>C.activeOptionIndex,resolveId:Q=>Q.id,resolveDisabled:Q=>Q.dataRef.disabled});k.value=j,_.value=O!=null?O:1,p.value=C.options})},selectOption(U){let R=p.value.find(C=>C.id===U);if(!R)return;let{dataRef:O}=R;B(at(F.value,{0:()=>O.value,1:()=>{let C=Pe(f.value.value).slice(),j=Pe(O.value),Q=C.findIndex(ve=>f.compare(j,Pe(ve)));return Q===-1?C.push(j):C.splice(Q,1),C}}))},selectActiveOption(){if(f.activeOptionIndex.value===null)return;let{dataRef:U,id:R}=p.value[f.activeOptionIndex.value];B(at(F.value,{0:()=>U.value,1:()=>{let O=Pe(f.value.value).slice(),C=Pe(U.value),j=O.findIndex(Q=>f.compare(C,Pe(Q)));return j===-1?O.push(C):O.splice(j,1),O}})),f.goToOption(ze.Specific,R)},registerOption(U,R){P&&cancelAnimationFrame(P);let O={id:U,dataRef:R},C=y(j=>(j.push(O),j));if(k.value===null){let j=R.value.value;at(F.value,{0:()=>f.compare(Pe(f.value.value),Pe(j)),1:()=>Pe(f.value.value).some(Q=>f.compare(Pe(Q),Pe(j)))})&&(C.activeOptionIndex=C.options.indexOf(O))}p.value=C.options,k.value=C.activeOptionIndex,_.value=1,C.options.some(j=>!je(j.dataRef.domRef))&&(P=requestAnimationFrame(()=>{let j=y();p.value=j.options,k.value=j.activeOptionIndex}))},unregisterOption(U){var R;f.activeOptionIndex.value!==null&&((R=f.options.value[f.activeOptionIndex.value])==null?void 0:R.id)===U&&(w.value=!0);let O=y(C=>{let j=C.findIndex(Q=>Q.id===U);return j!==-1&&C.splice(j,1),C});p.value=O.options,k.value=O.activeOptionIndex,_.value=1}};Va([d,l,i],()=>f.closeCombobox(),ne(()=>s.value===0)),_r(Nr,f),Oa(ne(()=>at(s.value,{0:yo.Open,1:yo.Closed})));let D=ne(()=>f.activeOptionIndex.value===null?null:p.value[f.activeOptionIndex.value].dataRef.value),X=ne(()=>{var U;return(U=je(d))==null?void 0:U.closest("form")});return Qe(()=>{De([X],()=>{if(!X.value||e.defaultValue===void 0)return;function U(){f.change(e.defaultValue)}return X.value.addEventListener("reset",U),()=>{var R;(R=X.value)==null||R.removeEventListener("reset",U)}},{immediate:!0})}),()=>{let Q=e,{name:U,disabled:R,form:O}=Q,C=Rt(Q,["name","disabled","form"]),j={open:s.value===0,disabled:R,activeIndex:f.activeOptionIndex.value,activeOption:D.value,value:N.value};return jt(ae,[...U!=null&&N.value!=null?Hr({[U]:N.value}).map(([ve,ue])=>jt(Na,wa({features:Rr.Hidden,key:ve,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:O,name:ve,value:ue}))):[],eo({theirProps:ge(ge({},o),yn(C,["modelValue","defaultValue","nullable","multiple","onUpdate:modelValue","by"])),ourProps:{},slot:j,slots:t,attrs:o,name:"Combobox"})])}}}),ei=Ze({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-combobox-button-${Wo()}`}},setup(e,{attrs:t,slots:o,expose:n}){let s=Co("ComboboxButton");n({el:s.buttonRef,$el:s.buttonRef});function r(i){s.disabled.value||(s.comboboxState.value===0?s.closeCombobox():(i.preventDefault(),s.openCombobox()),it(()=>{var v;return(v=je(s.inputRef))==null?void 0:v.focus({preventScroll:!0})}))}function d(i){switch(i.key){case et.ArrowDown:i.preventDefault(),i.stopPropagation(),s.comboboxState.value===1&&s.openCombobox(),it(()=>{var v;return(v=s.inputRef.value)==null?void 0:v.focus({preventScroll:!0})});return;case et.ArrowUp:i.preventDefault(),i.stopPropagation(),s.comboboxState.value===1&&(s.openCombobox(),it(()=>{s.value.value||s.goToOption(ze.Last)})),it(()=>{var v;return(v=s.inputRef.value)==null?void 0:v.focus({preventScroll:!0})});return;case et.Escape:if(s.comboboxState.value!==0)return;i.preventDefault(),s.optionsRef.value&&!s.optionsPropsRef.value.static&&i.stopPropagation(),s.closeCombobox(),it(()=>{var v;return(v=s.inputRef.value)==null?void 0:v.focus({preventScroll:!0})});return}}let l=Fa(ne(()=>({as:e.as,type:t.type})),s.buttonRef);return()=>{var i,v;let p={open:s.comboboxState.value===0,disabled:s.disabled.value,value:s.value.value},y=e,{id:k}=y,_=Rt(y,["id"]),w={ref:s.buttonRef,id:k,type:l.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(i=je(s.optionsRef))==null?void 0:i.id,"aria-expanded":s.comboboxState.value===0,"aria-labelledby":s.labelRef.value?[(v=je(s.labelRef))==null?void 0:v.id,k].join(" "):void 0,disabled:s.disabled.value===!0?!0:void 0,onKeydown:d,onClick:r};return eo({ourProps:w,theirProps:_,slot:p,attrs:t,slots:o,name:"ComboboxButton"})}}}),ti=Ze({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:()=>`headlessui-combobox-input-${Wo()}`}},emits:{change:e=>!0},setup(e,{emit:t,attrs:o,slots:n,expose:s}){let r=Co("ComboboxInput"),d=ne(()=>wn(je(r.inputRef))),l={value:!1};s({el:r.inputRef,$el:r.inputRef});function i(){r.change(null);let T=je(r.optionsRef);T&&(T.scrollTop=0),r.goToOption(ze.Nothing)}let v=ne(()=>{var T;let B=r.value.value;return je(r.inputRef)?typeof e.displayValue!="undefined"&&B!==void 0?(T=e.displayValue(B))!=null?T:"":typeof B=="string"?B:"":""});Qe(()=>{De([v,r.comboboxState,d],([T,B],[N,m])=>{if(l.value)return;let P=je(r.inputRef);P&&((m===0&&B===1||T!==N)&&(P.value=T),requestAnimationFrame(()=>{var f;if(l.value||!P||((f=d.value)==null?void 0:f.activeElement)!==P)return;let{selectionStart:D,selectionEnd:X}=P;Math.abs((X!=null?X:0)-(D!=null?D:0))===0&&D===0&&P.setSelectionRange(P.value.length,P.value.length)}))},{immediate:!0}),De([r.comboboxState],([T],[B])=>{if(T===0&&B===1){if(l.value)return;let N=je(r.inputRef);if(!N)return;let m=N.value,{selectionStart:P,selectionEnd:f,selectionDirection:D}=N;N.value="",N.value=m,D!==null?N.setSelectionRange(P,f,D):N.setSelectionRange(P,f)}})});let p=L(!1);function k(){p.value=!0}function _(){Vr().nextFrame(()=>{p.value=!1})}function w(T){switch(l.value=!0,T.key){case et.Enter:if(l.value=!1,r.comboboxState.value!==0||p.value)return;if(T.preventDefault(),T.stopPropagation(),r.activeOptionIndex.value===null){r.closeCombobox();return}r.selectActiveOption(),r.mode.value===0&&r.closeCombobox();break;case et.ArrowDown:return l.value=!1,T.preventDefault(),T.stopPropagation(),at(r.comboboxState.value,{0:()=>r.goToOption(ze.Next),1:()=>r.openCombobox()});case et.ArrowUp:return l.value=!1,T.preventDefault(),T.stopPropagation(),at(r.comboboxState.value,{0:()=>r.goToOption(ze.Previous),1:()=>{r.openCombobox(),it(()=>{r.value.value||r.goToOption(ze.Last)})}});case et.Home:if(T.shiftKey)break;return l.value=!1,T.preventDefault(),T.stopPropagation(),r.goToOption(ze.First);case et.PageUp:return l.value=!1,T.preventDefault(),T.stopPropagation(),r.goToOption(ze.First);case et.End:if(T.shiftKey)break;return l.value=!1,T.preventDefault(),T.stopPropagation(),r.goToOption(ze.Last);case et.PageDown:return l.value=!1,T.preventDefault(),T.stopPropagation(),r.goToOption(ze.Last);case et.Escape:if(l.value=!1,r.comboboxState.value!==0)return;T.preventDefault(),r.optionsRef.value&&!r.optionsPropsRef.value.static&&T.stopPropagation(),r.nullable.value&&r.mode.value===0&&r.value.value===null&&i(),r.closeCombobox();break;case et.Tab:if(l.value=!1,r.comboboxState.value!==0)return;r.mode.value===0&&r.selectActiveOption(),r.closeCombobox();break}}function y(T){t("change",T),r.nullable.value&&r.mode.value===0&&T.target.value===""&&i(),r.openCombobox()}function F(){l.value=!1}let A=ne(()=>{var T,B,N,m;return(m=(N=(B=e.defaultValue)!=null?B:r.defaultValue.value!==void 0?(T=e.displayValue)==null?void 0:T.call(e,r.defaultValue.value):null)!=null?N:r.defaultValue.value)!=null?m:""});return()=>{var T,B,N,m,P,f;let D={open:r.comboboxState.value===0},j=e,{id:X,displayValue:U,onChange:R}=j,O=Rt(j,["id","displayValue","onChange"]),C={"aria-controls":(T=r.optionsRef.value)==null?void 0:T.id,"aria-expanded":r.comboboxState.value===0,"aria-activedescendant":r.activeOptionIndex.value===null||(B=r.options.value[r.activeOptionIndex.value])==null?void 0:B.id,"aria-labelledby":(P=(N=je(r.labelRef))==null?void 0:N.id)!=null?P:(m=je(r.buttonRef))==null?void 0:m.id,"aria-autocomplete":"list",id:X,onCompositionstart:k,onCompositionend:_,onKeydown:w,onInput:y,onBlur:F,role:"combobox",type:(f=o.type)!=null?f:"text",tabIndex:0,ref:r.inputRef,defaultValue:A.value,disabled:r.disabled.value===!0?!0:void 0};return eo({ourProps:C,theirProps:O,slot:D,attrs:o,slots:n,features:go.RenderStrategy|go.Static,name:"ComboboxInput"})}}}),oi=Ze({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(e,{attrs:t,slots:o,expose:n}){let s=Co("ComboboxOptions"),r=`headlessui-combobox-options-${Wo()}`;n({el:s.optionsRef,$el:s.optionsRef}),Pt(()=>{s.optionsPropsRef.value.static=e.static}),Pt(()=>{s.optionsPropsRef.value.hold=e.hold});let d=Pr(),l=ne(()=>d!==null?(d.value&yo.Open)===yo.Open:s.comboboxState.value===0);return Ea({container:ne(()=>je(s.optionsRef)),enabled:ne(()=>s.comboboxState.value===0),accept(i){return i.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:i.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(i){i.setAttribute("role","none")}}),()=>{var i,v,p;let k={open:s.comboboxState.value===0},_={"aria-labelledby":(p=(i=je(s.labelRef))==null?void 0:i.id)!=null?p:(v=je(s.buttonRef))==null?void 0:v.id,id:r,ref:s.optionsRef,role:"listbox","aria-multiselectable":s.mode.value===1?!0:void 0},w=yn(e,["hold"]);return eo({ourProps:_,theirProps:w,slot:k,attrs:t,slots:o,features:go.RenderStrategy|go.Static,visible:l.value,name:"ComboboxOptions"})}}}),ni=Ze({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(e,{slots:t,attrs:o,expose:n}){let s=Co("ComboboxOption"),r=`headlessui-combobox-option-${Wo()}`,d=L(null);n({el:d,$el:d});let l=ne(()=>s.activeOptionIndex.value!==null?s.options.value[s.activeOptionIndex.value].id===r:!1),i=ne(()=>at(s.mode.value,{0:()=>s.compare(Pe(s.value.value),Pe(e.value)),1:()=>Pe(s.value.value).some(A=>s.compare(Pe(A),Pe(e.value)))})),v=ne(()=>({disabled:e.disabled,value:e.value,domRef:d}));Qe(()=>s.registerOption(r,v)),mn(()=>s.unregisterOption(r)),Pt(()=>{s.comboboxState.value===0&&l.value&&s.activationTrigger.value!==0&&it(()=>{var A,T;return(T=(A=je(d))==null?void 0:A.scrollIntoView)==null?void 0:T.call(A,{block:"nearest"})})});function p(A){if(e.disabled)return A.preventDefault();s.selectOption(r),s.mode.value===0&&s.closeCombobox(),Ja()||requestAnimationFrame(()=>{var T;return(T=je(s.inputRef))==null?void 0:T.focus()})}function k(){if(e.disabled)return s.goToOption(ze.Nothing);s.goToOption(ze.Specific,r)}let _=Ua();function w(A){_.update(A)}function y(A){_.wasMoved(A)&&(e.disabled||l.value||s.goToOption(ze.Specific,r,0))}function F(A){_.wasMoved(A)&&(e.disabled||l.value&&(s.optionsPropsRef.value.hold||s.goToOption(ze.Nothing)))}return()=>{let{disabled:A}=e,T={active:l.value,selected:i.value,disabled:A},B={id:r,ref:d,role:"option",tabIndex:A===!0?void 0:-1,"aria-disabled":A===!0?!0:void 0,"aria-selected":i.value,disabled:void 0,onClick:p,onFocus:k,onPointerenter:w,onMouseenter:w,onPointermove:y,onMousemove:y,onPointerleave:F,onMouseleave:F};return eo({ourProps:B,theirProps:e,slot:T,attrs:o,slots:t,name:"ComboboxOption"})}}});var Ke="top",pt="bottom",ft="right",Ye="left",xn="auto",Oo=[Ke,pt,ft,Ye],qt="start",bo="end",ri="clippingParents",zr="viewport",no="popper",si="reference",qn=Oo.reduce(function(e,t){return e.concat([t+"-"+qt,t+"-"+bo])},[]),Ur=[].concat(Oo,[xn]).reduce(function(e,t){return e.concat([t,t+"-"+qt,t+"-"+bo])},[]),ai="beforeRead",ii="read",li="afterRead",di="beforeMain",ui="main",ci="afterMain",pi="beforeWrite",fi="write",vi="afterWrite",mi=[ai,ii,li,di,ui,ci,pi,fi,vi];function $t(e){return e?(e.nodeName||"").toLowerCase():null}function yt(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Wt(e){var t=yt(e).Element;return e instanceof t||e instanceof Element}function dt(e){var t=yt(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function qr(e){if(typeof ShadowRoot=="undefined")return!1;var t=yt(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function hi(e){var t=e.state;Object.keys(t.elements).forEach(function(o){var n=t.styles[o]||{},s=t.attributes[o]||{},r=t.elements[o];!dt(r)||!$t(r)||(Object.assign(r.style,n),Object.keys(s).forEach(function(d){var l=s[d];l===!1?r.removeAttribute(d):r.setAttribute(d,l===!0?"":l)}))})}function gi(e){var t=e.state,o={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,o.popper),t.styles=o,t.elements.arrow&&Object.assign(t.elements.arrow.style,o.arrow),function(){Object.keys(t.elements).forEach(function(n){var s=t.elements[n],r=t.attributes[n]||{},d=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:o[n]),l=d.reduce(function(i,v){return i[v]="",i},{});!dt(s)||!$t(s)||(Object.assign(s.style,l),Object.keys(r).forEach(function(i){s.removeAttribute(i)}))})}}const yi={name:"applyStyles",enabled:!0,phase:"write",fn:hi,effect:gi,requires:["computeStyles"]};function _t(e){return e.split("-")[0]}var Bt=Math.max,Vo=Math.min,Jt=Math.round;function Kt(e,t){t===void 0&&(t=!1);var o=e.getBoundingClientRect(),n=1,s=1;if(dt(e)&&t){var r=e.offsetHeight,d=e.offsetWidth;d>0&&(n=Jt(o.width)/d||1),r>0&&(s=Jt(o.height)/r||1)}return{width:o.width/n,height:o.height/s,top:o.top/s,right:o.right/n,bottom:o.bottom/s,left:o.left/n,x:o.left/n,y:o.top/s}}function _n(e){var t=Kt(e),o=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-o)<=1&&(o=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:n}}function Wr(e,t){var o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(o&&qr(o)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Tt(e){return yt(e).getComputedStyle(e)}function bi(e){return["table","td","th"].indexOf($t(e))>=0}function Lt(e){return((Wt(e)?e.ownerDocument:e.document)||window.document).documentElement}function Jo(e){return $t(e)==="html"?e:e.assignedSlot||e.parentNode||(qr(e)?e.host:null)||Lt(e)}function Wn(e){return!dt(e)||Tt(e).position==="fixed"?null:e.offsetParent}function wi(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,o=navigator.userAgent.indexOf("Trident")!==-1;if(o&&dt(e)){var n=Tt(e);if(n.position==="fixed")return null}for(var s=Jo(e);dt(s)&&["html","body"].indexOf($t(s))<0;){var r=Tt(s);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||t&&r.willChange==="filter"||t&&r.filter&&r.filter!=="none")return s;s=s.parentNode}return null}function Fo(e){for(var t=yt(e),o=Wn(e);o&&bi(o)&&Tt(o).position==="static";)o=Wn(o);return o&&($t(o)==="html"||$t(o)==="body"&&Tt(o).position==="static")?t:o||wi(e)||t}function kn(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function uo(e,t,o){return Bt(e,Vo(t,o))}function xi(e,t,o){var n=uo(e,t,o);return n>o?o:n}function Jr(){return{top:0,right:0,bottom:0,left:0}}function Kr(e){return Object.assign({},Jr(),e)}function Yr(e,t){return t.reduce(function(o,n){return o[n]=e,o},{})}var _i=function(t,o){return t=typeof t=="function"?t(Object.assign({},o.rects,{placement:o.placement})):t,Kr(typeof t!="number"?t:Yr(t,Oo))};function ki(e){var t,o=e.state,n=e.name,s=e.options,r=o.elements.arrow,d=o.modifiersData.popperOffsets,l=_t(o.placement),i=kn(l),v=[Ye,ft].indexOf(l)>=0,p=v?"height":"width";if(!(!r||!d)){var k=_i(s.padding,o),_=_n(r),w=i==="y"?Ke:Ye,y=i==="y"?pt:ft,F=o.rects.reference[p]+o.rects.reference[i]-d[i]-o.rects.popper[p],A=d[i]-o.rects.reference[i],T=Fo(r),B=T?i==="y"?T.clientHeight||0:T.clientWidth||0:0,N=F/2-A/2,m=k[w],P=B-_[p]-k[y],f=B/2-_[p]/2+N,D=uo(m,f,P),X=i;o.modifiersData[n]=(t={},t[X]=D,t.centerOffset=D-f,t)}}function $i(e){var t=e.state,o=e.options,n=o.element,s=n===void 0?"[data-popper-arrow]":n;s!=null&&(typeof s=="string"&&(s=t.elements.popper.querySelector(s),!s)||Wr(t.elements.popper,s)&&(t.elements.arrow=s))}const Ci={name:"arrow",enabled:!0,phase:"main",fn:ki,effect:$i,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Yt(e){return e.split("-")[1]}var Oi={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Fi(e){var t=e.x,o=e.y,n=window,s=n.devicePixelRatio||1;return{x:Jt(t*s)/s||0,y:Jt(o*s)/s||0}}function Jn(e){var t,o=e.popper,n=e.popperRect,s=e.placement,r=e.variation,d=e.offsets,l=e.position,i=e.gpuAcceleration,v=e.adaptive,p=e.roundOffsets,k=e.isFixed,_=d.x,w=_===void 0?0:_,y=d.y,F=y===void 0?0:y,A=typeof p=="function"?p({x:w,y:F}):{x:w,y:F};w=A.x,F=A.y;var T=d.hasOwnProperty("x"),B=d.hasOwnProperty("y"),N=Ye,m=Ke,P=window;if(v){var f=Fo(o),D="clientHeight",X="clientWidth";if(f===yt(o)&&(f=Lt(o),Tt(f).position!=="static"&&l==="absolute"&&(D="scrollHeight",X="scrollWidth")),f=f,s===Ke||(s===Ye||s===ft)&&r===bo){m=pt;var U=k&&P.visualViewport?P.visualViewport.height:f[D];F-=U-n.height,F*=i?1:-1}if(s===Ye||(s===Ke||s===pt)&&r===bo){N=ft;var R=k&&P.visualViewport?P.visualViewport.width:f[X];w-=R-n.width,w*=i?1:-1}}var O=Object.assign({position:l},v&&Oi),C=p===!0?Fi({x:w,y:F}):{x:w,y:F};if(w=C.x,F=C.y,i){var j;return Object.assign({},O,(j={},j[m]=B?"0":"",j[N]=T?"0":"",j.transform=(P.devicePixelRatio||1)<=1?"translate("+w+"px, "+F+"px)":"translate3d("+w+"px, "+F+"px, 0)",j))}return Object.assign({},O,(t={},t[m]=B?F+"px":"",t[N]=T?w+"px":"",t.transform="",t))}function Ai(e){var t=e.state,o=e.options,n=o.gpuAcceleration,s=n===void 0?!0:n,r=o.adaptive,d=r===void 0?!0:r,l=o.roundOffsets,i=l===void 0?!0:l,v={placement:_t(t.placement),variation:Yt(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Jn(Object.assign({},v,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:d,roundOffsets:i})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Jn(Object.assign({},v,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:i})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const Ti={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ai,data:{}};var Mo={passive:!0};function Si(e){var t=e.state,o=e.instance,n=e.options,s=n.scroll,r=s===void 0?!0:s,d=n.resize,l=d===void 0?!0:d,i=yt(t.elements.popper),v=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&v.forEach(function(p){p.addEventListener("scroll",o.update,Mo)}),l&&i.addEventListener("resize",o.update,Mo),function(){r&&v.forEach(function(p){p.removeEventListener("scroll",o.update,Mo)}),l&&i.removeEventListener("resize",o.update,Mo)}}const Ei={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Si,data:{}};var Di={left:"right",right:"left",bottom:"top",top:"bottom"};function Bo(e){return e.replace(/left|right|bottom|top/g,function(t){return Di[t]})}var ji={start:"end",end:"start"};function Kn(e){return e.replace(/start|end/g,function(t){return ji[t]})}function $n(e){var t=yt(e),o=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:o,scrollTop:n}}function Cn(e){return Kt(Lt(e)).left+$n(e).scrollLeft}function Pi(e){var t=yt(e),o=Lt(e),n=t.visualViewport,s=o.clientWidth,r=o.clientHeight,d=0,l=0;return n&&(s=n.width,r=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(d=n.offsetLeft,l=n.offsetTop)),{width:s,height:r,x:d+Cn(e),y:l}}function Li(e){var t,o=Lt(e),n=$n(e),s=(t=e.ownerDocument)==null?void 0:t.body,r=Bt(o.scrollWidth,o.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),d=Bt(o.scrollHeight,o.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),l=-n.scrollLeft+Cn(e),i=-n.scrollTop;return Tt(s||o).direction==="rtl"&&(l+=Bt(o.clientWidth,s?s.clientWidth:0)-r),{width:r,height:d,x:l,y:i}}function On(e){var t=Tt(e),o=t.overflow,n=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(o+s+n)}function Xr(e){return["html","body","#document"].indexOf($t(e))>=0?e.ownerDocument.body:dt(e)&&On(e)?e:Xr(Jo(e))}function co(e,t){var o;t===void 0&&(t=[]);var n=Xr(e),s=n===((o=e.ownerDocument)==null?void 0:o.body),r=yt(n),d=s?[r].concat(r.visualViewport||[],On(n)?n:[]):n,l=t.concat(d);return s?l:l.concat(co(Jo(d)))}function an(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Mi(e){var t=Kt(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function Yn(e,t){return t===zr?an(Pi(e)):Wt(t)?Mi(t):an(Li(Lt(e)))}function Ri(e){var t=co(Jo(e)),o=["absolute","fixed"].indexOf(Tt(e).position)>=0,n=o&&dt(e)?Fo(e):e;return Wt(n)?t.filter(function(s){return Wt(s)&&Wr(s,n)&&$t(s)!=="body"}):[]}function Hi(e,t,o){var n=t==="clippingParents"?Ri(e):[].concat(t),s=[].concat(n,[o]),r=s[0],d=s.reduce(function(l,i){var v=Yn(e,i);return l.top=Bt(v.top,l.top),l.right=Vo(v.right,l.right),l.bottom=Vo(v.bottom,l.bottom),l.left=Bt(v.left,l.left),l},Yn(e,r));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function Gr(e){var t=e.reference,o=e.element,n=e.placement,s=n?_t(n):null,r=n?Yt(n):null,d=t.x+t.width/2-o.width/2,l=t.y+t.height/2-o.height/2,i;switch(s){case Ke:i={x:d,y:t.y-o.height};break;case pt:i={x:d,y:t.y+t.height};break;case ft:i={x:t.x+t.width,y:l};break;case Ye:i={x:t.x-o.width,y:l};break;default:i={x:t.x,y:t.y}}var v=s?kn(s):null;if(v!=null){var p=v==="y"?"height":"width";switch(r){case qt:i[v]=i[v]-(t[p]/2-o[p]/2);break;case bo:i[v]=i[v]+(t[p]/2-o[p]/2);break}}return i}function wo(e,t){t===void 0&&(t={});var o=t,n=o.placement,s=n===void 0?e.placement:n,r=o.boundary,d=r===void 0?ri:r,l=o.rootBoundary,i=l===void 0?zr:l,v=o.elementContext,p=v===void 0?no:v,k=o.altBoundary,_=k===void 0?!1:k,w=o.padding,y=w===void 0?0:w,F=Kr(typeof y!="number"?y:Yr(y,Oo)),A=p===no?si:no,T=e.rects.popper,B=e.elements[_?A:p],N=Hi(Wt(B)?B:B.contextElement||Lt(e.elements.popper),d,i),m=Kt(e.elements.reference),P=Gr({reference:m,element:T,strategy:"absolute",placement:s}),f=an(Object.assign({},T,P)),D=p===no?f:m,X={top:N.top-D.top+F.top,bottom:D.bottom-N.bottom+F.bottom,left:N.left-D.left+F.left,right:D.right-N.right+F.right},U=e.modifiersData.offset;if(p===no&&U){var R=U[s];Object.keys(X).forEach(function(O){var C=[ft,pt].indexOf(O)>=0?1:-1,j=[Ke,pt].indexOf(O)>=0?"y":"x";X[O]+=R[j]*C})}return X}function Bi(e,t){t===void 0&&(t={});var o=t,n=o.placement,s=o.boundary,r=o.rootBoundary,d=o.padding,l=o.flipVariations,i=o.allowedAutoPlacements,v=i===void 0?Ur:i,p=Yt(n),k=p?l?qn:qn.filter(function(y){return Yt(y)===p}):Oo,_=k.filter(function(y){return v.indexOf(y)>=0});_.length===0&&(_=k);var w=_.reduce(function(y,F){return y[F]=wo(e,{placement:F,boundary:s,rootBoundary:r,padding:d})[_t(F)],y},{});return Object.keys(w).sort(function(y,F){return w[y]-w[F]})}function Ii(e){if(_t(e)===xn)return[];var t=Bo(e);return[Kn(e),t,Kn(t)]}function Vi(e){var t=e.state,o=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var s=o.mainAxis,r=s===void 0?!0:s,d=o.altAxis,l=d===void 0?!0:d,i=o.fallbackPlacements,v=o.padding,p=o.boundary,k=o.rootBoundary,_=o.altBoundary,w=o.flipVariations,y=w===void 0?!0:w,F=o.allowedAutoPlacements,A=t.options.placement,T=_t(A),B=T===A,N=i||(B||!y?[Bo(A)]:Ii(A)),m=[A].concat(N).reduce(function(J,q){return J.concat(_t(q)===xn?Bi(t,{placement:q,boundary:p,rootBoundary:k,padding:v,flipVariations:y,allowedAutoPlacements:F}):q)},[]),P=t.rects.reference,f=t.rects.popper,D=new Map,X=!0,U=m[0],R=0;R<m.length;R++){var O=m[R],C=_t(O),j=Yt(O)===qt,Q=[Ke,pt].indexOf(C)>=0,ve=Q?"width":"height",ue=wo(t,{placement:O,boundary:p,rootBoundary:k,altBoundary:_,padding:v}),oe=Q?j?ft:Ye:j?pt:Ke;P[ve]>f[ve]&&(oe=Bo(oe));var K=Bo(oe),ee=[];if(r&&ee.push(ue[C]<=0),l&&ee.push(ue[oe]<=0,ue[K]<=0),ee.every(function(J){return J})){U=O,X=!1;break}D.set(O,ee)}if(X)for(var ke=y?3:1,we=function(q){var h=m.find(function(H){var M=D.get(H);if(M)return M.slice(0,q).every(function(se){return se})});if(h)return U=h,"break"},ye=ke;ye>0;ye--){var Fe=we(ye);if(Fe==="break")break}t.placement!==U&&(t.modifiersData[n]._skip=!0,t.placement=U,t.reset=!0)}}const Ni={name:"flip",enabled:!0,phase:"main",fn:Vi,requiresIfExists:["offset"],data:{_skip:!1}};function Xn(e,t,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-t.height-o.y,right:e.right-t.width+o.x,bottom:e.bottom-t.height+o.y,left:e.left-t.width-o.x}}function Gn(e){return[Ke,ft,pt,Ye].some(function(t){return e[t]>=0})}function zi(e){var t=e.state,o=e.name,n=t.rects.reference,s=t.rects.popper,r=t.modifiersData.preventOverflow,d=wo(t,{elementContext:"reference"}),l=wo(t,{altBoundary:!0}),i=Xn(d,n),v=Xn(l,s,r),p=Gn(i),k=Gn(v);t.modifiersData[o]={referenceClippingOffsets:i,popperEscapeOffsets:v,isReferenceHidden:p,hasPopperEscaped:k},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":k})}const Ui={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:zi};function qi(e,t,o){var n=_t(e),s=[Ye,Ke].indexOf(n)>=0?-1:1,r=typeof o=="function"?o(Object.assign({},t,{placement:e})):o,d=r[0],l=r[1];return d=d||0,l=(l||0)*s,[Ye,ft].indexOf(n)>=0?{x:l,y:d}:{x:d,y:l}}function Wi(e){var t=e.state,o=e.options,n=e.name,s=o.offset,r=s===void 0?[0,0]:s,d=Ur.reduce(function(p,k){return p[k]=qi(k,t.rects,r),p},{}),l=d[t.placement],i=l.x,v=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=i,t.modifiersData.popperOffsets.y+=v),t.modifiersData[n]=d}const Ji={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Wi};function Ki(e){var t=e.state,o=e.name;t.modifiersData[o]=Gr({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const Yi={name:"popperOffsets",enabled:!0,phase:"read",fn:Ki,data:{}};function Xi(e){return e==="x"?"y":"x"}function Gi(e){var t=e.state,o=e.options,n=e.name,s=o.mainAxis,r=s===void 0?!0:s,d=o.altAxis,l=d===void 0?!1:d,i=o.boundary,v=o.rootBoundary,p=o.altBoundary,k=o.padding,_=o.tether,w=_===void 0?!0:_,y=o.tetherOffset,F=y===void 0?0:y,A=wo(t,{boundary:i,rootBoundary:v,padding:k,altBoundary:p}),T=_t(t.placement),B=Yt(t.placement),N=!B,m=kn(T),P=Xi(m),f=t.modifiersData.popperOffsets,D=t.rects.reference,X=t.rects.popper,U=typeof F=="function"?F(Object.assign({},t.rects,{placement:t.placement})):F,R=typeof U=="number"?{mainAxis:U,altAxis:U}:Object.assign({mainAxis:0,altAxis:0},U),O=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,C={x:0,y:0};if(f){if(r){var j,Q=m==="y"?Ke:Ye,ve=m==="y"?pt:ft,ue=m==="y"?"height":"width",oe=f[m],K=oe+A[Q],ee=oe-A[ve],ke=w?-X[ue]/2:0,we=B===qt?D[ue]:X[ue],ye=B===qt?-X[ue]:-D[ue],Fe=t.elements.arrow,J=w&&Fe?_n(Fe):{width:0,height:0},q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Jr(),h=q[Q],H=q[ve],M=uo(0,D[ue],J[ue]),se=N?D[ue]/2-ke-M-h-R.mainAxis:we-M-h-R.mainAxis,ie=N?-D[ue]/2+ke+M+H+R.mainAxis:ye+M+H+R.mainAxis,me=t.elements.arrow&&Fo(t.elements.arrow),Ae=me?m==="y"?me.clientTop||0:me.clientLeft||0:0,Me=(j=O==null?void 0:O[m])!=null?j:0,Ne=oe+se-Me-Ae,Je=oe+ie-Me,Ie=uo(w?Vo(K,Ne):K,oe,w?Bt(ee,Je):ee);f[m]=Ie,C[m]=Ie-oe}if(l){var Be,he=m==="x"?Ke:Ye,Te=m==="x"?pt:ft,Ee=f[P],Se=P==="y"?"height":"width",S=Ee+A[he],g=Ee-A[Te],x=[Ke,Ye].indexOf(T)!==-1,V=(Be=O==null?void 0:O[P])!=null?Be:0,re=x?S:Ee-D[Se]-X[Se]-V+R.altAxis,de=x?Ee+D[Se]+X[Se]-V-R.altAxis:g,$e=w&&x?xi(re,Ee,de):uo(w?re:S,Ee,w?de:g);f[P]=$e,C[P]=$e-Ee}t.modifiersData[n]=C}}const Qi={name:"preventOverflow",enabled:!0,phase:"main",fn:Gi,requiresIfExists:["offset"]};function Zi(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function el(e){return e===yt(e)||!dt(e)?$n(e):Zi(e)}function tl(e){var t=e.getBoundingClientRect(),o=Jt(t.width)/e.offsetWidth||1,n=Jt(t.height)/e.offsetHeight||1;return o!==1||n!==1}function ol(e,t,o){o===void 0&&(o=!1);var n=dt(t),s=dt(t)&&tl(t),r=Lt(t),d=Kt(e,s),l={scrollLeft:0,scrollTop:0},i={x:0,y:0};return(n||!n&&!o)&&(($t(t)!=="body"||On(r))&&(l=el(t)),dt(t)?(i=Kt(t,!0),i.x+=t.clientLeft,i.y+=t.clientTop):r&&(i.x=Cn(r))),{x:d.left+l.scrollLeft-i.x,y:d.top+l.scrollTop-i.y,width:d.width,height:d.height}}function nl(e){var t=new Map,o=new Set,n=[];e.forEach(function(r){t.set(r.name,r)});function s(r){o.add(r.name);var d=[].concat(r.requires||[],r.requiresIfExists||[]);d.forEach(function(l){if(!o.has(l)){var i=t.get(l);i&&s(i)}}),n.push(r)}return e.forEach(function(r){o.has(r.name)||s(r)}),n}function rl(e){var t=nl(e);return mi.reduce(function(o,n){return o.concat(t.filter(function(s){return s.phase===n}))},[])}function sl(e){var t;return function(){return t||(t=new Promise(function(o){Promise.resolve().then(function(){t=void 0,o(e())})})),t}}function al(e){var t=e.reduce(function(o,n){var s=o[n.name];return o[n.name]=s?Object.assign({},s,n,{options:Object.assign({},s.options,n.options),data:Object.assign({},s.data,n.data)}):n,o},{});return Object.keys(t).map(function(o){return t[o]})}var Qn={placement:"bottom",modifiers:[],strategy:"absolute"};function Zn(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function il(e){e===void 0&&(e={});var t=e,o=t.defaultModifiers,n=o===void 0?[]:o,s=t.defaultOptions,r=s===void 0?Qn:s;return function(l,i,v){v===void 0&&(v=r);var p={placement:"bottom",orderedModifiers:[],options:Object.assign({},Qn,r),modifiersData:{},elements:{reference:l,popper:i},attributes:{},styles:{}},k=[],_=!1,w={state:p,setOptions:function(T){var B=typeof T=="function"?T(p.options):T;F(),p.options=Object.assign({},r,p.options,B),p.scrollParents={reference:Wt(l)?co(l):l.contextElement?co(l.contextElement):[],popper:co(i)};var N=rl(al([].concat(n,p.options.modifiers)));return p.orderedModifiers=N.filter(function(m){return m.enabled}),y(),w.update()},forceUpdate:function(){if(!_){var T=p.elements,B=T.reference,N=T.popper;if(Zn(B,N)){p.rects={reference:ol(B,Fo(N),p.options.strategy==="fixed"),popper:_n(N)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(R){return p.modifiersData[R.name]=Object.assign({},R.data)});for(var m=0;m<p.orderedModifiers.length;m++){if(p.reset===!0){p.reset=!1,m=-1;continue}var P=p.orderedModifiers[m],f=P.fn,D=P.options,X=D===void 0?{}:D,U=P.name;typeof f=="function"&&(p=f({state:p,options:X,name:U,instance:w})||p)}}}},update:sl(function(){return new Promise(function(A){w.forceUpdate(),A(p)})}),destroy:function(){F(),_=!0}};if(!Zn(l,i))return w;w.setOptions(v).then(function(A){!_&&v.onFirstUpdate&&v.onFirstUpdate(A)});function y(){p.orderedModifiers.forEach(function(A){var T=A.name,B=A.options,N=B===void 0?{}:B,m=A.effect;if(typeof m=="function"){var P=m({state:p,name:T,instance:w,options:N}),f=function(){};k.push(P||f)}})}function F(){k.forEach(function(A){return A()}),k=[]}return w}}var ll=[Ei,Yi,Ti,yi,Ji,Ni,Qi,Ci,Ui],dl=il({defaultModifiers:ll});const ul={name:"Popover",inheritAttrs:!1,props:{show:{default:void 0},trigger:{type:String,default:"click"},hoverDelay:{type:Number,default:0},leaveDelay:{type:Number,default:0},placement:{type:String,default:"bottom-start"},popoverClass:[String,Object,Array],transition:{default:null},hideOnBlur:{default:!0}},emits:["open","close","update:show"],expose:["open","close"],data(){return{popoverContainerClass:"body-container",showPopup:!1,targetWidth:null,pointerOverTargetOrPopup:!1}},watch:{show(e){e?this.open():this.close()}},created(){if(typeof window!="undefined"&&!document.getElementById("frappeui-popper-root")){const e=document.createElement("div");e.id="frappeui-popper-root",document.body.appendChild(e)}},mounted(){this.listener=e=>{const t=e.target,o=this.$refs.reference,n=this.$refs.popover;if(t===o||t===n||(o==null?void 0:o.contains(t))||(n==null?void 0:n.contains(t)))return;if(!document.getElementById("frappeui-popper-root").contains(t))return this.close();const l=`.${this.popoverContainerClass}`,i=t==null?void 0:t.closest(l),v=o==null?void 0:o.closest(l);i&&v&&i===v&&this.close()},this.hideOnBlur&&(document.addEventListener("click",this.listener),document.addEventListener("mousedown",this.listener)),this.$nextTick(()=>{this.targetWidth=this.$refs.target.clientWidth})},beforeDestroy(){this.popper&&this.popper.destroy(),document.removeEventListener("click",this.listener),document.removeEventListener("mousedown",this.listener)},computed:{showPropPassed(){return this.show!=null},isOpen:{get(){return this.showPropPassed?this.show:this.showPopup},set(e){e=!!e,this.showPropPassed?this.$emit("update:show",e):this.showPopup=e,e===!1?this.$emit("close"):e===!0&&this.$emit("open")}},popupTransition(){let e={default:{enterActiveClass:"transition duration-150 ease-out",enterFromClass:"translate-y-1 opacity-0",enterToClass:"translate-y-0 opacity-100",leaveActiveClass:"transition duration-150 ease-in",leaveFromClass:"translate-y-0 opacity-100",leaveToClass:"translate-y-1 opacity-0"}};return typeof this.transition=="string"?e[this.transition]:this.transition}},methods:{setupPopper(){this.popper?this.updatePosition():this.popper=dl(this.$refs.reference,this.$refs.popover,{placement:this.placement})},updatePosition(){this.popper&&this.popper.update()},togglePopover(e){e instanceof Event&&(e=null),e==null&&(e=!this.isOpen),e=!!e,e?this.open():this.close()},open(){this.isOpen=!0,this.$nextTick(()=>this.setupPopper())},close(){this.isOpen=!1},onMouseover(){this.pointerOverTargetOrPopup=!0,this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.trigger==="hover"&&(this.hoverDelay?this.hoverTimer=setTimeout(()=>{this.pointerOverTargetOrPopup&&this.open()},Number(this.hoverDelay)*1e3):this.open())},onMouseleave(e){this.pointerOverTargetOrPopup=!1,this.hoverTimer&&(clearTimeout(this.hoverTimer),this.hoverTimer=null),this.trigger==="hover"&&(this.leaveTimer&&clearTimeout(this.leaveTimer),this.leaveDelay?this.leaveTimer=setTimeout(()=>{this.pointerOverTargetOrPopup||this.close()},Number(this.leaveDelay)*1e3):this.pointerOverTargetOrPopup||this.close())}}},cl={ref:"reference"},pl={class:"rounded-lg border border-gray-100 bg-white shadow-xl"};function fl(e,t,o,n,s,r){return u(),c("div",cl,[a("div",{ref:"target",class:fe(["flex",e.$attrs.class]),onClick:t[0]||(t[0]=(...d)=>r.updatePosition&&r.updatePosition(...d)),onFocusin:t[1]||(t[1]=(...d)=>r.updatePosition&&r.updatePosition(...d)),onKeydown:t[2]||(t[2]=(...d)=>r.updatePosition&&r.updatePosition(...d)),onMouseover:t[3]||(t[3]=(...d)=>r.onMouseover&&r.onMouseover(...d)),onMouseleave:t[4]||(t[4]=(...d)=>r.onMouseleave&&r.onMouseleave(...d))},[Le(e.$slots,"target",Ft(Et({togglePopover:r.togglePopover,updatePosition:r.updatePosition,open:r.open,close:r.close,isOpen:r.isOpen})))],34),(u(),Ce(hn,{to:"#frappeui-popper-root"},[a("div",{ref:"popover",class:fe(["relative z-[100]",[s.popoverContainerClass,o.popoverClass]]),style:lt({minWidth:s.targetWidth?s.targetWidth+"px":null}),onMouseover:t[5]||(t[5]=d=>s.pointerOverTargetOrPopup=!0),onMouseleave:t[6]||(t[6]=(...d)=>r.onMouseleave&&r.onMouseleave(...d))},[ce(Ps,Ft(Et(r.popupTransition)),{default:be(()=>[Ve(a("div",null,[Le(e.$slots,"body",Ft(Et({togglePopover:r.togglePopover,updatePosition:r.updatePosition,open:r.open,close:r.close,isOpen:r.isOpen})),()=>[a("div",pl,[Le(e.$slots,"body-main",Ft(Et({togglePopover:r.togglePopover,updatePosition:r.updatePosition,open:r.open,close:r.close,isOpen:r.isOpen})))])])],512),[[ho,r.isOpen]])]),_:3},16)],38)]))],512)}const Qr=_e(ul,[["render",fl]]),vl={name:"Autocomplete",props:{options:{type:Array,default:()=>[]},modelValue:{type:[String,Object,Array]},placeholder:{type:String},bodyClasses:{type:[String,Array,Object]},multiple:{type:Boolean,default:!1},hideSearch:{type:Boolean,default:!1}},emits:["update:modelValue","update:query","change"],components:{Popover:Qr,Button:st,FeatherIcon:Ls,Combobox:Za,ComboboxInput:ti,ComboboxOptions:oi,ComboboxOption:ni,ComboboxButton:ei},expose:["togglePopover","rootRef"],data(){return{query:"",showOptions:!1}},computed:{selectedValue:{get(){var e,t;return this.multiple?ro((e=this.modelValue)==null?void 0:e[0])==="value"?(t=this.modelValue)==null?void 0:t.map(o=>this.findOption(o)):this.modelValue:this.findOption(this.modelValue)},set(e){if(this.query="",e&&!this.multiple&&(this.showOptions=!1),!this.multiple){this.$emit("update:modelValue",e);return}this.$emit("update:modelValue",e)}},groups(){var t;return!this.options||this.options.length==0?[]:((t=this.options[0])!=null&&t.group?this.options:[{group:"",items:this.sanitizeOptions(this.options)}]).map((o,n)=>({key:n,group:o.group,hideLabel:o.hideLabel||!1,items:this.filterOptions(this.sanitizeOptions(o.items))})).filter(o=>o.items.length>0)},allOptions(){return this.groups.flatMap(e=>e.items)},areAllOptionsSelected(){var e;return this.multiple?this.allOptions.length===((e=this.selectedValue)==null?void 0:e.length):!1}},watch:{query(e){this.$emit("update:query",e)},showOptions(e){e&&it(()=>{var t,o;return(o=(t=this.$refs.searchInput)==null?void 0:t.$el)==null?void 0:o.focus()})}},methods:{rootRef(){return this.$refs.rootRef},togglePopover(e){this.showOptions=e!=null?e:!this.showOptions},findOption(e){if(!e)return e;const t=ro(e)==="value"?e:e.value;return this.allOptions.find(o=>o.value===t)},filterOptions(e){return this.query?e.filter(t=>t.label.toLowerCase().includes(this.query.trim().toLowerCase())||t.value.toLowerCase().includes(this.query.trim().toLowerCase())):e},displayValue(e){return e?this.multiple?Array.isArray(e)?e.map(t=>this.getLabel(this.findOption(t))).join(", "):"":this.getLabel(this.findOption(e)):""},getLabel(e){return ro(e)==="value"?e:(e==null?void 0:e.label)||(e==null?void 0:e.value)||"No label"},sanitizeOptions(e){return e?e.map(t=>ro(t)==="option"?t:{label:t,value:t}):[]},isOptionSelected(e){var o,n;if(!this.selectedValue)return!1;const t=ro(e)==="value"?e:e.value;return this.multiple?(n=this.selectedValue)==null?void 0:n.find(s=>s&&s.value===t):((o=this.selectedValue)==null?void 0:o.value)===t},selectAll(){this.selectedValue=this.allOptions},clearAll(){this.selectedValue=[]}}};function ro(e){return typeof e=="object"?"option":"value"}const ml={class:"w-full"},hl=["onClick"],gl={class:"flex items-center overflow-hidden"},yl={key:0,class:"truncate text-base leading-5"},bl={key:1,class:"text-base leading-5 text-gray-500"},wl={key:0,class:"sticky top-0 z-10 flex items-stretch space-x-1.5 bg-white py-1.5"},xl={class:"relative w-full"},_l={key:0,class:"sticky top-10 truncate bg-white px-2.5 py-1.5 text-sm font-medium text-gray-600"},kl={class:"flex flex-1 gap-2 overflow-hidden"},$l={key:0,class:"flex-shrink-0"},Cl={key:1,class:"h-4 w-4"},Ol={class:"flex-1 truncate"},Fl={key:0,class:"ml-2 flex-shrink-0"},Al={key:0,class:"text-sm text-gray-600"},Tl={key:1,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"},Sl={key:0,class:"border-t p-1"},El={key:0,class:"flex items-center justify-end"};function Dl(e,t,o,n,s,r){const d=qe("FeatherIcon"),l=qe("ComboboxInput"),i=qe("ComboboxOption"),v=qe("ComboboxOptions"),p=qe("Button"),k=qe("Popover"),_=qe("Combobox");return u(),Ce(_,{modelValue:r.selectedValue,"onUpdate:modelValue":t[3]||(t[3]=w=>r.selectedValue=w),multiple:o.multiple,nullable:""},{default:be(({open:w})=>[ce(k,{class:"w-full",show:s.showOptions,"onUpdate:show":t[2]||(t[2]=y=>s.showOptions=y),ref:"rootRef"},{target:be(({open:y,togglePopover:F})=>[Le(e.$slots,"target",Ft(Et({open:y,togglePopover:F})),()=>[a("div",ml,[a("button",{class:fe(["flex h-7 w-full items-center justify-between gap-2 rounded bg-gray-100 px-2 py-1 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",{"bg-gray-200":w}]),onClick:()=>F()},[a("div",gl,[Le(e.$slots,"prefix"),r.selectedValue?(u(),c("span",yl,E(r.displayValue(r.selectedValue)),1)):(u(),c("span",bl,E(o.placeholder||""),1))]),ce(d,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"})],10,hl)])])]),body:be(({isOpen:y,togglePopover:F})=>[Ve(a("div",null,[a("div",{class:fe(["relative mt-1 rounded-lg bg-white text-base shadow-2xl",o.bodyClasses])},[ce(v,{class:fe(["max-h-[15rem] overflow-y-auto px-1.5 pb-1.5",{"pt-1.5":o.hideSearch}]),static:""},{default:be(()=>[o.hideSearch?Y("",!0):(u(),c("div",wl,[a("div",xl,[ce(l,{ref:"searchInput",class:"form-input w-full",type:"text",onChange:t[0]||(t[0]=A=>{s.query=A.target.value}),value:s.query,autocomplete:"off",placeholder:"Search"},null,8,["value"]),a("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:t[1]||(t[1]=A=>r.selectedValue=null)},[ce(d,{name:"x",class:"w-4"})])])])),(u(!0),c(ae,null,xe(r.groups,A=>Ve((u(),c("div",{key:A.key},[A.group&&!A.hideLabel?(u(),c("div",_l,E(A.group),1)):Y("",!0),(u(!0),c(ae,null,xe(A.items.slice(0,50),(T,B)=>(u(),Ce(i,{as:"template",key:(T==null?void 0:T.value)||B,value:T},{default:be(({active:N,selected:m})=>[a("li",{class:fe(["flex cursor-pointer items-center justify-between rounded px-2.5 py-1.5 text-base",{"bg-gray-100":N}])},[a("div",kl,[e.$slots["item-prefix"]||e.$props.multiple?(u(),c("div",$l,[Le(e.$slots,"item-prefix",ot({ref_for:!0},{active:N,selected:m,option:T}),()=>[r.isOptionSelected(T)?(u(),Ce(d,{key:0,name:"check",class:"h-4 w-4 text-gray-700"})):(u(),c("div",Cl))])])):Y("",!0),a("span",Ol,E(r.getLabel(T)),1)]),e.$slots["item-suffix"]||T!=null&&T.description?(u(),c("div",Fl,[Le(e.$slots,"item-suffix",ot({ref_for:!0},{active:N,selected:m,option:T}),()=>[T!=null&&T.description?(u(),c("div",Al,E(T.description),1)):Y("",!0)])])):Y("",!0)],2)]),_:2},1032,["value"]))),128))])),[[ho,A.items.length>0]])),128)),r.groups.length==0?(u(),c("li",Tl," No results found ")):Y("",!0)]),_:3},8,["class"]),e.$slots.footer||o.multiple?(u(),c("div",Sl,[Le(e.$slots,"footer",Ft(Et({togglePopover:F})),()=>[o.multiple?(u(),c("div",El,[r.areAllOptionsSelected?Y("",!0):(u(),Ce(p,{key:0,label:"Select All",onClick:At(r.selectAll,["stop"])},null,8,["onClick"])),r.areAllOptionsSelected?(u(),Ce(p,{key:1,label:"Clear All",onClick:At(r.clearAll,["stop"])},null,8,["onClick"])):Y("",!0)])):Y("",!0)])])):Y("",!0)],2)],512),[[ho,y]])]),_:2},1032,["show"])]),_:3},8,["modelValue","multiple"])}const Zr=_e(vl,[["render",Dl]]);let jl=0;function Pl(){return++jl}function es(){return"frappe-ui-"+Pl()}const Ll=["disabled","id","checked"],Ml=["for"],Rl=Ze({__name:"Checkbox",props:{size:{default:"sm"},label:{},checked:{type:Boolean},disabled:{type:Boolean},padding:{type:Boolean,default:!1},modelValue:{type:[Boolean,Number]},id:{}},setup(e){var d;const t=e,o=ko(),n=(d=t.id)!=null?d:es(),s=ne(()=>[{sm:"text-base font-medium",md:"text-lg font-medium"}[t.size],t.disabled?"text-gray-500":"text-gray-800","select-none"]),r=ne(()=>{let l=t.disabled?"border-gray-300 bg-gray-50 text-gray-400":"border-gray-500 text-gray-900 hover:border-gray-600 focus:ring-offset-0 focus:border-gray-900 active:border-gray-700 transition",i=t.disabled?"":t.padding?"focus:ring-0":"hover:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400 active:bg-gray-100",v={sm:"w-3.5 h-3.5",md:"w-4 h-4"}[t.size];return[l,i,v]});return(l,i)=>(u(),c("div",{class:fe(["inline-flex items-center space-x-2 rounded transition",{"px-2.5 py-1.5":l.padding&&l.size==="sm","px-3 py-2":l.padding&&l.size==="md","focus-within:bg-gray-100 focus-within:ring-2 focus-within:ring-gray-400 hover:bg-gray-200 active:bg-gray-300":l.padding&&!l.disabled}])},[a("input",ot({class:["rounded-sm",r.value],type:"checkbox",disabled:l.disabled,id:le(n),checked:!!l.modelValue,onChange:i[0]||(i[0]=v=>l.$emit("update:modelValue",v.target.checked))},le(o)),null,16,Ll),l.label?(u(),c("label",{key:0,class:fe(["block",s.value]),for:le(n)},E(l.label),11,Ml)):Y("",!0)],2))}}),Hl={class:"relative flex items-center"},Bl=["type","placeholder","disabled","id","value"],ts=Ze({__name:"TextInput",props:{type:{default:"text"},size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{}},emits:["update:modelValue"],setup(e,{expose:t,emit:o}){const n=e,s=o,r=kr(),d=ko(),l=L(null);t({el:l});const i=ne(()=>n.disabled?"text-gray-600":"text-gray-800"),v=ne(()=>{let y={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[n.size],F={sm:["py-1.5",r.prefix?"pl-8":"pl-2",r.suffix?"pr-8":"pr-2"],md:["py-1.5",r.prefix?"pl-9":"pl-2.5",r.suffix?"pr-9":"pr-2.5"],lg:["py-1.5",r.prefix?"pl-10":"pl-3",r.suffix?"pr-10":"pr-3"],xl:["py-1.5",r.prefix?"pl-10":"pl-3",r.suffix?"pr-10":"pr-3"]}[n.size],A=n.disabled?"disabled":n.variant,T={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",n.variant==="outline"?"border-gray-300":"border-transparent"]}[A];return[y,F,T,i.value,"transition-colors w-full"]});let p=ne(()=>({sm:"pl-2",md:"pl-2.5",lg:"pl-3",xl:"pl-3"})[n.size]),k=ne(()=>({sm:"pr-2",md:"pr-2.5",lg:"pr-3",xl:"pr-3"})[n.size]),_=y=>{s("update:modelValue",y)};n.debounce&&(_=$r(_,n.debounce));let w=y=>{_(y.target.value)};return(y,F)=>(u(),c("div",Hl,[y.$slots.prefix?(u(),c("div",{key:0,class:fe(["absolute inset-y-0 left-0 flex items-center",i.value,le(p)])},[Le(y.$slots,"prefix")],2)):Y("",!0),a("input",ot({ref_key:"inputRef",ref:l,type:y.type,placeholder:y.placeholder,class:v.value,disabled:y.disabled,id:y.id,value:y.modelValue,onInput:F[0]||(F[0]=(...A)=>le(w)&&le(w)(...A)),onChange:F[1]||(F[1]=(...A)=>le(w)&&le(w)(...A))},le(d)),null,16,Bl),y.$slots.suffix?(u(),c("div",{key:1,class:fe(["absolute inset-y-0 right-0 flex items-center",i.value,le(k)])},[Le(y.$slots,"suffix")],2)):Y("",!0)]))}});class Il{constructor(){this.listeners={},this.failed=!1}on(t,o){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(o)}trigger(t,o){(this.listeners[t]||[]).forEach(s=>{s.call(this,o)})}upload(t,o){return new Promise((n,s)=>{let r=new XMLHttpRequest;r.upload.addEventListener("loadstart",()=>{this.trigger("start")}),r.upload.addEventListener("progress",i=>{i.lengthComputable&&this.trigger("progress",{uploaded:i.loaded,total:i.total})}),r.upload.addEventListener("load",()=>{this.trigger("finish")}),r.addEventListener("error",()=>{this.trigger("error"),s()}),r.onreadystatechange=()=>{if(r.readyState==XMLHttpRequest.DONE){let i;if(r.status===200){let v=null;try{v=JSON.parse(r.responseText)}catch(k){v=r.responseText}let p=v.message||v;n(p)}else if(r.status===403)i=JSON.parse(r.responseText);else{this.failed=!0;try{i=JSON.parse(r.responseText)}catch(v){}}i&&i.exc&&console.error(JSON.parse(i.exc)[0]),s(i)}};const d=o.upload_endpoint||"/api/method/upload_file";r.open("POST",d,!0),r.setRequestHeader("Accept","application/json"),window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&r.setRequestHeader("X-Frappe-CSRF-Token",window.csrf_token);let l=new FormData;t&&l.append("file",t,t.name),l.append("is_private",o.private?"1":"0"),l.append("folder",o.folder||"Home"),o.file_url&&l.append("file_url",o.file_url),o.doctype&&l.append("doctype",o.doctype),o.docname&&l.append("docname",o.docname),o.fieldname&&l.append("fieldname",o.fieldname),o.method&&l.append("method",o.method),o.type&&l.append("type",o.type),r.send(l)})}}const Vl={name:"FileUploader",props:{fileTypes:{type:[String,Array]},uploadArgs:{type:Object},validateFile:{type:Function,default:null}},data(){return{uploader:null,uploading:!1,uploaded:0,error:null,message:"",total:0,file:null,finishedUploading:!1}},computed:{progress(){let e=Math.floor(this.uploaded/this.total*100);return isNaN(e)?0:e},success(){return this.finishedUploading&&!this.error}},methods:{inputRef(){return this.$refs.input},openFileSelector(){this.$refs.input.click()},onFileAdd(e){return te(this,null,function*(){if(this.error=null,this.file=e.target.files[0],this.file&&this.validateFile)try{let t=yield this.validateFile(this.file);t&&(this.error=t)}catch(t){this.error=t}this.error||this.uploadFile(this.file)})},uploadFile(e){return te(this,null,function*(){this.error=null,this.uploaded=0,this.total=0,this.uploader=new Il,this.uploader.on("start",()=>{this.uploading=!0}),this.uploader.on("progress",t=>{this.uploaded=t.uploaded,this.total=t.total}),this.uploader.on("error",()=>{this.uploading=!1,this.error="Error Uploading File"}),this.uploader.on("finish",()=>{this.uploading=!1,this.finishedUploading=!0}),this.uploader.upload(e,this.uploadArgs||{}).then(t=>{this.$emit("success",t)}).catch(t=>{this.uploading=!1;let o="Error Uploading File";t!=null&&t._server_messages?o=JSON.parse(JSON.parse(t._server_messages)[0]).message:t!=null&&t.exc&&(o=JSON.parse(t.exc)[0].split(`
`).slice(-2,-1)[0]),this.error=o,this.$emit("failure",t)})})}},expose:["inputRef"]},Nl=["accept"];function zl(e,t,o,n,s,r){return u(),c("div",null,[a("input",{ref:"input",type:"file",accept:o.fileTypes,class:"hidden",onChange:t[0]||(t[0]=(...d)=>r.onFileAdd&&r.onFileAdd(...d))},null,40,Nl),Le(e.$slots,"default",Ft(Et({file:s.file,uploading:s.uploading,progress:r.progress,uploaded:s.uploaded,message:s.message,error:s.error,total:s.total,success:r.success,openFileSelector:r.openFileSelector})))])}const Ul=_e(Vl,[["render",zl]]),ql={class:"relative flex items-center"},Wl=["disabled","id","value"],Jl=["value","disabled","selected"],Kl=Ze({inheritAttrs:!1,__name:"Select",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},options:{}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=t;kr();const s=ko();function r(_){n("update:modelValue",_.target.value)}const d=ne(()=>{var _;return((_=o.options)==null?void 0:_.map(w=>typeof w=="string"?{label:w,value:w}:w).filter(Boolean))||[]}),l=ne(()=>o.disabled?"text-gray-500":"text-gray-800"),i=ne(()=>({sm:"text-base",md:"text-base",lg:"text-lg",xl:"text-xl"})[o.size]),v=ne(()=>({sm:"px-2",md:"px-2.5",lg:"px-3",xl:"px-3"})[o.size]),p=ne(()=>{let _={sm:"rounded h-7",md:"rounded h-8",lg:"rounded-md h-10",xl:"rounded-md h-10"}[o.size],w=o.disabled?"disabled":o.variant,y={subtle:"border border-gray-100 bg-gray-100 hover:border-gray-200 hover:bg-gray-200 focus:border-gray-500 focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white hover:border-gray-400 focus:border-gray-500 focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",ghost:"bg-transparent border-transparent hover:bg-gray-200 focus:bg-gray-200 focus:border-gray-500 focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border",o.variant!=="ghost"?"bg-gray-50":"",o.variant==="outline"?"border-gray-300":"border-transparent"]}[w];return[_,i.value,v.value,y,l.value,"transition-colors w-full py-0"]});let k=ne(()=>({sm:"pl-2",md:"pl-2.5",lg:"pl-3",xl:"pl-3"})[o.size]);return(_,w)=>(u(),c("div",ql,[_.$slots.prefix?(u(),c("div",{key:0,class:fe(["absolute inset-y-0 left-0 flex items-center",l.value,le(k)])},[Le(_.$slots,"prefix")],2)):Y("",!0),_.placeholder?Ve((u(),c("div",{key:1,class:fe(["pointer-events-none absolute text-gray-500",[i.value,v.value]])},E(_.placeholder),3)),[[ho,!_.modelValue]]):Y("",!0),a("select",ot({class:p.value,disabled:_.disabled,id:_.id,value:_.modelValue,onChange:r},le(s)),[(u(!0),c(ae,null,xe(d.value,y=>(u(),c("option",{key:y.value,value:y.value,disabled:y.disabled||!1,selected:_.modelValue===y.value},E(y.label),9,Jl))),128))],16,Wl)]))}}),Yl={class:"space-y-1.5"},Xl=["for"],Gl=["placeholder","disabled","id","value","rows"],Ql=Ze({__name:"Textarea",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{},rows:{default:3},label:{}},emits:["update:modelValue"],setup(e,{expose:t,emit:o}){const n=e,s=o,r=ko(),d=L(null),l=ne(()=>{let k={sm:"text-base rounded",md:"text-base rounded",lg:"text-lg rounded-md",xl:"text-xl rounded-md"}[n.size],_={sm:["py-1.5 px-2"],md:["py-1.5 px-2.5"],lg:["py-1.5 px-3"],xl:["py-1.5 px-3"]}[n.size],w=n.disabled?"disabled":n.variant,y={subtle:"border border-gray-100 bg-gray-100 placeholder-gray-500 hover:border-gray-200 hover:bg-gray-200 focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",outline:"border border-gray-300 bg-white placeholder-gray-500 hover:border-gray-400 hover:shadow-sm focus:bg-white focus:border-gray-500 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",disabled:["border bg-gray-50 placeholder-gray-400",n.variant==="outline"?"border-gray-300":"border-transparent"]}[w];return[k,_,y,n.disabled?"text-gray-600":"text-gray-800","transition-colors w-full block"]}),i=ne(()=>[{sm:"text-xs",md:"text-base",lg:"text-lg",xl:"text-xl"}[n.size],"text-gray-600"]);let v=k=>{s("update:modelValue",k)};n.debounce&&(v=$r(v,n.debounce));let p=k=>{v(k.target.value)};return t({el:d}),(k,_)=>(u(),c("div",Yl,[k.label?(u(),c("label",{key:0,class:fe(["block",i.value]),for:k.id},E(k.label),11,Xl)):Y("",!0),a("textarea",ot({ref_key:"textareaRef",ref:d,placeholder:k.placeholder,class:l.value,disabled:k.disabled,id:k.id,value:k.modelValue,rows:k.rows,onInput:_[0]||(_[0]=(...w)=>le(p)&&le(p)(...w)),onChange:_[1]||(_[1]=(...w)=>le(p)&&le(p)(...w))},le(r)),null,16,Gl)]))}}),Zl=["for"],ed={key:0,class:"text-red-500"},td={inheritAttrs:!1},tt=Ze(We(ge({},td),{__name:"FormControl",props:{label:{},description:{},type:{default:"text"},size:{default:"sm"},required:{type:Boolean}},setup(e){const t=es(),o=e,n=ko(),s=ne(()=>{let l={};for(let i in n)i!=="class"&&i!=="style"&&(l[i]=n[i]);return l}),r=ne(()=>[{sm:"text-xs",md:"text-base"}[o.size],"text-gray-600"]),d=ne(()=>[{sm:"text-xs",md:"text-base"}[o.size],"text-gray-600"]);return(l,i)=>l.type!="checkbox"?(u(),c("div",{key:0,class:fe(["space-y-1.5",le(n).class])},[l.label?(u(),c("label",{key:0,class:fe(["block",r.value]),for:le(t)},[pe(E(l.label)+" ",1),l.required?(u(),c("span",ed,"*")):Y("",!0)],10,Zl)):Y("",!0),l.type==="select"?(u(),Ce(Kl,ot({key:1,id:le(t)},We(ge({},s.value),{size:l.size})),Zo({_:2},[l.$slots.prefix?{name:"prefix",fn:be(()=>[Le(l.$slots,"prefix")]),key:"0"}:void 0]),1040,["id"])):l.type==="autocomplete"?(u(),Ce(Zr,Ft(ot({key:2},ge({},s.value))),Zo({_:2},[l.$slots.prefix?{name:"prefix",fn:be(()=>[Le(l.$slots,"prefix")]),key:"0"}:void 0,l.$slots["item-prefix"]?{name:"item-prefix",fn:be(v=>[Le(l.$slots,"item-prefix",Ft(Et(v)))]),key:"1"}:void 0]),1040)):l.type==="textarea"?(u(),Ce(Ql,ot({key:3,id:le(t)},We(ge({},s.value),{size:l.size})),null,16,["id"])):(u(),Ce(ts,ot({key:4,id:le(t)},We(ge({},s.value),{type:l.type,size:l.size})),Zo({_:2},[l.$slots.prefix?{name:"prefix",fn:be(()=>[Le(l.$slots,"prefix")]),key:"0"}:void 0,l.$slots.suffix?{name:"suffix",fn:be(()=>[Le(l.$slots,"suffix")]),key:"1"}:void 0]),1040,["id"])),Le(l.$slots,"description",{},()=>[l.description?(u(),c("p",{key:0,class:fe(d.value)},E(l.description),3)):Y("",!0)])],2)):(u(),Ce(Rl,ot({key:1,id:le(t)},We(ge({},s.value),{label:l.label,size:l.size,class:le(n).class})),null,16,["id"]))}}));var Xe="top",vt="bottom",mt="right",Ge="left",Fn="auto",Ao=[Xe,vt,mt,Ge],Xt="start",xo="end",od="clippingParents",os="viewport",so="popper",nd="reference",er=Ao.reduce(function(e,t){return e.concat([t+"-"+Xt,t+"-"+xo])},[]),ns=[].concat(Ao,[Fn]).reduce(function(e,t){return e.concat([t,t+"-"+Xt,t+"-"+xo])},[]),rd="beforeRead",sd="read",ad="afterRead",id="beforeMain",ld="main",dd="afterMain",ud="beforeWrite",cd="write",pd="afterWrite",fd=[rd,sd,ad,id,ld,dd,ud,cd,pd];function Ct(e){return e?(e.nodeName||"").toLowerCase():null}function nt(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Vt(e){var t=nt(e).Element;return e instanceof t||e instanceof Element}function ut(e){var t=nt(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function An(e){if(typeof ShadowRoot=="undefined")return!1;var t=nt(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function vd(e){var t=e.state;Object.keys(t.elements).forEach(function(o){var n=t.styles[o]||{},s=t.attributes[o]||{},r=t.elements[o];!ut(r)||!Ct(r)||(Object.assign(r.style,n),Object.keys(s).forEach(function(d){var l=s[d];l===!1?r.removeAttribute(d):r.setAttribute(d,l===!0?"":l)}))})}function md(e){var t=e.state,o={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,o.popper),t.styles=o,t.elements.arrow&&Object.assign(t.elements.arrow.style,o.arrow),function(){Object.keys(t.elements).forEach(function(n){var s=t.elements[n],r=t.attributes[n]||{},d=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:o[n]),l=d.reduce(function(i,v){return i[v]="",i},{});!ut(s)||!Ct(s)||(Object.assign(s.style,l),Object.keys(r).forEach(function(i){s.removeAttribute(i)}))})}}const rs={name:"applyStyles",enabled:!0,phase:"write",fn:vd,effect:md,requires:["computeStyles"]};function kt(e){return e.split("-")[0]}var It=Math.max,No=Math.min,Gt=Math.round;function ln(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function ss(){return!/^((?!chrome|android).)*safari/i.test(ln())}function Qt(e,t,o){t===void 0&&(t=!1),o===void 0&&(o=!1);var n=e.getBoundingClientRect(),s=1,r=1;t&&ut(e)&&(s=e.offsetWidth>0&&Gt(n.width)/e.offsetWidth||1,r=e.offsetHeight>0&&Gt(n.height)/e.offsetHeight||1);var d=Vt(e)?nt(e):window,l=d.visualViewport,i=!ss()&&o,v=(n.left+(i&&l?l.offsetLeft:0))/s,p=(n.top+(i&&l?l.offsetTop:0))/r,k=n.width/s,_=n.height/r;return{width:k,height:_,top:p,right:v+k,bottom:p+_,left:v,x:v,y:p}}function Tn(e){var t=Qt(e),o=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-o)<=1&&(o=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:n}}function as(e,t){var o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(o&&An(o)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function St(e){return nt(e).getComputedStyle(e)}function hd(e){return["table","td","th"].indexOf(Ct(e))>=0}function Mt(e){return((Vt(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ko(e){return Ct(e)==="html"?e:e.assignedSlot||e.parentNode||(An(e)?e.host:null)||Mt(e)}function tr(e){return!ut(e)||St(e).position==="fixed"?null:e.offsetParent}function gd(e){var t=/firefox/i.test(ln()),o=/Trident/i.test(ln());if(o&&ut(e)){var n=St(e);if(n.position==="fixed")return null}var s=Ko(e);for(An(s)&&(s=s.host);ut(s)&&["html","body"].indexOf(Ct(s))<0;){var r=St(s);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||t&&r.willChange==="filter"||t&&r.filter&&r.filter!=="none")return s;s=s.parentNode}return null}function To(e){for(var t=nt(e),o=tr(e);o&&hd(o)&&St(o).position==="static";)o=tr(o);return o&&(Ct(o)==="html"||Ct(o)==="body"&&St(o).position==="static")?t:o||gd(e)||t}function Sn(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function po(e,t,o){return It(e,No(t,o))}function yd(e,t,o){var n=po(e,t,o);return n>o?o:n}function is(){return{top:0,right:0,bottom:0,left:0}}function ls(e){return Object.assign({},is(),e)}function ds(e,t){return t.reduce(function(o,n){return o[n]=e,o},{})}var bd=function(t,o){return t=typeof t=="function"?t(Object.assign({},o.rects,{placement:o.placement})):t,ls(typeof t!="number"?t:ds(t,Ao))};function wd(e){var t,o=e.state,n=e.name,s=e.options,r=o.elements.arrow,d=o.modifiersData.popperOffsets,l=kt(o.placement),i=Sn(l),v=[Ge,mt].indexOf(l)>=0,p=v?"height":"width";if(!(!r||!d)){var k=bd(s.padding,o),_=Tn(r),w=i==="y"?Xe:Ge,y=i==="y"?vt:mt,F=o.rects.reference[p]+o.rects.reference[i]-d[i]-o.rects.popper[p],A=d[i]-o.rects.reference[i],T=To(r),B=T?i==="y"?T.clientHeight||0:T.clientWidth||0:0,N=F/2-A/2,m=k[w],P=B-_[p]-k[y],f=B/2-_[p]/2+N,D=po(m,f,P),X=i;o.modifiersData[n]=(t={},t[X]=D,t.centerOffset=D-f,t)}}function xd(e){var t=e.state,o=e.options,n=o.element,s=n===void 0?"[data-popper-arrow]":n;s!=null&&(typeof s=="string"&&(s=t.elements.popper.querySelector(s),!s)||as(t.elements.popper,s)&&(t.elements.arrow=s))}const _d={name:"arrow",enabled:!0,phase:"main",fn:wd,effect:xd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Zt(e){return e.split("-")[1]}var kd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $d(e,t){var o=e.x,n=e.y,s=t.devicePixelRatio||1;return{x:Gt(o*s)/s||0,y:Gt(n*s)/s||0}}function or(e){var t,o=e.popper,n=e.popperRect,s=e.placement,r=e.variation,d=e.offsets,l=e.position,i=e.gpuAcceleration,v=e.adaptive,p=e.roundOffsets,k=e.isFixed,_=d.x,w=_===void 0?0:_,y=d.y,F=y===void 0?0:y,A=typeof p=="function"?p({x:w,y:F}):{x:w,y:F};w=A.x,F=A.y;var T=d.hasOwnProperty("x"),B=d.hasOwnProperty("y"),N=Ge,m=Xe,P=window;if(v){var f=To(o),D="clientHeight",X="clientWidth";if(f===nt(o)&&(f=Mt(o),St(f).position!=="static"&&l==="absolute"&&(D="scrollHeight",X="scrollWidth")),f=f,s===Xe||(s===Ge||s===mt)&&r===xo){m=vt;var U=k&&f===P&&P.visualViewport?P.visualViewport.height:f[D];F-=U-n.height,F*=i?1:-1}if(s===Ge||(s===Xe||s===vt)&&r===xo){N=mt;var R=k&&f===P&&P.visualViewport?P.visualViewport.width:f[X];w-=R-n.width,w*=i?1:-1}}var O=Object.assign({position:l},v&&kd),C=p===!0?$d({x:w,y:F},nt(o)):{x:w,y:F};if(w=C.x,F=C.y,i){var j;return Object.assign({},O,(j={},j[m]=B?"0":"",j[N]=T?"0":"",j.transform=(P.devicePixelRatio||1)<=1?"translate("+w+"px, "+F+"px)":"translate3d("+w+"px, "+F+"px, 0)",j))}return Object.assign({},O,(t={},t[m]=B?F+"px":"",t[N]=T?w+"px":"",t.transform="",t))}function Cd(e){var t=e.state,o=e.options,n=o.gpuAcceleration,s=n===void 0?!0:n,r=o.adaptive,d=r===void 0?!0:r,l=o.roundOffsets,i=l===void 0?!0:l,v={placement:kt(t.placement),variation:Zt(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,or(Object.assign({},v,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:d,roundOffsets:i})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,or(Object.assign({},v,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:i})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const Od={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Cd,data:{}};var Ro={passive:!0};function Fd(e){var t=e.state,o=e.instance,n=e.options,s=n.scroll,r=s===void 0?!0:s,d=n.resize,l=d===void 0?!0:d,i=nt(t.elements.popper),v=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&v.forEach(function(p){p.addEventListener("scroll",o.update,Ro)}),l&&i.addEventListener("resize",o.update,Ro),function(){r&&v.forEach(function(p){p.removeEventListener("scroll",o.update,Ro)}),l&&i.removeEventListener("resize",o.update,Ro)}}const Ad={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Fd,data:{}};var Td={left:"right",right:"left",bottom:"top",top:"bottom"};function Io(e){return e.replace(/left|right|bottom|top/g,function(t){return Td[t]})}var Sd={start:"end",end:"start"};function nr(e){return e.replace(/start|end/g,function(t){return Sd[t]})}function En(e){var t=nt(e),o=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:o,scrollTop:n}}function Dn(e){return Qt(Mt(e)).left+En(e).scrollLeft}function Ed(e,t){var o=nt(e),n=Mt(e),s=o.visualViewport,r=n.clientWidth,d=n.clientHeight,l=0,i=0;if(s){r=s.width,d=s.height;var v=ss();(v||!v&&t==="fixed")&&(l=s.offsetLeft,i=s.offsetTop)}return{width:r,height:d,x:l+Dn(e),y:i}}function Dd(e){var t,o=Mt(e),n=En(e),s=(t=e.ownerDocument)==null?void 0:t.body,r=It(o.scrollWidth,o.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),d=It(o.scrollHeight,o.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),l=-n.scrollLeft+Dn(e),i=-n.scrollTop;return St(s||o).direction==="rtl"&&(l+=It(o.clientWidth,s?s.clientWidth:0)-r),{width:r,height:d,x:l,y:i}}function jn(e){var t=St(e),o=t.overflow,n=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(o+s+n)}function us(e){return["html","body","#document"].indexOf(Ct(e))>=0?e.ownerDocument.body:ut(e)&&jn(e)?e:us(Ko(e))}function fo(e,t){var o;t===void 0&&(t=[]);var n=us(e),s=n===((o=e.ownerDocument)==null?void 0:o.body),r=nt(n),d=s?[r].concat(r.visualViewport||[],jn(n)?n:[]):n,l=t.concat(d);return s?l:l.concat(fo(Ko(d)))}function dn(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function jd(e,t){var o=Qt(e,!1,t==="fixed");return o.top=o.top+e.clientTop,o.left=o.left+e.clientLeft,o.bottom=o.top+e.clientHeight,o.right=o.left+e.clientWidth,o.width=e.clientWidth,o.height=e.clientHeight,o.x=o.left,o.y=o.top,o}function rr(e,t,o){return t===os?dn(Ed(e,o)):Vt(t)?jd(t,o):dn(Dd(Mt(e)))}function Pd(e){var t=fo(Ko(e)),o=["absolute","fixed"].indexOf(St(e).position)>=0,n=o&&ut(e)?To(e):e;return Vt(n)?t.filter(function(s){return Vt(s)&&as(s,n)&&Ct(s)!=="body"}):[]}function Ld(e,t,o,n){var s=t==="clippingParents"?Pd(e):[].concat(t),r=[].concat(s,[o]),d=r[0],l=r.reduce(function(i,v){var p=rr(e,v,n);return i.top=It(p.top,i.top),i.right=No(p.right,i.right),i.bottom=No(p.bottom,i.bottom),i.left=It(p.left,i.left),i},rr(e,d,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function cs(e){var t=e.reference,o=e.element,n=e.placement,s=n?kt(n):null,r=n?Zt(n):null,d=t.x+t.width/2-o.width/2,l=t.y+t.height/2-o.height/2,i;switch(s){case Xe:i={x:d,y:t.y-o.height};break;case vt:i={x:d,y:t.y+t.height};break;case mt:i={x:t.x+t.width,y:l};break;case Ge:i={x:t.x-o.width,y:l};break;default:i={x:t.x,y:t.y}}var v=s?Sn(s):null;if(v!=null){var p=v==="y"?"height":"width";switch(r){case Xt:i[v]=i[v]-(t[p]/2-o[p]/2);break;case xo:i[v]=i[v]+(t[p]/2-o[p]/2);break}}return i}function _o(e,t){t===void 0&&(t={});var o=t,n=o.placement,s=n===void 0?e.placement:n,r=o.strategy,d=r===void 0?e.strategy:r,l=o.boundary,i=l===void 0?od:l,v=o.rootBoundary,p=v===void 0?os:v,k=o.elementContext,_=k===void 0?so:k,w=o.altBoundary,y=w===void 0?!1:w,F=o.padding,A=F===void 0?0:F,T=ls(typeof A!="number"?A:ds(A,Ao)),B=_===so?nd:so,N=e.rects.popper,m=e.elements[y?B:_],P=Ld(Vt(m)?m:m.contextElement||Mt(e.elements.popper),i,p,d),f=Qt(e.elements.reference),D=cs({reference:f,element:N,strategy:"absolute",placement:s}),X=dn(Object.assign({},N,D)),U=_===so?X:f,R={top:P.top-U.top+T.top,bottom:U.bottom-P.bottom+T.bottom,left:P.left-U.left+T.left,right:U.right-P.right+T.right},O=e.modifiersData.offset;if(_===so&&O){var C=O[s];Object.keys(R).forEach(function(j){var Q=[mt,vt].indexOf(j)>=0?1:-1,ve=[Xe,vt].indexOf(j)>=0?"y":"x";R[j]+=C[ve]*Q})}return R}function Md(e,t){t===void 0&&(t={});var o=t,n=o.placement,s=o.boundary,r=o.rootBoundary,d=o.padding,l=o.flipVariations,i=o.allowedAutoPlacements,v=i===void 0?ns:i,p=Zt(n),k=p?l?er:er.filter(function(y){return Zt(y)===p}):Ao,_=k.filter(function(y){return v.indexOf(y)>=0});_.length===0&&(_=k);var w=_.reduce(function(y,F){return y[F]=_o(e,{placement:F,boundary:s,rootBoundary:r,padding:d})[kt(F)],y},{});return Object.keys(w).sort(function(y,F){return w[y]-w[F]})}function Rd(e){if(kt(e)===Fn)return[];var t=Io(e);return[nr(e),t,nr(t)]}function Hd(e){var t=e.state,o=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var s=o.mainAxis,r=s===void 0?!0:s,d=o.altAxis,l=d===void 0?!0:d,i=o.fallbackPlacements,v=o.padding,p=o.boundary,k=o.rootBoundary,_=o.altBoundary,w=o.flipVariations,y=w===void 0?!0:w,F=o.allowedAutoPlacements,A=t.options.placement,T=kt(A),B=T===A,N=i||(B||!y?[Io(A)]:Rd(A)),m=[A].concat(N).reduce(function(J,q){return J.concat(kt(q)===Fn?Md(t,{placement:q,boundary:p,rootBoundary:k,padding:v,flipVariations:y,allowedAutoPlacements:F}):q)},[]),P=t.rects.reference,f=t.rects.popper,D=new Map,X=!0,U=m[0],R=0;R<m.length;R++){var O=m[R],C=kt(O),j=Zt(O)===Xt,Q=[Xe,vt].indexOf(C)>=0,ve=Q?"width":"height",ue=_o(t,{placement:O,boundary:p,rootBoundary:k,altBoundary:_,padding:v}),oe=Q?j?mt:Ge:j?vt:Xe;P[ve]>f[ve]&&(oe=Io(oe));var K=Io(oe),ee=[];if(r&&ee.push(ue[C]<=0),l&&ee.push(ue[oe]<=0,ue[K]<=0),ee.every(function(J){return J})){U=O,X=!1;break}D.set(O,ee)}if(X)for(var ke=y?3:1,we=function(q){var h=m.find(function(H){var M=D.get(H);if(M)return M.slice(0,q).every(function(se){return se})});if(h)return U=h,"break"},ye=ke;ye>0;ye--){var Fe=we(ye);if(Fe==="break")break}t.placement!==U&&(t.modifiersData[n]._skip=!0,t.placement=U,t.reset=!0)}}const Bd={name:"flip",enabled:!0,phase:"main",fn:Hd,requiresIfExists:["offset"],data:{_skip:!1}};function sr(e,t,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-t.height-o.y,right:e.right-t.width+o.x,bottom:e.bottom-t.height+o.y,left:e.left-t.width-o.x}}function ar(e){return[Xe,mt,vt,Ge].some(function(t){return e[t]>=0})}function Id(e){var t=e.state,o=e.name,n=t.rects.reference,s=t.rects.popper,r=t.modifiersData.preventOverflow,d=_o(t,{elementContext:"reference"}),l=_o(t,{altBoundary:!0}),i=sr(d,n),v=sr(l,s,r),p=ar(i),k=ar(v);t.modifiersData[o]={referenceClippingOffsets:i,popperEscapeOffsets:v,isReferenceHidden:p,hasPopperEscaped:k},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":k})}const Vd={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Id};function Nd(e,t,o){var n=kt(e),s=[Ge,Xe].indexOf(n)>=0?-1:1,r=typeof o=="function"?o(Object.assign({},t,{placement:e})):o,d=r[0],l=r[1];return d=d||0,l=(l||0)*s,[Ge,mt].indexOf(n)>=0?{x:l,y:d}:{x:d,y:l}}function zd(e){var t=e.state,o=e.options,n=e.name,s=o.offset,r=s===void 0?[0,0]:s,d=ns.reduce(function(p,k){return p[k]=Nd(k,t.rects,r),p},{}),l=d[t.placement],i=l.x,v=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=i,t.modifiersData.popperOffsets.y+=v),t.modifiersData[n]=d}const Ud={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:zd};function qd(e){var t=e.state,o=e.name;t.modifiersData[o]=cs({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const Wd={name:"popperOffsets",enabled:!0,phase:"read",fn:qd,data:{}};function Jd(e){return e==="x"?"y":"x"}function Kd(e){var t=e.state,o=e.options,n=e.name,s=o.mainAxis,r=s===void 0?!0:s,d=o.altAxis,l=d===void 0?!1:d,i=o.boundary,v=o.rootBoundary,p=o.altBoundary,k=o.padding,_=o.tether,w=_===void 0?!0:_,y=o.tetherOffset,F=y===void 0?0:y,A=_o(t,{boundary:i,rootBoundary:v,padding:k,altBoundary:p}),T=kt(t.placement),B=Zt(t.placement),N=!B,m=Sn(T),P=Jd(m),f=t.modifiersData.popperOffsets,D=t.rects.reference,X=t.rects.popper,U=typeof F=="function"?F(Object.assign({},t.rects,{placement:t.placement})):F,R=typeof U=="number"?{mainAxis:U,altAxis:U}:Object.assign({mainAxis:0,altAxis:0},U),O=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,C={x:0,y:0};if(f){if(r){var j,Q=m==="y"?Xe:Ge,ve=m==="y"?vt:mt,ue=m==="y"?"height":"width",oe=f[m],K=oe+A[Q],ee=oe-A[ve],ke=w?-X[ue]/2:0,we=B===Xt?D[ue]:X[ue],ye=B===Xt?-X[ue]:-D[ue],Fe=t.elements.arrow,J=w&&Fe?Tn(Fe):{width:0,height:0},q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:is(),h=q[Q],H=q[ve],M=po(0,D[ue],J[ue]),se=N?D[ue]/2-ke-M-h-R.mainAxis:we-M-h-R.mainAxis,ie=N?-D[ue]/2+ke+M+H+R.mainAxis:ye+M+H+R.mainAxis,me=t.elements.arrow&&To(t.elements.arrow),Ae=me?m==="y"?me.clientTop||0:me.clientLeft||0:0,Me=(j=O==null?void 0:O[m])!=null?j:0,Ne=oe+se-Me-Ae,Je=oe+ie-Me,Ie=po(w?No(K,Ne):K,oe,w?It(ee,Je):ee);f[m]=Ie,C[m]=Ie-oe}if(l){var Be,he=m==="x"?Xe:Ge,Te=m==="x"?vt:mt,Ee=f[P],Se=P==="y"?"height":"width",S=Ee+A[he],g=Ee-A[Te],x=[Xe,Ge].indexOf(T)!==-1,V=(Be=O==null?void 0:O[P])!=null?Be:0,re=x?S:Ee-D[Se]-X[Se]-V+R.altAxis,de=x?Ee+D[Se]+X[Se]-V-R.altAxis:g,$e=w&&x?yd(re,Ee,de):po(w?re:S,Ee,w?de:g);f[P]=$e,C[P]=$e-Ee}t.modifiersData[n]=C}}const Yd={name:"preventOverflow",enabled:!0,phase:"main",fn:Kd,requiresIfExists:["offset"]};function Xd(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Gd(e){return e===nt(e)||!ut(e)?En(e):Xd(e)}function Qd(e){var t=e.getBoundingClientRect(),o=Gt(t.width)/e.offsetWidth||1,n=Gt(t.height)/e.offsetHeight||1;return o!==1||n!==1}function Zd(e,t,o){o===void 0&&(o=!1);var n=ut(t),s=ut(t)&&Qd(t),r=Mt(t),d=Qt(e,s,o),l={scrollLeft:0,scrollTop:0},i={x:0,y:0};return(n||!n&&!o)&&((Ct(t)!=="body"||jn(r))&&(l=Gd(t)),ut(t)?(i=Qt(t,!0),i.x+=t.clientLeft,i.y+=t.clientTop):r&&(i.x=Dn(r))),{x:d.left+l.scrollLeft-i.x,y:d.top+l.scrollTop-i.y,width:d.width,height:d.height}}function eu(e){var t=new Map,o=new Set,n=[];e.forEach(function(r){t.set(r.name,r)});function s(r){o.add(r.name);var d=[].concat(r.requires||[],r.requiresIfExists||[]);d.forEach(function(l){if(!o.has(l)){var i=t.get(l);i&&s(i)}}),n.push(r)}return e.forEach(function(r){o.has(r.name)||s(r)}),n}function tu(e){var t=eu(e);return fd.reduce(function(o,n){return o.concat(t.filter(function(s){return s.phase===n}))},[])}function ou(e){var t;return function(){return t||(t=new Promise(function(o){Promise.resolve().then(function(){t=void 0,o(e())})})),t}}function nu(e){var t=e.reduce(function(o,n){var s=o[n.name];return o[n.name]=s?Object.assign({},s,n,{options:Object.assign({},s.options,n.options),data:Object.assign({},s.data,n.data)}):n,o},{});return Object.keys(t).map(function(o){return t[o]})}var ir={placement:"bottom",modifiers:[],strategy:"absolute"};function lr(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function ru(e){e===void 0&&(e={});var t=e,o=t.defaultModifiers,n=o===void 0?[]:o,s=t.defaultOptions,r=s===void 0?ir:s;return function(l,i,v){v===void 0&&(v=r);var p={placement:"bottom",orderedModifiers:[],options:Object.assign({},ir,r),modifiersData:{},elements:{reference:l,popper:i},attributes:{},styles:{}},k=[],_=!1,w={state:p,setOptions:function(T){var B=typeof T=="function"?T(p.options):T;F(),p.options=Object.assign({},r,p.options,B),p.scrollParents={reference:Vt(l)?fo(l):l.contextElement?fo(l.contextElement):[],popper:fo(i)};var N=tu(nu([].concat(n,p.options.modifiers)));return p.orderedModifiers=N.filter(function(m){return m.enabled}),y(),w.update()},forceUpdate:function(){if(!_){var T=p.elements,B=T.reference,N=T.popper;if(lr(B,N)){p.rects={reference:Zd(B,To(N),p.options.strategy==="fixed"),popper:Tn(N)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(R){return p.modifiersData[R.name]=Object.assign({},R.data)});for(var m=0;m<p.orderedModifiers.length;m++){if(p.reset===!0){p.reset=!1,m=-1;continue}var P=p.orderedModifiers[m],f=P.fn,D=P.options,X=D===void 0?{}:D,U=P.name;typeof f=="function"&&(p=f({state:p,options:X,name:U,instance:w})||p)}}}},update:ou(function(){return new Promise(function(A){w.forceUpdate(),A(p)})}),destroy:function(){F(),_=!0}};if(!lr(l,i))return w;w.setOptions(v).then(function(A){!_&&v.onFirstUpdate&&v.onFirstUpdate(A)});function y(){p.orderedModifiers.forEach(function(A){var T=A.name,B=A.options,N=B===void 0?{}:B,m=A.effect;if(typeof m=="function"){var P=m({state:p,name:T,instance:w,options:N}),f=function(){};k.push(P||f)}})}function F(){k.forEach(function(A){return A()}),k=[]}return w}}var su=[Ad,Wd,Od,rs,Ud,Bd,Yd,_d,Vd],au=ru({defaultModifiers:su}),iu="tippy-box",ps="tippy-content",lu="tippy-backdrop",fs="tippy-arrow",vs="tippy-svg-arrow",Ht={passive:!0,capture:!0},ms=function(){return document.body};function tn(e,t,o){if(Array.isArray(e)){var n=e[t];return n==null?Array.isArray(o)?o[t]:o:n}return e}function Pn(e,t){var o={}.toString.call(e);return o.indexOf("[object")===0&&o.indexOf(t+"]")>-1}function hs(e,t){return typeof e=="function"?e.apply(void 0,t):e}function dr(e,t){if(t===0)return e;var o;return function(n){clearTimeout(o),o=setTimeout(function(){e(n)},t)}}function du(e){return e.split(/\s+/).filter(Boolean)}function Ut(e){return[].concat(e)}function ur(e,t){e.indexOf(t)===-1&&e.push(t)}function uu(e){return e.filter(function(t,o){return e.indexOf(t)===o})}function cu(e){return e.split("-")[0]}function zo(e){return[].slice.call(e)}function cr(e){return Object.keys(e).reduce(function(t,o){return e[o]!==void 0&&(t[o]=e[o]),t},{})}function vo(){return document.createElement("div")}function Yo(e){return["Element","Fragment"].some(function(t){return Pn(e,t)})}function pu(e){return Pn(e,"NodeList")}function fu(e){return Pn(e,"MouseEvent")}function vu(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function mu(e){return Yo(e)?[e]:pu(e)?zo(e):Array.isArray(e)?e:zo(document.querySelectorAll(e))}function on(e,t){e.forEach(function(o){o&&(o.style.transitionDuration=t+"ms")})}function pr(e,t){e.forEach(function(o){o&&o.setAttribute("data-state",t)})}function hu(e){var t,o=Ut(e),n=o[0];return n!=null&&(t=n.ownerDocument)!=null&&t.body?n.ownerDocument:document}function gu(e,t){var o=t.clientX,n=t.clientY;return e.every(function(s){var r=s.popperRect,d=s.popperState,l=s.props,i=l.interactiveBorder,v=cu(d.placement),p=d.modifiersData.offset;if(!p)return!0;var k=v==="bottom"?p.top.y:0,_=v==="top"?p.bottom.y:0,w=v==="right"?p.left.x:0,y=v==="left"?p.right.x:0,F=r.top-n+k>i,A=n-r.bottom-_>i,T=r.left-o+w>i,B=o-r.right-y>i;return F||A||T||B})}function nn(e,t,o){var n=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(s){e[n](s,o)})}function fr(e,t){for(var o=t;o;){var n;if(e.contains(o))return!0;o=o.getRootNode==null||(n=o.getRootNode())==null?void 0:n.host}return!1}var wt={isTouch:!1},vr=0;function yu(){wt.isTouch||(wt.isTouch=!0,window.performance&&document.addEventListener("mousemove",gs))}function gs(){var e=performance.now();e-vr<20&&(wt.isTouch=!1,document.removeEventListener("mousemove",gs)),vr=e}function bu(){var e=document.activeElement;if(vu(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function wu(){document.addEventListener("touchstart",yu,Ht),window.addEventListener("blur",bu)}var xu=typeof window!="undefined"&&typeof document!="undefined",_u=xu?!!window.msCrypto:!1,ku={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},$u={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},gt=Object.assign({appendTo:ms,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},ku,$u),Cu=Object.keys(gt),Ou=function(t){var o=Object.keys(t);o.forEach(function(n){gt[n]=t[n]})};function ys(e){var t=e.plugins||[],o=t.reduce(function(n,s){var r=s.name,d=s.defaultValue;if(r){var l;n[r]=e[r]!==void 0?e[r]:(l=gt[r])!=null?l:d}return n},{});return Object.assign({},e,o)}function Fu(e,t){var o=t?Object.keys(ys(Object.assign({},gt,{plugins:t}))):Cu,n=o.reduce(function(s,r){var d=(e.getAttribute("data-tippy-"+r)||"").trim();if(!d)return s;if(r==="content")s[r]=d;else try{s[r]=JSON.parse(d)}catch(l){s[r]=d}return s},{});return n}function mr(e,t){var o=Object.assign({},t,{content:hs(t.content,[e])},t.ignoreAttributes?{}:Fu(e,t.plugins));return o.aria=Object.assign({},gt.aria,o.aria),o.aria={expanded:o.aria.expanded==="auto"?t.interactive:o.aria.expanded,content:o.aria.content==="auto"?t.interactive?null:"describedby":o.aria.content},o}var Au=function(){return"innerHTML"};function un(e,t){e[Au()]=t}function hr(e){var t=vo();return e===!0?t.className=fs:(t.className=vs,Yo(e)?t.appendChild(e):un(t,e)),t}function gr(e,t){Yo(t.content)?(un(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?un(e,t.content):e.textContent=t.content)}function cn(e){var t=e.firstElementChild,o=zo(t.children);return{box:t,content:o.find(function(n){return n.classList.contains(ps)}),arrow:o.find(function(n){return n.classList.contains(fs)||n.classList.contains(vs)}),backdrop:o.find(function(n){return n.classList.contains(lu)})}}function bs(e){var t=vo(),o=vo();o.className=iu,o.setAttribute("data-state","hidden"),o.setAttribute("tabindex","-1");var n=vo();n.className=ps,n.setAttribute("data-state","hidden"),gr(n,e.props),t.appendChild(o),o.appendChild(n),s(e.props,e.props);function s(r,d){var l=cn(t),i=l.box,v=l.content,p=l.arrow;d.theme?i.setAttribute("data-theme",d.theme):i.removeAttribute("data-theme"),typeof d.animation=="string"?i.setAttribute("data-animation",d.animation):i.removeAttribute("data-animation"),d.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth=typeof d.maxWidth=="number"?d.maxWidth+"px":d.maxWidth,d.role?i.setAttribute("role",d.role):i.removeAttribute("role"),(r.content!==d.content||r.allowHTML!==d.allowHTML)&&gr(v,e.props),d.arrow?p?r.arrow!==d.arrow&&(i.removeChild(p),i.appendChild(hr(d.arrow))):i.appendChild(hr(d.arrow)):p&&i.removeChild(p)}return{popper:t,onUpdate:s}}bs.$$tippy=!0;var Tu=1,Ho=[],rn=[];function Su(e,t){var o=mr(e,Object.assign({},gt,ys(cr(t)))),n,s,r,d=!1,l=!1,i=!1,v=!1,p,k,_,w=[],y=dr(Ne,o.interactiveDebounce),F,A=Tu++,T=null,B=uu(o.plugins),N={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},m={id:A,reference:e,popper:vo(),popperInstance:T,props:o,state:N,plugins:B,clearDelayTimeouts:re,setProps:de,setContent:$e,show:ht,hide:to,hideWithInteractivity:I,enable:x,disable:V,unmount:$,destroy:W};if(!o.render)return m;var P=o.render(m),f=P.popper,D=P.onUpdate;f.setAttribute("data-tippy-root",""),f.id="tippy-"+m.id,m.popper=f,e._tippy=m,f._tippy=m;var X=B.map(function(b){return b.fn(m)}),U=e.hasAttribute("aria-expanded");return me(),ke(),oe(),K("onCreate",[m]),o.showOnCreate&&S(),f.addEventListener("mouseenter",function(){m.props.interactive&&m.state.isVisible&&m.clearDelayTimeouts()}),f.addEventListener("mouseleave",function(){m.props.interactive&&m.props.trigger.indexOf("mouseenter")>=0&&Q().addEventListener("mousemove",y)}),m;function R(){var b=m.props.touch;return Array.isArray(b)?b:[b,0]}function O(){return R()[0]==="hold"}function C(){var b;return!!((b=m.props.render)!=null&&b.$$tippy)}function j(){return F||e}function Q(){var b=j().parentNode;return b?hu(b):document}function ve(){return cn(f)}function ue(b){return m.state.isMounted&&!m.state.isVisible||wt.isTouch||p&&p.type==="focus"?0:tn(m.props.delay,b?0:1,gt.delay)}function oe(b){b===void 0&&(b=!1),f.style.pointerEvents=m.props.interactive&&!b?"":"none",f.style.zIndex=""+m.props.zIndex}function K(b,z,G){if(G===void 0&&(G=!0),X.forEach(function(Oe){Oe[b]&&Oe[b].apply(Oe,z)}),G){var Z;(Z=m.props)[b].apply(Z,z)}}function ee(){var b=m.props.aria;if(b.content){var z="aria-"+b.content,G=f.id,Z=Ut(m.props.triggerTarget||e);Z.forEach(function(Oe){var Re=Oe.getAttribute(z);if(m.state.isVisible)Oe.setAttribute(z,Re?Re+" "+G:G);else{var Ue=Re&&Re.replace(G,"").trim();Ue?Oe.setAttribute(z,Ue):Oe.removeAttribute(z)}})}}function ke(){if(!(U||!m.props.aria.expanded)){var b=Ut(m.props.triggerTarget||e);b.forEach(function(z){m.props.interactive?z.setAttribute("aria-expanded",m.state.isVisible&&z===j()?"true":"false"):z.removeAttribute("aria-expanded")})}}function we(){Q().removeEventListener("mousemove",y),Ho=Ho.filter(function(b){return b!==y})}function ye(b){if(!(wt.isTouch&&(i||b.type==="mousedown"))){var z=b.composedPath&&b.composedPath()[0]||b.target;if(!(m.props.interactive&&fr(f,z))){if(Ut(m.props.triggerTarget||e).some(function(G){return fr(G,z)})){if(wt.isTouch||m.state.isVisible&&m.props.trigger.indexOf("click")>=0)return}else K("onClickOutside",[m,b]);m.props.hideOnClick===!0&&(m.clearDelayTimeouts(),m.hide(),l=!0,setTimeout(function(){l=!1}),m.state.isMounted||h())}}}function Fe(){i=!0}function J(){i=!1}function q(){var b=Q();b.addEventListener("mousedown",ye,!0),b.addEventListener("touchend",ye,Ht),b.addEventListener("touchstart",J,Ht),b.addEventListener("touchmove",Fe,Ht)}function h(){var b=Q();b.removeEventListener("mousedown",ye,!0),b.removeEventListener("touchend",ye,Ht),b.removeEventListener("touchstart",J,Ht),b.removeEventListener("touchmove",Fe,Ht)}function H(b,z){se(b,function(){!m.state.isVisible&&f.parentNode&&f.parentNode.contains(f)&&z()})}function M(b,z){se(b,z)}function se(b,z){var G=ve().box;function Z(Oe){Oe.target===G&&(nn(G,"remove",Z),z())}if(b===0)return z();nn(G,"remove",k),nn(G,"add",Z),k=Z}function ie(b,z,G){G===void 0&&(G=!1);var Z=Ut(m.props.triggerTarget||e);Z.forEach(function(Oe){Oe.addEventListener(b,z,G),w.push({node:Oe,eventType:b,handler:z,options:G})})}function me(){O()&&(ie("touchstart",Me,{passive:!0}),ie("touchend",Je,{passive:!0})),du(m.props.trigger).forEach(function(b){if(b!=="manual")switch(ie(b,Me),b){case"mouseenter":ie("mouseleave",Je);break;case"focus":ie(_u?"focusout":"blur",Ie);break;case"focusin":ie("focusout",Ie);break}})}function Ae(){w.forEach(function(b){var z=b.node,G=b.eventType,Z=b.handler,Oe=b.options;z.removeEventListener(G,Z,Oe)}),w=[]}function Me(b){var z,G=!1;if(!(!m.state.isEnabled||Be(b)||l)){var Z=((z=p)==null?void 0:z.type)==="focus";p=b,F=b.currentTarget,ke(),!m.state.isVisible&&fu(b)&&Ho.forEach(function(Oe){return Oe(b)}),b.type==="click"&&(m.props.trigger.indexOf("mouseenter")<0||d)&&m.props.hideOnClick!==!1&&m.state.isVisible?G=!0:S(b),b.type==="click"&&(d=!G),G&&!Z&&g(b)}}function Ne(b){var z=b.target,G=j().contains(z)||f.contains(z);if(!(b.type==="mousemove"&&G)){var Z=Se().concat(f).map(function(Oe){var Re,Ue=Oe._tippy,rt=(Re=Ue.popperInstance)==null?void 0:Re.state;return rt?{popperRect:Oe.getBoundingClientRect(),popperState:rt,props:o}:null}).filter(Boolean);gu(Z,b)&&(we(),g(b))}}function Je(b){var z=Be(b)||m.props.trigger.indexOf("click")>=0&&d;if(!z){if(m.props.interactive){m.hideWithInteractivity(b);return}g(b)}}function Ie(b){m.props.trigger.indexOf("focusin")<0&&b.target!==j()||m.props.interactive&&b.relatedTarget&&f.contains(b.relatedTarget)||g(b)}function Be(b){return wt.isTouch?O()!==b.type.indexOf("touch")>=0:!1}function he(){Te();var b=m.props,z=b.popperOptions,G=b.placement,Z=b.offset,Oe=b.getReferenceClientRect,Re=b.moveTransition,Ue=C()?cn(f).arrow:null,rt=Oe?{getBoundingClientRect:Oe,contextElement:Oe.contextElement||j()}:e,oo={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(So){var zt=So.state;if(C()){var Ts=ve(),Qo=Ts.box;["placement","reference-hidden","escaped"].forEach(function(Eo){Eo==="placement"?Qo.setAttribute("data-placement",zt.placement):zt.attributes.popper["data-popper-"+Eo]?Qo.setAttribute("data-"+Eo,""):Qo.removeAttribute("data-"+Eo)}),zt.attributes.popper={}}}},bt=[{name:"offset",options:{offset:Z}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Re}},oo];C()&&Ue&&bt.push({name:"arrow",options:{element:Ue,padding:3}}),bt.push.apply(bt,(z==null?void 0:z.modifiers)||[]),m.popperInstance=au(rt,f,Object.assign({},z,{placement:G,onFirstUpdate:_,modifiers:bt}))}function Te(){m.popperInstance&&(m.popperInstance.destroy(),m.popperInstance=null)}function Ee(){var b=m.props.appendTo,z,G=j();m.props.interactive&&b===ms||b==="parent"?z=G.parentNode:z=hs(b,[G]),z.contains(f)||z.appendChild(f),m.state.isMounted=!0,he()}function Se(){return zo(f.querySelectorAll("[data-tippy-root]"))}function S(b){m.clearDelayTimeouts(),b&&K("onTrigger",[m,b]),q();var z=ue(!0),G=R(),Z=G[0],Oe=G[1];wt.isTouch&&Z==="hold"&&Oe&&(z=Oe),z?n=setTimeout(function(){m.show()},z):m.show()}function g(b){if(m.clearDelayTimeouts(),K("onUntrigger",[m,b]),!m.state.isVisible){h();return}if(!(m.props.trigger.indexOf("mouseenter")>=0&&m.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(b.type)>=0&&d)){var z=ue(!1);z?s=setTimeout(function(){m.state.isVisible&&m.hide()},z):r=requestAnimationFrame(function(){m.hide()})}}function x(){m.state.isEnabled=!0}function V(){m.hide(),m.state.isEnabled=!1}function re(){clearTimeout(n),clearTimeout(s),cancelAnimationFrame(r)}function de(b){if(!m.state.isDestroyed){K("onBeforeUpdate",[m,b]),Ae();var z=m.props,G=mr(e,Object.assign({},z,cr(b),{ignoreAttributes:!0}));m.props=G,me(),z.interactiveDebounce!==G.interactiveDebounce&&(we(),y=dr(Ne,G.interactiveDebounce)),z.triggerTarget&&!G.triggerTarget?Ut(z.triggerTarget).forEach(function(Z){Z.removeAttribute("aria-expanded")}):G.triggerTarget&&e.removeAttribute("aria-expanded"),ke(),oe(),D&&D(z,G),m.popperInstance&&(he(),Se().forEach(function(Z){requestAnimationFrame(Z._tippy.popperInstance.forceUpdate)})),K("onAfterUpdate",[m,b])}}function $e(b){m.setProps({content:b})}function ht(){var b=m.state.isVisible,z=m.state.isDestroyed,G=!m.state.isEnabled,Z=wt.isTouch&&!m.props.touch,Oe=tn(m.props.duration,0,gt.duration);if(!(b||z||G||Z)&&!j().hasAttribute("disabled")&&(K("onShow",[m],!1),m.props.onShow(m)!==!1)){if(m.state.isVisible=!0,C()&&(f.style.visibility="visible"),oe(),q(),m.state.isMounted||(f.style.transition="none"),C()){var Re=ve(),Ue=Re.box,rt=Re.content;on([Ue,rt],0)}_=function(){var bt;if(!(!m.state.isVisible||v)){if(v=!0,f.offsetHeight,f.style.transition=m.props.moveTransition,C()&&m.props.animation){var Go=ve(),So=Go.box,zt=Go.content;on([So,zt],Oe),pr([So,zt],"visible")}ee(),ke(),ur(rn,m),(bt=m.popperInstance)==null||bt.forceUpdate(),K("onMount",[m]),m.props.animation&&C()&&M(Oe,function(){m.state.isShown=!0,K("onShown",[m])})}},Ee()}}function to(){var b=!m.state.isVisible,z=m.state.isDestroyed,G=!m.state.isEnabled,Z=tn(m.props.duration,1,gt.duration);if(!(b||z||G)&&(K("onHide",[m],!1),m.props.onHide(m)!==!1)){if(m.state.isVisible=!1,m.state.isShown=!1,v=!1,d=!1,C()&&(f.style.visibility="hidden"),we(),h(),oe(!0),C()){var Oe=ve(),Re=Oe.box,Ue=Oe.content;m.props.animation&&(on([Re,Ue],Z),pr([Re,Ue],"hidden"))}ee(),ke(),m.props.animation?C()&&H(Z,m.unmount):m.unmount()}}function I(b){Q().addEventListener("mousemove",y),ur(Ho,y),y(b)}function $(){m.state.isVisible&&m.hide(),m.state.isMounted&&(Te(),Se().forEach(function(b){b._tippy.unmount()}),f.parentNode&&f.parentNode.removeChild(f),rn=rn.filter(function(b){return b!==m}),m.state.isMounted=!1,K("onHidden",[m]))}function W(){m.state.isDestroyed||(m.clearDelayTimeouts(),m.unmount(),Ae(),delete e._tippy,m.state.isDestroyed=!0,K("onDestroy",[m]))}}function Nt(e,t){t===void 0&&(t={});var o=gt.plugins.concat(t.plugins||[]);wu();var n=Object.assign({},t,{plugins:o}),s=mu(e),r=s.reduce(function(d,l){var i=l&&Su(l,n);return i&&d.push(i),d},[]);return Yo(e)?r[0]:r}Nt.defaultProps=gt;Nt.setDefaultProps=Ou;Nt.currentInput=wt;Object.assign({},rs,{effect:function(t){var o=t.state,n={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(o.elements.popper.style,n.popper),o.styles=n,o.elements.arrow&&Object.assign(o.elements.arrow.style,n.arrow)}});Nt.setDefaultProps({render:bs});class Eu{constructor({editor:t,element:o,view:n,tippyOptions:s={},updateDelay:r=250,shouldShow:d}){this.preventHide=!1,this.shouldShow=({view:l,state:i,from:v,to:p})=>{const{doc:k,selection:_}=i,{empty:w}=_,y=!k.textBetween(v,p).length&&Ms(i.selection),F=this.element.contains(document.activeElement);return!(!(l.hasFocus()||F)||w||y||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:l})=>{var i;if(this.preventHide){this.preventHide=!1;return}l!=null&&l.relatedTarget&&(!((i=this.element.parentNode)===null||i===void 0)&&i.contains(l.relatedTarget))||this.hide()},this.tippyBlurHandler=l=>{this.blurHandler({event:l})},this.handleDebouncedUpdate=(l,i)=>{const v=!(i!=null&&i.selection.eq(l.state.selection)),p=!(i!=null&&i.doc.eq(l.state.doc));!v&&!p||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(l,v,p,i)},this.updateDelay))},this.updateHandler=(l,i,v,p)=>{var k,_,w;const{state:y,composing:F}=l,{selection:A}=y;if(F||!i&&!v)return;this.createTooltip();const{ranges:B}=A,N=Math.min(...B.map(f=>f.$from.pos)),m=Math.max(...B.map(f=>f.$to.pos));if(!((k=this.shouldShow)===null||k===void 0?void 0:k.call(this,{editor:this.editor,view:l,state:y,oldState:p,from:N,to:m}))){this.hide();return}(_=this.tippy)===null||_===void 0||_.setProps({getReferenceClientRect:((w=this.tippyOptions)===null||w===void 0?void 0:w.getReferenceClientRect)||(()=>{if(Rs(y.selection)){let f=l.nodeDOM(N);const D=f.dataset.nodeViewWrapper?f:f.querySelector("[data-node-view-wrapper]");if(D&&(f=D.firstChild),f)return f.getBoundingClientRect()}return Ar(l,N,m)})}),this.show()},this.editor=t,this.element=o,this.view=n,this.updateDelay=r,d&&(this.shouldShow=d),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=s,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,o=!!t.parentElement;this.tippy||!o||(this.tippy=Nt(t,ge({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,o){const{state:n}=t,s=n.selection.$from.pos!==n.selection.$to.pos;if(this.updateDelay>0&&s){this.handleDebouncedUpdate(t,o);return}const r=!(o!=null&&o.selection.eq(t.state.selection)),d=!(o!=null&&o.doc.eq(t.state.doc));this.updateHandler(t,r,d,o)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,o;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(o=this.tippy)===null||o===void 0||o.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const ws=e=>new Cr({key:typeof e.pluginKey=="string"?new Or(e.pluginKey):e.pluginKey,view:t=>new Eu(ge({view:t},e))});Fr.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[ws({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class Du{constructor({editor:t,element:o,view:n,tippyOptions:s={},shouldShow:r}){this.preventHide=!1,this.shouldShow=({view:d,state:l})=>{const{selection:i}=l,{$anchor:v,empty:p}=i,k=v.depth===1,_=v.parent.isTextblock&&!v.parent.type.spec.code&&!v.parent.textContent;return!(!d.hasFocus()||!p||!k||!_||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:d})=>{var l;if(this.preventHide){this.preventHide=!1;return}d!=null&&d.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(d.relatedTarget))||this.hide()},this.tippyBlurHandler=d=>{this.blurHandler({event:d})},this.editor=t,this.element=o,this.view=n,r&&(this.shouldShow=r),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=s,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,o=!!t.parentElement;this.tippy||!o||(this.tippy=Nt(t,ge({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,o){var n,s,r;const{state:d}=t,{doc:l,selection:i}=d,{from:v,to:p}=i;if(o&&o.doc.eq(l)&&o.selection.eq(i))return;if(this.createTooltip(),!((n=this.shouldShow)===null||n===void 0?void 0:n.call(this,{editor:this.editor,view:t,state:d,oldState:o}))){this.hide();return}(s=this.tippy)===null||s===void 0||s.setProps({getReferenceClientRect:((r=this.tippyOptions)===null||r===void 0?void 0:r.getReferenceClientRect)||(()=>Ar(t,v,p))}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,o;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(o=this.tippy)===null||o===void 0||o.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const xs=e=>new Cr({key:typeof e.pluginKey=="string"?new Or(e.pluginKey):e.pluginKey,view:t=>new Du(ge({view:t},e))});Fr.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[xs({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});const ju=Ze({name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const o=L(null);return Qe(()=>{const{updateDelay:n,editor:s,pluginKey:r,shouldShow:d,tippyOptions:l}=e;s.registerPlugin(ws({updateDelay:n,editor:s,element:o.value,pluginKey:r,shouldShow:d,tippyOptions:l}))}),qo(()=>{const{pluginKey:n,editor:s}=e;s.unregisterPlugin(n)}),()=>{var n;return jt("div",{ref:o},(n=t.default)===null||n===void 0?void 0:n.call(t))}}});function yr(e){return Bs((t,o)=>({get(){return t(),e},set(n){e=n,requestAnimationFrame(()=>{requestAnimationFrame(()=>{o()})})}}))}class Pu extends Hs{constructor(t={}){return super(t),this.vueRenderers=Tr(new Map),this.contentComponent=null,this.reactiveState=yr(this.view.state),this.reactiveExtensionStorage=yr(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),Sr(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,o){super.registerPlugin(t,o),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const Lu=Ze({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=L(),o=Is();return Pt(()=>{const n=e.editor;n&&n.options.element&&t.value&&it(()=>{if(!t.value||!n.options.element.firstChild)return;const s=le(t.value);t.value.append(...n.options.element.childNodes),n.contentComponent=o.ctx._,n.setOptions({element:s}),n.createNodeViews()})}),qo(()=>{const n=e.editor;if(!n||(n.isDestroyed||n.view.setProps({nodeViews:{}}),n.contentComponent=null,!n.options.element.firstChild))return;const s=document.createElement("div");s.append(...n.options.element.childNodes),n.setOptions({element:s})}),{rootEl:t}},render(){const e=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const o=jt(hn,{to:t.teleportElement,key:t.id},jt(t.component,ge({ref:t.id},t.props)));e.push(o)}),jt("div",{ref:t=>{this.rootEl=t}},...e)}}),Mu=Ze({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const o=L(null);return Qe(()=>{const{pluginKey:n,editor:s,tippyOptions:r,shouldShow:d}=e;s.registerPlugin(xs({pluginKey:n,editor:s,element:o.value,tippyOptions:r,shouldShow:d}))}),qo(()=>{const{pluginKey:n,editor:s}=e;s.unregisterPlugin(n)}),()=>{var n;return jt("div",{ref:o},(n=t.default)===null||n===void 0?void 0:n.call(t))}}});class Ru{constructor(t,{props:o={},editor:n}){if(this.id=Math.floor(Math.random()*4294967295).toString(),this.editor=n,this.component=Sr(t),this.teleportElement=document.createElement("div"),this.element=this.teleportElement,this.props=Tr(o),this.editor.vueRenderers.set(this.id,this),this.editor.contentComponent){if(this.editor.contentComponent.update(),this.teleportElement.children.length!==1)throw Error("VueRenderer doesn’t support multiple child elements.");this.element=this.teleportElement.firstElementChild}}get ref(){var t;return(t=this.editor.contentComponent)===null||t===void 0?void 0:t.refs[this.id]}updateProps(t={}){Object.entries(t).forEach(([o,n])=>{this.props[o]=n})}destroy(){this.editor.vueRenderers.delete(this.id)}}const Hu={props:{items:{type:Array,required:!0},command:{type:Function,required:!0}},data(){return{selectedIndex:0}},watch:{items(){this.selectedIndex=0}},methods:{onKeyDown({event:e}){return e.key==="ArrowUp"?(this.upHandler(),!0):e.key==="ArrowDown"?(this.downHandler(),!0):e.key==="Enter"?(this.enterHandler(),!0):!1},upHandler(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler(){this.selectItem(this.selectedIndex)},selectItem(e){const t=this.items[e];t&&this.command({id:t.value,label:t.label})}}},Bu={key:0,class:"min-w-40 rounded-lg border bg-white p-1 text-base shadow-lg"},Iu=["onClick","onMouseover"];function Vu(e,t,o,n,s,r){return u(),c("div",null,[o.items.length?(u(),c("div",Bu,[(u(!0),c(ae,null,xe(o.items,(d,l)=>(u(),c("button",{class:fe([l===s.selectedIndex?"bg-gray-100":"text-gray-900","flex w-full items-center whitespace-nowrap rounded-md px-2 py-2 text-sm"]),key:l,onClick:i=>r.selectItem(l),onMouseover:i=>s.selectedIndex=l},E(d.label),43,Iu))),128))])):Y("",!0)])}const Nu=_e(Hu,[["render",Vu]]);function zu(e){return Vs.configure({HTMLAttributes:{class:"mention"},suggestion:Uu(e)})}function Uu(e){return{items:({query:t})=>e.filter(o=>o.label.toLowerCase().startsWith(t.toLowerCase())).slice(0,10),render:()=>{let t,o;return{onStart:n=>{t=new Ru(Nu,{props:n,editor:n.editor}),n.clientRect&&(o=Nt("body",{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(n){t.updateProps(n),n.clientRect&&o[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown(n){var s;return n.event.key==="Escape"?(o[0].hide(),!0):(s=t.ref)==null?void 0:s.onKeyDown(n)},onExit(){o[0].destroy(),t.destroy()}}}}}const qu={name:"TipTapMenu",props:["buttons"],inject:["editor"],components:{Popover:Qr},methods:{onButtonClick(e){e.action(this.editor)}}},Wu={class:"inline-flex bg-white px-1 py-1"},Ju={class:"inline-flex items-center gap-1"},Ku={key:0,class:"h-4 w-[2px] border-l"},Yu={key:1,class:"shrink-0"},Xu=["onClick","set"],Gu={key:1},Qu={class:"rounded border bg-white p-1 shadow-md"},Zu={class:"w-full"},ec=["onClick"],tc=["onClick","title"],oc={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function nc(e,t,o,n,s,r){const d=qe("Popover");return u(),c("div",Wu,[a("div",Ju,[(u(!0),c(ae,null,xe(o.buttons,l=>(u(),c(ae,{key:l.label},[l.type==="separator"?(u(),c("div",Ku)):l.map?(u(),c("div",Yu,[ce(d,null,{target:be(({togglePopover:i})=>[a("button",{class:"rounded px-2 py-1 text-base font-medium text-gray-800 transition-colors hover:bg-gray-100",onClick:i,set:e.activeBtn=l.find(v=>v.isActive(r.editor))||l[0]},[e.activeBtn.icon?(u(),Ce(lo(e.activeBtn.icon),{key:0,class:"h-4 w-4"})):(u(),c("span",Gu,E(e.activeBtn.label),1))],8,Xu)]),body:be(({close:i})=>[a("ul",Qu,[(u(!0),c(ae,null,xe(l,v=>Ve((u(),c("li",Zu,[a("button",{class:"w-full rounded px-2 py-1 text-left text-base hover:bg-gray-50",onClick:()=>{r.onButtonClick(v),i()}},E(v.label),9,ec)],512)),[[ho,v.isDisabled?!v.isDisabled(r.editor):!0]])),256))])]),_:2},1024)])):(u(),Ce(lo(l.component||"div"),ot({key:2,ref_for:!0},{editor:r.editor}),{default:be(i=>[a("button",{class:fe(["flex rounded p-1 text-gray-800 transition-colors",l.isActive(r.editor)||i!=null&&i.isActive?"bg-gray-100":"hover:bg-gray-100"]),onClick:v=>i!=null&&i.onClick?i.onClick(l):r.onButtonClick(l),title:l.label},[l.icon?(u(),Ce(lo(l.icon),{key:0,class:"h-4 w-4"})):(u(),c("span",oc,E(l.text),1))],10,tc)]),_:2},1040))],64))),128))])])}const _s=_e(qu,[["render",nc]]),rc={},sc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function ac(e,t){return u(),c("svg",sc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm8-12v12h-2v-9.796l-2 .536V8.67L19.5 8H21z",fill:"currentColor"},null,-1)]))}const ic=_e(rc,[["render",ac]]),lc={},dc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function uc(e,t){return u(),c("svg",dc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 4c2.071 0 3.75 1.679 3.75 3.75 0 .857-.288 1.648-.772 2.28l-.148.18L18.034 18H22v2h-7v-1.556l4.82-5.546c.268-.307.43-.709.43-1.148 0-.966-.784-1.75-1.75-1.75-.918 0-1.671.707-1.744 1.606l-.006.144h-2C14.75 9.679 16.429 8 18.5 8z",fill:"currentColor"},null,-1)]))}const cc=_e(lc,[["render",uc]]),pc={},fc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function vc(e,t){return u(),c("svg",fc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M22 8l-.002 2-2.505 2.883c1.59.435 2.757 1.89 2.757 3.617 0 2.071-1.679 3.75-3.75 3.75-1.826 0-3.347-1.305-3.682-3.033l1.964-.382c.156.806.866 1.415 1.718 1.415.966 0 1.75-.784 1.75-1.75s-.784-1.75-1.75-1.75c-.286 0-.556.069-.794.19l-1.307-1.547L19.35 10H15V8h7zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z",fill:"currentColor"},null,-1)]))}const mc=_e(pc,[["render",vc]]),hc={},gc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function yc(e,t){return u(),c("svg",gc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M13 20h-2v-7H4v7H2V4h2v7h7V4h2v16zm9-12v8h1.5v2H22v2h-2v-2h-5.5v-1.34l5-8.66H22zm-2 3.133L17.19 16H20v-4.867z",fill:"currentColor"},null,-1)]))}const bc=_e(hc,[["render",yc]]),wc={},xc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function _c(e,t){return u(),c("svg",xc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M22 8v2h-4.323l-.464 2.636c.33-.089.678-.136 1.037-.136 2.21 0 4 1.79 4 4s-1.79 4-4 4c-1.827 0-3.367-1.224-3.846-2.897l1.923-.551c.24.836 1.01 1.448 1.923 1.448 1.105 0 2-.895 2-2s-.895-2-2-2c-.63 0-1.193.292-1.56.748l-1.81-.904L16 8h6zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2z",fill:"currentColor"},null,-1)]))}const kc=_e(wc,[["render",_c]]),$c={},Cc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Oc(e,t){return u(),c("svg",Cc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M21.097 8l-2.598 4.5c2.21 0 4.001 1.79 4.001 4s-1.79 4-4 4-4-1.79-4-4c0-.736.199-1.426.546-2.019L18.788 8h2.309zM4 4v7h7V4h2v16h-2v-7H4v7H2V4h2zm14.5 10.5c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2z",fill:"currentColor"},null,-1)]))}const Fc=_e($c,[["render",Oc]]),Ac={},Tc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Sc(e,t){return u(),c("svg",Tc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M13 6v15h-2V6H5V4h14v2z",fill:"currentColor"},null,-1)]))}const Ec=_e(Ac,[["render",Sc]]),Dc={},jc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Pc(e,t){return u(),c("svg",jc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M8 11h4.5a2.5 2.5 0 1 0 0-5H8v5zm10 4.5a4.5 4.5 0 0 1-4.5 4.5H6V4h6.5a4.5 4.5 0 0 1 3.256 7.606A4.498 4.498 0 0 1 18 15.5zM8 13v5h5.5a2.5 2.5 0 1 0 0-5H8z",fill:"currentColor"},null,-1)]))}const Lc=_e(Dc,[["render",Pc]]),Mc={},Rc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Hc(e,t){return u(),c("svg",Rc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M15 20H7v-2h2.927l2.116-12H9V4h8v2h-2.927l-2.116 12H15z",fill:"currentColor"},null,-1)]))}const Bc=_e(Mc,[["render",Hc]]),Ic={},Vc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Nc(e,t){return u(),c("svg",Vc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M8 3v9a4 4 0 1 0 8 0V3h2v9a6 6 0 1 1-12 0V3h2zM4 20h16v2H4v-2z",fill:"currentColor"},null,-1)]))}const zc=_e(Ic,[["render",Nc]]),Uc={},qc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Wc(e,t){return u(),c("svg",qc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M3 4h18v2H3V4zm2 15h14v2H5v-2zm-2-5h18v2H3v-2zm2-5h14v2H5V9z",fill:"currentColor"},null,-1)]))}const Jc=_e(Uc,[["render",Wc]]),Kc={},Yc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Xc(e,t){return u(),c("svg",Yc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M3 4h18v2H3V4zm0 15h14v2H3v-2zm0-5h18v2H3v-2zm0-5h14v2H3V9z",fill:"currentColor"},null,-1)]))}const Gc=_e(Kc,[["render",Xc]]),Qc={},Zc={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function ep(e,t){return u(),c("svg",Zc,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M3 4h18v2H3V4zm4 15h14v2H7v-2zm-4-5h18v2H3v-2zm4-5h14v2H7V9z",fill:"currentColor"},null,-1)]))}const tp=_e(Qc,[["render",ep]]),op={},np={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function rp(e,t){return u(),c("svg",np,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M15.246 14H8.754l-1.6 4H5l6-15h2l6 15h-2.154l-1.6-4zm-.8-2L12 5.885 9.554 12h4.892zM3 20h18v2H3v-2z",fill:"currentColor"},null,-1)]))}const sp=_e(op,[["render",rp]]),ap={},ip={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function lp(e,t){return u(),c("svg",ip,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M8 4h13v2H8V4zM5 3v3h1v1H3V6h1V4H3V3h2zM3 14v-2.5h2V11H3v-1h3v2.5H4v.5h2v1H3zm2 5.5H3v-1h2V18H3v-1h3v4H3v-1h2v-.5zM8 11h13v2H8v-2zm0 7h13v2H8v-2z",fill:"currentColor"},null,-1)]))}const dp=_e(ap,[["render",lp]]),up={},cp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function pp(e,t){return u(),c("svg",cp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M8 4h13v2H8V4zM4.5 6.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 6.9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM8 11h13v2H8v-2zm0 7h13v2H8v-2z",fill:"currentColor"},null,-1)]))}const fp=_e(up,[["render",pp]]),vp={},mp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function hp(e,t){return u(),c("svg",mp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M19.417 6.679C20.447 7.773 21 9 21 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311-1.804-.167-3.226-1.648-3.226-3.489a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179zm-10 0C10.447 7.773 11 9 11 10.989c0 3.5-2.457 6.637-6.03 8.188l-.893-1.378c3.335-1.804 3.987-4.145 4.247-5.621-.537.278-1.24.375-1.929.311C4.591 12.322 3.17 10.841 3.17 9a3.5 3.5 0 0 1 3.5-3.5c1.073 0 2.099.49 2.748 1.179z",fill:"currentColor"},null,-1)]))}const gp=_e(vp,[["render",hp]]),yp={},bp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function wp(e,t){return u(),c("svg",bp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M16.95 8.464l1.414-1.414 4.95 4.95-4.95 4.95-1.414-1.414L20.485 12 16.95 8.464zm-9.9 0L3.515 12l3.535 3.536-1.414 1.414L.686 12l4.95-4.95L7.05 8.464z",fill:"currentColor"},null,-1)]))}const xp=_e(yp,[["render",wp]]),_p={},kp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function $p(e,t){return u(),c("svg",kp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M18.364 15.536L16.95 14.12l1.414-1.414a5 5 0 1 0-7.071-7.071L9.879 7.05 8.464 5.636 9.88 4.222a7 7 0 0 1 9.9 9.9l-1.415 1.414zm-2.828 2.828l-1.415 1.414a7 7 0 0 1-9.9-9.9l1.415-1.414L7.05 9.88l-1.414 1.414a5 5 0 1 0 7.071 7.071l1.414-1.414 1.415 1.414zm-.708-10.607l1.415 1.415-7.071 7.07-1.415-1.414 7.071-7.07z",fill:"currentColor"},null,-1)]))}const Cp=_e(_p,[["render",$p]]),Op={},Fp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Ap(e,t){return u(),c("svg",Fp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M21 15v3h3v2h-3v3h-2v-3h-3v-2h3v-3h2zm.008-12c.548 0 .992.445.992.993V13h-2V5H4v13.999L14 9l3 3v2.829l-3-3L6.827 19H14v2H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3h18.016zM8 7a2 2 0 1 1 0 4 2 2 0 0 1 0-4z",fill:"currentColor"},null,-1)]))}const Tp=_e(Op,[["render",Ap]]),Sp={},Ep={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Dp(e,t){return u(),c("svg",Ep,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0H24V24H0z"},null,-1),a("path",{d:"M16 4c.552 0 1 .448 1 1v4.2l5.213-3.65c.226-.158.538-.103.697.124.058.084.09.184.09.286v12.08c0 .276-.224.5-.5.5-.103 0-.203-.032-.287-.09L17 14.8V19c0 .552-.448 1-1 1H2c-.552 0-1-.448-1-1V5c0-.552.448-1 1-1h14zm-1 2H3v12h12V6zM8 8h2v3h3v2H9.999L10 16H8l-.001-3H5v-2h3V8zm13 .841l-4 2.8v.718l4 2.8V8.84z",fill:"currentColor"},null,-1)]))}const jp=_e(Sp,[["render",Dp]]),Pp={},Lp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Mp(e,t){return u(),c("svg",Lp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M5.828 7l2.536 2.536L6.95 10.95 2 6l4.95-4.95 1.414 1.414L5.828 5H13a8 8 0 1 1 0 16H4v-2h9a6 6 0 1 0 0-12H5.828z",fill:"currentColor"},null,-1)]))}const Rp=_e(Pp,[["render",Mp]]),Hp={},Bp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Ip(e,t){return u(),c("svg",Bp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M18.172 7H11a6 6 0 1 0 0 12h9v2h-9a8 8 0 1 1 0-16h7.172l-2.536-2.536L17.05 1.05 22 6l-4.95 4.95-1.414-1.414L18.172 7z",fill:"currentColor"},null,-1)]))}const Vp=_e(Hp,[["render",Ip]]),Np={},zp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Up(e,t){return u(),c("svg",zp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M2 11h2v2H2v-2zm4 0h12v2H6v-2zm14 0h2v2h-2v-2z",fill:"currentColor"},null,-1)]))}const qp=_e(Np,[["render",Up]]),Wp={},Jp={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"};function Kp(e,t){return u(),c("svg",Jp,t[0]||(t[0]=[a("path",{fill:"none",d:"M0 0h24v24H0z"},null,-1),a("path",{d:"M13 10v4h6v-4h-6zm-2 0H5v4h6v-4zm2 9h6v-3h-6v3zm-2 0v-3H5v3h6zm2-14v3h6V5h-6zm-2 0H5v3h6V5zM4 3h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z",fill:"currentColor"},null,-1)]))}const Yp=_e(Wp,[["render",Kp]]),Xp={Paragraph:{label:"Paragraph",icon:Ec,action:e=>e.chain().focus().setParagraph().run(),isActive:e=>e.isActive("paragraph")},"Heading 1":{label:"Heading 1",text:"H1",icon:ic,action:e=>e.chain().focus().toggleHeading({level:1}).run(),isActive:e=>e.isActive("heading",{level:1})},"Heading 2":{label:"Heading 2",text:"H2",icon:cc,action:e=>e.chain().focus().toggleHeading({level:2}).run(),isActive:e=>e.isActive("heading",{level:2})},"Heading 3":{label:"Heading 3",text:"H3",icon:mc,action:e=>e.chain().focus().toggleHeading({level:3}).run(),isActive:e=>e.isActive("heading",{level:3})},"Heading 4":{label:"Heading 4",text:"H4",icon:bc,action:e=>e.chain().focus().toggleHeading({level:4}).run(),isActive:e=>e.isActive("heading",{level:4})},"Heading 5":{label:"Heading 5",text:"H5",icon:kc,action:e=>e.chain().focus().toggleHeading({level:5}).run(),isActive:e=>e.isActive("heading",{level:5})},"Heading 6":{label:"Heading 6",text:"H6",icon:Fc,action:e=>e.chain().focus().toggleHeading({level:6}).run(),isActive:e=>e.isActive("heading",{level:6})},Bold:{label:"Bold",icon:Lc,action:e=>e.chain().focus().toggleBold().run(),isActive:e=>e.isActive("bold")},Italic:{label:"Italic",icon:Bc,action:e=>e.chain().focus().toggleItalic().run(),isActive:e=>e.isActive("italic")},Underline:{label:"Underline",icon:zc,action:e=>e.chain().focus().toggleUnderline().run(),isActive:e=>e.isActive("underline")},"Bullet List":{label:"Bullet List",icon:fp,action:e=>e.chain().focus().toggleBulletList().run(),isActive:e=>e.isActive("bulletList")},"Numbered List":{label:"Numbered List",icon:dp,action:e=>e.chain().focus().toggleOrderedList().run(),isActive:e=>e.isActive("orderedList")},"Align Center":{label:"Align Center",icon:Jc,action:e=>e.chain().focus().setTextAlign("center").run(),isActive:e=>e.isActive({textAlign:"center"})},"Align Left":{label:"Align Left",icon:Gc,action:e=>e.chain().focus().setTextAlign("left").run(),isActive:e=>e.isActive({textAlign:"left"})},"Align Right":{label:"Align Right",icon:tp,action:e=>e.chain().focus().setTextAlign("right").run(),isActive:e=>e.isActive({textAlign:"right"})},FontColor:{label:"Font Color",icon:sp,isActive:e=>e.isActive("textStyle")||e.isActive("highlight"),component:jo(()=>Po(()=>import("./FontColor-BHHAqtij.js"),__vite__mapDeps([0,1,2])))},Blockquote:{label:"Blockquote",icon:gp,action:e=>e.chain().focus().toggleBlockquote().run(),isActive:e=>e.isActive("blockquote")},Code:{label:"Code",icon:xp,action:e=>e.chain().focus().toggleCodeBlock().run(),isActive:e=>e.isActive("codeBlock")},"Horizontal Rule":{label:"Horizontal Rule",icon:qp,action:e=>e.chain().focus().setHorizontalRule().run(),isActive:e=>!1},Link:{label:"Link",icon:Cp,isActive:e=>e.isActive("link"),component:jo(()=>Po(()=>import("./InsertLink-BWdhbrmU.js"),__vite__mapDeps([3,4,1,2])))},Image:{label:"Image",icon:Tp,isActive:e=>!1,component:jo(()=>Po(()=>import("./InsertImage-DL60cU3L.js"),__vite__mapDeps([5,1,2,4])))},Video:{label:"Video",icon:jp,isActive:e=>!1,component:jo(()=>Po(()=>import("./InsertVideo-CrKBESEJ.js"),__vite__mapDeps([6,1,2,4])))},Undo:{label:"Undo",icon:Rp,action:e=>e.chain().focus().undo().run(),isActive:e=>!1},Redo:{label:"Redo",icon:Vp,action:e=>e.chain().focus().redo().run(),isActive:e=>!1},InsertTable:{label:"Insert Table",icon:Yp,action:e=>e.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),isActive:e=>!1},AddColumnBefore:{label:"Add Column Before",action:e=>e.chain().focus().addColumnBefore().run(),isActive:e=>!1,isDisabled:e=>!e.can().addColumnBefore()},AddColumnAfter:{label:"Add Column After",action:e=>e.chain().focus().addColumnAfter().run(),isActive:e=>!1,isDisabled:e=>!e.can().addColumnAfter()},DeleteColumn:{label:"Delete Column",action:e=>e.chain().focus().deleteColumn().run(),isActive:e=>!1,isDisabled:e=>!e.can().deleteColumn()},AddRowBefore:{label:"Add Row Before",action:e=>e.chain().focus().addRowBefore().run(),isActive:e=>!1,isDisabled:e=>!e.can().addRowBefore()},AddRowAfter:{label:"Add Row After",action:e=>e.chain().focus().addRowAfter().run(),isActive:e=>!1,isDisabled:e=>!e.can().addRowAfter()},DeleteRow:{label:"Delete Row",action:e=>e.chain().focus().deleteRow().run(),isActive:e=>!1,isDisabled:e=>!e.can().deleteRow()},DeleteTable:{label:"Delete Table",action:e=>e.chain().focus().deleteTable().run(),isActive:e=>!1,isDisabled:e=>!e.can().deleteTable()},MergeCells:{label:"Merge Cells",action:e=>e.chain().focus().mergeCells().run(),isActive:e=>!1,isDisabled:e=>!e.can().mergeCells()},SplitCell:{label:"Split Cell",action:e=>e.chain().focus().splitCell().run(),isActive:e=>!1,isDisabled:e=>!e.can().splitCell()},ToggleHeaderColumn:{label:"Toggle Header Column",action:e=>e.chain().focus().toggleHeaderColumn().run(),isActive:e=>!1,isDisabled:e=>!e.can().toggleHeaderColumn()},ToggleHeaderRow:{label:"Toggle Header Row",action:e=>e.chain().focus().toggleHeaderRow().run(),isActive:e=>!1,isDisabled:e=>!e.can().toggleHeaderRow()},ToggleHeaderCell:{label:"Toggle Header Cell",action:e=>e.chain().focus().toggleHeaderCell().run(),isActive:e=>!1,isDisabled:e=>!e.can().toggleHeaderCell()},Separator:{type:"separator"}};function Xo(e){return e instanceof Array?e.map(Xo):typeof e=="object"?e:Xp[e]}const Gp={name:"TextEditorFixedMenu",props:["buttons"],components:{Menu:_s},inject:["editor"],computed:{fixedMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=[["Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"],"Paragraph","Separator","Bold","Italic","Separator","Bullet List","Numbered List","Separator","Align Left","Align Center","Align Right","FontColor","Separator","Image","Video","Link","Blockquote","Code","Horizontal Rule",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"],"Separator","Undo","Redo"],e.map(Xo)}}};function Qp(e,t,o,n,s,r){const d=qe("Menu");return r.fixedMenuButtons?(u(),Ce(d,{key:0,buttons:r.fixedMenuButtons},null,8,["buttons"])):Y("",!0)}const Zp=_e(Gp,[["render",Qp]]),ef={name:"TextEditorBubbleMenu",props:["buttons","options"],components:{BubbleMenu:ju,Menu:_s},inject:["editor"],computed:{bubbleMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=["Paragraph","Heading 2","Heading 3","Separator","Bold","Italic","Link","Separator","Bullet List","Numbered List","Separator","Image","Video","Blockquote","Code",["InsertTable","AddColumnBefore","AddColumnAfter","DeleteColumn","AddRowBefore","AddRowAfter","DeleteRow","MergeCells","SplitCell","ToggleHeaderColumn","ToggleHeaderRow","ToggleHeaderCell","DeleteTable"]],e.map(Xo)}}};function tf(e,t,o,n,s,r){const d=qe("Menu"),l=qe("BubbleMenu");return r.bubbleMenuButtons?(u(),Ce(l,ot({key:0,class:"bubble-menu rounded-md shadow-sm","tippy-options":{duration:100},editor:r.editor},o.options),{default:be(()=>[ce(d,{class:"rounded-md border border-gray-100 shadow-lg",buttons:r.bubbleMenuButtons},null,8,["buttons"])]),_:1},16,["editor"])):Y("",!0)}const of=_e(ef,[["render",tf]]),nf={name:"TextEditorFloatingMenu",props:["buttons"],components:{FloatingMenu:Mu},inject:["editor"],computed:{floatingMenuButtons(){if(!this.buttons)return!1;let e;return Array.isArray(this.buttons)?e=this.buttons:e=["Paragraph","Heading 2","Heading 3","Bullet List","Numbered List","Blockquote","Code","Horizontal Rule"],e.map(Xo)}}},rf=["onClick","title"],sf={key:1,class:"inline-block h-4 min-w-[1rem] text-sm leading-4"};function af(e,t,o,n,s,r){const d=qe("FloatingMenu");return r.floatingMenuButtons?(u(),Ce(d,{key:0,"tippy-options":{duration:100},editor:r.editor,class:"flex"},{default:be(()=>[(u(!0),c(ae,null,xe(r.floatingMenuButtons,l=>(u(),c("button",{key:l.label,class:fe(["flex rounded p-1 text-gray-800 transition-colors",l.isActive(r.editor)?"bg-gray-100":"hover:bg-gray-100"]),onClick:()=>l.action(r.editor),title:l.label},[l.icon?(u(),Ce(lo(l.icon),{key:0,class:"h-4 w-4"})):(u(),c("span",sf,E(l.text),1))],10,rf))),128))]),_:1},8,["editor"])):Y("",!0)}const lf=_e(nf,[["render",af]]);function df(e){return new Ns.Converter().makeHtml(e)}function uf(e){return e.split(`
`).filter(n=>n.startsWith("![")||n.startsWith("#")||n.startsWith("> ")||n.startsWith("*")||n.startsWith("- ")||n.startsWith("1. ")||n.startsWith("```")||n.startsWith("`")||n.startsWith("[")||n.startsWith("---")).length>0}const cf={name:"TextEditor",inheritAttrs:!1,components:{EditorContent:Lu,TextEditorFixedMenu:Zp,TextEditorBubbleMenu:of,TextEditorFloatingMenu:lf},props:{content:{type:String,default:null},placeholder:{type:[String,Function],default:""},editorClass:{type:[String,Array,Object],default:""},editable:{type:Boolean,default:!0},bubbleMenu:{type:[Boolean,Array],default:!1},bubbleMenuOptions:{type:Object,default:()=>({})},fixedMenu:{type:[Boolean,Array],default:!1},floatingMenu:{type:[Boolean,Array],default:!1},extensions:{type:Array,default:()=>[]},starterkitOptions:{type:Object,default:()=>({})},mentions:{type:Array,default:()=>[]}},emits:["change","focus","blur"],expose:["editor"],provide(){return{editor:zs(()=>this.editor)}},data(){return{editor:null}},watch:{content(e){this.editor.getHTML()!==e&&this.editor.commands.setContent(e)},editable(e){this.editor.setEditable(e)},editorProps:{deep:!0,handler(e){this.editor&&this.editor.setOptions({editorProps:e})}}},mounted(){this.editor=new Pu({content:this.content||null,editorProps:this.editorProps,editable:this.editable,extensions:[Us.configure(ge({},this.starterkitOptions)),qs.configure({resizable:!0}),Ws,Js,Ks,Ys,Xs.configure({types:["heading","paragraph"]}),Gs,Qs,Zs.configure({multicolor:!0}),ea,ta,oa.configure({openOnClick:!1}),na.configure({showOnlyWhenEditable:!1,placeholder:typeof this.placeholder=="function"?this.placeholder:()=>this.placeholder}),zu(this.mentions),...this.extensions||[]],onUpdate:({editor:e})=>{this.$emit("change",e.getHTML())},onFocus:({editor:e,event:t})=>{this.$emit("focus",t)},onBlur:({editor:e,event:t})=>{this.$emit("blur",t)}})},beforeUnmount(){this.editor.destroy(),this.editor=null},computed:{editorProps(){return{attributes:{class:fe(["prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100",this.editorClass])},clipboardTextParser:(e,t)=>{if(!uf(e)||!confirm("Do you want to convert markdown content to HTML before pasting?"))return;let o=document.createElement("div");return o.innerHTML=df(e),(this.editor.view.someProp("clipboardParser")||this.editor.view.someProp("domParser")||ra.fromSchema(this.editor.schema)).parseSlice(o,{preserveWhitespace:!0,context:t})}}}}};function pf(e,t,o,n,s,r){const d=qe("TextEditorBubbleMenu"),l=qe("TextEditorFixedMenu"),i=qe("TextEditorFloatingMenu"),v=qe("editor-content");return s.editor?(u(),c("div",{key:0,class:fe(["relative w-full",e.$attrs.class])},[ce(d,{buttons:o.bubbleMenu,options:o.bubbleMenuOptions},null,8,["buttons","options"]),ce(l,{class:"w-full overflow-x-auto rounded-t-lg border border-gray-200",buttons:o.fixedMenu},null,8,["buttons"]),ce(i,{buttons:o.floatingMenu},null,8,["buttons"]),Le(e.$slots,"top"),Le(e.$slots,"editor",{editor:s.editor},()=>[ce(v,{editor:s.editor},null,8,["editor"])]),Le(e.$slots,"bottom")],2)):Y("",!0)}const ff=_e(cf,[["render",pf]]),ct={doctypeFields:{},linkOptions:{},clientScripts:{}};function Ln(){return te(this,null,function*(){try{return(yield(yield fetch("/api/method/frappe.auth.get_logged_user")).json()).message||null}catch(e){return console.error("Error getting current user:",e),null}})}function vf(){return te(this,null,function*(){try{const t=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Has Role",fields:["role"],filters:{parenttype:"User",parent:yield Ln()}})})).json();return t.message?t.message.map(o=>o.role):[]}catch(e){return console.error("Error fetching user roles:",e),[]}})}function mf(){return te(this,null,function*(){try{const t=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","allow","for_value","apply_to_all_doctypes","applicable_for"],filters:{user:yield Ln()}})})).json();return t.message?t.message:[]}catch(e){return console.error("Error fetching user permissions:",e),[]}})}function hf(e){return te(this,null,function*(){try{const o=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocPerm",fields:["name","role","permlevel","read","write","create","delete","submit","cancel","amend","report","import","export","print","email","share","if_owner"],filters:{parent:e}})})).json();return o.message?o.message:[]}catch(t){return console.error(`Error fetching permissions for ${e}:`,t),[]}})}function ks(e){return te(this,null,function*(){if(ct.doctypeFields[e])return console.log(`Using cached fields for ${e}`),ct.doctypeFields[e];try{console.log(`Fetching complete doctype information for ${e}...`);let t={fields:[],meta:null,permissions:[]};const o=new Set;try{console.log(`Trying custom API for ${e}...`);const d=yield fetch("/api/method/oms.api.get_doctype_fields",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e}),credentials:"include"});if(d.ok){const l=yield d.json();l&&l.message&&Array.isArray(l.message)&&(console.log(`Custom API returned ${l.message.length} fields`),l.message.forEach(i=>{i&&i.fieldname&&!o.has(i.fieldname)&&(t.fields.push(i),o.add(i.fieldname))}))}}catch(d){console.warn("Custom API failed or not available:",d)}try{console.log(`Trying resource API for ${e}...`);const d=yield fetch(`/api/resource/DocType/${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});if(d.ok){const l=yield d.json();l&&l.data&&(console.log(`Resource API returned data for ${e}`),t.meta=l.data,l.data.fields&&Array.isArray(l.data.fields)&&l.data.fields.forEach(i=>{if(i&&i.fieldname)if(o.has(i.fieldname)){const v=t.fields.find(p=>p.fieldname===i.fieldname);v&&Object.keys(i).forEach(p=>{(v[p]===void 0||v[p]===null)&&(v[p]=i[p])})}else t.fields.push(i),o.add(i.fieldname)}))}}catch(d){console.warn("Resource API failed:",d)}try{console.log(`Trying desk form load API for ${e}...`);const d=yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e}),credentials:"include"});if(d.ok){const l=yield d.json();l&&l.message&&l.message.docs&&l.message.docs[0]&&(console.log(`Form load API returned data for ${e}`),t.meta?Object.keys(l.message.docs[0]).forEach(i=>{i!=="fields"&&(t.meta[i]===void 0||t.meta[i]===null)&&(t.meta[i]=l.message.docs[0][i])}):t.meta=l.message.docs[0],l.message.perm&&(t.permissions=l.message.perm),l.message.docs[0].fields&&Array.isArray(l.message.docs[0].fields)&&l.message.docs[0].fields.forEach(i=>{if(i&&i.fieldname)if(o.has(i.fieldname)){const v=t.fields.find(p=>p.fieldname===i.fieldname);v&&Object.keys(i).forEach(p=>{(p==="description"&&i[p]||v[p]===void 0||v[p]===null)&&(v[p]=i[p])})}else t.fields.push(i),o.add(i.fieldname)}))}}catch(d){console.warn("Form load API failed:",d)}if(t.fields.length===0)try{console.log(`Trying get_doctype API for ${e}...`);const d=yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e,with_parent:1}),credentials:"include"});if(d.ok){const l=yield d.json();l&&l.message&&l.message.docs&&l.message.docs[0]&&(console.log(`Get doctype API returned data for ${e}`),t.meta||(t.meta=l.message.docs[0]),l.message.docs[0].fields&&Array.isArray(l.message.docs[0].fields)&&l.message.docs[0].fields.forEach(i=>{i&&i.fieldname&&!o.has(i.fieldname)&&(t.fields.push(i),o.add(i.fieldname))}))}}catch(d){console.warn("Get doctype API failed:",d)}if(t.fields.length===0)throw new Error(`Could not fetch fields for ${e} from any API`);t.fields=t.fields.map(d=>ge({fieldname:d.fieldname||"",fieldtype:d.fieldtype||"Data",label:d.label||d.fieldname||"",reqd:d.reqd||0,hidden:d.hidden||0,read_only:d.read_only||0,options:d.options||"",default:d.default||"",description:d.description||"",idx:d.idx||0,allow_in_quick_entry:d.allow_in_quick_entry||0,collapsible:d.collapsible||0},d)),t.fields.sort((d,l)=>(d.idx||0)-(l.idx||0)),ct.doctypeFields[e]=t,console.log(`Successfully merged field data for ${e} from multiple sources`),console.log(`Total fields: ${t.fields.length}`);const n=t.fields.filter(d=>d.allow_in_quick_entry===1),s=t.fields.filter(d=>d.fieldtype==="Section Break"&&d.collapsible===1),r=t.fields.filter(d=>d.description&&d.description.trim()!=="");return console.log(`Fields with allow_in_quick_entry=1: ${n.length}`),console.log(`Collapsible sections: ${s.length}`),console.log(`Fields with descriptions: ${r.length}`),t}catch(t){throw console.error("Error fetching doctype fields:",t),t}})}function gf(e){return te(this,null,function*(){try{const o=(yield ks(e)).fields||[],n={};for(const s of o)n[s.fieldname]=s.permlevel||0;return n}catch(t){return console.error(`Error getting field permissions for ${e}:`,t),{}}})}function yf(r){return te(this,arguments,function*(e,t=["name"],o={},n=0,s=9999){const d=`${e}:${t.join(",")}:${JSON.stringify(o)}:${n}:${s}`;if(ct.linkOptions[d])return ct.linkOptions[d];try{const i=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e,fields:t,filters:o,start:n,limit_page_length:s})})).json();return i.message?(ct.linkOptions[d]=i.message,i.message):[]}catch(l){return console.error(`Error fetching options for ${e}:`,l),[]}})}function bf(e){return te(this,null,function*(){if(ct.clientScripts[e])return ct.clientScripts[e];try{const o=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Client Script",fields:["name","script","dt","enabled"],filters:{dt:e,enabled:1}})})).json();return o.message?(ct.clientScripts[e]=o.message,o.message):[]}catch(t){return console.error(`Error fetching client scripts for ${e}:`,t),[]}})}function wf(e,t){return te(this,null,function*(){try{const n=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e,name:t})})).json();if(n.message)return n.message;throw new Error(`Document ${e} ${t} not found`)}catch(o){throw console.error(`Error fetching document ${e} ${t}:`,o),o}})}function xf(e){return te(this,null,function*(){try{const{doctype:t,fields:o=["*"],filters:n={},orFilters:s,start:r=0,limit:d=20,orderBy:l="creation desc"}=e,i={doctype:t,fields:o,filters:n,start:r,limit_page_length:d};if(s&&s.length>0&&(i.or_filters=s),l){const[k,_]=l.split(" ");i.order_by=`${k} ${_}`}const p=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();if(p.message){const _=yield(yield fetch("/api/method/frappe.client.get_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:t,filters:n})})).json();return{records:p.message,totalCount:_.message||p.message.length}}return{records:[],totalCount:0}}catch(t){throw console.error(`Error fetching document list for ${e.doctype}:`,t),t}})}function $s(e){return te(this,null,function*(){try{const o=yield(yield fetch("/api/method/frappe.client.insert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:e})})).json();if(o.message)return o.message;throw new Error("Failed to create document")}catch(t){throw console.error(`Error creating document ${e.doctype}:`,t),t}})}function Cs(e){return te(this,null,function*(){try{const o=yield(yield fetch("/api/method/frappe.client.save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:e})})).json();if(o.message)return o.message;throw new Error("Failed to update document")}catch(t){throw console.error(`Error updating document ${e.doctype} ${e.name}:`,t),t}})}function _f(e,t=!1){return te(this,null,function*(){return t?$s(e):Cs(e)})}function kf(e,t){return te(this,null,function*(){try{if((yield(yield fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e,name:t})})).json()).message==="ok")return!0;throw new Error("Failed to delete document")}catch(o){throw console.error(`Error deleting document ${e} ${t}:`,o),o}})}function Os(e){return te(this,null,function*(){try{const t=new FormData;t.append("file",e),t.append("is_private",0);const n=yield(yield fetch("/api/method/upload_file",{method:"POST",body:t})).json();if(n.exc_type||n.exception){let s="Failed to upload file";if(n._server_messages)try{const r=JSON.parse(n._server_messages);Array.isArray(r)?s=JSON.parse(r[0]).message||s:s=r.message||s}catch(r){s=n._server_messages}else if(n.exception){const r=n.exception.match(/ValidationError: (.*?)($|\n)/);r&&r[1]&&(s=r[1])}throw console.error("Upload failed:",s),new Error(s)}if(n.message&&n.message.file_url)return console.log("File uploaded successfully:",n.message.file_url),n.message.file_url;throw new Error("Failed to upload file: No file URL returned")}catch(t){throw console.error("Error uploading file:",t),t}})}function Fs(e,t,o,n){return te(this,null,function*(){try{if(!o||!t)throw new Error("Document name and type are required to attach a file");const d=yield(yield fetch("/api/method/frappe.client.insert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc:{doctype:"File",file_url:e,attached_to_doctype:t,attached_to_name:o,attached_to_field:n,is_private:0}})})).json();if(d.exc_type||d.exception){let l="Failed to attach file to document";if(d._server_messages)try{const i=JSON.parse(d._server_messages);Array.isArray(i)?l=JSON.parse(i[0]).message||l:l=i.message||l}catch(i){l=d._server_messages}else if(d.exception){const i=d.exception.match(/ValidationError: (.*?)($|\n)/);i&&i[1]&&(l=i[1])}throw console.error("Attachment failed:",l),new Error(l)}return d.message&&d.message.file_url?(console.log("File attached successfully:",d.message.file_url),d.message.file_url):e}catch(s){throw console.error("Error attaching file to document:",s),s}})}function $f(e,t,o,n){return te(this,null,function*(){try{const s=yield Os(e);return n?yield Fs(s,t,n,o):s}catch(s){throw console.error("Error in uploadFile:",s),s}})}function Cf(e){return te(this,null,function*(){try{const o=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e,with_parent:1})})).json();return o.message&&o.message.docs&&o.message.docs[0]?o.message.docs[0].fields||[]:[]}catch(t){return console.error(`Error fetching fields for ${e}:`,t),[]}})}function Of(n){return te(this,arguments,function*(e,t=["name"],o={}){try{const r=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e,fields:t,filters:o,limit_page_length:500})})).json();return r.message?r.message:[]}catch(s){return console.error(`Error fetching options for ${e}:`,s),[]}})}function Ff(){ct.doctypeFields={},ct.linkOptions={},ct.clientScripts={}}const He={getCurrentUser:Ln,fetchUserRoles:vf,fetchUserPermissions:mf,fetchDocPermissions:hf,fetchDoctypeFields:ks,getFieldPermissions:gf,fetchLinkOptions:yf,fetchClientScripts:bf,fetchDocument:wf,fetchDocumentList:xf,createDocument:$s,updateDocument:Cs,saveDocument:_f,deleteDocument:kf,uploadFile:$f,uploadFileToTemp:Os,attachFileToDoc:Fs,clearCache:Ff,fetchChildTableFields:Cf,fetchLinkOption:Of};function Af(e){return te(this,null,function*(){try{console.log(`Checking permissions for ${e}...`);const t={read:1,write:1,create:1,delete:1,submit:0,cancel:0,report:1,share:1,if_owner:0,read_all:1};try{const n=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e})});if(n.ok){const s=yield n.json();if(s.message)return console.log(`Direct permissions API for ${e}:`,s.message),{read:s.message.read||1,write:s.message.write||1,create:s.message.create||1,delete:s.message.delete||1,submit:s.message.submit||0,cancel:s.message.cancel||0,amend:s.message.amend||0,report:s.message.report||1,import:s.message.import||0,export:s.message.export||0,print:s.message.print||0,email:s.message.email||0,share:s.message.share||1,if_owner:s.message.if_owner||0,read_all:1}}}catch(n){console.error("Error using direct permissions API:",n)}let o=[];try{const n=yield fetch("/api/method/frappe.auth.get_roles");n.ok&&(o=(yield n.json()).message||[],console.log("User roles:",o))}catch(n){console.error("Error fetching user roles:",n)}if(o.includes("Support Team"))return console.log("User has Support Team role, granting all permissions"),t;try{const n=yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:e})});if(n.ok){const s=yield n.json();if(s.message&&s.message._permissions){const r=s.message._permissions;return console.log(`Permissions from getdoctype for ${e}:`,r),{read:(r.read,1),write:(r.write,1),create:(r.create,1),delete:(r.delete,1),submit:r.submit?1:0,cancel:r.cancel?1:0,amend:r.amend?1:0,report:(r.report,1),import:r.import?1:0,export:r.export?1:0,print:r.print?1:0,email:r.email?1:0,share:(r.share,1),if_owner:r.if_owner?1:0,read_all:1}}}}catch(n){console.error("Error using getdoctype API:",n)}return console.log(`Using default permissions for ${e}`),t}catch(t){return console.error(`Error fetching permissions for ${e}:`,t),{read:1,write:1,create:1,delete:1,submit:0,cancel:0,report:1,share:1,if_owner:0,read_all:1}}})}function io(){return te(this,null,function*(){try{const e=yield fetch("/api/method/frappe.auth.get_logged_user");if(!e.ok)return console.error("Error fetching current user: Response not OK"),null;const t=yield e.json();return t.message?(console.log("Current user:",t.message),t.message):null}catch(e){return console.error("Error fetching current user:",e),null}})}const Tf={class:"filter-dropdown-container"},Sf={class:"filter-dropdown bg-white rounded-lg shadow-lg p-3 border"},Ef={key:0,class:"mb-3"},Df=["value"],jf={class:"block text-xs font-medium text-gray-700 mb-1"},Pf={key:0,class:"relative"},Lf=["onUpdate:modelValue","placeholder","onFocus","onInput","onBlur"],Mf={key:0,class:"absolute z-[200] mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm"},Rf=["onMousedown"],Hf={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-4 text-blue-600"},Bf={key:0,class:"py-2 px-3 text-gray-500 italic"},If=["onMousedown"],Vf=["onUpdate:modelValue"],Nf={value:""},zf=["value"],Uf={key:2,class:"flex gap-2"},qf=["onUpdate:modelValue"],Wf=["onUpdate:modelValue"],Jf=["onUpdate:modelValue","placeholder"],Kf={class:"mb-3"},Yf={class:"mb-3"},Xf=["value"],Gf=["value"],Qf={__name:"FilterPanel",props:{statusField:{type:Object,default:null},filterableFields:{type:Array,required:!0},sortableFields:{type:Array,required:!0},linkFieldOptions:{type:Object,default:()=>({})},statusFilter:{type:String,default:""},customFilters:{type:Object,default:()=>({})},dateFilters:{type:Object,default:()=>({})},assignmentFilter:{type:String,default:""},sortOption:{type:String,default:"creation desc"}},emits:["update:statusFilter","update:customFilters","update:dateFilters","update:assignmentFilter","update:sortOption","reset","apply"],setup(e,{emit:t}){const o=e,n=t,s=L(o.statusFilter),r=L(ge({},o.customFilters)),d=L(ge({},o.dateFilters)),l=L(o.assignmentFilter),i=L(o.sortOption),v=L({}),p=L(null),k=L({});Qe(()=>{o.filterableFields.forEach(O=>{if(O.fieldtype==="Link"&&r.value[O.fieldname]){const j=(o.linkFieldOptions[O.fieldname]||[]).find(Q=>Q.value===r.value[O.fieldname]);j?v.value[O.fieldname]=j.label:v.value[O.fieldname]=r.value[O.fieldname]}else v.value[O.fieldname]="";k.value[O.fieldname]=o.linkFieldOptions[O.fieldname]||[]})}),De(()=>o.statusFilter,O=>{s.value=O}),De(()=>o.customFilters,O=>{r.value=ge({},O),o.filterableFields.forEach(C=>{if(C.fieldtype==="Link"&&O[C.fieldname]){const Q=(o.linkFieldOptions[C.fieldname]||[]).find(ve=>ve.value===O[C.fieldname]);Q&&(v.value[C.fieldname]=Q.label)}})},{deep:!0}),De(()=>o.dateFilters,O=>{d.value=ge({},O)},{deep:!0}),De(()=>o.assignmentFilter,O=>{l.value=O}),De(()=>o.sortOption,O=>{i.value=O});const _=O=>{p.value=O,y(O)},w=O=>{setTimeout(()=>{p.value===O&&(p.value=null)},200)},y=O=>{const C=v.value[O]||"",j=o.linkFieldOptions[O]||[];C?k.value[O]=j.filter(Q=>Q.label.toLowerCase().includes(C.toLowerCase())):k.value[O]=j},F=O=>k.value[O.fieldname]||[],A=(O,C,j)=>{r.value[O]=C,v.value[O]=j,N(),p.value=null},T=O=>{r.value[O]="",v.value[O]="",N(),p.value=null},B=()=>{n("update:statusFilter",s.value)},N=()=>{n("update:customFilters",ge({},r.value))},m=()=>{n("update:dateFilters",ge({},d.value))},P=()=>{n("update:assignmentFilter",l.value)},f=()=>{n("update:sortOption",i.value)},D=()=>o.statusField&&o.statusField.options?o.statusField.options.split(`
`):["Open","Closed","Resolved","On Hold","Replied"],X=O=>O.options?O.options.split(`
`):[],U=()=>{s.value="",r.value={},v.value={};const O={};for(const C in d.value)O[C]={from:"",to:""};d.value=O,l.value="",i.value="creation desc",n("update:statusFilter",""),n("update:customFilters",{}),n("update:dateFilters",O),n("update:assignmentFilter",""),n("update:sortOption","creation desc"),n("reset")},R=()=>{n("update:statusFilter",s.value),n("update:customFilters",ge({},r.value)),n("update:dateFilters",ge({},d.value)),n("update:assignmentFilter",l.value),n("update:sortOption",i.value),n("apply")};return(O,C)=>(u(),c("div",Tf,[a("div",Sf,[e.statusField?(u(),c("div",Ef,[C[4]||(C[4]=a("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Status",-1)),Ve(a("select",{"onUpdate:modelValue":C[0]||(C[0]=j=>s.value=j),class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onChange:B},[C[3]||(C[3]=a("option",{value:""},"All Status",-1)),(u(!0),c(ae,null,xe(D(),j=>(u(),c("option",{key:j,value:j},E(j),9,Df))),128))],544),[[ao,s.value]])])):Y("",!0),(u(!0),c(ae,null,xe(e.filterableFields,j=>(u(),c("div",{key:j.fieldname,class:"mb-3"},[a("label",jf,E(j.label),1),j.fieldtype==="Link"?(u(),c("div",Pf,[Ve(a("input",{"onUpdate:modelValue":Q=>v.value[j.fieldname]=Q,type:"text",class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Search ${j.label}...`,onFocus:Q=>_(j.fieldname),onInput:Q=>y(j.fieldname),onBlur:Q=>w(j.fieldname)},null,40,Lf),[[Dt,v.value[j.fieldname]]]),p.value===j.fieldname?(u(),c("div",Mf,[(u(!0),c(ae,null,xe(F(j),Q=>(u(),c("div",{key:Q.value,class:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100",onMousedown:ve=>A(j.fieldname,Q.value,Q.label)},[a("span",{class:fe(["block truncate",{"font-semibold":r.value[j.fieldname]===Q.value}])},E(Q.label),3),r.value[j.fieldname]===Q.value?(u(),c("span",Hf,C[5]||(C[5]=[a("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))):Y("",!0)],40,Rf))),128)),F(j).length===0?(u(),c("div",Bf," No results found ")):Y("",!0),a("div",{class:"py-2 px-3 text-blue-600 hover:bg-gray-100 cursor-pointer border-t",onMousedown:Q=>T(j.fieldname)}," Clear selection ",40,If)])):Y("",!0)])):j.fieldtype==="Select"?Ve((u(),c("select",{key:1,"onUpdate:modelValue":Q=>r.value[j.fieldname]=Q,class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onChange:N},[a("option",Nf,"All "+E(j.label),1),(u(!0),c(ae,null,xe(X(j),Q=>(u(),c("option",{key:Q,value:Q},E(Q),9,zf))),128))],40,Vf)),[[ao,r.value[j.fieldname]]]):j.fieldtype==="Date"||j.fieldtype==="Datetime"?(u(),c("div",Uf,[Ve(a("input",{"onUpdate:modelValue":Q=>d.value[j.fieldname].from=Q,type:"date",class:"w-1/2 border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"From",onChange:m},null,40,qf),[[Dt,d.value[j.fieldname].from]]),Ve(a("input",{"onUpdate:modelValue":Q=>d.value[j.fieldname].to=Q,type:"date",class:"w-1/2 border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"To",onChange:m},null,40,Wf),[[Dt,d.value[j.fieldname].to]])])):Ve((u(),c("input",{key:3,"onUpdate:modelValue":Q=>r.value[j.fieldname]=Q,type:"text",class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:`Filter by ${j.label}`,onInput:N},null,40,Jf)),[[Dt,r.value[j.fieldname]]])]))),128)),a("div",Kf,[C[7]||(C[7]=a("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Assignment",-1)),Ve(a("select",{"onUpdate:modelValue":C[1]||(C[1]=j=>l.value=j),class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onChange:P},C[6]||(C[6]=[a("option",{value:""},"All Records",-1),a("option",{value:"assigned_to_me"},"Assigned to Me",-1),a("option",{value:"created_by_me"},"Created by Me",-1),a("option",{value:"both"},"Both",-1)]),544),[[ao,l.value]])]),a("div",Yf,[C[10]||(C[10]=a("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Sort By",-1)),Ve(a("select",{"onUpdate:modelValue":C[2]||(C[2]=j=>i.value=j),class:"w-full border rounded-lg py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onChange:f},[C[8]||(C[8]=a("option",{value:"creation desc"},"Newest First",-1)),C[9]||(C[9]=a("option",{value:"creation asc"},"Oldest First",-1)),(u(!0),c(ae,null,xe(e.sortableFields,j=>(u(),c("option",{key:j.fieldname,value:`${j.fieldname} asc`},E(j.label)+" (A-Z) ",9,Xf))),128)),(u(!0),c(ae,null,xe(e.sortableFields,j=>(u(),c("option",{key:`${j.fieldname}-desc`,value:`${j.fieldname} desc`},E(j.label)+" (Z-A) ",9,Gf))),128))],544),[[ao,i.value]])]),a("div",{class:"flex justify-between"},[a("button",{onClick:U,class:"px-3 py-1.5 text-sm border rounded-lg hover:bg-gray-50"}," Reset "),a("button",{onClick:R,class:"px-3 py-1.5 text-sm bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-colors"}," Apply ")])])]))}},Zf=_e(Qf,[["__scopeId","data-v-0f663b1e"]]),ev={class:"p-4"},tv={class:"bg-white rounded-xl shadow-md p-3 mb-4 sticky top-0 z-10"},ov={class:"flex items-center gap-2"},nv={class:"flex-1 relative"},rv=["placeholder"],sv={class:"relative"},av={key:0,class:"absolute -top-1 -right-1 bg-blue-600 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center"},iv={key:0,class:"flex justify-center items-center py-8"},lv={key:1,class:"bg-white rounded-xl shadow-md p-6 text-center"},dv={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-blue-100 flex items-center justify-center"},uv={class:"text-gray-600 mb-4"},cv={key:2,class:"space-y-4"},pv=["onClick"],fv={class:"flex justify-between items-start"},vv={class:"flex-1"},mv={class:"flex items-center space-x-2 flex-wrap gap-2"},hv={class:"text-sm text-gray-500"},gv={key:1,class:"flex items-center text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full"},yv={key:2,class:"flex items-center text-gray-600 bg-gray-50 px-2 py-0.5 rounded-full"},bv={class:"text-xs font-medium"},wv={class:"font-semibold text-gray-800 mt-1 text-lg"},xv={class:"flex flex-wrap gap-4 mt-2"},_v={key:3,class:"mt-6 flex justify-between items-center"},kv=["disabled"],$v={class:"text-sm text-gray-600 bg-white px-4 py-2 rounded-lg border"},Cv=["disabled"],Ov={__name:"ListView",props:{doctype:{type:String,required:!0},titleField:{type:String,default:"subject"},listFields:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})},showOnlyOwnRecords:{type:Boolean,default:!1}},emits:["record-click"],setup(e,{emit:t}){const o=e,n=$o();gn();const s=L([]),r=L(!0),d=L([]);L(null);const l=L({}),i=L([]),v=L(!1),p=L(null),k=L({}),_=L({}),w=L(""),y=L(""),F=L({}),A=L({}),T=L("creation desc"),B=L(""),N=L(!1),m=L(1),P=L(20),f=L(1),D=L(0),X=L([]),U=()=>`${o.doctype.toLowerCase()}_list_state`,R=()=>{const g={searchQuery:w.value,statusFilter:y.value,customFilters:F.value,dateFilters:A.value,sortOption:T.value,assignmentFilter:B.value,currentPage:m.value};localStorage.setItem(U(),JSON.stringify(g))},O=()=>{try{const g=localStorage.getItem(U());if(g){const x=JSON.parse(g);return w.value=x.searchQuery||"",y.value=x.statusFilter||"",F.value=x.customFilters||{},A.value=x.dateFilters||{},T.value=x.sortOption||"creation desc",B.value=x.assignmentFilter||"",m.value=x.currentPage||1,!0}}catch(g){console.error("Error loading filter state:",g)}return!1},C=ne(()=>o.doctype.toLowerCase().replace(/\s+/g,"-")),j=ne(()=>y.value!==""||w.value!==""||B.value!==""||Object.values(F.value).some(g=>g!=="")||Object.values(A.value).some(g=>g.from||g.to)),Q=ne(()=>{let g=0;return y.value&&g++,w.value&&g++,B.value&&g++,g+=Object.values(F.value).filter(x=>x!=="").length,g+=Object.values(A.value).filter(x=>x.from||x.to).length,g}),ve=ne(()=>d.value.find(g=>g.fieldname==="status")),ue=ne(()=>d.value.filter(g=>["Data","Link","Select","Date","Datetime"].includes(g.fieldtype))),oe=ne(()=>d.value.filter(g=>["Data","Link","Select","Date","Datetime","Int","Float"].includes(g.fieldtype)&&!["name","creation","modified","modified_by","owner"].includes(g.fieldname)&&g.fieldname!=="status").slice(0,5)),K=ne(()=>{if(o.listFields.length>0)return o.listFields.map(V=>d.value.find(re=>re.fieldname===V)).filter(Boolean);const g=d.value.filter(V=>V.in_list_view===1||V.in_list_view===!0||V.in_list_view==="1");if(g.length>0)return g.slice(0,4);const x=["name","title","subject","status","creation"];return d.value.filter(V=>x.includes(V.fieldname)).slice(0,3)}),ee=()=>te(this,null,function*(){try{v.value=!0,console.log(`Permission check for ${o.doctype}: canCreate = ${v.value}`);const g=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:o.doctype})});if(g.ok){const x=yield g.json();x.message&&(v.value=!0,console.log(`Direct permissions for ${o.doctype}:`,x.message))}}catch(g){console.error("Error checking permissions:",g),v.value=!0}}),ke=()=>te(this,null,function*(){try{const g=yield He.fetchDoctypeFields(o.doctype);if(Array.isArray(g))d.value=g;else if(g&&g.fields)d.value=g.fields;else throw new Error("Invalid response format");d.value.filter(x=>x.fieldtype==="Date"||x.fieldtype==="Datetime").forEach(x=>{A.value[x.fieldname]={from:"",to:""}}),yield ye()}catch(g){console.error("Error fetching doctype fields:",g),g.value="Failed to load doctype fields"}}),we=()=>te(this,null,function*(){try{const x=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield io()]}})})).json();x.message&&(i.value=x.message,console.log("User permissions:",i.value))}catch(g){console.error("Error fetching user permissions:",g)}}),ye=()=>te(this,null,function*(){const g=[...K.value,...oe.value].filter(x=>x&&x.fieldtype==="Link").reduce((x,V)=>(x.some(re=>re.fieldname===V.fieldname)||x.push(V),x),[]);for(const x of g)try{console.log(`Fetching options for ${x.fieldname} (${x.options})`);let V=[];x.options==="Project"?V=(yield He.fetchLinkOptions("Project",["name","project_name"])).map(de=>({value:de.name,label:de.project_name||de.name})):x.options==="Contact"?V=(yield He.fetchLinkOptions("Contact",["name","first_name","last_name"])).map(de=>({value:de.name,label:`${de.first_name||""} ${de.last_name||""} (${de.name})`})):V=(yield He.fetchLinkOptions(x.options,["name"])).map(de=>({value:de.name,label:de.name})),l.value[x.fieldname]=V}catch(V){console.error(`Error fetching options for ${x.fieldname}:`,V)}}),Fe=()=>te(this,null,function*(){try{p.value||(p.value=yield io());const x=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["reference_name","allocated_to"],filters:{reference_type:o.doctype,status:"Open"}})})).json();if(x.message){const V={},re={};x.message.forEach(de=>{de.allocated_to===p.value&&(V[de.reference_name]=!0),re[de.reference_name]=de.allocated_to}),k.value=V,_.value=re,console.log("Assigned records:",k.value),console.log("Assigned users:",_.value)}}catch(g){console.error("Error fetching assigned records:",g)}}),J=g=>k.value[g.name]===!0||g.allocated_to&&g.allocated_to===p.value,q=g=>_.value[g.name]&&_.value[g.name]!==p.value,h=g=>{const x=_.value[g.name];return x?x.substring(0,2).toUpperCase():""},H=()=>te(this,null,function*(){r.value=!0;try{const g=ge({},o.filters);se(g),p.value||(p.value=yield io()),yield Fe();let x=[];if(B.value){if(B.value==="assigned_to_me"){const de=Object.keys(k.value);de.length>0?x.push(["name","in",de]):x.push(["name","=","no-assignments-found"]),d.value.some(ht=>ht.fieldname==="allocated_to")&&x.push(["allocated_to","=",p.value])}else if(B.value==="created_by_me")x.push(["owner","=",p.value]);else if(B.value==="both"){const de=Object.keys(k.value);de.length>0&&x.push(["name","in",de]),d.value.some(ht=>ht.fieldname==="allocated_to")&&x.push(["allocated_to","=",p.value]),x.push(["owner","=",p.value])}}else o.showOnlyOwnRecords&&p.value&&(x.push(["owner","=",p.value]),d.value.some($e=>$e.fieldname==="allocated_to")&&x.push(["allocated_to","=",p.value]),Object.keys(k.value).length>0&&x.push(["name","in",Object.keys(k.value)]));y.value&&(g.status=y.value);for(const[de,$e]of Object.entries(F.value))$e&&(g[de]=$e);for(const[de,$e]of Object.entries(A.value))$e.from&&$e.to?g[de]=["between",[$e.from,$e.to]]:$e.from?g[de]=[">=",$e.from]:$e.to&&(g[de]=["<=",$e.to]);let V=[];if(w.value.trim()){const de=w.value.trim();V.push([o.doctype,"name","like",`%${de}%`]),V.push([o.doctype,o.titleField,"like",`%${de}%`])}console.log("Fetching all records with filters:",g),console.log("OR filters:",x);const re=yield He.fetchDocumentList({doctype:o.doctype,fields:["*"],filters:g,orFilters:x.length>0?x:V.length>0?V:void 0,limit:1e3,orderBy:T.value});X.value=re.records,D.value=re.records.length,f.value=Math.ceil(D.value/P.value),console.log(`Fetched ${X.value.length} total records. Pages: ${f.value}`),M(),R()}catch(g){console.error(`Error fetching ${o.doctype} records:`,g),g.value=`Failed to load ${o.doctype} records`}finally{r.value=!1}}),M=()=>{const g=(m.value-1)*P.value,x=Math.min(g+P.value,X.value.length);console.log(`Updating displayed records for page ${m.value}, start: ${g}, end: ${x}`),s.value=X.value.slice(g,x),console.log(`Displaying ${s.value.length} records for page ${m.value}`)},se=g=>{const x=i.value.filter(V=>V.allow===o.doctype);if(x.length>0){const V={};for(const re of x){const de=d.value.filter($e=>$e.fieldtype==="Link"&&$e.options===re.allow);for(const $e of de)V[$e.fieldname]||(V[$e.fieldname]=[]),V[$e.fieldname].push(re.for_value)}for(const[re,de]of Object.entries(V))de.length===1?g[re]=de[0]:g[re]=["in",de]}},ie=g=>g[o.titleField]||g.name||"Untitled",me=g=>{switch(g.toLowerCase()){case"open":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-green-100 text-green-800";case"resolved":return"bg-blue-100 text-blue-800";case"on hold":case"hold":return"bg-orange-100 text-orange-800";case"replied":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},Ae=g=>{if(!g)return In;switch(g.fieldname){case"project":return va;case"priority":return fa;case"custom_raised_by_contact":case"raised_by":case"allocated_to":return la;case"creation":case"modified":return ca;case"status":return ya;case"company":return ia;case"custom_raised_by_mobile":return aa;case"email":return sa;default:return In}},Me=g=>g?g.label||g.fieldname:"",Ne=(g,x)=>{if(!g||!x)return"";const V=g[x.fieldname];return V==null?"":x.fieldtype==="Link"&&g[`${x.fieldname}_data`]?g[`${x.fieldname}_data`].label||V:x.fieldtype==="Date"||x.fieldtype==="Datetime"?Je(V):V},Je=g=>g?new Date(g).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ie=g=>{R(),n.push(`/${C.value}/${g.name}`)},Be=()=>{clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{if(m.value=1,w.value.trim()){const g=w.value.trim().toLowerCase(),x=X.value.filter(V=>V.name.toLowerCase().includes(g)||V[o.titleField]&&V[o.titleField].toLowerCase().includes(g));s.value=x.slice(0,P.value),D.value=x.length,f.value=Math.ceil(D.value/P.value)}else M();R()},300)},he=()=>{y.value="",T.value="creation desc",w.value="",F.value={},B.value="";for(const g in A.value)A.value[g]={from:"",to:""};N.value=!1,m.value=1,localStorage.removeItem(U()),H()},Te=()=>{N.value=!1,m.value=1,H()},Ee=()=>{m.value>1&&(m.value--,M(),R())},Se=()=>{m.value<f.value&&(m.value++,M(),R())},S=g=>{const x=document.querySelector(".filter-dropdown"),V=document.querySelector(".filter-toggle-btn");N.value&&x&&!x.contains(g.target)&&!V.contains(g.target)&&(N.value=!1)};return Qe(()=>te(this,null,function*(){console.log(`ListView component mounted for ${o.doctype}`);try{p.value=yield io(),yield ee(),yield ke(),yield we();const g=O();console.log(`Filter state loaded: ${g}`),yield Fe(),yield H()}catch(g){console.error("Error initializing component:",g),g.value="Failed to initialize component"}document.addEventListener("click",S)})),De(T,()=>{m.value=1,H()}),De(()=>o.doctype,()=>te(this,null,function*(){r.value=!0,d.value=[],s.value=[],X.value=[],m.value=1,localStorage.removeItem(U());try{yield ee(),yield ke(),yield we(),yield Fe(),yield H()}catch(g){console.error("Error when doctype changed:",g)}finally{r.value=!1}})),De(()=>o.filters,()=>{m.value=1,H()},{deep:!0}),qo(()=>{R()}),mn(()=>{document.removeEventListener("click",S)}),(g,x)=>(u(),c("div",ev,[a("div",tv,[a("div",ov,[a("div",nv,[Ve(a("input",{"onUpdate:modelValue":x[0]||(x[0]=V=>w.value=V),type:"text",placeholder:`Search ${e.doctype}...`,class:"w-full pl-8 pr-2 py-2 text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onInput:Be},null,40,rv),[[Dt,w.value]]),ce(le(ha),{class:"h-4 w-4 text-gray-400 absolute left-2 top-2.5"})]),a("div",sv,[a("button",{onClick:x[1]||(x[1]=V=>N.value=!N.value),class:fe(["p-2 border rounded-lg hover:bg-gray-50 relative filter-toggle-btn",{"bg-blue-50 border-blue-300":j.value}])},[ce(le(ma),{class:fe(["h-5 w-5",j.value?"text-blue-600":"text-gray-600"])},null,8,["class"]),j.value?(u(),c("span",av,E(Q.value),1)):Y("",!0)],2),N.value?(u(),Ce(Zf,{key:0,"status-field":ve.value,"filterable-fields":oe.value,"sortable-fields":ue.value,"link-field-options":l.value,"status-filter":y.value,"custom-filters":F.value,"date-filters":A.value,"assignment-filter":B.value,"sort-option":T.value,"onUpdate:statusFilter":x[2]||(x[2]=V=>y.value=V),"onUpdate:customFilters":x[3]||(x[3]=V=>F.value=V),"onUpdate:dateFilters":x[4]||(x[4]=V=>A.value=V),"onUpdate:assignmentFilter":x[5]||(x[5]=V=>B.value=V),"onUpdate:sortOption":x[6]||(x[6]=V=>T.value=V),onReset:he,onApply:Te},null,8,["status-field","filterable-fields","sortable-fields","link-field-options","status-filter","custom-filters","date-filters","assignment-filter","sort-option"])):Y("",!0)]),v.value?(u(),c("button",{key:0,onClick:x[7]||(x[7]=V=>g.$router.push(`/${C.value}/new`)),class:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg flex items-center hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-md"},[ce(le(ga),{class:"h-5 w-5 mr-1"}),x[9]||(x[9]=pe(" New "))])):Y("",!0)])]),r.value?(u(),c("div",iv,x[10]||(x[10]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):s.value.length===0?(u(),c("div",lv,[a("div",dv,[ce(le(pa),{class:"h-8 w-8 text-blue-600"})]),a("p",uv,"No "+E(e.doctype)+" found",1),v.value?(u(),c("button",{key:0,onClick:x[8]||(x[8]=V=>g.$router.push(`/${C.value}/new`)),class:"mt-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 shadow-md"}," Create New "+E(e.doctype),1)):Y("",!0)])):(u(),c("div",cv,[(u(!0),c(ae,null,xe(s.value,V=>(u(),c("div",{key:V.name,onClick:re=>Ie(V),class:"bg-white rounded-xl shadow-md p-4 cursor-pointer hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 border border-transparent hover:border-blue-100"},[a("div",fv,[a("div",vv,[a("div",mv,[a("span",hv,E(V.name),1),V.status?(u(),c("div",{key:0,class:fe([me(V.status),"px-2 py-0.5 rounded-full text-xs font-medium"])},E(V.status),3)):Y("",!0),J(V)?(u(),c("div",gv,[ce(le(Vn),{class:"h-4 w-4 mr-1"}),x[11]||(x[11]=a("span",{class:"text-xs font-medium"},"Assigned to me",-1))])):q(V)?(u(),c("div",yv,[ce(le(Vn),{class:"h-4 w-4 mr-1"}),a("span",bv,E(h(V)),1)])):Y("",!0)]),a("h3",wv,E(ie(V)),1),a("div",xv,[(u(!0),c(ae,null,xe(K.value,(re,de)=>(u(),c("div",{key:de,class:"flex items-center text-sm text-gray-500"},[(u(),Ce(lo(Ae(re)),{class:"h-4 w-4 mr-1 text-blue-500"})),a("span",null,E(Me(re))+": "+E(Ne(V,re)),1)]))),128))])])])],8,pv))),128))])),f.value>1?(u(),c("div",_v,[a("button",{onClick:Ee,disabled:m.value===1,class:"px-4 py-2 bg-white border rounded-lg disabled:opacity-50 hover:bg-gray-50 transition-colors flex items-center"},x[12]||(x[12]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),pe(" Previous ")]),8,kv),a("span",$v," Page "+E(m.value)+" of "+E(f.value),1),a("button",{onClick:Se,disabled:m.value===f.value,class:"px-4 py-2 bg-white border rounded-lg disabled:opacity-50 hover:bg-gray-50 transition-colors flex items-center"},x[13]||(x[13]=[pe(" Next "),a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Cv)])):Y("",!0)]))}},Fv={hiddenFields:[],readonlyFields:[],hiddenViewFields:[]},Mn=["name","owner","creation","modified","modified_by","docstatus","idx","parent","parentfield","parenttype"],br={Task:{hiddenFields:["tna_base_document_no","tna_planne","custom_tna_end_date","completed_by","completed_on","start","duration","custom_section_break_iahoa","custom_task_resource","custom_total_amount","sb_depends_on","depends_on","depends_on_tasks","act_start_date","act_end_date","review_date","closing_date","custom_development_checklist","custom_qc_check","color"],readonlyFields:[],hiddenViewFields:["custom_section_break_iahoa","custom_task_resource","custom_total_amount","sb_depends_on","depends_on","actual_time","custom_developer_name","custom_development_complete","company","custom_development_checklist","custom_qc_complete","custom_qc_check"]},Issue:{hiddenFields:[],readonlyFields:[],hiddenViewFields:[]},"Timesheet Detail":{hiddenFields:["activity_type"],readonlyFields:[],hiddenViewFields:[...Mn,"activity_type"]}};function Av(e){return br[e]?br[e]:e&&(e.includes("Detail")||e.includes("Item")||e.includes("Child"))?{hiddenFields:[],readonlyFields:[],hiddenViewFields:Mn}:Fv}function mo(e,t){return Mn.includes(t)&&(e.includes("Detail")||e.includes("Item")||e.includes("Child"))?!0:Av(e).hiddenViewFields.includes(t)}const xt={global:["naming_series","section_break_19","email_account","via_customer_portal","subject_section"],doctypes:{Issue:["avg_response_time","total_hold_time","lead","first_response_time","user_resolution_time","opening_date","opening_time","resolution_time","agreement_status","service_level_agreement","response_by","resolution_by","response_by_variance","resolution_by_variance","on_hold_since","total_hold_time","user","customer_name","service_level_section","issue_split_from","contact","resolution_details","response","first_responded_on","additional_info","custom_qc_count","custom_qc_rework_count","custom_client_rework_count","custom_client_change_count_","sla_resolution_by","customer","custom_issue_tracker","company"],Task:["sb_depends_on","depends_on","depends_on_tasks","sb_actual","act_start_date","act_end_date","actual_time","sb_costing","total_costing_amount","total_billing_amount","total_expense_claim","sb_more_info","review_date","closing_date","department","custom_custom_title","custom_development_complete","custom_section_break_ixk4k","custom_development_checklist","custom_section_break_5sqth","custom_development_note","custom_qc_date","custom_qc_template","custom_tester","custom_qc_complete","custom_section_break_n3cef","custom_qc_check","custom_section_break_qrtn3","custom_quality_control_notes","tna_base_document_no","tna_planner","tna_status","custom_tna_end_date","completed_by","completed_on","start","duration","is_milestone","custom_section_break_iahoa","custom_task_resource","custom_total_amount"],Timesheet:["sales_invoice","salary_slip","start_date","end_date","total_billed_hours","total_billed_amount","base_total_billable_amount","base_total_billed_amount","base_total_costing_amount","per_billed","section_break_18","note","company","customer","exchange_rate","currency"],"Timesheet Detail":["billing_hours","billing_rate","billing_amount","base_billing_rate","base_billing_amount","costing_rate","costing_amount","base_costing_rate","base_costing_amount","weightage","project_name","is_billable","sales_invoice"]},additional:[]},Uo=e=>{const t=[...xt.global,...xt.additional];if(e)if(xt.doctypes[e])t.push(...xt.doctypes[e]);else{const o=Object.keys(xt.doctypes).find(n=>n.toLowerCase()===e.toLowerCase());o&&t.push(...xt.doctypes[o])}return t};[...xt.global,...xt.doctypes.Issue||[],...xt.doctypes.Task||[],...xt.doctypes.TimeSheet||[]];const Tv={class:"mb-6"},Sv={class:"block text-sm font-medium text-gray-700 mb-1 group relative"},Ev={key:0,class:"text-red-500"},Dv={key:1,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help"},jv={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4"},Pv={key:0,class:"bg-gray-100 p-2 mb-2 text-xs rounded"},Lv={key:0,class:"text-red-500"},Mv={key:1,class:"flex justify-center items-center py-4 bg-white rounded-lg border border-gray-200"},Rv={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4"},Hv={key:3,class:"bg-white rounded-lg border border-gray-200 p-4 text-center"},Bv={class:"flex flex-col items-center justify-center py-6"},Iv={class:"text-gray-500 mb-4"},Vv={key:4,class:"bg-white rounded-lg border border-gray-200 overflow-hidden"},Nv={class:"flex items-center justify-between p-4 border-b border-gray-200"},zv={class:"text-lg font-medium text-gray-900"},Uv={class:"overflow-x-auto"},qv={class:"min-w-full divide-y divide-gray-200"},Wv={class:"bg-gray-50"},Jv={class:"bg-white divide-y divide-gray-200"},Kv=["onClick"],Yv={key:0,class:"flex items-center"},Xv={key:0,class:"h-2.5 w-2.5 rounded-full bg-white"},Gv={key:0,class:"text-blue-600"},Qv={key:1,class:"text-gray-400 italic"},Zv={key:0},em={key:1,class:"text-gray-400 italic"},tm={key:0,class:"whitespace-pre-line max-h-20 overflow-y-auto"},om={key:1,class:"text-gray-400 italic"},nm={key:0,class:"flex items-center"},rm={key:1,class:"text-gray-400 italic"},sm={key:0,class:"font-medium"},am={key:1,class:"text-gray-400 italic"},im={key:0},lm={key:1,class:"text-gray-400 italic"},dm={class:"flex justify-end space-x-2"},um={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]"},cm={class:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden"},pm={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},fm={class:"text-lg font-medium text-gray-900"},vm={key:0},mm={key:1},hm={key:2},gm={class:"p-6 overflow-y-auto max-h-[calc(90vh-8rem)]"},ym={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},bm={key:0,class:"col-span-1 md:col-span-2 border-t border-gray-200 pt-6 mt-2"},wm={key:0,class:"text-base font-medium text-gray-900 mb-4"},xm={key:1,class:"hidden md:block"},_m={key:0,class:"relative"},km={key:0,class:"text-red-500 ml-1"},$m={key:1},Cm={class:"block text-sm font-medium text-gray-700 mb-1"},Om={class:"p-2 bg-gray-50 rounded-lg border border-gray-200"},Fm={key:0},Am={key:1,class:"text-gray-400 italic"},Tm={key:2,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm"},Sm=["onMousedown"],Em={class:"block truncate font-medium"},Dm={key:0,class:"block text-xs text-gray-500 truncate"},jm={key:1,class:"absolute inset-y-0 right-0 flex items-center pr-4 text-blue-600"},Pm={key:0,class:"py-2 px-3 text-gray-500 italic"},Lm={key:1,class:"flex items-center"},Mm={key:0,class:"text-red-500 ml-1"},Rm={key:1},Hm={class:"block text-sm font-medium text-gray-700 mb-1"},Bm={class:"p-2 bg-gray-50 rounded-lg border border-gray-200 flex items-center"},Im={key:0,class:"h-2.5 w-2.5 rounded-full bg-white"},Vm={key:0,class:"text-red-500 ml-1"},Nm={key:3},zm={class:"block text-sm font-medium text-gray-700 mb-1"},Um={class:"p-2 bg-gray-50 rounded-lg border border-gray-200"},qm={key:0},Wm={key:1,class:"text-gray-400 italic"},Jm={key:0,class:"text-red-500 ml-1"},Km={key:5},Ym={class:"block text-sm font-medium text-gray-700 mb-1"},Xm={class:"p-2 bg-gray-50 rounded-lg border border-gray-200"},Gm={key:0},Qm={key:1,class:"text-gray-400 italic"},Zm={key:0,class:"text-red-500 ml-1"},eh={key:7},th={class:"block text-sm font-medium text-gray-700 mb-1"},oh={class:"p-2 bg-gray-50 rounded-lg border border-gray-200"},nh={key:0},rh={key:1,class:"text-gray-400 italic"},sh={key:0,class:"text-red-500 ml-1"},ah={key:9},ih={class:"block text-sm font-medium text-gray-700 mb-1"},lh={class:"p-2 bg-gray-50 rounded-lg border border-gray-200 whitespace-pre-line"},dh={key:0},uh={key:1,class:"text-gray-400 italic"},ch={key:0,class:"text-red-500 ml-1"},ph={key:11},fh={class:"block text-sm font-medium text-gray-700 mb-1"},vh={class:"p-2 bg-gray-50 rounded-lg border border-gray-200"},mh={key:0},hh={key:1,class:"text-gray-400 italic"},gh={key:0,class:"text-red-500 ml-1"},yh={key:13},bh={class:"block text-sm font-medium text-gray-700 mb-1"},wh={class:"p-2 bg-gray-50 rounded-lg border border-gray-200"},xh={key:0},_h={key:1,class:"text-gray-400 italic"},kh={class:"px-6 py-4 bg-gray-50 text-right"},$h={class:"flex justify-end space-x-3"},Ch=3,Oh={__name:"ChildTableComponent",props:{modelValue:{type:Array,default:()=>[]},fieldname:{type:String,required:!0},label:{type:String,required:!0},description:{type:String,default:""},required:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!1},childDoctype:{type:String,required:!0},parentDoctype:{type:String,required:!0},debug:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:t}){const o=e,n=t,s=vn("formData",L({})),r=L([]),d=L(!0),l=L(!1),i=L({}),v=L(-1),p=L("add"),k=L({}),_=L({}),w=L(null),y=L(null),F=L(0),A=ne(()=>{const J=Uo(o.childDoctype);return r.value.filter(q=>!q.hidden&&q.fieldtype!=="Section Break"&&q.fieldtype!=="Column Break"&&q.fieldtype!=="HTML"&&q.fieldtype!=="Button"&&!["name","owner","creation","modified","modified_by","docstatus","idx","parent","parentfield","parenttype"].includes(q.fieldname)&&!J.includes(q.fieldname))}),T=ne(()=>{const J=Uo(o.childDoctype);return r.value.filter(q=>!["name","owner","creation","modified","modified_by","docstatus","idx","parent","parentfield","parenttype"].includes(q.fieldname)&&!J.includes(q.fieldname)).sort((q,h)=>(q.idx||0)-(h.idx||0))}),B=ne(()=>{const J=A.value.filter(q=>q.in_list_view===!0||q.in_list_view===1||q.in_list_view==="1");return J.length===0?A.value.slice(0,5):J}),N=ne(()=>r.value.filter(J=>!J.hidden&&!["name","owner","creation","modified","modified_by","docstatus","idx","parent","parentfield","parenttype"].includes(J.fieldname)).sort((J,q)=>(J.idx||0)-(q.idx||0))),m=()=>te(this,null,function*(){var J;try{F.value++;const H=((J=(yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocType",name:o.childDoctype}),credentials:"include"})).json()).message)==null?void 0:J.fields)||[],ie=(yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Custom Field",filters:{dt:o.childDoctype},fields:["*"],limit_page_length:500}),credentials:"include"})).json()).message||[];r.value=[...H.map(me=>We(ge({},me),{is_custom_field:!1})),...ie.map(me=>We(ge({},me),{is_custom_field:!0,fieldname:me.fieldname,fieldtype:me.fieldtype,label:me.label,reqd:me.reqd===1,options:me.options,description:me.description,idx:me.idx,hidden:me.hidden===1,read_only:me.read_only===1,in_list_view:me.in_list_view===1,allow_in_quick_entry:me.allow_in_quick_entry===1}))],r.value.sort((me,Ae)=>(me.idx||0)-(Ae.idx||0))}catch(q){if(console.error("Error fetching fields:",q),F.value<Ch)return yield m();q.value=`Could not fetch fields for ${o.childDoctype}`,r.value=[{fieldname:"description",label:"Description",fieldtype:"Small Text"},{fieldname:"qty",label:"Quantity",fieldtype:"Float"},{fieldname:"rate",label:"Rate",fieldtype:"Currency"},{fieldname:"amount",label:"Amount",fieldtype:"Currency"}]}}),P=()=>te(this,null,function*(){var q,h;const J=r.value.filter(H=>H.fieldtype==="Link");for(const H of J)try{if(!H.options)continue;const ie=((q=(yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocType",name:H.options,fields:["title_field"]}),credentials:"include"})).json()).message)==null?void 0:q.title_field)||"name",Me=(yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocField",fields:["fieldname","fieldtype"],filters:{parent:H.options},limit_page_length:0}),credentials:"include"})).json()).message||[],Ne=new Set(["name",ie,"creation"]);["first_name","last_name","full_name","project_name","subject","title","customer_name","employee_name"].forEach(he=>{Me.some(Te=>Te.fieldname===he)&&Ne.add(he)}),Me.some(he=>he.fieldname==="status")&&Ne.add("status");const Ie=yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:H.options,fields:Array.from(Ne),limit_page_length:0,order_by:"creation desc"}),credentials:"include"});if(!Ie.ok)throw new Error(`Failed to fetch options for ${H.fieldname}`);const Be=yield Ie.json();Be.message&&(k.value[H.fieldname]=Be.message.map(he=>{let Te=he[ie]||he.name;return Te===he.name&&(he.first_name&&he.last_name?Te=`${he.first_name} ${he.last_name}`.trim():he.full_name?Te=he.full_name:he.project_name?Te=he.project_name:he.subject?Te=he.subject:he.title?Te=he.title:he.customer_name?Te=he.customer_name:he.employee_name&&(Te=he.employee_name)),ge({value:he.name,label:Te||he.name,description:he.name!==Te?`${he.name}`:void 0,creation:he.creation},he.status&&{status:he.status})}))}catch(M){console.error(`Error fetching options for ${H.fieldname}:`,M);const ie=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:H.options,fields:["name"],limit_page_length:500}),credentials:"include"})).json();k.value[H.fieldname]=((h=ie.message)==null?void 0:h.map(me=>({value:me.name,label:me.name})))||[]}}),f=J=>J===!0||J===1||J==="1"||J==="Yes",D=J=>{const q={};return J.fieldtype==="Check"?q.width="80px":J.fieldtype==="Int"||J.fieldtype==="Float"?q.width="100px":J.fieldtype==="Date"||J.fieldtype==="Color"?q.width="120px":J.fieldtype==="Small Text"&&(q.minWidth="200px"),q},X=(J,q)=>{if(!q)return"";const H=(k.value[J.fieldname]||[]).find(M=>M.value===q);return H?H.label:q},U=J=>J.options?J.options.split(`
`).filter(Boolean).map(q=>({value:q,label:q})):[],R=J=>{if(!J)return"";try{return new Date(J).toLocaleDateString()}catch(q){return J}},O=J=>{try{return parseFloat(J).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}catch(q){return J}},C=J=>o.isReadOnly||J.read_only===1||J.read_only===!0||J.read_only==="1",j=J=>{var q;J&&(J.preventDefault(),J.stopPropagation()),i.value={},_.value={},r.value.forEach(h=>{h.fieldtype==="Check"?i.value[h.fieldname]=!1:h.default?i.value[h.fieldname]=h.default:i.value[h.fieldname]=""}),i.value.parentfield=o.fieldname,i.value.parenttype=o.parentDoctype,delete i.value.parent,delete i.value.name,o.childDoctype==="Timesheet Detail"&&((q=s.value)!=null&&q.parent_project)&&(i.value.project=s.value.parent_project,r.value.find(H=>H.fieldname==="project")&&(_.value.project=s.value.parent_project_name||s.value.parent_project)),v.value=-1,p.value="add",l.value=!0},Q=J=>{i.value=JSON.parse(JSON.stringify(o.modelValue[J])),_.value={},r.value.filter(q=>q.fieldtype==="Link").forEach(q=>{const h=i.value[q.fieldname];if(h){const M=(k.value[q.fieldname]||[]).find(se=>se.value===h);_.value[q.fieldname]=M?M.label:h}}),v.value=J,p.value="view",l.value=!0},ve=()=>{p.value="edit"},ue=()=>{var H;const J=N.value.filter(M=>M.reqd&&!i.value[M.fieldname]);if(J.length>0){alert(`Please fill in all required fields: ${J.map(M=>M.label).join(", ")}`);return}if(o.childDoctype==="Timesheet Detail"&&((H=s.value)!=null&&H.parent_project)){if(i.value.project&&i.value.project!==s.value.parent_project){alert(`Project must be same as the one set in the Timesheet: ${s.value.parent_project}`);return}i.value.project=s.value.parent_project}N.value.forEach(M=>{["Int","Float","Currency","Percent"].includes(M.fieldtype)&&i.value[M.fieldname]!==void 0&&i.value[M.fieldname]!==null&&i.value[M.fieldname]!==""&&(i.value[M.fieldname]=parseFloat(i.value[M.fieldname]))});const q=[...o.modelValue||[]],h=ge({},i.value);delete h.parent,p.value==="edit"?q[v.value]=h:q.push(h),n("update:modelValue",q),n("change",q),K()},oe=J=>{if(confirm("Are you sure you want to delete this entry?")){const q=[...o.modelValue];q.splice(J,1),n("update:modelValue",q),n("change",q)}},K=()=>{l.value=!1,i.value={},v.value=-1,_.value={},w.value=null},ee=J=>{if(w.value=J.fieldname,i.value[J.fieldname]){const h=(k.value[J.fieldname]||[]).find(H=>H.value===i.value[J.fieldname]);h?_.value[J.fieldname]=h.label:i.value[J.fieldname]&&(_.value[J.fieldname]=i.value[J.fieldname])}},ke=J=>{setTimeout(()=>{w.value===J&&(w.value=null)},200)},we=J=>{const q=k.value[J.fieldname]||[],h=_.value[J.fieldname]||"";return h?q.filter(H=>H.label.toLowerCase().includes(h.toLowerCase())||H.value.toLowerCase().includes(h.toLowerCase())||H.description&&H.description.toLowerCase().includes(h.toLowerCase())):q},ye=(J,q,h)=>{i.value[J]=q,_.value[J]=h,w.value=null},Fe=()=>te(this,null,function*(){d.value=!0,y.value=null,F.value=0;try{yield m(),yield P()}catch(J){y.value=J.message||"Failed to load child table fields"}finally{d.value=!1}});return Qe(()=>te(this,null,function*(){try{d.value=!0,yield m(),yield P()}catch(J){y.value=J.message||"Failed to load child table fields"}finally{d.value=!1}})),De(()=>o.childDoctype,()=>te(this,null,function*(){d.value=!0,r.value=[],k.value={},F.value=0,y.value=null;try{yield m(),yield P()}catch(J){console.error("Error when childDoctype changed:",J)}finally{d.value=!1}})),(J,q)=>(u(),c("div",Tv,[a("label",Sv,[pe(E(e.label)+" ",1),e.required?(u(),c("span",Ev,"*")):Y("",!0),e.description?(u(),c("span",Dv,[q[1]||(q[1]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("div",jv,E(e.description),1)])):Y("",!0)]),e.debug?(u(),c("div",Pv,[a("div",null,"Child Doctype: "+E(e.childDoctype),1),a("div",null,"Fields loaded: "+E(r.value.length),1),a("div",null,"Visible fields: "+E(A.value.length),1),a("div",null,"List view fields: "+E(B.value.length),1),y.value?(u(),c("div",Lv,"Error: "+E(y.value),1)):Y("",!0)])):Y("",!0),d.value?(u(),c("div",Mv,q[2]||(q[2]=[a("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1)]))):y.value?(u(),c("div",Rv,[a("p",null,E(y.value),1),a("button",{onClick:Fe,class:"mt-2 text-sm bg-red-100 hover:bg-red-200 text-red-800 py-1 px-3 rounded"}," Retry ")])):(e.modelValue||[]).length===0?(u(),c("div",Hv,[a("div",Bv,[q[4]||(q[4]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 text-gray-300 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),a("p",Iv,"No "+E(e.label.toLowerCase())+" added yet",1),e.isReadOnly?Y("",!0):(u(),Ce(le(st),{key:0,onClick:j,variant:"solid",size:"sm"},{default:be(()=>[q[3]||(q[3]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)),pe(" Add "+E(e.label),1)]),_:1}))])])):(u(),c("div",Vv,[a("div",Nv,[a("h3",zv,E(e.label),1),e.isReadOnly?Y("",!0):(u(),Ce(le(st),{key:0,onClick:At(j,["stop"]),variant:"solid",size:"sm"},{default:be(()=>q[5]||(q[5]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),pe(" Add ")])),_:1}))]),a("div",Uv,[a("table",qv,[a("thead",Wv,[a("tr",null,[(u(!0),c(ae,null,xe(B.value,h=>(u(),c("th",{key:h.fieldname,class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",style:lt(D(h))},E(h.label),5))),128)),q[6]||(q[6]=a("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-24 sticky right-0 bg-gray-50"}," Actions ",-1))])]),a("tbody",Jv,[(u(!0),c(ae,null,xe(e.modelValue,(h,H)=>(u(),c("tr",{key:H,class:"hover:bg-gray-50 cursor-pointer",onClick:M=>Q(H)},[(u(!0),c(ae,null,xe(B.value,M=>(u(),c("td",{key:M.fieldname,class:"px-4 py-3 text-sm text-gray-900",style:lt(D(M))},[M.fieldtype==="Check"?(u(),c("div",Yv,[a("span",{class:fe(["relative flex items-center justify-center h-5 w-5 rounded-full border-2 transition-all",{"border-blue-600 bg-blue-600":f(h[M.fieldname]),"border-gray-300":!f(h[M.fieldname])}])},[f(h[M.fieldname])?(u(),c("span",Xv)):Y("",!0)],2)])):M.fieldtype==="Link"?(u(),c(ae,{key:1},[h[M.fieldname]?(u(),c("span",Gv,E(X(M,h[M.fieldname])),1)):(u(),c("span",Qv,"—"))],64)):M.fieldtype==="Date"||M.fieldtype==="Datetime"?(u(),c(ae,{key:2},[h[M.fieldname]?(u(),c("span",Zv,E(R(h[M.fieldname])),1)):(u(),c("span",em,"—"))],64)):M.fieldtype==="Small Text"?(u(),c(ae,{key:3},[h[M.fieldname]?(u(),c("div",tm,E(h[M.fieldname]),1)):(u(),c("span",om,"—"))],64)):M.fieldtype==="Color"?(u(),c(ae,{key:4},[h[M.fieldname]?(u(),c("div",nm,[a("div",{class:"h-4 w-4 rounded mr-1",style:lt({backgroundColor:h[M.fieldname]})},null,4),a("span",null,E(h[M.fieldname]),1)])):(u(),c("span",rm,"—"))],64)):M.fieldtype==="Currency"||M.fieldtype==="Float"?(u(),c(ae,{key:5},[h[M.fieldname]!==void 0&&h[M.fieldname]!==null&&h[M.fieldname]!==""?(u(),c("span",sm,E(O(h[M.fieldname])),1)):(u(),c("span",am,"—"))],64)):(u(),c(ae,{key:6},[h[M.fieldname]!==void 0&&h[M.fieldname]!==null&&h[M.fieldname]!==""?(u(),c("span",im,E(h[M.fieldname]),1)):(u(),c("span",lm,"—"))],64))],4))),128)),a("td",{class:"px-4 py-3 text-sm text-right whitespace-nowrap sticky right-0 bg-white",onClick:q[0]||(q[0]=At(()=>{},["stop"]))},[a("div",dm,[ce(le(st),{onClick:M=>oe(H),variant:"ghost",size:"sm",class:"text-red-600 hover:text-red-800"},{default:be(()=>q[7]||(q[7]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v10M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m-5 0h10"})],-1)])),_:2},1032,["onClick"])])])],8,Kv))),128))])])])])),l.value?(u(),c("div",um,[a("div",cm,[a("div",pm,[a("h3",fm,[p.value==="view"?(u(),c("span",vm,"View")):p.value==="edit"?(u(),c("span",mm,"Edit")):(u(),c("span",hm,"Add")),pe(" "+E(e.label),1)]),ce(le(st),{onClick:K,variant:"ghost",size:"sm"},{default:be(()=>q[8]||(q[8]=[a("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1})]),a("div",gm,[a("div",ym,[(u(!0),c(ae,null,xe(T.value,h=>(u(),c(ae,{key:h.fieldname},[h.fieldtype==="Section Break"?(u(),c("div",bm,[h.label?(u(),c("h4",wm,E(h.label),1)):Y("",!0)])):h.fieldtype==="Column Break"?(u(),c("div",xm)):(u(),c("div",{key:2,class:fe(["col-span-1",{"md:col-span-2":h.fieldtype==="Text Editor"||h.fieldtype==="Long Text"||h.fieldtype==="Small Text"}])},[h.fieldtype==="Link"?(u(),c("div",_m,[p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:0,type:"text","model-value":_.value[h.fieldname]||"",placeholder:`Search ${h.label}...`,size:"sm",variant:"subtle","onUpdate:modelValue":H=>_.value[h.fieldname]=H,onFocus:H=>ee(h),onBlur:H=>ke(h.fieldname)},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",km,"*")):Y("",!0)]),_:2},1032,["model-value","placeholder","onUpdate:modelValue","onFocus","onBlur"])):(u(),c("div",$m,[a("label",Cm,E(h.label),1),a("div",Om,[i.value[h.fieldname]?(u(),c("span",Fm,E(X(h,i.value[h.fieldname])),1)):(u(),c("span",Am,"—"))])])),w.value===h.fieldname&&p.value!=="view"&&!C(h)?(u(),c("div",Tm,[(u(!0),c(ae,null,xe(we(h),H=>(u(),c("div",{key:H.value,class:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100",onMousedown:M=>ye(h.fieldname,H.value,H.label)},[a("span",Em,E(H.label),1),H.description?(u(),c("span",Dm,E(H.description),1)):Y("",!0),i.value[h.fieldname]===H.value?(u(),c("span",jm,q[9]||(q[9]=[a("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))):Y("",!0)],40,Sm))),128)),we(h).length===0?(u(),c("div",Pm," No results found ")):Y("",!0)])):Y("",!0)])):h.fieldtype==="Check"?(u(),c("div",Lm,[p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:0,type:"checkbox","model-value":f(i.value[h.fieldname]),size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H?1:0},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",Mm,"*")):Y("",!0)]),_:2},1032,["model-value","onUpdate:modelValue"])):(u(),c("div",Rm,[a("label",Hm,E(h.label),1),a("div",Bm,[a("span",{class:fe(["relative flex items-center justify-center h-5 w-5 rounded-full border-2 transition-all mr-2",{"border-blue-600 bg-blue-600":f(i.value[h.fieldname]),"border-gray-300":!f(i.value[h.fieldname])}])},[f(i.value[h.fieldname])?(u(),c("span",Im)):Y("",!0)],2),pe(" "+E(f(i.value[h.fieldname])?"Yes":"No"),1)])]))])):h.fieldtype==="Select"&&p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:2,type:"select","model-value":i.value[h.fieldname],options:U(h),size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",Vm,"*")):Y("",!0)]),_:2},1032,["model-value","options","onUpdate:modelValue"])):h.fieldtype==="Select"?(u(),c("div",Nm,[a("label",zm,E(h.label),1),a("div",Um,[i.value[h.fieldname]?(u(),c("span",qm,E(i.value[h.fieldname]),1)):(u(),c("span",Wm,"—"))])])):h.fieldtype==="Date"&&p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:4,type:"date","model-value":i.value[h.fieldname],size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",Jm,"*")):Y("",!0)]),_:2},1032,["model-value","onUpdate:modelValue"])):h.fieldtype==="Date"?(u(),c("div",Km,[a("label",Ym,E(h.label),1),a("div",Xm,[i.value[h.fieldname]?(u(),c("span",Gm,E(R(i.value[h.fieldname])),1)):(u(),c("span",Qm,"—"))])])):h.fieldtype==="Datetime"&&p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:6,type:"datetime-local","model-value":i.value[h.fieldname],size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",Zm,"*")):Y("",!0)]),_:2},1032,["model-value","onUpdate:modelValue"])):h.fieldtype==="Datetime"?(u(),c("div",eh,[a("label",th,E(h.label),1),a("div",oh,[i.value[h.fieldname]?(u(),c("span",nh,E(R(i.value[h.fieldname])),1)):(u(),c("span",rh,"—"))])])):(h.fieldtype==="Small Text"||h.fieldtype==="Long Text")&&p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:8,type:"textarea","model-value":i.value[h.fieldname],rows:h.fieldtype==="Long Text"?4:2,size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",sh,"*")):Y("",!0)]),_:2},1032,["model-value","rows","onUpdate:modelValue"])):h.fieldtype==="Small Text"||h.fieldtype==="Long Text"?(u(),c("div",ah,[a("label",ih,E(h.label),1),a("div",lh,[i.value[h.fieldname]?(u(),c("span",dh,E(i.value[h.fieldname]),1)):(u(),c("span",uh,"—"))])])):(h.fieldtype==="Int"||h.fieldtype==="Float"||h.fieldtype==="Currency"||h.fieldtype==="Percent")&&p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:10,type:"number","model-value":i.value[h.fieldname],step:h.fieldtype==="Int"?"1":"0.01",size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",ch,"*")):Y("",!0)]),_:2},1032,["model-value","step","onUpdate:modelValue"])):h.fieldtype==="Int"||h.fieldtype==="Float"||h.fieldtype==="Currency"||h.fieldtype==="Percent"?(u(),c("div",ph,[a("label",fh,E(h.label),1),a("div",vh,[i.value[h.fieldname]!==void 0&&i.value[h.fieldname]!==null&&i.value[h.fieldname]!==""?(u(),c("span",mh,E(O(i.value[h.fieldname])),1)):(u(),c("span",hh,"—"))])])):p.value!=="view"&&!C(h)?(u(),Ce(le(tt),{key:12,type:"text","model-value":i.value[h.fieldname],size:"sm",variant:"subtle","onUpdate:modelValue":H=>i.value[h.fieldname]=H},{label:be(()=>[pe(E(h.label)+" ",1),h.reqd?(u(),c("span",gh,"*")):Y("",!0)]),_:2},1032,["model-value","onUpdate:modelValue"])):(u(),c("div",yh,[a("label",bh,E(h.label),1),a("div",wh,[i.value[h.fieldname]!==void 0&&i.value[h.fieldname]!==null&&i.value[h.fieldname]!==""?(u(),c("span",xh,E(i.value[h.fieldname]),1)):(u(),c("span",_h,"—"))])]))],2))],64))),128))])]),a("div",kh,[a("div",$h,[ce(le(st),{onClick:K,variant:"outline",size:"sm"},{default:be(()=>[pe(E(p.value==="view"?"Close":"Cancel"),1)]),_:1}),p.value==="view"?(u(),Ce(le(st),{key:0,onClick:ve,variant:"solid",size:"sm"},{default:be(()=>q[10]||(q[10]=[pe(" Edit ")])),_:1})):p.value!=="view"?(u(),Ce(le(st),{key:1,onClick:ue,variant:"solid",size:"sm"},{default:be(()=>[pe(E(p.value==="edit"?"Update":"Add"),1)]),_:1})):Y("",!0)])])])])):Y("",!0)]))}},Fh=_e(Oh,[["__scopeId","data-v-957d7256"]]),Ah={key:0,class:"ml-1 text-gray-400 hover:text-gray-600 cursor-help group relative"},Th={class:"absolute hidden group-hover:block bg-black text-white text-xs rounded p-2 z-50 w-48 -mt-1 ml-4 shadow-lg"},Sh=["innerHTML"],Eh={__name:"FieldDescription",props:{description:{type:String,default:""}},setup(e){return(t,o)=>e.description?(u(),c("span",Ah,[o[0]||(o[0]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("div",Th,[a("span",{innerHTML:e.description},null,8,Sh)])])):Y("",!0)}},Ot=_e(Eh,[["__scopeId","data-v-4f9367fa"]]),Dh=["data-fieldname"],jh={key:0},Ph={key:1,class:"relative group"},Lh={class:"block text-sm font-medium text-gray-700 mb-2"},Mh={key:0,class:"text-red-500 ml-1"},Rh={key:2,class:"group"},Hh={key:0,class:"text-red-500 ml-1"},Bh={key:3,class:"group"},Ih={class:"block text-sm font-medium text-gray-700 mb-2"},Vh={key:0,class:"text-red-500 ml-1"},Nh={key:4,class:"group"},zh={key:0,class:"text-red-500 ml-1"},Uh={key:5,class:"group"},qh={key:0,class:"text-red-500 ml-1"},Wh={key:6,class:"group"},Jh={key:0,class:"text-red-500 ml-1"},Kh={key:7,class:"group"},Yh={key:0,class:"text-red-500 ml-1"},Xh={key:8,class:"group"},Gh={class:"block text-sm font-medium text-gray-700 mb-2"},Qh={key:0,class:"text-red-500 ml-1"},Zh={key:0,class:"mb-3"},e0={key:0,class:"relative inline-block"},t0=["src"],o0={key:1,class:"flex items-center justify-between bg-gray-50 p-3 rounded-lg border"},n0={class:"flex items-center"},r0={class:"text-sm text-gray-700 font-medium"},s0={key:1},a0=["onClick"],i0={class:"mx-auto h-12 w-12 text-gray-400 mb-4",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},l0={key:0,d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},d0={key:1,d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},u0={key:0,class:"text-sm text-blue-600 font-medium"},c0={class:"w-full bg-gray-200 rounded-full h-2 mt-2"},p0={key:1,class:"text-sm text-red-600"},f0={key:2,class:"text-sm text-gray-600"},v0={class:"text-xs text-gray-500 mt-1"},m0={key:9,class:"group"},h0={key:0,class:"text-red-500 ml-1"},g0={__name:"UniversalField",props:{field:{type:Object,required:!0},value:{default:null},options:{type:Array,default:()=>[]},isReadOnly:{type:Boolean,default:!1},isInvalid:{type:Boolean,default:!1},filePreview:{type:String,default:null},attachmentName:{type:String,default:null}},emits:["update:value","file-upload","file-remove","link-search","link-select","error"],setup(e,{emit:t}){const o=e,n=t,s=p=>["Int","Float","Currency","Percent"].includes(p.fieldtype),r=p=>{switch(p.fieldtype){case"Email":return"email";case"Password":return"password";case"Phone":return"tel";case"Int":case"Float":case"Currency":case"Percent":return"number";default:return"text"}},d=p=>{n(p?"link-select":"update:value",p)},l=p=>p.size>5242880?(n("error","File size must be less than 5MB"),!1):o.field.fieldtype==="Attach Image"&&!p.type.startsWith("image/")?(n("error","Please upload an image file"),!1):!0,i=p=>{n("file-upload",p)},v=p=>{n("error",p.message||"File upload failed")};return(p,k)=>(u(),c("div",{class:"universal-field","data-fieldname":e.field.fieldname},[e.field.fieldtype==="Table"?(u(),c("div",jh,[ce(Fh,{"model-value":e.value,fieldname:e.field.fieldname,label:e.field.label,description:e.field.description,required:e.field.reqd,"is-read-only":e.field.read_only||e.isReadOnly,"child-doctype":e.field.options,"parent-doctype":e.field.parent||"Unknown","onUpdate:modelValue":k[0]||(k[0]=_=>p.$emit("update:value",_))},null,8,["model-value","fieldname","label","description","required","is-read-only","child-doctype","parent-doctype"])])):e.field.fieldtype==="Link"?(u(),c("div",Ph,[a("label",Lh,[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",Mh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),ce(le(Zr),{value:e.value,options:e.options,placeholder:e.field.placeholder||`Select ${e.field.label}`,disabled:e.isReadOnly,size:"sm",variant:"subtle",class:fe({"field-error":e.isInvalid}),"onUpdate:value":d,"onUpdate:query":k[1]||(k[1]=_=>p.$emit("link-search",_))},null,8,["value","options","placeholder","disabled","class"])])):e.field.fieldtype==="Select"?(u(),c("div",Rh,[ce(le(tt),{type:"select","model-value":e.value,options:e.options,size:"sm",variant:"subtle",placeholder:e.field.placeholder||`Select ${e.field.label}`,disabled:e.isReadOnly,class:fe({"field-error":e.isInvalid}),"onUpdate:modelValue":k[2]||(k[2]=_=>p.$emit("update:value",_))},{label:be(()=>[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",Hh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),_:1},8,["model-value","options","placeholder","disabled","class"])])):e.field.fieldtype==="Text Editor"?(u(),c("div",Bh,[a("label",Ih,[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",Vh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),a("div",{class:fe(["border rounded-lg overflow-hidden",{"border-red-500":e.isInvalid}])},[ce(le(ff),{content:e.value||"","editor-class":"prose-sm min-h-[8rem] border-0 p-3",placeholder:`Write ${e.field.label.toLowerCase()}...`,"read-only":e.isReadOnly,onChange:k[3]||(k[3]=_=>p.$emit("update:value",_)),"bubble-menu":!0,"fixed-menu":!0,"starterkit-options":{heading:{levels:[2,3,4]}}},null,8,["content","placeholder","read-only"])],2)])):e.field.fieldtype==="Date"||e.field.fieldtype==="Datetime"?(u(),c("div",Nh,[ce(le(ts),{type:e.field.fieldtype==="Date"?"date":"datetime-local","model-value":e.value,size:"sm",variant:"subtle",placeholder:e.field.placeholder||e.field.label,disabled:e.isReadOnly,class:fe({"field-error":e.isInvalid}),"onUpdate:modelValue":k[4]||(k[4]=_=>p.$emit("update:value",_))},{label:be(()=>[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",zh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),_:1},8,["type","model-value","placeholder","disabled","class"])])):e.field.fieldtype==="Check"?(u(),c("div",Uh,[ce(le(tt),{type:"checkbox","model-value":e.value===1||e.value===!0||e.value==="1",size:"sm",variant:"subtle",disabled:e.isReadOnly,"onUpdate:modelValue":k[5]||(k[5]=_=>p.$emit("update:value",_?1:0))},{label:be(()=>[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",qh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),_:1},8,["model-value","disabled"])])):s(e.field)?(u(),c("div",Wh,[ce(le(tt),{type:"number","model-value":e.value,size:"sm",variant:"subtle",placeholder:e.field.placeholder||e.field.label,disabled:e.isReadOnly,step:e.field.fieldtype==="Int"?"1":"0.01",min:e.field.min_value,max:e.field.max_value,class:fe({"field-error":e.isInvalid}),"onUpdate:modelValue":k[6]||(k[6]=_=>p.$emit("update:value",_))},{label:be(()=>[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",Jh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),_:1},8,["model-value","placeholder","disabled","step","min","max","class"])])):e.field.fieldtype==="Long Text"||e.field.fieldtype==="Small Text"?(u(),c("div",Kh,[ce(le(tt),{type:"textarea","model-value":e.value,size:"sm",variant:"subtle",placeholder:e.field.placeholder||`Enter ${e.field.label.toLowerCase()}`,disabled:e.isReadOnly,rows:e.field.fieldtype==="Long Text"?6:3,class:fe({"field-error":e.isInvalid}),"onUpdate:modelValue":k[7]||(k[7]=_=>p.$emit("update:value",_))},{label:be(()=>[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",Yh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),_:1},8,["model-value","placeholder","disabled","rows","class"])])):e.field.fieldtype==="Attach Image"||e.field.fieldtype==="Attach"?(u(),c("div",Xh,[a("label",Gh,[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",Qh,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),e.filePreview?(u(),c("div",Zh,[e.field.fieldtype==="Attach Image"?(u(),c("div",e0,[a("img",{src:e.filePreview,alt:"Preview",class:"h-32 w-auto rounded-lg object-cover border shadow-sm"},null,8,t0),e.isReadOnly?Y("",!0):(u(),Ce(le(st),{key:0,variant:"ghost",size:"sm",class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-md",onClick:k[8]||(k[8]=_=>p.$emit("file-remove"))},{default:be(()=>k[11]||(k[11]=[a("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])),_:1}))])):(u(),c("div",o0,[a("div",n0,[k[12]||(k[12]=a("svg",{class:"h-6 w-6 text-gray-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1)),a("span",r0,E(e.attachmentName),1)]),e.isReadOnly?Y("",!0):(u(),Ce(le(st),{key:0,variant:"ghost",size:"sm",class:"text-red-500 hover:text-red-600",onClick:k[9]||(k[9]=_=>p.$emit("file-remove"))},{default:be(()=>k[13]||(k[13]=[a("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])),_:1}))]))])):Y("",!0),!e.filePreview&&!e.isReadOnly?(u(),c("div",s0,[ce(le(Ul),{"file-types":e.field.fieldtype==="Attach Image"?["image/*"]:["*"],"validate-file":l,onSuccess:i,onError:v},{default:be(({file:_,uploading:w,progress:y,uploaded:F,message:A,error:T,total:B,success:N,openFileSelector:m})=>[a("div",{class:fe(["border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors cursor-pointer",{"border-red-500":e.isInvalid,"border-blue-500":w}]),onClick:m},[(u(),c("svg",i0,[e.field.fieldtype==="Attach Image"?(u(),c("path",l0)):(u(),c("path",d0))])),w?(u(),c("div",u0,[pe(" Uploading... "+E(y)+"% ",1),a("div",c0,[a("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:lt({width:`${y}%`})},null,4)])])):T?(u(),c("div",p0,E(T),1)):(u(),c("div",f0,[k[14]||(k[14]=a("span",{class:"font-medium text-blue-600 hover:text-blue-500"},"Upload a file",-1)),k[15]||(k[15]=a("span",null," or drag and drop",-1)),a("p",v0,E(e.field.fieldtype==="Attach Image"?"PNG, JPG, GIF up to 5MB":"Any file type up to 5MB"),1)]))],10,a0)]),_:1},8,["file-types"])])):Y("",!0)])):(u(),c("div",m0,[ce(le(tt),{type:r(e.field),"model-value":e.value,size:"sm",variant:"subtle",placeholder:e.field.placeholder||e.field.label,disabled:e.isReadOnly,maxlength:e.field.length||140,class:fe({"field-error":e.isInvalid}),"onUpdate:modelValue":k[10]||(k[10]=_=>p.$emit("update:value",_))},{label:be(()=>[pe(E(e.field.label)+" ",1),e.field.reqd?(u(),c("span",h0,"*")):Y("",!0),ce(Ot,{description:e.field.description},null,8,["description"])]),_:1},8,["type","model-value","placeholder","disabled","maxlength","class"])]))],8,Dh))}},y0=_e(g0,[["__scopeId","data-v-d363d05c"]]),b0={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},w0={class:"bg-white rounded-lg shadow-xl w-full max-w-md overflow-hidden animate-fade-in"},x0={class:"flex justify-between items-center border-b px-4 py-3 bg-gradient-to-r from-blue-50 to-white"},_0={class:"text-lg font-medium text-gray-900"},k0={class:"px-4 py-4 space-y-4 max-h-[70vh] overflow-y-auto"},$0={class:"flex items-center p-3 bg-blue-50 rounded-lg"},C0={class:"inline-flex items-center cursor-pointer"},O0={key:0,class:"h-2 w-2 text-white",viewBox:"0 0 8 8",fill:"currentColor"},F0={key:0,class:"ml-auto flex items-center"},A0={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white mr-2"},T0=["src","alt"],S0={key:1,class:"text-sm font-medium"},E0={class:"text-sm font-medium text-gray-700 truncate max-w-[120px]"},D0={key:0},j0={class:"relative"},P0=["disabled"],L0=["value"],M0={class:"relative"},R0=["disabled"],H0={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm left-0 right-0",style:{"max-width":"100%"}},B0=["onMousedown"],I0={class:"flex items-center"},V0={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white mr-2"},N0=["src","alt","onError"],z0={key:1,class:"text-sm font-medium"},U0={class:"flex flex-col"},q0={class:"font-medium"},W0={class:"text-xs text-gray-500"},J0={key:0,class:"py-2 px-3 text-gray-500 italic"},K0={class:"flex space-x-2"},Y0={class:"bg-gray-50 px-4 py-3 flex justify-end"},X0=["disabled"],G0={key:0,class:"flex items-center"},Q0={key:1},Z0={__name:"AssignmentDialog",props:{doctype:{type:String,required:!0},docname:{type:String,required:!0}},emits:["assignment-added","assignment-error"],setup(e,{emit:t}){const o=e,n=t,s=L(!1),r=L(!1),d=L(""),l=L(!1),i=L([]),v=L([]),p=L(null),k=L(!1),_=L(""),w=L([]),y=L({doctype:o.doctype,name:o.docname,assign_to:"",user_group:"",description:"",priority:"Medium",complete_by:""}),F=ne(()=>d.value?w.value.filter(oe=>oe.label.toLowerCase().includes(d.value.toLowerCase())):w.value),A=ne(()=>y.value.assign_to!==""),T=ne(()=>v.value.length>0),B=()=>te(this,null,function*(){s.value=!0,m(),yield P(),yield Promise.all([j(),Q(),ve()]),f()}),N=()=>{s.value=!1,m()},m=()=>{r.value=!1,d.value="",y.value={doctype:o.doctype,name:o.docname,assign_to:"",user_group:"",description:"",priority:"Medium",complete_by:""}},P=()=>te(this,null,function*(){try{const K=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:o.doctype,name:o.docname,fields:["name","title","subject"]})})).json();if(K.message){const ee=K.message;_.value=ee.title||ee.subject||ee.name||o.docname}}catch(oe){console.error("Error fetching document title:",oe),_.value=o.docname}}),f=()=>{const oe=_.value||o.docname;y.value.description=`Please review this ${o.doctype}: ${oe}`},D=()=>{r.value&&p.value?(y.value.assign_to=p.value.value,d.value=p.value.fullName?`${p.value.fullName} (${p.value.userId})`:p.value.userId):(y.value.assign_to="",d.value="")},X=()=>{setTimeout(()=>{l.value=!1},200)},U=oe=>{y.value.assign_to=oe.value,d.value=oe.fullName?`${oe.fullName} (${oe.userId})`:oe.userId,l.value=!1},R=oe=>{if(!oe)return"";if(oe.includes("@"))return oe.substring(0,2).toUpperCase();const K=oe.split(" ");return K.length===1?K[0].charAt(0).toUpperCase():(K[0].charAt(0)+K[K.length-1].charAt(0)).toUpperCase()},O=(oe,K)=>{oe.target.style.display="none",K&&(K.image=null)},C=oe=>oe?oe.startsWith("/private/")?`/api/method/frappe.utils.file_manager.get_file?private=1&file=${encodeURIComponent(oe)}`:oe:null,j=()=>te(this,null,function*(){try{const K=yield(yield fetch("/api/method/frappe.auth.get_logged_user")).json();if(K.message){const ke=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",name:K.message,fields:["name","full_name","user_image"]})})).json();if(ke.message){const we=ke.message;p.value={value:we.name,label:we.full_name?`${we.full_name} (${we.name})`:we.name,fullName:we.full_name||"",userId:we.name,image:we.user_image?C(we.user_image):null}}}}catch(oe){console.error("Error fetching current user:",oe)}}),Q=()=>te(this,null,function*(){try{try{const ke=yield(yield fetch("/api/method/frappe.desk.form.assign_to.get_assignable_users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:o.doctype})})).json();if(ke.message&&Array.isArray(ke.message)){const we=ke.message.map(ye=>te(this,null,function*(){try{const J=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",name:ye,fields:["name","full_name","user_image"]})})).json();if(J.message){const q=J.message;return{value:q.name,label:q.full_name?`${q.full_name} (${q.name})`:q.name,fullName:q.full_name||"",userId:q.name,image:q.user_image?C(q.user_image):null}}return{value:ye,label:ye,fullName:"",userId:ye,image:null}}catch(Fe){return console.error(`Error fetching details for user ${ye}:`,Fe),{value:ye,label:ye,fullName:"",userId:ye,image:null}}}));w.value=yield Promise.all(we),i.value=w.value;return}}catch(ee){console.error("Error fetching assignable users, falling back to all users:",ee)}const K=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",fields:["name","full_name","user_image"],filters:{enabled:1},limit_page_length:0})})).json();K.message&&(w.value=K.message.map(ee=>({value:ee.name,label:ee.full_name?`${ee.full_name} (${ee.name})`:ee.name,fullName:ee.full_name||"",userId:ee.name,image:ee.user_image?C(ee.user_image):null})),i.value=w.value)}catch(oe){console.error("Error fetching users:",oe),w.value=[],i.value=[]}}),ve=()=>te(this,null,function*(){try{const K=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Group",fields:["name"],limit_page_length:0})})).json();K.message&&(v.value=K.message.map(ee=>({value:ee.name,label:ee.name})))}catch(oe){console.error("Error fetching user groups:",oe)}}),ue=()=>te(this,null,function*(){var oe,K,ee,ke;if(A.value)try{k.value=!0;try{const J=yield(yield fetch("/api/method/oms.api.assign_document",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:o.doctype,name:o.docname,user:y.value.assign_to,description:y.value.description,priority:y.value.priority,date:y.value.complete_by||null})})).json();if(J.message&&J.message.status==="success"){const q={name:J.message.name||Date.now().toString(),allocated_to:y.value.assign_to,allocated_to_fullname:((oe=w.value.find(h=>h.value===y.value.assign_to))==null?void 0:oe.label)||y.value.assign_to,user_image:((K=w.value.find(h=>h.value===y.value.assign_to))==null?void 0:K.image)||null,description:y.value.description,priority:y.value.priority,date:y.value.complete_by||null};n("assignment-added",q),N();return}}catch(Fe){console.log("Custom endpoint not available, falling back to standard API")}const ye=yield(yield fetch("/api/method/frappe.desk.form.assign_to.add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assign_to:[y.value.assign_to],doctype:o.doctype,name:o.docname,description:y.value.description,priority:y.value.priority,date:y.value.complete_by||null})})).json();if(ye.message){const Fe={name:ye.message.name||Date.now().toString(),allocated_to:y.value.assign_to,allocated_to_fullname:((ee=w.value.find(J=>J.value===y.value.assign_to))==null?void 0:ee.label)||y.value.assign_to,user_image:((ke=w.value.find(J=>J.value===y.value.assign_to))==null?void 0:ke.image)||null,description:y.value.description,priority:y.value.priority,date:y.value.complete_by||null};n("assignment-added",Fe),N()}else throw new Error("Failed to create assignment")}catch(we){console.error("Error creating assignment:",we),n("assignment-error",we.message||"Failed to create assignment")}finally{k.value=!1}});return De(()=>o.doctype,oe=>{y.value.doctype=oe}),De(()=>o.docname,oe=>{y.value.name=oe}),(oe,K)=>(u(),c("div",null,[a("button",{onClick:B,class:"flex items-center justify-center p-3 bg-white text-blue-600 border border-blue-600 rounded-full hover:bg-blue-50 transition-colors shadow-sm",title:"Assign to User"},K[10]||(K[10]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])),s.value?(u(),c("div",b0,[a("div",w0,[a("div",x0,[a("h3",_0,"Assign "+E(e.doctype),1),a("button",{onClick:N,class:"text-gray-400 hover:text-gray-500 focus:outline-none"},K[11]||(K[11]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),a("div",k0,[a("div",$0,[a("label",C0,[Ve(a("input",{type:"checkbox",id:"assign-to-me","onUpdate:modelValue":K[0]||(K[0]=ee=>r.value=ee),class:"absolute opacity-0 w-0 h-0",onChange:D},null,544),[[da,r.value]]),a("span",{class:fe(["relative flex items-center justify-center h-4 w-4 rounded-full border-2 transition-all",{"border-blue-600 bg-blue-600":r.value,"border-gray-300":!r.value}])},[r.value?(u(),c("svg",O0,K[12]||(K[12]=[a("circle",{cx:"4",cy:"4",r:"3"},null,-1)]))):Y("",!0)],2),K[13]||(K[13]=a("span",{class:"ml-2 text-gray-700 font-medium"},"Assign to me",-1))]),r.value&&p.value?(u(),c("div",F0,[a("div",A0,[p.value.image?(u(),c("img",{key:0,src:p.value.image,alt:p.value.label,class:"h-full w-full object-cover",onError:K[1]||(K[1]=ee=>O(ee,p.value))},null,40,T0)):(u(),c("span",S0,E(R(p.value.label)),1))]),a("span",E0,E(p.value.label),1)])):Y("",!0)]),T.value?(u(),c("div",D0,[K[15]||(K[15]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assign To User Group",-1)),a("div",j0,[Ve(a("select",{"onUpdate:modelValue":K[2]||(K[2]=ee=>y.value.user_group=ee),class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:r.value},[K[14]||(K[14]=a("option",{value:""},"Select User Group",-1)),(u(!0),c(ae,null,xe(v.value,ee=>(u(),c("option",{key:ee.value,value:ee.value},E(ee.label),9,L0))),128))],8,P0),[[ao,y.value.user_group]])])])):Y("",!0),a("div",null,[K[16]||(K[16]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[pe(" Assign To "),a("span",{class:"text-red-500"},"*")],-1)),a("div",M0,[Ve(a("input",{"onUpdate:modelValue":K[3]||(K[3]=ee=>d.value=ee),type:"text",class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Search users...",onFocus:K[4]||(K[4]=ee=>l.value=!0),onBlur:X,disabled:r.value},null,40,R0),[[Dt,d.value]]),l.value&&!r.value?(u(),c("div",H0,[(u(!0),c(ae,null,xe(F.value,ee=>(u(),c("div",{key:ee.value,class:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100",onMousedown:ke=>U(ee)},[a("div",I0,[a("div",V0,[ee.image?(u(),c("img",{key:0,src:ee.image,alt:ee.fullName||ee.userId,class:"h-full w-full object-cover",onError:ke=>O(ke,ee)},null,40,N0)):(u(),c("span",z0,E(R(ee.fullName||ee.userId)),1))]),a("div",U0,[a("span",q0,E(ee.fullName),1),a("span",W0,E(ee.userId),1)])])],40,B0))),128)),F.value.length===0?(u(),c("div",J0," No users found ")):Y("",!0)])):Y("",!0)])]),a("div",null,[K[17]||(K[17]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Complete By",-1)),Ve(a("input",{type:"date","onUpdate:modelValue":K[5]||(K[5]=ee=>y.value.complete_by=ee),class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,512),[[Dt,y.value.complete_by]])]),a("div",null,[K[18]||(K[18]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),a("div",K0,[a("button",{onClick:K[6]||(K[6]=ee=>y.value.priority="Low"),class:fe(["flex-1 py-2 px-3 rounded-md border focus:outline-none transition-colors",y.value.priority==="Low"?"bg-green-50 border-green-300 text-green-700":"bg-gray-50 border-gray-300 text-gray-700"])}," Low ",2),a("button",{onClick:K[7]||(K[7]=ee=>y.value.priority="Medium"),class:fe(["flex-1 py-2 px-3 rounded-md border focus:outline-none transition-colors",y.value.priority==="Medium"?"bg-yellow-50 border-yellow-300 text-yellow-700":"bg-gray-50 border-gray-300 text-gray-700"])}," Medium ",2),a("button",{onClick:K[8]||(K[8]=ee=>y.value.priority="High"),class:fe(["flex-1 py-2 px-3 rounded-md border focus:outline-none transition-colors",y.value.priority==="High"?"bg-red-50 border-red-300 text-red-700":"bg-gray-50 border-gray-300 text-gray-700"])}," High ",2)])]),a("div",null,[K[19]||(K[19]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Comment",-1)),Ve(a("textarea",{"onUpdate:modelValue":K[9]||(K[9]=ee=>y.value.description=ee),rows:"3",class:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Add a comment..."},null,512),[[Dt,y.value.description]])])]),a("div",Y0,[a("button",{onClick:ue,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:!A.value||k.value},[k.value?(u(),c("span",G0,K[20]||(K[20]=[a("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),pe(" Processing... ")]))):(u(),c("span",Q0,"Assign"))],8,X0)])])])):Y("",!0)]))}},pn=_e(Z0,[["__scopeId","data-v-5b0b9858"]]),eg={class:"assignment-list"},tg={key:0,class:"flex justify-center items-center py-2"},og={key:1},ng={key:0,class:"text-gray-500 text-sm italic"},rg={key:1,class:"flex flex-wrap gap-1"},sg=["onClick","title"],ag={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white border-2 border-white shadow-sm"},ig=["src","alt","onError"],lg={key:1,class:"text-xs font-medium"},dg=["title"],ug=["data-popup-id"],cg={class:"flex items-center justify-between"},pg={class:"flex items-center"},fg={class:"h-8 w-8 rounded-full overflow-hidden flex items-center justify-center bg-blue-600 text-white mr-2"},vg=["src","alt","onError"],mg={key:1,class:"text-xs font-medium"},hg={class:"font-medium text-blue-700 text-sm truncate max-w-[120px]"},gg=["onClick"],yg={class:"mt-2 text-xs text-gray-600"},bg={key:0,class:"mb-1"},wg={class:"truncate"},xg={key:1,class:"mb-1"},_g={class:"flex items-center"},kg={__name:"AssignmentList",props:{doctype:{type:String,required:!0},docname:{type:String,required:!0}},emits:["assignment-removed","assignment-error"],setup(e,{expose:t,emit:o}){const n=e,s=o,r=L([]),d=L(!0),l=L(null),i=L(null),v=L(null);L({});const p=()=>te(this,null,function*(){if(!(!n.doctype||!n.docname))try{d.value=!0;const O=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["name","allocated_to","owner","description","priority","date","status"],filters:{reference_type:n.doctype,reference_name:n.docname,status:"Open"}})})).json();if(O.message){const j=O.message.map(Q=>te(this,null,function*(){try{const ue=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User",name:Q.allocated_to,fields:["name","full_name","user_image"]})})).json();return ue.message&&(Q.allocated_to_fullname=ue.message.full_name||Q.allocated_to,Q.user_image=ue.message.user_image?y(ue.message.user_image):null),Q}catch(ve){return console.error("Error fetching user details:",ve),Q}}));r.value=yield Promise.all(j)}else r.value=[]}catch(R){console.error("Error fetching assignments:",R),r.value=[]}finally{d.value=!1}}),k=R=>l.value&&R.allocated_to===l.value,_=(R,O)=>{R.target.style.display="none",O&&(O.user_image=null)},w=R=>{if(!R)return;const O=r.value.findIndex(C=>C.allocated_to===R.allocated_to);O>=0?r.value[O]=ge(ge({},r.value[O]),R):r.value.push(R)},y=R=>R?R.startsWith("/private/")?`/api/method/frappe.utils.file_manager.get_file?private=1&file=${encodeURIComponent(R)}`:R:null,F=R=>{if(!R)return"";if(R.includes("@"))return R.substring(0,2).toUpperCase();const O=R.split(" ");return O.length===1?O[0].charAt(0).toUpperCase():(O[0].charAt(0)+O[O.length-1].charAt(0)).toUpperCase()},A=R=>{if(!R)return"No due date";const O=new Date(R),C=new Date,j=new Date(C);return j.setDate(j.getDate()+1),O.toDateString()===C.toDateString()?"Today":O.toDateString()===j.toDateString()?"Tomorrow":O.toLocaleDateString("en-US",{month:"short",day:"numeric"})},T=()=>te(this,null,function*(){try{const O=yield(yield fetch("/api/method/frappe.auth.get_logged_user")).json();O.message&&(l.value=O.message)}catch(R){console.error("Error fetching current user:",R)}}),B=R=>l.value&&(R.owner===l.value||R.allocated_to===l.value),N=R=>te(this,null,function*(){try{if((yield(yield fetch("/api/method/frappe.client.set_value",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",name:R,fieldname:"status",value:"Cancelled"})})).json()).message)r.value=r.value.filter(j=>j.name!==R),s("assignment-removed",R),i.value=null;else throw new Error("Failed to remove assignment")}catch(O){console.error("Error removing assignment:",O),s("assignment-error",O.message||"Failed to remove assignment")}}),m=R=>{const O=r.value.findIndex(ue=>ue.name===R.name),C=window.innerWidth<640,j=(O+1)%4===0||O===r.value.length-1,Q=r.value.length-O<=2;let ve={top:"100%",left:"0",transform:"none"};return C?ve={top:"auto",bottom:"20px",left:"50%",transform:"translateX(-50%)",width:"calc(100vw - 40px)",maxWidth:"300px"}:(j||Q)&&(ve={top:"0",right:"100%",left:"auto",marginRight:"8px"}),ve},P=R=>{i.value===R.name?i.value=null:(i.value=R.name,it(()=>{f()}))},f=()=>{it(()=>{document.querySelectorAll("[data-popup-id]").forEach(O=>{const C=O.getBoundingClientRect(),j=window.innerWidth,Q=window.innerHeight;C.right>j&&(O.style.left="auto",O.style.right="0"),C.bottom>Q&&(O.style.top="auto",O.style.bottom="100%"),C.left<0&&(O.style.left="0",O.style.right="auto"),C.top<0&&(O.style.top="0",O.style.bottom="auto")})})},D=R=>{i.value&&!R.target.closest(".assignment-list")&&(i.value=null)};De([()=>n.doctype,()=>n.docname],()=>{p()});const X=R=>{R.detail&&R.detail.doctype===n.doctype&&R.detail.docname===n.docname&&w(R.detail.assignment)},U=()=>{i.value&&f()};return Qe(()=>{T(),p(),document.addEventListener("click",D),window.addEventListener("resize",U),window.addEventListener("assignment-added",X)}),mn(()=>{document.removeEventListener("click",D),window.removeEventListener("resize",U),window.removeEventListener("assignment-added",X)}),t({addAssignment:w,removeAssignment:N,fetchAssignments:p}),(R,O)=>(u(),c("div",eg,[d.value?(u(),c("div",tg,O[0]||(O[0]=[a("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"},null,-1)]))):(u(),c("div",og,[r.value.length===0?(u(),c("div",ng," No assignments ")):(u(),c("div",rg,[(u(!0),c(ae,null,xe(r.value,C=>(u(),c("div",{key:C.name,class:"relative"},[a("div",{onClick:j=>P(C),class:"cursor-pointer transition-transform hover:scale-110",title:k(C)?"You":C.allocated_to_fullname||C.allocated_to},[a("div",ag,[C.user_image?(u(),c("img",{key:0,src:C.user_image,alt:k(C)?"You":C.allocated_to_fullname||C.allocated_to,class:"h-full w-full object-cover",onError:j=>_(j,C)},null,40,ig)):(u(),c("span",lg,E(F(C.allocated_to_fullname||C.allocated_to)),1))]),a("div",{class:fe(["absolute -top-1 -right-1 w-3 h-3 rounded-full border border-white",{"bg-red-500":C.priority==="High","bg-yellow-500":C.priority==="Medium","bg-green-500":C.priority==="Low"}]),title:`Priority: ${C.priority}`},null,10,dg)],8,sg),i.value===C.name?(u(),c("div",{key:0,ref_for:!0,ref_key:"popupRef",ref:v,"data-popup-id":C.name,class:"fixed bg-white rounded-lg shadow-lg z-50 w-48 p-3 border",style:lt(m(C))},[a("div",cg,[a("div",pg,[a("div",fg,[C.user_image?(u(),c("img",{key:0,src:C.user_image,alt:k(C)?"You":C.allocated_to_fullname,class:"h-full w-full object-cover",onError:j=>_(j,C)},null,40,vg)):(u(),c("span",mg,E(F(C.allocated_to_fullname)),1))]),a("div",hg,E(k(C)?"You":C.allocated_to_fullname),1)]),B(C)?(u(),c("button",{key:0,onClick:j=>N(C.name),class:"text-gray-400 hover:text-red-500 ml-2",title:"Remove assignment"},O[1]||(O[1]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,gg)):Y("",!0)]),a("div",yg,[C.description?(u(),c("div",bg,[O[2]||(O[2]=a("div",{class:"font-medium"},"Comment:",-1)),a("div",wg,E(C.description),1)])):Y("",!0),C.date?(u(),c("div",xg,[O[3]||(O[3]=a("div",{class:"font-medium"},"Due:",-1)),a("div",null,E(A(C.date)),1)])):Y("",!0),a("div",_g,[O[4]||(O[4]=a("div",{class:"font-medium mr-1"},"Priority:",-1)),a("div",{class:fe(["px-2 py-0.5 rounded-full text-xs",{"bg-red-100 text-red-800":C.priority==="High","bg-yellow-100 text-yellow-800":C.priority==="Medium","bg-green-100 text-green-800":C.priority==="Low"}])},E(C.priority),3)])])],12,ug)):Y("",!0)]))),128))]))]))]))}},fn=_e(kg,[["__scopeId","data-v-18f13f66"]]),$g={class:"bg-white rounded-lg shadow-sm form-view"},Cg={class:"p-4 md:p-6 overflow-y-auto form-content"},Og={key:0,class:"flex justify-center items-center py-8"},Fg={key:0,class:"bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r-lg"},Ag={class:"flex items-start"},Tg={class:"ml-3 flex-1"},Sg={class:"text-sm font-medium text-red-800"},Eg={class:"mt-2 text-sm text-red-700"},Dg={key:0,class:"mt-3"},jg={class:"list-disc list-inside space-y-1"},Pg={key:1,class:"bg-green-50 border-l-4 border-green-500 p-4 mb-6 rounded-r-lg"},Lg={class:"flex items-center"},Mg={class:"ml-3 flex-1"},Rg={class:"text-sm font-medium text-green-800"},Hg={class:"ml-4"},Bg={key:2,class:"bg-gray-50 rounded-lg p-4 mb-6"},Ig={class:"flex items-center justify-between mb-3"},Vg={class:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2"},Ng={key:0,class:"col-span-1 md:col-span-2 border-t border-gray-200 pt-6 mt-6 first:border-t-0 first:pt-0 first:mt-0"},zg=["onClick"],Ug={class:"flex items-center"},qg={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Wg={key:1,class:"hidden md:block"},Jg={class:"sticky bottom-0 z-10 bg-white p-4 md:p-6 border-t shadow-lg"},Kg={class:"flex flex-col sm:flex-row gap-3"},wr={__name:"FetchFieldProp",props:{modelValue:{type:Object,required:!0},fields:{type:Array,required:!0},fieldOptions:{type:Object,default:()=>({})},isReadOnly:{type:Boolean,default:!1},submitText:{type:String,default:"Save"},submittingText:{type:String,default:"Saving..."},doctype:{type:String,required:!0},docname:{type:String,default:null},mode:{type:String,default:"add",validator:e=>["add","edit","view"].includes(e)},titleField:{type:String,default:"name"},debug:{type:Boolean,default:!1}},emits:["update:modelValue","submit","validate","field-change","delete","cancel","load"],setup(e,{expose:t,emit:o}){const n=e,s=o,r=L(!1),d=L(!1),l=L(""),i=L(""),v=L({}),p=L({}),k=L(!1),_=L({}),w=L({}),y=L([]),F=L({});L(null);const A=L([]),T=L({}),B=$o(),N=L({}),m=L({}),P=L(null),f=ne({get:()=>n.modelValue,set:S=>s("update:modelValue",S)});ne(()=>f.value[n.titleField]?f.value[n.titleField]:`${n.doctype} ${n.docname||""}`);const D=ne(()=>Uo(n.doctype)),X=ne(()=>n.fields.filter(S=>S&&S.fieldname&&!S.hidden&&S.hidden!==1&&!D.value.includes(S.fieldname)).sort((S,g)=>(S.idx||0)-(g.idx||0))),U=S=>{const g=X.value[S],x=S>0?X.value[S-1]:null,V=S<X.value.length-1?X.value[S+1]:null;return g.fieldtype==="Section Break"?"col-span-1 md:col-span-2":x&&x.fieldtype==="Section Break"||x&&x.fieldtype==="Column Break"||V&&V.fieldtype==="Column Break"?"col-span-1":g.fieldtype==="Long Text"||g.fieldtype==="Text Editor"||g.fieldtype==="Table"?"col-span-1 md:col-span-2":"col-span-1"},R=S=>n.fieldOptions[S.fieldname]?n.fieldOptions[S.fieldname]:S.fieldtype==="Link"&&w.value[S.fieldname]?w.value[S.fieldname]:S.fieldtype==="Select"&&S.options?S.options.split(`
`).map(g=>({value:g,label:g})):[],O=S=>p.value[S]?p.value[S]:T.value[S]?T.value[S]:f.value[S]?f.value[S]:null,C=S=>{if(v.value[S])return v.value[S].name;if(f.value[S]){const x=f.value[S].split("/");return x[x.length-1]}return null},j=S=>{const g=n.fields.find(x=>x.fieldname===S);return g?g.label||g.fieldname:S},Q=S=>y.value.includes(S),ve=()=>y.value.length>0?"Validation Error":"Error",ue=S=>{if(typeof S!="string")return"An error occurred";if(S.includes("Please fill in all required fields"))return"Please complete all required fields before proceeding.";if(S.includes("Attached To Name must be a string or an integer"))return"Unable to attach file to this document. Please save the document first.";if(S.includes("ValidationError")){const g=S.match(/ValidationError: (.*?)($|\n)/);if(g&&g[1])return g[1]}return S.includes("File size exceeded")?"The file is too large. Please upload a smaller file (maximum 5MB).":S.includes("Failed to upload file")?"Unable to upload the file. Please try again or use a different file.":S.replace(/^\[.*?\]\s*/,"").replace(/\n.*$/,"")},oe=()=>{l.value="",y.value=[],m.value={}},K=S=>{N.value[S]=!N.value[S]},ee=S=>N.value[S]!==!1,ke=(S,g)=>{if(S.fieldtype==="Section Break"||S.fieldtype==="Column Break")return!1;let x=-1;for(let V=g-1;V>=0;V--)if(X.value[V].fieldtype==="Section Break"){x=V;break}if(x>=0){const V=X.value[x];if(V.collapsible===1&&ee(V.fieldname))return!0}return!1},we=(S,g)=>{const x=n.fields.find(V=>V.fieldname===S);x&&x.fieldtype,f.value[S]=g,y.value.includes(S)&&(y.value=y.value.filter(V=>V!==S)),m.value[S]&&delete m.value[S],y.value.length===0&&l.value.includes("required fields")&&(l.value=""),s("field-change",{fieldname:S,value:g})},ye=(S,g)=>{m.value[S]=g},Fe=(S,g)=>{if(!S)return;const x=5*1024*1024;if(S.size>x){ye(g,"File size must be less than 5MB");return}const V=n.fields.find(de=>de.fieldname===g);if((V==null?void 0:V.fieldtype)==="Attach Image"){if(!S.type.startsWith("image/")){ye(g,"Please upload an image file");return}const de=new FileReader;de.onload=$e=>{p.value[g]=$e.target.result,v.value[g]=S,f.value[g]=null,m.value[g]&&delete m.value[g],s("field-change",{fieldname:g,value:null,file:S})},de.readAsDataURL(S)}else v.value[g]=S,f.value[g]=null,m.value[g]&&delete m.value[g],s("field-change",{fieldname:g,value:null,file:S})},J=S=>{delete p.value[S],delete v.value[S],delete T.value[S],f.value[S]=null,m.value[S]&&delete m.value[S],s("field-change",{fieldname:S,value:null,file:null})},q=(S,g)=>{F.value[S]=g,s("field-change",{fieldname:S,value:f.value[S],searchQuery:g})},h=(S,g)=>{f.value[S]=g;const x=n.fields.find(V=>V.fieldname===S);if(x&&x.fieldtype==="Link"){const re=R(x).find(de=>de.value===g);re&&(F.value[S]=re.label)}m.value[S]&&delete m.value[S],y.value.includes(S)&&(y.value=y.value.filter(V=>V!==S)),s("field-change",{fieldname:S,value:g})},H=S=>{P.value&&P.value.addAssignment(S),i.value="Assignment added successfully!",setTimeout(()=>{i.value=""},3e3)},M=S=>{i.value="Assignment removed successfully!",setTimeout(()=>{i.value=""},3e3)},se=S=>{l.value=`Assignment error: ${S}`},ie=()=>{X.value.forEach(S=>{if((S.fieldtype==="Date"||S.fieldtype==="Datetime")&&f.value[S.fieldname]==="Today"){const g=new Date;S.fieldtype==="Date"?f.value[S.fieldname]=g.toISOString().split("T")[0]:f.value[S.fieldname]=g.toISOString().slice(0,16)}}),f.value.opening_date==="Today"&&(f.value.opening_date=new Date().toISOString().split("T")[0])},me=()=>te(this,null,function*(){try{const g=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield He.getCurrentUser()]}})})).json();g.message&&(A.value=g.message,console.log("User permissions loaded:",A.value),n.mode!=="edit"&&Ae())}catch(S){console.error("Error fetching user permissions:",S)}}),Ae=()=>{n.mode!=="edit"&&A.value.forEach(S=>{n.fields.filter(x=>x.fieldtype==="Link"&&x.options===S.allow).forEach(x=>{f.value[x.fieldname]=S.for_value,F.value[x.fieldname]=S.for_value;const V=n.fields.findIndex(re=>re.fieldname===x.fieldname);V!==-1&&(n.fields[V].read_only=1,n.fields[V].read_only_depends_on=`User Permission for ${S.allow}`)})})},Me=()=>te(this,null,function*(){const S={};for(const[g,x]of Object.entries(v.value))try{const V=yield He.uploadFileToTemp(x);T.value[g]=V,S[g]=V}catch(V){throw console.error(`Error uploading file for ${g}:`,V),ye(g,ue(V.message)||`Error uploading file: ${x.name}`),V}return S}),Ne=S=>te(this,null,function*(){if(!S)return{};const g={};for(const[x,V]of Object.entries(T.value))try{const re=yield He.attachFileToDoc(V,n.doctype,S,x);g[x]=re,f.value[x]=re}catch(re){console.error(`Error attaching file for ${x}:`,re),ye(x,ue(re.message)||"Error attaching file to document")}return g}),Je=()=>{const S=[],g={};return X.value.forEach(x=>{if(x.reqd&&x.fieldtype!=="Section Break"&&x.fieldtype!=="Column Break"){const V=f.value[x.fieldname],re=v.value[x.fieldname];!V&&!re&&V!==0&&V!==!1&&(S.push(x.fieldname),g[x.fieldname]=`${x.label||x.fieldname} is required`)}}),{missingFields:S,errors:g}},Ie=()=>te(this,null,function*(){oe(),ie();const S=Je();if(S.missingFields.length>0){l.value="Please fill in all required fields",y.value=S.missingFields,m.value=S.errors;const g=document.querySelector(`[data-fieldname="${S.missingFields[0]}"]`);g&&g.scrollIntoView({behavior:"smooth",block:"center"});return}if(s("validate"),!l.value){d.value=!0;try{const g=n.mode==="add",x=Object.keys(v.value).length>0;x&&(yield Me()),s("submit",{formData:f.value,files:v.value,isNew:g,doctype:n.doctype,docname:n.docname,tempFileUrls:T.value,attachFilesToDoc:x?Ne:null}),i.value=`${n.doctype} ${g?"created":"updated"} successfully!`}catch(g){d.value=!1,l.value=ue(g.message)||"An error occurred while saving"}}}),Be=()=>{n.mode==="edit"||k.value?(Object.assign(f.value,JSON.parse(JSON.stringify(_.value))),k.value=!1,n.docname?B.push(`/${n.doctype.toLowerCase().replace(/\s+/g,"-")}/${n.docname}`):B.push(`/${n.doctype.toLowerCase().replace(/\s+/g,"-")}`)):B.push(`/${n.doctype.toLowerCase().replace(/\s+/g,"-")}`),s("cancel",{mode:n.mode,doctype:n.doctype,docname:n.docname})},he=()=>te(this,null,function*(){if(!(n.mode!=="edit"&&n.mode!=="view")&&n.docname)try{r.value=!0;const S=yield He.fetchDocument(n.doctype,n.docname);Object.assign(f.value,S),_.value=JSON.parse(JSON.stringify(S)),Te(),s("load",S)}catch(S){console.error(`Error loading ${n.doctype}:`,S),l.value=ue(S.message)||`Error loading ${n.doctype}`}finally{r.value=!1}}),Te=()=>{const S=X.value.filter(g=>g.fieldtype==="Link");for(const g of S)if(f.value[g.fieldname]){const V=R(g).find(re=>re.value===f.value[g.fieldname]);V?F.value[g.fieldname]=V.label:F.value[g.fieldname]=f.value[g.fieldname]}},Ee=()=>te(this,null,function*(){var g,x;const S=X.value.filter(V=>V.fieldtype==="Link");for(const V of S)try{if(!V.options)continue;const $e=((g=(yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocType",name:V.options,fields:["title_field"]}),credentials:"include"})).json()).message)==null?void 0:g.title_field)||"name",I=(yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"DocField",fields:["fieldname","fieldtype"],filters:{parent:V.options},limit_page_length:0}),credentials:"include"})).json()).message||[],$=new Set(["name",$e,"creation"]);["first_name","last_name","full_name","project_name","subject","title","customer_name","employee_name"].forEach(G=>{I.some(Z=>Z.fieldname===G)&&$.add(G)}),I.some(G=>G.fieldname==="status")&&$.add("status");const b=yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:V.options,fields:Array.from($),limit_page_length:0,order_by:"creation desc"}),credentials:"include"});if(!b.ok)throw new Error(`Failed to fetch options for ${V.fieldname}`);const z=yield b.json();z.message&&(w.value[V.fieldname]=z.message.map(G=>{let Z=G[$e]||G.name;return Z===G.name&&(G.first_name&&G.last_name?Z=`${G.first_name} ${G.last_name}`.trim():G.full_name?Z=G.full_name:G.project_name?Z=G.project_name:G.subject?Z=G.subject:G.title?Z=G.title:G.customer_name?Z=G.customer_name:G.employee_name&&(Z=G.employee_name)),ge({value:G.name,label:Z||G.name,description:G.name!==Z?`${G.name}`:void 0,creation:G.creation},G.status&&{status:G.status})}))}catch(re){console.error(`Error fetching options for ${V.fieldname}:`,re);const $e=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:V.options,fields:["name"],limit_page_length:500}),credentials:"include"})).json();w.value[V.fieldname]=((x=$e.message)==null?void 0:x.map(ht=>({value:ht.name,label:ht.name})))||[]}}),Se=()=>{X.value.forEach(S=>{S.fieldtype==="Section Break"&&S.collapsible===1&&N.value[S.fieldname]===void 0&&(N.value[S.fieldname]=!0)})};return t({setSubmitting(S){d.value=S},setErrorMessage(S){l.value=S},setSuccessMessage(S){i.value=S},getFiles(){return v.value},uploadFilesToTemp:Me,attachFilesToDoc:Ne,loadDocument:he,handleSubmit:Ie,validateForm:Je}),De(()=>n.mode,S=>{(S==="edit"||S==="view")&&he()}),De(()=>n.docname,S=>{S&&(n.mode==="edit"||n.mode==="view")&&he()}),De(A,()=>{n.mode!=="edit"&&Ae()},{deep:!0}),Qe(()=>te(this,null,function*(){console.log(`FormView mounted for ${n.doctype} in ${n.mode} mode`),yield me(),yield Ee(),Se(),(n.mode==="edit"||n.mode==="view")&&n.docname?yield he():it(()=>{ie(),Ae()})})),(S,g)=>(u(),c("div",$g,[a("div",Cg,[r.value?(u(),c("div",Og,[ce(le(ua),{text:"Loading form..."})])):(u(),c("form",{key:1,onSubmit:At(Ie,["prevent"]),class:"space-y-6"},[l.value?(u(),c("div",Fg,[a("div",Ag,[g[3]||(g[3]=a("div",{class:"flex-shrink-0"},[a("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),a("div",Tg,[a("h3",Sg,E(ve()),1),a("div",Eg,[a("p",null,E(ue(l.value)),1),y.value.length>0?(u(),c("div",Dg,[g[1]||(g[1]=a("p",{class:"font-medium mb-2"},"Missing required fields:",-1)),a("ul",jg,[(u(!0),c(ae,null,xe(y.value,x=>(u(),c("li",{key:x,class:"text-sm"},E(j(x)),1))),128))])])):Y("",!0)])]),a("div",{class:"ml-4"},[a("button",{onClick:oe,class:"text-red-400 hover:text-red-600 transition-colors"},g[2]||(g[2]=[a("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):Y("",!0),i.value?(u(),c("div",Pg,[a("div",Lg,[g[5]||(g[5]=a("div",{class:"flex-shrink-0"},[a("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),a("div",Mg,[a("p",Rg,E(i.value),1)]),a("div",Hg,[a("button",{onClick:g[0]||(g[0]=x=>i.value=""),class:"text-green-400 hover:text-green-600 transition-colors"},g[4]||(g[4]=[a("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])):Y("",!0),e.mode==="edit"&&e.docname?(u(),c("div",Bg,[a("div",Ig,[g[6]||(g[6]=a("h3",{class:"text-sm font-medium text-gray-900"},"Assignments",-1)),ce(pn,{doctype:e.doctype,docname:e.docname,onAssignmentAdded:H,onAssignmentError:se},null,8,["doctype","docname"])]),ce(fn,{ref_key:"assignmentListRef",ref:P,doctype:e.doctype,docname:e.docname,onAssignmentRemoved:M,onAssignmentError:se},null,8,["doctype","docname"])])):Y("",!0),a("div",Vg,[(u(!0),c(ae,null,xe(X.value,(x,V)=>(u(),c(ae,{key:x.fieldname},[x.fieldtype==="Section Break"?(u(),c("div",Ng,[x.label?(u(),c("div",{key:0,class:fe({"cursor-pointer hover:bg-gray-50 p-3 rounded-lg flex items-center justify-between transition-colors":x.collapsible===1,"mb-6":!x.collapsible}),onClick:re=>x.collapsible===1?K(x.fieldname):null},[a("h3",{class:fe(["text-lg font-semibold",{"text-gray-900":!x.collapsible,"text-blue-700":x.collapsible===1}])},[a("div",Ug,[x.collapsible===1?(u(),c("svg",qg,g[7]||(g[7]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]))):Y("",!0),pe(" "+E(x.label),1)])],2),x.collapsible===1?(u(),c("svg",{key:0,class:fe(["h-5 w-5 text-blue-600 transition-transform duration-200",ee(x.fieldname)?"":"transform rotate-180"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},g[8]||(g[8]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2)):Y("",!0)],10,zg)):Y("",!0)])):x.fieldtype==="Column Break"?(u(),c("div",Wg)):ke(x,V)?Y("",!0):(u(),c("div",{key:2,class:fe(["field-container",U(V)])},[ce(y0,{field:x,value:f.value[x.fieldname],options:R(x),"is-read-only":x.read_only||e.isReadOnly,"is-invalid":Q(x.fieldname),"file-preview":O(x.fieldname),"attachment-name":C(x.fieldname),"onUpdate:value":re=>we(x.fieldname,re),onFileUpload:re=>Fe(re,x.fieldname),onFileRemove:()=>J(x.fieldname),onLinkSearch:re=>q(x.fieldname,re),onLinkSelect:re=>h(x.fieldname,re),onError:re=>ye(x.fieldname,re)},null,8,["field","value","options","is-read-only","is-invalid","file-preview","attachment-name","onUpdate:value","onFileUpload","onFileRemove","onLinkSearch","onLinkSelect","onError"])],2))],64))),128))])],32))]),a("div",Jg,[Le(S.$slots,"actions",{},()=>[a("div",Kg,[ce(le(st),{variant:"outline",onClick:Be,class:"flex-1 order-2 sm:order-1",disabled:d.value},{default:be(()=>g[9]||(g[9]=[pe(" Cancel ")])),_:1},8,["disabled"]),ce(le(st),{variant:"solid",onClick:Ie,loading:d.value,disabled:d.value||e.isReadOnly,class:"flex-1 order-1 sm:order-2"},{default:be(()=>[pe(E(d.value?e.submittingText||"Saving...":e.submitText||"Save"),1)]),_:1},8,["loading","disabled"])])])])]))}},Yg={class:"max-w-4xl mx-auto"},Xg={class:"sticky top-0 z-30 bg-white p-2 md:p-4 border-b"},Gg={class:"flex items-center pl-10 md:pl-0"},Qg={class:"text-xl font-semibold"},Zg={class:"flex"},ey={class:"flex-shrink-0"},ty={key:0,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},oy={key:1,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},ny={class:"ml-3"},ry={class:"text-sm"},sy={class:"ml-auto pl-3"},ay={class:"-mx-1.5 -my-1.5"},iy={key:1,class:"flex justify-center items-center py-8"},ly={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},dy={class:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},uy={class:"p-4 border-b flex justify-between items-center"},cy={class:"text-lg font-medium"},py={class:"p-4"},fy={class:"flex flex-wrap gap-3"},vy=["disabled"],my={key:0,class:"flex items-center justify-center"},hy={key:1},gy={key:3,class:"form-container"},As={__name:"FormHandler",props:{doctype:{type:String,required:!0},recordId:{type:String,default:null},defaultValues:{type:Object,default:()=>({})},titleField:{type:String,default:"name"}},emits:["form-submitted"],setup(e,{emit:t}){const o=e,n=t,s=$o();gn();const r=L(!0),d=L(!1),l=L([]),i=L([]),v=L({}),p=L({}),k=L(null),_=L(""),w=L("info");L([]);const y=L({}),F=L([]),A=L(""),T=L(!1),B=L([]),N=L({}),m=L(null),P=L(null),f=ne(()=>o.doctype.toLowerCase().replace(/\s+/g,"-")),D=ne(()=>!!o.recordId&&o.recordId!=="new"),X=ne(()=>P.value?P.value.quick_entry===1?!0:l.value.some(h=>h.allow_in_quick_entry===1||h.allow_in_quick_entry===!0||h.allow_in_quick_entry==="1"):!1),U=()=>te(this,null,function*(){try{console.log(`Fetching doctype fields for ${o.doctype}...`);const h=yield He.fetchDoctypeFields(o.doctype);if(h&&h.fields){P.value=h.meta||{},l.value=h.fields,console.log(`Successfully fetched ${h.fields.length} fields for ${o.doctype}`);const H=h.fields.find(ie=>ie.fieldtype==="Section Break"&&(ie.collapsible===1||ie.collapsible===!0||ie.collapsible==="1"));H&&console.log("Sample collapsible section:",H);const M=h.fields.find(ie=>ie.allow_in_quick_entry===1||ie.allow_in_quick_entry===!0||ie.allow_in_quick_entry==="1");M&&console.log("Sample quick entry field:",M);const se=h.fields.find(ie=>ie.description&&ie.description.trim()!=="");se&&console.log("Sample field with description:",se)}else throw new Error("Invalid fields data in response");R(),O(),yield ue(),yield oe(),!D.value&&X.value&&(T.value=!0)}catch(h){console.error("Error fetching doctype fields:",h),_.value="Failed to load doctype fields",w.value="error"}finally{r.value=!1}}),R=()=>{const h=["name","owner","creation","modified","modified_by","docstatus","idx"],H=Uo(o.doctype);i.value=l.value.filter(M=>!(!M||!M.fieldname||h.includes(M.fieldname)||M.hidden===1||M.hidden===!0||M.hidden==="1"||H.includes(M.fieldname))).sort((M,se)=>(M.idx||0)-(se.idx||0)),i.value=i.value.map(M=>ge({fieldname:M.fieldname||"",fieldtype:M.fieldtype||"Data",label:M.label||M.fieldname||"",reqd:M.reqd||0,hidden:M.hidden||0,read_only:M.read_only||0,options:M.options||"",default:M.default||"",description:M.description||"",idx:M.idx||0,allow_in_quick_entry:M.allow_in_quick_entry||0,collapsible:M.collapsible||0},M))},O=()=>{var H;if(!l.value||l.value.length===0)return;const h=l.value.filter(M=>{const se=M.allow_in_quick_entry===1||M.allow_in_quick_entry===!0||M.allow_in_quick_entry==="1",ie=["Section Break","Column Break","HTML","Button"].includes(M.fieldtype);return se&&!ie}).sort((M,se)=>(M.idx||0)-(se.idx||0));if(h.length>0)B.value=h,console.log("Using fields explicitly marked for quick entry:",B.value);else if(((H=P.value)==null?void 0:H.quick_entry)===1){const M=l.value.filter(se=>{const ie=se.reqd===1||se.reqd===!0||se.reqd==="1",me=["Section Break","Column Break","HTML","Button"].includes(se.fieldtype),Ae=["Long Text","Text Editor","Table"].includes(se.fieldtype);return ie&&!me&&!Ae&&!se.hidden});if(B.value=M,B.value.length<3){const se=l.value.filter(ie=>{const me=["Data","Link","Select","Date","Check"].includes(ie.fieldtype),Ae=["Long Text","Text Editor","Table","Section Break","Column Break","HTML","Button"].includes(ie.fieldtype);return me&&!Ae&&!ie.hidden&&!B.value.some(Me=>Me.fieldname===ie.fieldname)}).slice(0,5-B.value.length);B.value=[...B.value,...se]}}else B.value=[];N.value={},B.value.forEach(M=>{N.value[M.fieldname]=M.default||""}),console.log("Final quick entry fields:",B.value)},C=()=>te(this,null,function*(){m.value&&m.value.handleSubmit()}),j=()=>{},Q=()=>{Object.assign(p.value,N.value),ve()},ve=()=>{T.value=!1},ue=()=>te(this,null,function*(){try{const H=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"User Permission",fields:["name","user","allow","for_value"],filters:{user:["=",yield He.getCurrentUser()]}})})).json();H.message&&(F.value=H.message,console.log("User permissions:",F.value))}catch(h){console.error("Error fetching user permissions:",h)}}),oe=()=>{D.value||F.value.forEach(h=>{i.value.filter(M=>M.fieldtype==="Link"&&M.options===h.allow).forEach(M=>{if(!p.value[M.fieldname]){p.value[M.fieldname]=h.for_value;const se=i.value.findIndex(ie=>ie.fieldname===M.fieldname);se!==-1&&(i.value[se]=We(ge({},i.value[se]),{read_only:1,read_only_depends_on:`User Permission for ${h.allow}`}))}})})},K=(h,H=null)=>{console.log(`Triggering event: ${h}, field: ${H||"none"}`);const M={doc:p.value,doctype:o.doctype,get_field:se=>i.value.find(ie=>ie.fieldname===se)||{},set_value:(se,ie)=>(p.value[se]=ie,Promise.resolve()),refresh_field:se=>{const ie=ge({},p.value);p.value=ie},trigger:se=>{K(se)}};if(y.value[h])for(const se of y.value[h])try{se(M)}catch(ie){console.error(`Error executing handler for ${h} event:`,ie),_.value=`Error in client script: ${ie.message}`,w.value="error"}if(H&&y.value[H])for(const se of y.value[H])try{se(M)}catch(ie){console.error(`Error executing handler for ${H} field:`,ie),_.value=`Error in client script: ${ie.message}`,w.value="error"}},ee=()=>te(this,null,function*(){try{r.value=!0;const h=yield He.fetchDocument(o.doctype,o.recordId);if(!ke(h)){_.value=`You don't have permission to access this ${o.doctype}`,w.value="error",s.push(`/${f.value}`);return}p.value=We(ge({},h),{doctype:o.doctype}),console.log("Loaded record data:",p.value)}catch(h){console.error(`Error fetching ${o.doctype}:`,h),_.value=`Failed to load ${o.doctype}`,w.value="error"}finally{r.value=!1}}),ke=h=>{const H=F.value.filter(M=>M.allow===o.doctype);if(H.length===0)return!0;for(const M of H)for(const[se,ie]of Object.entries(h))if(ie===M.for_value)return!0;return!1},we=()=>{p.value=ge({doctype:o.doctype},o.defaultValues);for(const h of i.value)h.default&&!p.value[h.fieldname]&&(p.value[h.fieldname]=h.default);oe()},ye=({fieldname:h,value:H,file:M})=>{console.log(`Field ${h} changed:`,H,M),K("change",h),K(h)},Fe=()=>{K("validate"),console.log("Validating form...")},J=ie=>te(this,[ie],function*({formData:h,files:H,tempFileUrls:M,attachFilesToDoc:se}){try{K("before_save"),d.value=!0,console.log(`Submitting ${o.doctype} with data:`,h);const me=We(ge({},h),{doctype:o.doctype}),Ae=yield He.saveDocument(me,!D.value);se&&typeof se=="function"&&(yield se(Ae.name)),K("after_save"),_.value=`${o.doctype} ${D.value?"updated":"created"} successfully!`,w.value="success",n("form-submitted",Ae),setTimeout(()=>{s.push(`/${f.value}/${Ae.name}`)},1500)}catch(me){console.error(`Error ${D.value?"updating":"creating"} ${o.doctype}:`,me),_.value=`Error ${D.value?"updating":"creating"} ${o.doctype}: ${me.message||"Unknown error"}`,w.value="error",d.value=!1,k.value&&k.value.setErrorMessage(me.message||`Error ${D.value?"updating":"creating"} ${o.doctype}`)}}),q=h=>te(this,null,function*(){try{d.value=!0,yield He.deleteDocument(o.doctype,h),_.value=`${o.doctype} deleted successfully!`,w.value="success",setTimeout(()=>{s.push(`/${f.value}`)},1500)}catch(H){console.error(`Error deleting ${o.doctype}:`,H),_.value=`Error deleting ${o.doctype}: ${H.message||"Unknown error"}`,w.value="error"}finally{d.value=!1}});return Qe(()=>te(this,null,function*(){console.log(`FormHandler component mounted for ${o.doctype}`),A.value=D.value?"Edit":"New";try{if(yield U(),D.value)yield ee();else{we();try{const h=yield He.getCurrentUser();h&&i.value.find(H=>H.fieldname==="raised_by")&&(p.value.raised_by=h)}catch(h){console.error("Error fetching current user:",h)}}}catch(h){console.error("Error initializing component:",h),_.value="Failed to initialize component",w.value="error"}finally{r.value=!1}})),De(()=>o.doctype,h=>te(this,null,function*(){r.value=!0;try{l.value=[],i.value=[],v.value={},yield U(),D.value?yield ee():we()}catch(H){console.error("Error when doctype prop changed:",H),_.value="Error loading data",w.value="error"}finally{r.value=!1}}),{immediate:!1}),De(()=>o.recordId,h=>te(this,null,function*(){if(h==="new")we();else if(h){r.value=!0;try{yield ee()}catch(H){console.error("Error when recordId prop changed:",H),_.value="Error loading data",w.value="error"}finally{r.value=!1}}}),{immediate:!1}),De(()=>p.value,(h,H)=>{if(!H)return;const M=Object.keys(h).find(se=>h[se]!==H[se]);M&&(K("change",M),K(M))},{deep:!0}),(h,H)=>(u(),c("div",Yg,[a("div",Xg,[a("div",Gg,[a("button",{onClick:H[0]||(H[0]=M=>h.$router.back()),class:"mr-4 text-gray-600 hover:text-gray-800 transition-colors"},H[4]||(H[4]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),a("h2",Qg,E(D.value?"Edit":"New")+" "+E(e.doctype),1)])]),_.value?(u(),c("div",{key:0,class:fe(["m-4 p-4 rounded-lg",w.value==="error"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"])},[a("div",Zg,[a("div",ey,[w.value==="error"?(u(),c("svg",ty,H[5]||(H[5]=[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):(u(),c("svg",oy,H[6]||(H[6]=[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])))]),a("div",ny,[a("p",ry,E(_.value),1)]),a("div",sy,[a("div",ay,[a("button",{onClick:H[1]||(H[1]=M=>_.value=""),class:fe(["inline-flex rounded-md p-1.5",w.value==="error"?"text-red-500 hover:bg-red-100":"text-green-500 hover:bg-green-100"])},H[7]||(H[7]=[a("span",{class:"sr-only"},"Dismiss",-1),a("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),2)])])])],2)):Y("",!0),r.value?(u(),c("div",iy,H[8]||(H[8]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):Y("",!0),T.value?(u(),c("div",ly,[a("div",dy,[a("div",uy,[a("h3",cy,"Quick Add "+E(e.doctype),1),a("button",{onClick:ve,class:"text-gray-500 hover:text-gray-700"},H[9]||(H[9]=[a("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))]),a("div",py,[ce(wr,{ref_key:"quickEntryFormRef",ref:m,modelValue:N.value,"onUpdate:modelValue":H[2]||(H[2]=M=>N.value=M),fields:B.value,"field-options":v.value,onValidate:j,onSubmit:J,"submit-text":"Save",doctype:e.doctype,mode:"add"},{actions:be(()=>[a("div",fy,[a("button",{type:"button",onClick:Q,class:"flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors"}," Full Form "),a("button",{onClick:C,disabled:d.value,class:"flex-1 bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-blue-800"},[d.value?(u(),c("span",my,H[10]||(H[10]=[a("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),pe(" Saving... ")]))):(u(),c("span",hy,"Save"))],8,vy)])]),_:1},8,["modelValue","fields","field-options","doctype"])])])])):r.value?Y("",!0):(u(),c("div",gy,[ce(wr,{ref_key:"formViewRef",ref:k,modelValue:p.value,"onUpdate:modelValue":H[3]||(H[3]=M=>p.value=M),fields:i.value,"field-options":v.value,onValidate:Fe,onSubmit:J,onFieldChange:ye,onDelete:q,"submit-text":D.value?"Update":"Create","submitting-text":D.value?"Updating...":"Creating...",doctype:e.doctype,docname:e.recordId,mode:D.value?"edit":"add",titleField:e.titleField},null,8,["modelValue","fields","field-options","submit-text","submitting-text","doctype","docname","mode","titleField"])]))]))}},yy={class:"enhanced-table-container"},by={class:"flex justify-between items-center mb-2"},wy={class:"text-sm font-medium text-gray-700"},xy={class:"text-gray-500 text-xs"},_y={key:0},ky={key:1},$y={key:0,class:"text-gray-500 italic text-sm p-3 bg-gray-50 rounded-lg"},Cy={key:1,class:"overflow-hidden rounded-lg border border-gray-200"},Oy={class:"md:hidden"},Fy=["onClick"],Ay={class:"flex justify-between items-center"},Ty={class:"font-medium text-blue-800"},Sy={key:0,class:"text-gray-500 text-sm"},Ey={key:0,class:"mt-1 text-sm text-gray-600 grid grid-cols-2 gap-2"},Dy={class:"min-w-full divide-y divide-gray-200 hidden md:table"},jy={class:"bg-gray-50"},Py={class:"bg-white divide-y divide-gray-200"},Ly=["onClick"],My={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Ry={key:1,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Hy={key:1,class:"flex items-center"},By={key:3,class:"font-medium"},Iy={key:4,class:"text-blue-600"},Vy={class:"px-3 py-2 text-right"},Ny=["onClick"],zy={class:"bg-white rounded-t-lg md:rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden"},Uy={class:"px-4 py-3 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10"},qy={class:"text-lg font-medium text-gray-900"},Wy={class:"p-4 overflow-y-auto max-h-[calc(90vh-4rem)]"},Jy={key:0,class:"text-center py-8 text-gray-500"},Ky={key:1,class:"space-y-4"},Yy={class:"text-sm font-medium text-gray-500 mb-1"},Xy={class:"text-blue-800 font-medium"},Gy={key:0,class:"text-green-600"},Qy={key:1,class:"text-red-600"},Zy={key:1,class:"flex items-center"},e1={key:4,class:"whitespace-pre-wrap bg-gray-50 p-2 rounded-md text-sm"},t1={class:"px-4 py-3 bg-gray-50 flex justify-end border-t"},o1={__name:"EnhancedTableView",props:{rows:{type:Array,default:()=>[],required:!0},fields:{type:Array,default:()=>[]},label:{type:String,default:"Items"},isCollapsible:{type:Boolean,default:!1},doctype:{type:String,default:""}},setup(e){const t=e,o=L(!1),n=L(!1),s=L(null),r=["name","owner","creation","modified","modified_by","docstatus","idx","parent","parentfield","parenttype"],d=P=>P.replace(/^custom_/,"").replace(/_/g," ").replace(/(?:^|\s)\S/g,f=>f.toUpperCase()).trim(),l=ne(()=>{var f;let P=[];return((f=t.fields)==null?void 0:f.length)>0?P=t.fields.map(D=>We(ge({},D),{label:D.label||d(D.fieldname)})):t.rows.length>0&&typeof t.rows[0]=="object"&&(P=Object.keys(t.rows[0]).map(D=>({fieldname:D,label:d(D),fieldtype:"Data"}))),P.filter(D=>!D.hidden).filter(D=>!r.includes(D.fieldname)).filter(D=>!mo(t.doctype,D.fieldname)).sort((D,X)=>(D.idx||0)-(X.idx||0))}),i=ne(()=>t.rows.map(P=>{const f={};for(const[D,X]of Object.entries(P))!mo(t.doctype,D)&&!r.includes(D)&&(f[D]=X);return f})),v=ne(()=>{const P=l.value.filter(f=>f.in_list_view===!0||f.in_list_view===1||f.in_list_view==="1");return P.length>0?P:l.value.slice(0,4)}),p=ne(()=>{if(!s.value)return{};const P={};for(const[f,D]of Object.entries(s.value))!r.includes(f)&&!mo(t.doctype,f)&&(_(f)==="Check"||D)&&(P[f]=D);return P}),k=P=>{const f=l.value.find(D=>D.fieldname===P);return(f==null?void 0:f.label)||d(P)},_=P=>{const f=l.value.find(D=>D.fieldname===P);return(f==null?void 0:f.fieldtype)||"Data"},w=P=>{const f={};return P.fieldtype==="Check"?f.width="80px":P.fieldtype==="Int"||P.fieldtype==="Float"?f.width="100px":P.fieldtype==="Date"||P.fieldtype==="Color"?f.width="120px":P.fieldtype==="Small Text"&&(f.minWidth="200px"),f},y=P=>{if(!P)return"";try{return new Date(P).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}catch(f){return P}},F=P=>{if(P==null||P==="")return"";try{return parseFloat(P).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}catch(f){return P}},A=(P,f)=>{if(f==null||f==="")return"-";switch(P.fieldtype){case"Check":return f?"Yes":"No";case"Date":case"Datetime":return y(f);case"Currency":case"Float":case"Percent":return F(f);default:return f}},T=P=>{if(v.value.length>0){const f=v.value[0];return A(f,P[f.fieldname])}return""},B=P=>{if(v.value.length>1){const f=v.value[1];return A(f,P[f.fieldname])}return""},N=()=>v.value.length>2?v.value.slice(2,4):[],m=(P,f)=>{s.value=JSON.parse(JSON.stringify(P)),n.value=!0};return(P,f)=>(u(),c("div",yy,[a("div",by,[a("h4",wy,[pe(E(e.label)+" ",1),a("span",xy,"("+E(i.value.length)+" items)",1)]),e.isCollapsible&&i.value.length>0?(u(),c("button",{key:0,onClick:f[0]||(f[0]=D=>o.value=!o.value),class:"text-blue-600 text-sm flex items-center"},[o.value?(u(),c("span",_y,"Show")):(u(),c("span",ky,"Hide")),(u(),c("svg",{xmlns:"http://www.w3.org/2000/svg",class:fe(["h-4 w-4 ml-1",{"transform rotate-180":!o.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},f[4]||(f[4]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])):Y("",!0)]),i.value.length===0?(u(),c("div",$y," No items ")):o.value?Y("",!0):(u(),c("div",Cy,[a("div",Oy,[(u(!0),c(ae,null,xe(i.value,(D,X)=>(u(),c("div",{key:X,class:"border-b border-gray-200 last:border-b-0 p-3 hover:bg-gray-50 cursor-pointer",onClick:U=>m(D)},[a("div",Ay,[a("div",Ty,E(T(D)),1),B(D)?(u(),c("div",Sy,E(B(D)),1)):Y("",!0)]),N().length>0?(u(),c("div",Ey,[(u(!0),c(ae,null,xe(N(),(U,R)=>(u(),c("div",{key:R,class:"flex items-center"}))),128))])):Y("",!0)],8,Fy))),128))]),a("table",Dy,[a("thead",jy,[a("tr",null,[(u(!0),c(ae,null,xe(v.value,D=>(u(),c("th",{key:D.fieldname,class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",style:lt(w(D))},E(D.label),5))),128)),f[5]||(f[5]=a("th",{class:"w-10 px-3 py-2"},null,-1))])]),a("tbody",Py,[(u(!0),c(ae,null,xe(i.value,(D,X)=>(u(),c("tr",{key:X,class:"hover:bg-gray-50 cursor-pointer",onClick:U=>m(D)},[(u(!0),c(ae,null,xe(v.value,U=>(u(),c("td",{key:U.fieldname,class:"px-3 py-2 text-sm",style:lt(w(U))},[U.fieldtype==="Check"?(u(),c(ae,{key:0},[D[U.fieldname]?(u(),c("span",My,f[6]||(f[6]=[a("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[a("circle",{cx:"4",cy:"4",r:"3"})],-1),pe(" Yes ")]))):(u(),c("span",Ry,f[7]||(f[7]=[a("svg",{class:"-ml-0.5 mr-1 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[a("circle",{cx:"4",cy:"4",r:"3"})],-1),pe(" No ")])))],64)):U.fieldtype==="Color"?(u(),c("div",Hy,[a("div",{class:"h-4 w-4 rounded mr-1",style:lt({backgroundColor:D[U.fieldname]||"#FFFFFF"})},null,4),a("span",null,E(D[U.fieldname]),1)])):U.fieldtype==="Date"||U.fieldtype==="Datetime"?(u(),c(ae,{key:2},[pe(E(y(D[U.fieldname])),1)],64)):U.fieldtype==="Currency"||U.fieldtype==="Float"?(u(),c("span",By,E(F(D[U.fieldname])),1)):U.fieldtype==="Link"?(u(),c("span",Iy,E(D[U.fieldname]),1)):(u(),c(ae,{key:5},[pe(E(D[U.fieldname]||"-"),1)],64))],4))),128)),a("td",Vy,[a("button",{class:"text-blue-600 hover:text-blue-800",onClick:At(U=>m(D),["stop"])},f[8]||(f[8]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,Ny)])],8,Ly))),128))])])])),(u(),Ce(hn,{to:"body"},[n.value&&s.value?(u(),c("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-end md:items-center justify-center z-[9999]",onClick:f[3]||(f[3]=At(D=>n.value=!1,["self"]))},[a("div",zy,[a("div",Uy,[a("h3",qy,E(e.label)+" Details",1),a("button",{onClick:f[1]||(f[1]=D=>n.value=!1),class:"text-gray-400 hover:text-gray-500"},f[9]||(f[9]=[a("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),a("div",Wy,[!s.value||Object.keys(p.value).length===0?(u(),c("div",Jy," No data available for this item. ")):(u(),c("div",Ky,[(u(!0),c(ae,null,xe(p.value,(D,X)=>(u(),c("div",{key:X,class:"border-b border-gray-100 pb-3 last:border-b-0"},[a("div",Yy,E(k(X)),1),a("div",Xy,[_(X)==="Check"?(u(),c(ae,{key:0},[D?(u(),c("span",Gy,"Yes")):(u(),c("span",Qy,"No"))],64)):_(X)==="Color"?(u(),c("div",Zy,[a("div",{class:"h-5 w-5 rounded mr-2",style:lt({backgroundColor:D||"#FFFFFF"})},null,4),a("span",null,E(D||"-"),1)])):_(X)==="Date"||_(X)==="Datetime"?(u(),c(ae,{key:2},[pe(E(y(D)||"-"),1)],64)):_(X)==="Currency"||_(X)==="Float"?(u(),c(ae,{key:3},[pe(E(D?F(D):"-"),1)],64)):_(X)==="Small Text"||_(X)==="Text"||_(X)==="Long Text"?(u(),c("div",e1,E(D||"-"),1)):(u(),c(ae,{key:5},[pe(E(D||"-"),1)],64))])]))),128))]))]),a("div",t1,[a("button",{onClick:f[2]||(f[2]=D=>n.value=!1),class:"px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50"}," Close ")])])])):Y("",!0)]))]))}},xr=_e(o1,[["__scopeId","data-v-15765453"]]),n1={class:"min-h-screen"},r1={key:0,class:"flex justify-center items-center py-8 bg-white"},s1={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 mx-4 bg-white"},a1={key:2,class:"bg-white"},i1={key:0,class:"bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-10"},l1={class:"px-4 py-3 max-w-3xl mx-auto flex items-center justify-between"},d1={class:"flex items-center"},u1={class:"text-xl font-semibold text-gray-900"},c1={class:"flex items-center gap-2"},p1={key:1,class:"md:hidden border-b border-gray-200 mt-16"},f1={class:"flex overflow-x-auto"},v1=["onClick"],m1={key:2,class:"p-0 max-w-3xl mx-auto"},h1={key:3},g1={class:"hidden md:block max-w-3xl mx-auto p-6"},y1={class:"space-y-6"},b1={class:"bg-blue-50 p-4 rounded-lg mb-6"},w1={class:"flex items-center mb-3"},x1={key:0,class:"text-lg font-medium text-gray-900 mb-4"},_1={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},k1={key:0,class:"mb-6"},$1={class:"text-sm font-medium text-gray-500 mb-1"},C1={key:0,class:"text-blue-800 font-medium"},O1={key:1,class:"text-blue-800 font-medium"},F1={key:2,class:"prose max-w-none bg-gray-50 p-3 rounded-lg"},A1=["innerHTML"],T1={key:3,class:"text-blue-800 font-medium"},S1={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},E1={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},D1={key:4,class:"mt-1"},j1=["src","onClick"],P1={key:5,class:"mt-1 flex items-center"},L1=["href"],M1={key:6,class:"text-blue-800 font-medium"},R1={key:7,class:"flex items-center"},H1={class:"text-blue-800 font-medium"},B1={key:8,class:"text-blue-800 font-medium whitespace-pre-wrap bg-gray-50 p-2 rounded-md text-sm"},I1={key:9},V1={key:10,class:"text-gray-500 italic"},N1={key:11,class:"text-blue-800 font-medium"},z1={key:0,class:"border-t border-gray-200 pt-6"},U1={class:"space-y-4"},q1={class:"font-medium text-gray-700 mb-2 flex items-center"},W1={class:"space-y-2"},J1=["href","onClick"],K1={class:"flex items-center"},Y1={class:"flex items-center"},X1={class:"hidden md:inline mr-2 text-xs text-gray-500"},G1={class:"border-t border-gray-200 pt-6"},Q1={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Z1={class:"text-blue-800 font-medium"},eb={class:"text-blue-800 font-medium"},tb={class:"text-blue-800 font-medium"},ob={class:"text-blue-800 font-medium"},nb={class:"md:hidden p-4"},rb={key:0,class:"bg-blue-50 px-3 py-2 rounded-lg mb-4"},sb={class:"flex items-center justify-between"},ab={class:"flex items-center space-x-2"},ib={key:1},lb={class:"space-y-4"},db={key:0,class:"mb-4 border-b pb-4"},ub={class:"text-sm font-medium text-gray-500 mb-1"},cb={key:0,class:"text-blue-800 font-medium"},pb={key:1,class:"text-blue-800 font-medium"},fb={key:2,class:"prose max-w-none bg-gray-50 p-3 rounded-lg"},vb=["innerHTML"],mb={key:3,class:"text-blue-800 font-medium"},hb={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},gb={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},yb={key:4,class:"mt-1"},bb=["src","onClick"],wb={key:5,class:"mt-1 flex items-center"},xb=["href"],_b={key:6,class:"text-blue-800 font-medium"},kb={key:7,class:"flex items-center"},$b={class:"text-blue-800 font-medium"},Cb={key:8,class:"text-blue-800 font-medium whitespace-pre-wrap bg-gray-50 p-2 rounded-md text-sm"},Ob={key:9},Fb={key:10,class:"text-gray-500 italic"},Ab={key:11,class:"text-blue-800 font-medium"},Tb={key:2,class:"space-y-4"},Sb={class:"text-sm font-medium text-gray-700 mb-2"},Eb={class:"space-y-3"},Db=["href","onClick"],jb={class:"text-sm text-gray-500 mt-1"},Pb={key:3,class:"space-y-4"},Lb={class:"mb-4 border-b pb-4"},Mb={class:"text-blue-800 font-medium"},Rb={class:"mb-4 border-b pb-4"},Hb={class:"text-blue-800 font-medium"},Bb={class:"mb-4 border-b pb-4"},Ib={class:"text-blue-800 font-medium"},Vb={class:"mb-4 border-b pb-4"},Nb={class:"text-blue-800 font-medium"},zb={class:"max-w-4xl max-h-screen p-4"},Ub=["src"],qb={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Wb={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Jb={class:"text-gray-600 mb-6"},Kb={class:"flex justify-end gap-3"},Yb={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Xb={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Gb={key:0,class:"text-gray-700 mb-6"},Qb={class:"mb-2"},Zb=["innerHTML"],ew={key:1,class:"text-gray-700 mb-6"},tw={class:"flex justify-end"},ow={__name:"DetailView",props:{doctype:{type:String,required:!0},recordId:{type:String,required:!0},titleField:{type:String,default:"subject"},detailFields:{type:Array,default:()=>[]}},emits:["record-deleted","record-updated"],setup(e,{emit:t}){const o=e,n=t,s=$o(),r=L({}),d=L({}),l=L([]),i=L(!0),v=L(null),p=L({}),k=L(!1),_=L([]),w=L({});L({});const y=L(!1);L(!1);const F=L(!1),A=L(!1),T=L(null),B=L([]),N=L({}),m=L(0),P=L(null),f=L(!1),D=L(""),X=L(!1),U=L(""),R=L(""),O=L(!1),C=ne(()=>o.doctype.toLowerCase().replace(/\s+/g,"-")),j=ne(()=>{if(r.value){if(r.value.name)return r.value.name;if(o.titleField&&r.value[o.titleField])return r.value[o.titleField]}return`${o.doctype} ${o.recordId}`}),Q=ne(()=>B.value.length>0),ve=ne(()=>{const I={};return B.value.forEach($=>{I[$.doctype]||(I[$.doctype]=[]),I[$.doctype].push($)}),I}),ue=I=>I.toLowerCase().replace(/\s+/g,"-"),oe=ne(()=>{const I=[];let $={label:"",columns:[[]]},W=0;const b=["name","owner","creation","modified","modified_by","docstatus","idx"],z=l.value.filter(G=>G&&G.fieldname&&!G.hidden&&!b.includes(G.fieldname)).sort((G,Z)=>(G.idx||0)-(Z.idx||0));for(const G of z)G.fieldtype==="Section Break"?$.columns[0].length>0||I.length===0?(I.push($),$={label:G.label||"",columns:[[]]},W=0):$.label=G.label||"":G.fieldtype==="Column Break"?(W++,$.columns[W]||($.columns[W]=[])):$.columns[W].push(G);return $.columns.some(G=>G.length>0)&&I.push($),I}),K=ne(()=>oe.value.filter(I=>I.columns.some($=>$.some(W=>Te(W)&&!ee(W.fieldname))))),ee=I=>["owner","creation","modified","modified_by","docstatus"].includes(I),ke=I=>N.value[I.options]||[],we=I=>ke(I).filter(W=>!W.hidden&&!mo(I.options,W.fieldname)),ye=I=>{D.value=I,f.value=!0};function Fe(I,$){return te(this,null,function*(){try{const W=yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I,name:$})});if(!W.ok){const z=yield W.json();throw new Error(z.exception||z.message||`Error fetching ${I}`)}const b=yield W.json();if(b.message)return b.message;throw new Error(`${I} not found`)}catch(W){throw console.error(`Error fetching ${I}:`,W),W}})}function J(I,$){return te(this,null,function*(){try{const b=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["allocated_to"],filters:{reference_type:I,reference_name:$,status:"Open"}})})).json();b.message&&b.message.length>0?(P.value=b.message[0].allocated_to,console.log(`Document is assigned to: ${P.value}`)):P.value=null}catch(W){console.error("Error fetching assignment info:",W),P.value=null}})}function q(I){return te(this,null,function*(){try{try{const z=yield(yield fetch("/api/method/oms.api.get_doctype_fields",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I})})).json();if(z.message&&Array.isArray(z.message)&&z.message.length>0)return console.log(`Successfully fetched ${z.message.length} fields using custom API`),z.message;console.log("Custom API returned no fields, falling back to standard API")}catch(b){console.error("Error using custom API, falling back to standard API:",b)}const W=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I})})).json();if(W.message&&W.message.docs&&W.message.docs[0]){const b=W.message.docs[0];return console.log(`Successfully fetched ${b.fields.length} fields using standard API`),{fields:b.fields||[],clientScripts:W.message.__client_scripts||[]}}else throw new Error("Failed to get fields from standard API")}catch($){throw console.error("Error fetching doctype fields:",$),$}})}function h(I){return te(this,null,function*(){try{const W=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I})})).json();return W.message&&W.message.docs&&W.message.docs[0]?W.message.docs[0].fields||[]:[]}catch($){return console.error(`Error fetching child table fields for ${I}:`,$),[]}})}function H(b){return te(this,arguments,function*(I,$=["name"],W={}){try{const G=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I,fields:$,filters:W,limit:0})})).json();return G.message?G.message:[]}catch(z){return console.error(`Error fetching options for ${I}:`,z),[]}})}function M(I,$){return te(this,null,function*(){try{console.log(`Fetching linked records for ${I} ${$}...`);const b=yield(yield fetch("/api/method/frappe.desk.form.linked_with.get_linked_doctypes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I})})).json();if(!b.message)return console.log("No linked doctypes found"),[];const z=Object.keys(b.message);console.log("Linked doctypes:",z);const G=[];for(const Z of z)try{if(["Version","Comment","Communication","File"].includes(Z))continue;const Re=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:Z,fields:["name","creation","modified"],filters:{[I.toLowerCase()]:$},limit:0})})).json();if(Re.message&&Re.message.length>0){console.log(`Found ${Re.message.length} linked ${Z} records`);const Ue=yield se(Z);if(Ue&&Ue!=="name")for(const rt of Re.message)try{const bt=yield(yield fetch("/api/method/frappe.client.get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:Z,name:rt.name})})).json();bt.message&&(rt.title=bt.message[Ue])}catch(oo){console.error(`Error fetching details for ${Z} ${rt.name}:`,oo)}Re.message.forEach(rt=>{G.push(We(ge({},rt),{doctype:Z}))})}}catch(Oe){console.error(`Error fetching linked ${Z} records:`,Oe)}return console.log("All linked records:",G),G}catch(W){return console.error(`Error fetching linked records for ${I} ${$}:`,W),[]}})}function se(I){return te(this,null,function*(){try{const W=yield(yield fetch("/api/method/frappe.desk.form.load.getdoctype",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I})})).json();if(W.message&&W.message.docs&&W.message.docs[0]){if(W.message.docs[0].title_field)return W.message.docs[0].title_field;const b=["title","subject","name","description"],z=W.message.docs[0].fields||[];for(const G of b)if(z.some(Z=>Z.fieldname===G))return G}return"name"}catch($){return console.error(`Error getting title field for ${I}:`,$),"name"}})}function ie(I,$){return te(this,null,function*(){try{const W=yield fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:I,name:$})});if(!W.ok){const b=yield W.json();throw new Error(b.exception||b.message||`Error deleting ${I}`)}return!0}catch(W){throw console.error(`Error deleting ${I}:`,W),W}})}function me(I){return te(this,null,function*(){try{console.log(`Fetching client scripts for ${I}...`);const W=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"Client Script",filters:{dt:I,enabled:1},fields:["name","script","dt","enabled","view"]})})).json();return W.message&&Array.isArray(W.message)?W.message:[]}catch($){return console.error(`Error fetching client scripts for ${I}:`,$),[]}})}const Ae=()=>te(this,null,function*(){try{i.value=!0,v.value=null,T.value=yield io(),console.log("Current user:",T.value);try{const I=yield Fe(o.doctype,o.recordId);console.log("Fetched document:",I);try{const $=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:o.doctype})});if($.ok){const W=yield $.json();W.message&&(F.value=W.message.write||!1,A.value=W.message.delete||!1,console.log(`Direct permissions for ${o.doctype}:`,W.message))}else{const W=yield Af(o.doctype);F.value=W.write,A.value=W.delete,W.if_owner&&!W.read_all&&(F.value=F.value&&I.owner===T.value,A.value=A.value&&I.owner===T.value),console.log(`Utility permissions for ${o.doctype}:`,{canEdit:F.value,canDelete:A.value})}}catch($){console.error("Error checking permissions:",$),F.value=I.owner===T.value,A.value=I.owner===T.value}r.value=I,d.value=JSON.parse(JSON.stringify(I)),yield J(o.doctype,o.recordId),B.value=yield M(o.doctype,o.recordId),Be("onload")}catch(I){console.error(`Error fetching ${o.doctype}:`,I),I.message&&I.message.includes("Permission")?v.value=`You don't have permission to view this ${o.doctype}. Please contact your administrator.`:v.value=`Failed to load ${o.doctype}: ${I.message||"Unknown error"}`}}finally{i.value=!1}}),Me=()=>te(this,null,function*(){try{const I=yield q(o.doctype);if(Array.isArray(I))l.value=I;else if(I&&I.fields)l.value=I.fields;else throw new Error("Invalid response format");const $=l.value.filter(W=>W.fieldtype==="Table");for(const W of $)if(W.options){const b=yield h(W.options);N.value[W.options]=b}yield he(),yield Ne()}catch(I){console.error("Error fetching doctype fields:",I),I.value="Failed to load doctype fields"}}),Ne=()=>te(this,null,function*(){try{console.log(`Fetching client scripts for ${o.doctype}...`);const I=yield me(o.doctype);_.value=I,console.log(`Successfully fetched ${_.value.length} client scripts`),Je()}catch(I){console.error("Error fetching client scripts:",I)}}),Je=()=>{window.frappe||(window.frappe=Ie());for(const I of _.value)try{console.log(`Parsing client script: ${I.name}`),new Function(I.script)(),console.log(`Successfully parsed client script: ${I.name}`)}catch($){console.error(`Error parsing client script ${I.name}:`,$)}},Ie=()=>({ui:{form:{on:($,W)=>{console.log(`Registering events for ${$}:`,W);for(const[b,z]of Object.entries(W))w.value[b]||(w.value[b]=[]),w.value[b].push(z),console.log(`Registered handler for ${b} event`)}}},msgprint:$=>{console.log("MSGPRINT:",$),U.value=typeof $=="object"?$.message:$,X.value=!0},throw:$=>{console.log("THROW:",$),v.value=typeof $=="object"?$.message:$},show_alert:($,W=3)=>{console.log("SHOW_ALERT:",$),U.value=typeof $=="object"?$.message:$,X.value=!0,setTimeout(()=>{X.value=!1},W*1e3)},confirm:($,W)=>{confirm($)&&W()},prompt:($,W)=>{const b=prompt($.message||"Please enter a value",$.default||"");b!==null&&W(b)},format:($,W)=>$,datetime:{now_date:()=>new Date().toISOString().split("T")[0]},model:{events:{on:($,W,b)=>{}}},meta:{get_docfield:($,W)=>l.value.find(b=>b.fieldname===W)||{}}}),Be=(I,$=null)=>{console.log(`Triggering event: ${I}, field: ${$||"none"}`);const W={doc:r.value,doctype:o.doctype,docname:o.recordId,fields_dict:{},get_field:b=>l.value.find(z=>z.fieldname===b)||{},set_value:(b,z)=>(r.value[b]=z,Promise.resolve()),refresh_field:b=>{const z=ge({},r.value);r.value=z},trigger:b=>{Be(b)}};if(w.value[I])for(const b of w.value[I])try{b(W)}catch(z){console.error(`Error executing handler for ${I} event:`,z)}if($&&w.value[$])for(const b of w.value[$])try{b(W)}catch(z){console.error(`Error executing handler for ${$} field:`,z)}},he=()=>te(this,null,function*(){const I=l.value.filter($=>$.fieldtype==="Link");for(const $ of I)try{console.log(`Fetching options for ${$.fieldname} (${$.options})`);let W=[];$.options==="Project"?W=(yield H("Project",["name","project_name"])).map(z=>({value:z.name,label:z.project_name||z.name})):$.options==="Contact"?W=(yield H("Contact",["name","first_name","last_name"])).map(z=>({value:z.name,label:`${z.first_name||""} ${z.last_name||""} (${z.name})`})):W=(yield H($.options,["name"])).map(z=>({value:z.name,label:z.name})),p.value[$.fieldname]=W}catch(W){console.error(`Error fetching options for ${$.fieldname}:`,W)}}),Te=I=>{if(!r.value)return!1;if(y.value)return!0;if(mo(o.doctype,I.fieldname))return!1;const $=r.value[I.fieldname];return I.fieldtype==="Check"||I.fieldtype==="Table"||$!=null&&$!==""},Ee=I=>{if(!I||!r.value)return"";const $=r.value[I.fieldname];if(!$)return"";if(I.fieldtype==="Link"){const b=(p.value[I.fieldname]||[]).find(z=>z.value===$);return b?b.label:$}return $},Se=I=>I?new Date(I).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",S=()=>{if(console.log("Attempting to start editing mode"),!F.value){U.value=`You don't have permission to edit this ${o.doctype}`,X.value=!0;return}d.value=JSON.parse(JSON.stringify(r.value)),y.value=!0,console.log("Edit mode activated"),Be("onedit")},g=I=>{r.value=I,y.value=!1,n("record-updated",I),Be("onupdate")},x=()=>{J(o.doctype,o.recordId)},V=()=>{J(o.doctype,o.recordId)},re=I=>{U.value=I,X.value=!0},de=()=>{if(!A.value){U.value=`You don't have permission to delete this ${o.doctype}`,X.value=!0;return}k.value=!0},$e=I=>{if(I.includes("LinkExistsError")||I.includes("is linked with")){O.value=!0;let $=I;if(I.includes("_server_messages"))try{const W=I.match(/_server_messages\s*:\s*"(.+?)"/);if(W&&W[1]){const b=W[1].replace(/\\"/g,'"').replace(/\\\\/g,"\\"),z=JSON.parse(b);Array.isArray(z)&&z.length>0&&($=JSON.parse(z[0]).message||I)}}catch(W){console.error("Error parsing server messages:",W)}return $=$.replace(/frappe\.exceptions\.LinkExistsError:\s*/,"").replace(/Cannot delete or cancel because/,"Cannot delete because"),$}return O.value=!1,I},ht=()=>te(this,null,function*(){try{i.value=!0,k.value=!1,yield ie(o.doctype,o.recordId),n("record-deleted",o.recordId),s.push(`/${C.value}`)}catch(I){console.error(`Error deleting ${o.doctype}:`,I),I.message&&I.message.includes("Permission")?U.value=`Error deleting ${o.doctype}: You don't have permission to delete this document`:(R.value=$e(I.message),U.value=I.message),X.value=!0}finally{i.value=!1}}),to=(I,$)=>{const W=`/${ue(I)}/${$}`;s.push(W)};return Qe(()=>te(this,null,function*(){console.log(`DetailView component mounted for ${o.doctype} ${o.recordId}`);try{yield Me(),yield Ae()}catch(I){console.error("Error initializing component:",I),I.value="Failed to initialize component"}})),De(()=>o.recordId,I=>te(this,null,function*(){I&&(y.value=!1,yield Ae())})),De(()=>o.doctype,()=>te(this,null,function*(){i.value=!0,l.value=[],r.value={},d.value={},y.value=!1,N.value={};try{yield Me(),yield Ae()}catch(I){console.error("Error when doctype changed:",I)}finally{i.value=!1}})),(I,$)=>(u(),c("div",n1,[i.value?(u(),c("div",r1,$[7]||($[7]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):v.value?(u(),c("div",s1,[a("p",null,E(v.value),1),a("button",{onClick:$[0]||($[0]=W=>I.$router.back()),class:"mt-2 bg-red-600 text-white px-4 py-2 rounded-lg"}," Go Back ")])):(u(),c("div",a1,[y.value?Y("",!0):(u(),c("div",i1,[a("div",l1,[a("div",d1,[a("button",{onClick:$[1]||($[1]=W=>I.$router.back()),class:"mr-3 text-blue-600 pl-3"},$[8]||($[8]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),a("h1",u1,E(j.value),1)]),a("div",c1,[F.value?(u(),c("button",{key:0,onClick:S,class:"flex items-center px-3 py-1 bg-blue-50 text-blue-600 text-sm rounded-full border border-blue-600 hover:bg-blue-50 transition-colors",title:"Edit"},$[9]||($[9]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),pe(" Edit ")]))):Y("",!0),A.value?(u(),c("button",{key:1,onClick:de,class:"p-3 bg-red-50 text-red-500 rounded-full border border-red-500 hover:bg-red-50 transition-colors",title:"Delete"},$[10]||($[10]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v10M9 7V4a1 1 0 011-1h4a1 1 0 011 1v3m-5 0h10"})],-1)]))):Y("",!0)])])])),y.value?Y("",!0):(u(),c("div",p1,[a("div",f1,[(u(!0),c(ae,null,xe(K.value,(W,b)=>(u(),c("button",{key:b,onClick:z=>m.value=b,class:fe(["px-4 py-3 text-sm font-medium whitespace-nowrap",m.value===b?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"])},E(W.label||`Section ${b+1}`),11,v1))),128)),Q.value?(u(),c("button",{key:0,onClick:$[2]||($[2]=W=>m.value=K.value.length),class:fe(["px-4 py-3 text-sm font-medium whitespace-nowrap",m.value===K.value.length?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"])}," Linked ",2)):Y("",!0),a("button",{onClick:$[3]||($[3]=W=>m.value=K.value.length+(Q.value?1:0)),class:fe(["px-4 py-3 text-sm font-medium whitespace-nowrap",m.value===K.value.length+(Q.value?1:0)?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"])}," Metadata ",2)])])),y.value?(u(),c("div",m1,[ce(As,{doctype:e.doctype,recordId:e.recordId,defaultValues:r.value,titleField:e.titleField,onFormSubmitted:g},null,8,["doctype","recordId","defaultValues","titleField"])])):(u(),c("div",h1,[a("div",g1,[a("div",y1,[a("div",b1,[a("div",w1,[$[11]||($[11]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),$[12]||($[12]=a("h3",{class:"text-lg font-medium text-gray-900 mr-2"},"Assigned To",-1)),ce(pn,{doctype:e.doctype,docname:e.recordId,onAssignmentAdded:x,onAssignmentError:re},null,8,["doctype","docname"])]),ce(fn,{doctype:e.doctype,docname:e.recordId,onAssignmentRemoved:V,onAssignmentError:re},null,8,["doctype","docname"])]),(u(!0),c(ae,null,xe(K.value,(W,b)=>(u(),c("div",{key:b,class:fe({"border-t border-gray-200 pt-6":b>0})},[W.label?(u(),c("h3",x1,E(W.label),1)):Y("",!0),a("div",_1,[(u(!0),c(ae,null,xe(W.columns,(z,G)=>(u(),c("div",{key:G,class:"space-y-4"},[(u(!0),c(ae,null,xe(z,Z=>(u(),c(ae,{key:Z.fieldname},[Te(Z)&&!ee(Z.fieldname)?(u(),c("div",k1,[a("div",$1,E(Z.label),1),Z.fieldtype==="Link"?(u(),c("div",C1,E(Ee(Z)),1)):Z.fieldtype==="Select"?(u(),c("div",O1,E(r.value[Z.fieldname]),1)):Z.fieldtype==="Text Editor"?(u(),c("div",F1,[a("div",{innerHTML:r.value[Z.fieldname]},null,8,A1)])):Z.fieldtype==="Check"?(u(),c("div",T1,[r.value[Z.fieldname]?(u(),c("span",S1,$[13]||($[13]=[a("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[a("circle",{cx:"4",cy:"4",r:"3"})],-1),pe(" Yes ")]))):(u(),c("span",E1,$[14]||($[14]=[a("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[a("circle",{cx:"4",cy:"4",r:"3"})],-1),pe(" No ")])))])):Z.fieldtype==="Attach Image"&&r.value[Z.fieldname]?(u(),c("div",D1,[a("img",{src:r.value[Z.fieldname],alt:"Attached Image",class:"h-48 w-auto rounded-lg object-cover cursor-pointer",onClick:Oe=>ye(r.value[Z.fieldname])},null,8,j1)])):Z.fieldtype==="Attach"&&r.value[Z.fieldname]?(u(),c("div",P1,[a("a",{href:r.value[Z.fieldname],target:"_blank",class:"text-blue-800 hover:underline flex items-center font-medium"},$[15]||($[15]=[a("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),pe(" Download Attachment ")]),8,L1)])):Z.fieldtype==="Date"||Z.fieldtype==="Datetime"?(u(),c("div",M1,E(Se(r.value[Z.fieldname])),1)):Z.fieldtype==="Color"&&r.value[Z.fieldname]?(u(),c("div",R1,[a("div",{class:"h-5 w-5 rounded mr-2",style:lt({backgroundColor:r.value[Z.fieldname]})},null,4),a("span",H1,E(r.value[Z.fieldname]),1)])):Z.fieldtype==="Small Text"?(u(),c("div",B1,E(r.value[Z.fieldname]),1)):Z.fieldtype==="Table"?(u(),c("div",I1,[ce(xr,{rows:r.value[Z.fieldname]||[],fields:we(Z),label:Z.label,isCollapsible:!0,doctype:Z.options},null,8,["rows","fields","label","doctype"])])):Z.fieldtype==="Table"&&(!r.value[Z.fieldname]||r.value[Z.fieldname].length===0)?(u(),c("div",V1," No items ")):(u(),c("div",N1,E(r.value[Z.fieldname]),1))])):Y("",!0)],64))),128))]))),128))])],2))),128)),Q.value?(u(),c("div",z1,[$[19]||($[19]=a("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[a("div",{class:"flex items-center"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})]),pe(" Linked Records ")])],-1)),a("div",U1,[(u(!0),c(ae,null,xe(ve.value,(W,b)=>(u(),c("div",{key:b,class:"bg-gray-50 p-4 rounded-lg"},[a("h4",q1,[$[16]||($[16]=a("span",{class:"inline-block w-2 h-2 bg-blue-600 rounded-full mr-2"},null,-1)),pe(" "+E(b)+" ("+E(W.length)+") ",1)]),a("div",W1,[(u(!0),c(ae,null,xe(W,z=>(u(),c("div",{key:z.name,class:"bg-white p-3 rounded border border-gray-200 hover:shadow-md transition-shadow"},[a("a",{href:`/${ue(b)}/${z.name}`,class:"flex justify-between items-center text-blue-800 hover:text-blue-900 font-medium",onClick:At(G=>to(b,z.name),["prevent"])},[a("div",K1,[$[17]||($[17]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),a("span",null,E(z.title||z.name),1)]),a("div",Y1,[a("span",X1,E(Se(z.modified||z.creation).split(",")[0]),1),$[18]||($[18]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,J1)]))),128))])]))),128))])])):Y("",!0),a("div",G1,[$[24]||($[24]=a("h3",{class:"text-lg font-medium text-gray-900 mb-4"},[a("div",{class:"flex items-center"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),pe(" Metadata ")])],-1)),a("div",Q1,[a("div",null,[$[20]||($[20]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Created By",-1)),a("div",Z1,E(r.value.owner||"Unknown"),1)]),a("div",null,[$[21]||($[21]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Created On",-1)),a("div",eb,E(Se(r.value.creation)),1)]),a("div",null,[$[22]||($[22]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Last Modified By",-1)),a("div",tb,E(r.value.modified_by||"Unknown"),1)]),a("div",null,[$[23]||($[23]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"},"Last Modified On",-1)),a("div",ob,E(Se(r.value.modified)),1)])])])])]),a("div",nb,[m.value===0?(u(),c("div",rb,[a("div",sb,[a("div",ab,[$[25]||($[25]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),$[26]||($[26]=a("h3",{class:"text-sm font-medium text-gray-900 whitespace-nowrap"},"Assigned To",-1)),ce(fn,{class:"flex-shrink-0",doctype:e.doctype,docname:e.recordId,onAssignmentRemoved:V,onAssignmentError:re},null,8,["doctype","docname"])]),ce(pn,{class:"flex-shrink-0",doctype:e.doctype,docname:e.recordId,onAssignmentAdded:x,onAssignmentError:re},null,8,["doctype","docname"])])])):Y("",!0),m.value<K.value.length?(u(),c("div",ib,[a("div",lb,[(u(!0),c(ae,null,xe(K.value[m.value].columns,W=>(u(),c(ae,{key:W},[(u(!0),c(ae,null,xe(W,b=>(u(),c(ae,{key:b.fieldname},[Te(b)&&!ee(b.fieldname)?(u(),c("div",db,[a("div",ub,E(b.label),1),b.fieldtype==="Link"?(u(),c("div",cb,E(Ee(b)),1)):b.fieldtype==="Select"?(u(),c("div",pb,E(r.value[b.fieldname]),1)):b.fieldtype==="Text Editor"?(u(),c("div",fb,[a("div",{innerHTML:r.value[b.fieldname]},null,8,vb)])):b.fieldtype==="Check"?(u(),c("div",mb,[r.value[b.fieldname]?(u(),c("span",hb,$[27]||($[27]=[a("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-green-400",fill:"currentColor",viewBox:"0 0 8 8"},[a("circle",{cx:"4",cy:"4",r:"3"})],-1),pe(" Yes ")]))):(u(),c("span",gb,$[28]||($[28]=[a("svg",{class:"-ml-0.5 mr-1.5 h-2 w-2 text-red-400",fill:"currentColor",viewBox:"0 0 8 8"},[a("circle",{cx:"4",cy:"4",r:"3"})],-1),pe(" No ")])))])):b.fieldtype==="Attach Image"&&r.value[b.fieldname]?(u(),c("div",yb,[a("img",{src:r.value[b.fieldname],alt:"Attached Image",class:"h-48 w-auto rounded-lg object-cover cursor-pointer",onClick:z=>ye(r.value[b.fieldname])},null,8,bb)])):b.fieldtype==="Attach"&&r.value[b.fieldname]?(u(),c("div",wb,[a("a",{href:r.value[b.fieldname],target:"_blank",class:"text-blue-800 hover:underline flex items-center font-medium"},$[29]||($[29]=[a("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),pe(" Download Attachment ")]),8,xb)])):b.fieldtype==="Date"||b.fieldtype==="Datetime"?(u(),c("div",_b,E(Se(r.value[b.fieldname])),1)):b.fieldtype==="Color"&&r.value[b.fieldname]?(u(),c("div",kb,[a("div",{class:"h-5 w-5 rounded mr-2",style:lt({backgroundColor:r.value[b.fieldname]})},null,4),a("span",$b,E(r.value[b.fieldname]),1)])):b.fieldtype==="Small Text"?(u(),c("div",Cb,E(r.value[b.fieldname]),1)):b.fieldtype==="Table"?(u(),c("div",Ob,[ce(xr,{rows:r.value[b.fieldname]||[],fields:ke(b),label:b.label,isCollapsible:!0},null,8,["rows","fields","label"])])):b.fieldtype==="Table"&&(!r.value[b.fieldname]||r.value[b.fieldname].length===0)?(u(),c("div",Fb," No items ")):(u(),c("div",Ab,E(r.value[b.fieldname]),1))])):Y("",!0)],64))),128))],64))),128))])])):Y("",!0),m.value===K.value.length&&Q.value?(u(),c("div",Tb,[(u(!0),c(ae,null,xe(ve.value,(W,b)=>(u(),c("div",{key:b,class:"mb-6"},[a("div",Sb,E(b)+" ("+E(W.length)+")",1),a("div",Eb,[(u(!0),c(ae,null,xe(W,z=>(u(),c("div",{key:z.name,class:"border rounded-lg p-3"},[a("a",{href:`/${ue(b)}/${z.name}`,class:"text-blue-800 hover:underline font-medium",onClick:At(G=>to(b,z.name),["prevent"])},E(z.title||z.name),9,Db),a("div",jb,E(Se(z.modified||z.creation)),1)]))),128))])]))),128))])):Y("",!0),m.value===K.value.length+(Q.value?1:0)?(u(),c("div",Pb,[a("div",Lb,[$[30]||($[30]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Created By ",-1)),a("div",Mb,E(r.value.owner||"Unknown"),1)]),a("div",Rb,[$[31]||($[31]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Created On ",-1)),a("div",Hb,E(Se(r.value.creation)),1)]),a("div",Bb,[$[32]||($[32]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Last Modified By ",-1)),a("div",Ib,E(r.value.modified_by||"Unknown"),1)]),a("div",Vb,[$[33]||($[33]=a("div",{class:"text-sm font-medium text-gray-500 mb-1"}," Last Modified On ",-1)),a("div",Nb,E(Se(r.value.modified)),1)])])):Y("",!0)])]))])),f.value?(u(),c("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:$[4]||($[4]=W=>f.value=!1)},[a("div",zb,[a("img",{src:D.value,alt:"Full size image",class:"max-w-full max-h-[90vh] object-contain"},null,8,Ub)])])):Y("",!0),k.value?(u(),c("div",qb,[a("div",Wb,[$[34]||($[34]=a("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Confirm Delete",-1)),a("p",Jb," Are you sure you want to delete this "+E(e.doctype)+"? This action cannot be undone. ",1),a("div",Kb,[a("button",{onClick:$[5]||($[5]=W=>k.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Cancel "),a("button",{onClick:ht,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"}," Delete ")])])])):Y("",!0),X.value?(u(),c("div",Yb,[a("div",Xb,[$[35]||($[35]=a("h3",{class:"text-lg font-medium text-red-600 mb-4"},"Error",-1)),O.value?(u(),c("div",Gb,[a("p",Qb," Cannot delete this "+E(e.doctype)+" because it is linked to other records: ",1),a("div",{class:"bg-gray-100 p-3 rounded-lg text-sm",innerHTML:R.value},null,8,Zb)])):(u(),c("div",ew,[a("p",null,E(U.value),1)])),a("div",tw,[a("button",{onClick:$[6]||($[6]=W=>X.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Close ")])])])):Y("",!0)]))}};function nw(){const e=L(null),t=L([]),o=L([]),n=L({}),s=L(!1),r=L(!1),d=L(!1),l=L(!1),i=()=>te(this,null,function*(){if(e.value)return e.value;try{return e.value=yield He.getCurrentUser(),e.value}catch(F){return console.error("Error getting current user:",F),null}}),v=()=>te(this,null,function*(){e.value||(yield i());try{return t.value=yield He.fetchUserRoles(),console.log("User roles:",t.value),t.value}catch(F){return console.error("Error fetching user roles:",F),[]}});return{currentUser:e,userRoles:t,userPermissions:o,doctypePermissions:n,canCreate:s,canRead:r,canWrite:d,canDelete:l,getCurrentUser:i,fetchUserRoles:v,fetchUserPermissions:()=>te(this,null,function*(){e.value||(yield i());try{return o.value=yield He.fetchUserPermissions(),console.log("User permissions:",o.value),o.value}catch(F){return console.error("Error fetching user permissions:",F),[]}}),checkPermissions:F=>te(this,null,function*(){e.value||(yield i()),t.value.length||(yield v());try{const A=yield fetch("/api/method/frappe.client.get_permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:F})});if(A.ok){const N=yield A.json();if(N.message)return n.value[F]=N.message,s.value=N.message.create||!1,r.value=N.message.read||!1,d.value=N.message.write||!1,l.value=N.message.delete||!1,console.log(`Direct permissions for ${F}:`,N.message),N.message}const T=yield He.fetchDocPermissions(F),B={create:!1,read:!1,write:!1,delete:!1};for(const N of T)t.value.includes(N.role)&&(N.create&&(B.create=!0),N.read&&(B.read=!0),N.write&&(B.write=!0),N.delete&&(B.delete=!0));return n.value[F]=B,s.value=B.create,r.value=B.read,d.value=B.write,l.value=B.delete,console.log(`Processed permissions for ${F}:`,B),B}catch(A){console.error(`Error checking permissions for ${F}:`,A);const T={create:!0,read:!0,write:!0,delete:!0};return n.value[F]=T,s.value=!0,r.value=!0,d.value=!0,l.value=!0,T}}),hasPermission:(F,A)=>n.value[F]&&n.value[F][A]||!1,isOwner:F=>F.owner===e.value,isAssignedToMe:(F,A)=>te(this,null,function*(){e.value||(yield i());try{const B=yield(yield fetch("/api/method/frappe.client.get_list",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doctype:"ToDo",fields:["name"],filters:{reference_type:F,reference_name:A,allocated_to:e.value,status:"Open"}})})).json();return B.message&&B.message.length>0}catch(T){return console.error("Error checking assignment:",T),!1}})}}const dw={__name:"GenerateUI",props:{doctype:{type:String,required:!0},titleField:{type:String,default:"name"},listFields:{type:Array,default:()=>[]},detailFields:{type:Array,default:()=>[]},defaultValues:{type:Object,default:()=>({})},showOnlyOwnRecords:{type:Boolean,default:!1},standardFilters:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})}},emits:["record-deleted","form-submitted","record-updated"],setup(e,{emit:t}){const o=e,n=t,s=gn(),r=$o(),d=L([]),{currentUser:l,canCreate:i,canRead:v,canWrite:p,canDelete:k,userPermissions:_,checkPermissions:w}=nw();Qe(()=>te(this,null,function*(){try{yield w(o.doctype);const f=yield He.fetchDoctypeFields(o.doctype);Array.isArray(f)?d.value=f:f&&f.fields&&(d.value=f.fields),console.log(`Loaded ${d.value.length} fields for ${o.doctype}`),console.log(`Permission check: canCreate=${i.value}, canRead=${v.value}, canWrite=${p.value}, canDelete=${k.value}`),!v.value&&F.value==="list"&&console.error(`User doesn't have permission to read ${o.doctype}`),!i.value&&F.value==="form"&&!A.value&&(console.error(`User doesn't have permission to create ${o.doctype}`),r.push(`/${y.value}`))}catch(f){console.error(`Error fetching fields for ${o.doctype}:`,f)}})),De(()=>o.doctype,()=>te(this,null,function*(){yield w(o.doctype);try{const f=yield He.fetchDoctypeFields(o.doctype);Array.isArray(f)?d.value=f:f&&f.fields&&(d.value=f.fields)}catch(f){console.error(`Error fetching fields for ${o.doctype}:`,f)}}));const y=ne(()=>o.doctype.toLowerCase().replace(/\s+/g,"-")),F=ne(()=>{const f=s.path,D=`/${y.value}`;return f===D?"list":f===`${D}/new`||f.includes("/edit/")?"form":"detail"}),A=ne(()=>s.path===`/${y.value}/new`?null:(s.path.includes("/edit/"),s.params.id)),T=ne(()=>{const f=ge({},o.defaultValues);return _.value.forEach(D=>{d.value.filter(U=>U.fieldtype==="Link"&&U.options===D.allow).forEach(U=>{f[U.fieldname]||(f[U.fieldname]=D.for_value)})}),f}),B=f=>{n("record-deleted",f),r.push(`/${y.value}`)},N=f=>{n("record-updated",f)},m=f=>{n("form-submitted",f),r.push(`/${y.value}/${f.name}`)},P=()=>{A.value?r.push(`/${y.value}/${A.value}`):r.push(`/${y.value}`)};return(f,D)=>(u(),c("div",null,[F.value==="list"?(u(),Ce(Ov,{key:0,doctype:e.doctype,titleField:e.titleField,listFields:e.listFields,showOnlyOwnRecords:e.showOnlyOwnRecords,standardFilters:e.standardFilters,filters:e.filters},null,8,["doctype","titleField","listFields","showOnlyOwnRecords","standardFilters","filters"])):F.value==="detail"?(u(),Ce(ow,{key:1,doctype:e.doctype,recordId:A.value,titleField:e.titleField,detailFields:e.detailFields,onRecordDeleted:B,onRecordUpdated:N},null,8,["doctype","recordId","titleField","detailFields"])):F.value==="form"?(u(),Ce(As,{key:2,doctype:e.doctype,recordId:A.value,defaultValues:T.value,titleField:e.titleField,onFormSubmitted:m,onCancel:P},null,8,["doctype","recordId","defaultValues","titleField"])):Y("",!0)]))}};export{aw as C,Ul as F,eo as H,Da as N,Qr as P,iw as S,ja as T,dw as _,tt as a,Rr as b,bn as c,lw as d,qa as e,Na as f,Vr as g,Wo as h,go as i,et as j,ba as k,yo as l,wn as m,Oa as n,je as o,Pr as p,yn as q,Ka as t,at as u,Ia as w,Va as y};
